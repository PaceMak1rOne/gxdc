window.TILE_VERSION={"ditu":{"normal":{"version":"088","updateDate":"20210927"},"satellite":{"version":"009","updateDate":"20210927"},"normalTraffic":{"version":"081","updateDate":"20210927"},"satelliteTraffic":{"version":"083","updateDate":"20210927"},"mapJS":{"version":"104","updateDate":"20210927"},"satelliteStreet":{"version":"083","updateDate":"20210927"},"earthVector":{"version":"001","updateDate":"20210927"}},"webapp":{"high_normal":{"version":"001","updateDate":"20210927"},"lower_normal":{"version":"002","updateDate":"20210927"}},"api_for_mobile":{"vector":{"version":"002","updateDate":"20210927"},"vectorIcon":{"version":"002","updateDate":"20210927"}}};window.MSV={"mapstyle":{"updateDate":"20210923","version":"001"}};window.BMAP_AUTHENTIC_KEY="OMEV7GvOjkdo7rvQc4pL7k6ymfX9BTK3";window.BMapGL=window.BMapGL||{};(function(bo,eB){var C=C||{version:"20150702",emptyFn:function(){}};(function(){C._log=[];var i=0;var T={};C.BaseClass=function(hU){T[(this.hashCode=(hU||C.BaseClass.guid()))]=this};C.BaseClass.guid=function(){return"mz_"+(i++).toString(36)};C.BaseClass.create=function(){var hU=new C.BaseClass();hU.decontrol();return hU};var e=C.instance=C.I=function(hU){return T[hU]};C.BaseClass.prototype.dispose=function(){if(this.hashCode){delete T[this.hashCode]}for(var hU in this){if(typeof this[hU]!="function"){delete this[hU]}}};C.BaseClass.prototype.getHashCode=function(){if(!this.hashCode){T[(this.hashCode=C.BaseClass.guid())]=this}return this.hashCode};C.BaseClass.prototype.decontrol=function(){delete T[this.hashCode]};C.BaseClass.prototype.toString=function(){return"[object "+(this._className||"Object")+"]"};C.BaseClass.prototype._wlog=function(hV,hW){var hU=C._log;if(hU.length>100){hU.reverse().length=50;hU.reverse()}hU[hU.length]="["+hV+"]["+(this._className||"Object")+" "+this.hashCode+"] "+hW}})();Function.prototype.inherits=function(hU,T){var e,hV,hX=this.prototype,hW=function(){};hW.prototype=hU.prototype;hV=this.prototype=new hW();if(typeof(T)=="string"){hV._className=T}for(e in hX){hV[e]=hX[e]}this.prototype.constructor=hX.constructor;hX=hW=null;return hV};C.BaseEvent=function(e,i){this.type=e;this.returnValue=true;this.target=i||null;this.currentTarget=this.srcElement=null;this.cancelBubble=false;this.domEvent=null};C.BaseClass.prototype.on=C.BaseClass.prototype.addEventListener=function(T,i){if(typeof i!=="function"){return this._wlog("error","addEventListener:"+i+" is not a function")}if(!this._listeners){this._listeners={}}var e=this._listeners;if(T.indexOf("on")!==0){T="on"+T}if(typeof e[T]!=="object"){e[T]={}}var hU=i.hashCode||C.BaseClass.guid();i.hashCode=hU;if(e[T][hU]){this._wlog("warning","repeat key:"+hU)}e[T][hU]=i};C.BaseClass.prototype.off=C.BaseClass.prototype.removeEventListener=function(T,i){if(typeof i=="function"){i=i.hashCode}else{if(typeof i!=="string"&&typeof i!=="undefined"){return}}if(!this._listeners){this._listeners={}}if(T.indexOf("on")!=0){T="on"+T}var e=this._listeners;if(!e[T]){return}if(i===undefined){e[T]={};return}if(e[T][i]){delete e[T][i]}};C.BaseClass.prototype.fire=C.BaseClass.prototype.dispatchEvent=function(hU){if(!this._listeners){this._listeners={}}var T,e=this._listeners,hV=hU.type;hU.target=hU.srcElement=hU.target||hU.srcElement||this;hU.currentTarget=this;if(typeof this[hV]=="function"){this[hV](hU)}if(typeof e[hV]=="object"){for(T in e[hV]){if(typeof e[hV][T]=="function"){e[hV][T].call(this,hU)}}}return hU.returnValue};C.BaseEvent.prototype.inherit=function(T){var i=this;this.domEvent=T=window.event||T;i.clientX=T.clientX||T.pageX;i.clientY=T.clientY||T.pageY;i.offsetX=T.offsetX||T.layerX;i.offsetY=T.offsetY||T.layerY;i.screenX=T.screenX;i.screenY=T.screenY;i.ctrlKey=T.ctrlKey||T.metaKey;i.shiftKey=T.shiftKey;i.altKey=T.altKey;return i};C.Browser=(function(){var T=navigator.userAgent;var hV=0;var e=0;var hW=0;var i=0;var h0=0;var hY=0;var hZ=0;var hX=0;var hU=0;var h1=0;if(typeof window.opera==="object"&&/Opera(\s|\/)(\d+(\.\d+)?)/.test(T)){hW=parseFloat(RegExp.$2)}else{if(/OPR(\/(\d+)(\..?)?)/.test(T)){hW=parseInt(RegExp.$2,10)}else{if(/Edge\/((\d+)\.\d+)/.test(T)){hV=parseInt(RegExp.$2,10)}else{if(/MSIE (\d+(\.\d+)?)/.test(T)){e=parseFloat(RegExp.$1)}else{if(T.indexOf("Trident")>-1&&/rv:(\d+(\.\d+)?)/.test(T)){e=parseInt(RegExp.$1,10)}else{if(/Firefox(\s|\/)(\d+(\.\d+)?)/.test(T)){h0=parseFloat(RegExp.$2)}else{if(navigator.vendor==="Netscape"&&/Netscape(\s|\/)(\d+(\.\d+)?)/.test(T)){hZ=parseFloat(RegExp.$2)}else{if(T.indexOf("Safari")>-1&&/Version\/(\d+(\.\d+)?)/.test(T)){i=parseFloat(RegExp.$1)}}}}}}}}if(T.indexOf("Trident")>-1&&/Trident\/(\d+(\.\d+)?)/.test(T)){hX=parseInt(RegExp.$1,10)}else{if(!e&&!hV&&T.indexOf("Gecko")>-1&&T.indexOf("KHTML")===-1&&/rv\:(\d+(\.\d+)?)/.test(T)){hU=parseFloat(RegExp.$1)}else{if(!hV&&/chrome\/(\d+(\.\d+)?)/i.test(T)){hY=parseFloat(RegExp.$1)}else{if(!hV&&/AppleWebKit\/(\d+(\.\d+)?)/.test(T)){h1=parseInt(RegExp.$1,10)}}}}var h2={edge:hV,ie:e,firefox:h0,netscape:hZ,opera:hW,safari:i,chrome:hY,gecko:hU,trident:hX,webkit:h1};return h2})();window.FeBrowser=C.Browser;C.Dom={};C.Dom.createDom=function(i,e){if(C.isIE&&e&&e.name){i="<"+i+' name="'+C.String.escapeHTML(e.name)+'">'}var T=document.createElement(i);if(e){C.Dom.setProperties(T,e)}return T};C.Dom.getOffset=function(hU){var hX=C.Dom.getOwnerDocument(hU);var hW=C.isGecko>0&&hX.getBoxObjectFor&&C.Dom.getStyle(hU,"position")=="absolute"&&(hU.style.top===""||hU.style.left==="");var hY={left:0,top:0};var i=(C.isIE&&!C.isStrict)?hX.body:hX.documentElement;if(hU==i){return hY}var T=null;var hV;if(hU.getBoundingClientRect){hV=hU.getBoundingClientRect();hY.left=hV.left+Math.max(hX.documentElement.scrollLeft,hX.body.scrollLeft);hY.top=hV.top+Math.max(hX.documentElement.scrollTop,hX.body.scrollTop);hY.left-=hX.documentElement.clientLeft;hY.top-=hX.documentElement.clientTop;if(C.isIE&&!C.isStrict){hY.left-=2;hY.top-=2}}else{if(hX.getBoxObjectFor&&!hW){hV=hX.getBoxObjectFor(hU);var e=hX.getBoxObjectFor(i);hY.left=hV.screenX-e.screenX;hY.top=hV.screenY-e.screenY}else{T=hU;do{hY.left+=T.offsetLeft;hY.top+=T.offsetTop;if(C.isWebkit>0&&C.Dom.getStyle(T,"position")=="fixed"){hY.left+=hX.body.scrollLeft;hY.top+=hX.body.scrollTop;break}T=T.offsetParent}while(T&&T!=hU);if(C.isOpera>0||(C.isWebkit>0&&C.Dom.getStyle(hU,"position")=="absolute")){hY.top-=hX.body.offsetTop}T=hU.offsetParent;while(T&&T!=hX.body){hY.left-=T.scrollLeft;if(!C.isOpera||T.tagName!="TR"){hY.top-=T.scrollTop}T=T.offsetParent}}}return hY};C.Dom.getOwnerDocument=function(e){return e.nodeType==9?e:e.ownerDocument||e.document};C.Dom.setProperties=function(i,e){C.each(e,function(hU,T){C.Dom._setProperty(i,T,hU)})};C.Dom._setProperty=function(i,e,T){if(e=="style"){i.style.cssText=T}else{if(e=="class"){i.className=T}else{if(e=="for"){i.htmlFor=T}else{if(e in C.Dom._DIRECT_ATTRIBUTE_MAP){i.setAttribute(C.Dom._DIRECT_ATTRIBUTE_MAP[e],T)}else{i[e]=T}}}}};C.Dom._DIRECT_ATTRIBUTE_MAP={cellpadding:"cellPadding",cellspacing:"cellSpacing",colspan:"colSpan",rowspan:"rowSpan",valign:"vAlign",height:"height",width:"width",usemap:"useMap",frameborder:"frameBorder"};C.G=function(){for(var T=[],hU=arguments.length-1;hU>-1;hU--){var hV=arguments[hU];T[hU]=null;if(typeof hV=="object"&&hV&&hV.dom){T[hU]=hV.dom}else{if((typeof hV=="object"&&hV&&hV.tagName)||hV==window||hV==document){T[hU]=hV}else{if(typeof hV=="string"&&(hV=document.getElementById(hV))){T[hU]=hV}}}}return T.length<2?T[0]:T};C.ac=function(e,i){if(!(e=this.G(e))){return}i=this.trim(i);if(!new RegExp("(^| )"+i.replace(/(\W)/g,"\\$1")+"( |$)").test(e.className)){e.className=e.className.split(/\s+/).concat(i).join(" ")}};C.addClassName=C.ac;C.each=function(hW,e){if(typeof e!="function"){return hW}if(hW){if(hW.length===undefined){for(var T in hW){e.call(hW[T],hW[T],T)}}else{for(var hU=0,hV=hW.length;hU<hV;hU++){e.call(hW[hU],hW[hU],hU)}}}return hW};C.extend=function(hW,hU){if(hW&&hU&&typeof(hU)=="object"){for(var hV in hU){hW[hV]=hU[hV]}var T=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"];for(var e=0,i;e<T.length;e++){i=T[e];if(Object.prototype.hasOwnProperty.call(hU,i)){hW[i]=hU[i]}}}return hW};C.hide=function(){C.each(arguments,function(e){if(e=C.G(e)){e.style.display="none"}})};C.inherit=function(hY,hU,T){var hX=hY.prototype;var hW=function(){};hW.prototype=hU.prototype;var hV=hY.prototype=new hW();if(typeof T=="string"){hV._className=T}for(var e in hX){hV[e]=hX[e]}hY.prototype.constructor=hX.constructor;hX=null;return hV};C.isIE=0;(function(){if(navigator.userAgent.indexOf("MSIE")>0&&!window.opera){/MSIE (\d+(\.\d+)?)/.test(navigator.userAgent);C.isIE=parseFloat(RegExp.$1)}})();C.rc=function(e,i){if(!(e=this.G(e))){return}i=this.trim(i);var T=e.className.replace(new RegExp("(^| +)"+i.replace(/(\W)/g,"\\$1")+"( +|$)","g"),"$2");if(e.className!=T){e.className=T}};C.removeClassName=C.rc;C.show=function(){this.each(arguments,function(e){if(e=C.G(e)){e.style.display=""}})};C.trim=function(e){return e.replace(/(^[\s\t\xa0\u3000]+)|([\u3000\xa0\s\t]+$)/g,"")};C.getElementsByClassName=function(e,i){if(e.getElementsByClassName){return e.getElementsByClassName(i)}else{return(function T(h1,hZ){if(hZ==null){hZ=document}var hY=[],hX=hZ.getElementsByTagName("*"),hU=hX.length,h0=new RegExp("(^|\\s)"+h1+"(\\s|$)"),hW,hV;for(hW=0,hV=0;hW<hU;hW++){if(h0.test(hX[hW].className)){hY[hV]=hX[hW];hV++}}return hY})(i,e)}};C.toggleClass=function(e,i){if(C.hasClass(e,i)){C.removeClassName(e,i)}else{C.addClassName(e,i)}};C.hasClass=function(hU,T){if(!hU||!hU.className||typeof hU.className!="string"){return false}var i=-1;try{i=hU.className==T||hU.className.search(new RegExp("(\\s|^)"+T+"(\\s|$)"))}catch(hV){return false}return i>-1};C.insertHTML=function(hU,e,T){hU=C.G(hU);if(hU===null){return hU}var i,hV;if(hU.insertAdjacentHTML){hU.insertAdjacentHTML(e,T)}else{i=hU.ownerDocument.createRange();e=e.toUpperCase();if(e=="AFTERBEGIN"||e=="BEFOREEND"){i.selectNodeContents(hU);i.collapse(e=="AFTERBEGIN")}else{hV=e=="BEFOREBEGIN";i[hV?"setStartBefore":"setEndAfter"](hU);i.collapse(hV)}i.insertNode(i.createContextualFragment(T))}return hU};if(typeof HTMLElement!="undefined"&&HTMLElement.prototype.__lookupGetter__&&!HTMLElement.prototype.__lookupGetter__("children")&&!window.opera){try{HTMLElement.prototype.__defineGetter__("children",function(){for(var T=[],hU=0,hW,hV=0,e=this.childNodes.length;hV<e;hV++){hW=this.childNodes[hV];if(hW.nodeType==1){T[hU++]=hW;if(hW.name){if(!T[hW.name]){T[hW.name]=[]}T[hW.name][T[hW.name].length]=hW}if(hW.id){T[hW.id]=hW}}}return T})}catch(gz){}}if(typeof(HTMLElement)!="undefined"&&!window.opera&&HTMLElement.prototype&&!HTMLElement.prototype.insertAdjacentHTML){HTMLElement.prototype.insertAdjacentHTML=function(i,T){var hU=this.ownerDocument.createRange();hU.setStartBefore(this);hU=hU.createContextualFragment(T);switch(i){case"beforeBegin":this.parentNode.insertBefore(hU,this);break;case"afterBegin":this.insertBefore(hU,this.firstChild);break;case"beforeEnd":this.appendChild(hU);break;case"afterEnd":if(!this.nextSibling){this.parentNode.appendChild(hU)}else{this.parentNode.insertBefore(hU,this.nextSibling)}break}}}if(typeof HTMLElement!="undefined"&&!window.opera){HTMLElement.prototype.contains=function(e){if(e==this){return true}while(e=e.parentNode){if(e==this){return true}}return false}}if(!C.Browser.ie&&typeof Event!="undefined"&&!window.opera){Event.prototype.__defineSetter__("returnValue",function(e){if(!e){this.preventDefault()}return e});Event.prototype.__defineSetter__("cancelBubble",function(e){if(e){this.stopPropagation()}return e})}C.each=function(hV,hU){if(bV(hU)){for(var T=0,e=hV.length;T<e;T++){if(hU.call(hV,hV[T],T)===false){break}}}return hV};C.Platform={x11:0,macintosh:0,windows:0,android:0,iphone:0,ipad:0};for(var gv in C.Platform){if(C.Platform.hasOwnProperty(gv)){C.Platform[gv]=new RegExp(gv,"i").test(window.navigator.userAgent)?1:0}}if(typeof(C.Dom)==="undefined"){C.Dom={}}C.Dom.getComputedStyle=function(i,e){var hU=i.nodeType==9?i:i.ownerDocument||i.document,T;if(hU.defaultView&&hU.defaultView.getComputedStyle){T=hU.defaultView.getComputedStyle(i,null);if(T){return T[e]||T.getPropertyValue(e)}}else{if(i.currentStyle){return i.currentStyle[e]||""}}return""};var bb=C.BaseEvent;var ed=C.BaseClass;ed.prototype.toString=function(){return this._className||""};C.on=function(T,i,e){if(!(T=C.G(T))){return T}i=i.replace(/^on/,"");if(T.addEventListener){T.addEventListener(i,e,false)}else{if(T.attachEvent){T.attachEvent("on"+i,e)}}return T};C.un=function(T,i,e){if(!(T=C.G(T))){return T}i=i.replace(/^on/,"");if(T.removeEventListener){T.removeEventListener(i,e,false)}else{if(T.detachEvent){T.detachEvent("on"+i,e)}}return T};C.hc=function(hU,T){if(!hU||!hU.className||typeof hU.className!="string"){return false}var i=-1;try{i=hU.className==T||hU.className.search(new RegExp("(\\s|^)"+T+"(\\s|$)"))}catch(hV){return false}return i>-1};C.isEmptyObject=function(T){if(Object.prototype.toString.call(T)==="[object Object]"){for(var e in T){return false}return true}else{return false}};var f6=window.location.protocol==="http:"?"http:":"https:";var eW={fontFamily:'Arial,Helvetica,"PingFang SC","Hiragino Sans GB",STHeiti,sans-serif',mapStyleNameIdPair:{"default":0,"grayed-out":1},mapHost:f6+"//map.baidu.com",apiHost:f6+"//api.map.baidu.com",apiIMG:f6+"//api.map.baidu.com/images",staticHost:f6+"//webmap0.bdimg.com",imgPath:f6+"//webmap0.bdimg.com/image/api/",tileDomain:[f6+"//maponline0.bdimg.com",f6+"//maponline1.bdimg.com",f6+"//maponline2.bdimg.com",f6+"//maponline3.bdimg.com"],optDomain:"http://10.120.25.45:8017",rasterTilePath:"/tile/",vectorTilePath:"/pvd/",originTilePath:[f6+"//pcor.baidu.com"],getIconSetPath:function(e){var i="map_icons2x/";if(typeof e==="string"&&this.mapStyleNameIdPair[e]>0){i="map_icons2x_"+(this.mapStyleNameIdPair[e]-1)+"/"}return f6+"//maponline0.bdimg.com/sty/"+i},getMapStyleFiles:function(T){var hV=true;if(typeof T==="string"&&T!=="default"){hV=false}var hW=hV?"":"_"+(this.mapStyleNameIdPair[T]-1);var i=fC();var hU="udt="+i.udt+"&v="+i.ver;var e=f6+"//maponline0.bdimg.com/sty/";return[e+"icons_2x"+hW+".js?"+hU,e+"fs"+hW+".js?"+hU,e+"indoor_fs.js?"+hU]},tvc:{ditu:{normal:{version:"088",updateDate:"20210726"},satellite:{version:"009",updateDate:"20210726"},normalTraffic:{version:"081",updateDate:"20210726"},satelliteTraffic:{version:"083",updateDate:"20210726"},mapJS:{version:"104",updateDate:"20210726"},satelliteStreet:{version:"083",updateDate:"20210726"},panoClick:{version:"1033",updateDate:"20180108"},panoUdt:{version:"20180108",updateDate:"20180108"},panoSwfAPI:{version:"20150123",updateDate:"20150123"},panoSwfPlace:{version:"20141112",updateDate:"20141112"},earthVector:{version:"001",updateDate:"20210726"}}},msv:{mapstyle:{updateDate:"20210726",version:"001"}}};eW.imgResources={blankGIF:eW.staticHost+"/res/litemapapi/v1d1/images/blank.gif?20170501",markerPng:eW.staticHost+"/res/litemapapi/v1d1/images/marker.png?20170501",locPng:eW.staticHost+"/res/litemapapi/v1d1/images/loc.png?20180918",locNewPng:eW.staticHost+"/res/litemapapi/v1d1/images/loc_new.png?20190314",zoomPng:eW.staticHost+"/res/litemapapi/v1d1/images/zoombtn.png?20180918",mapLogoPng:eW.staticHost+"/res/litemapapi/v1d1/images/logo-2x.png?20190226"};var e5=eW;var a3="ruler.cur";if(C.Browser.ie||C.Browser.edge){C.extend(e5,{distCursor:"url("+e5.imgPath+a3+"),crosshair",defaultCursor:"url("+e5.imgPath+"openhand.cur),default",draggingCursor:"url("+e5.imgPath+"closedhand.cur),move"})}else{if(C.Browser.firefox){C.extend(e5,{distCursor:"url("+e5.imgPath+a3+"),crosshair",defaultCursor:"-moz-grab",draggingCursor:"-moz-grabbing"})}else{if(C.Browser.chrome||C.Browser.safari){C.extend(e5,{distCursor:"url("+e5.imgPath+a3+") 2 6,crosshair",defaultCursor:"url("+e5.imgPath+"openhand.cur) 8 8,default",draggingCursor:"url("+e5.imgPath+"closedhand.cur) 8 8,move"});if(C.Platform.macintosh){e5.defaultCursor="-webkit-grab";e5.draggingCursor="-webkit-grabbing"}}else{C.extend(e5,{distCursor:"url("+e5.imgPath+a3+"),crosshair",defaultCursor:"url("+e5.imgPath+"openhand.cur),default",draggingCursor:"url("+e5.imgPath+"closedhand.cur),move"})}}}bo=bo||{};bo.version="gl";bo._register=[];bo.register=function(e){this._register[this._register.length]=e};bo.guid=1;bo.getGUID=function(e){return(e||"")+bo.guid++};var gh=window.BMAP_AUTHENTIC_KEY||"";window.__abbaidu_2063_cidcb=function(e){var i=2;var T=new Date();T.setTime(T.getTime()+i*24*60*60*1000);document.cookie="SECKEY_CID1="+e+";expires="+T.toGMTString();window.SECKEY_CID=e};window.__abbaidu_2063_cb=function(i){var e=JSON.parse(i);var T=2;var hU=new Date();hU.setTime(hU.getTime()+T*24*60*60*1000);document.cookie="BMAP_SECKEY="+e.data+";expires="+hU.toGMTString()};bo.bmapVerifyCbk=function(e){if(e&&e.error!==0){if(typeof map!=="undefined"){map.getContainer().innerHTML="";map.__listeners={}}bo=null;var i="百度未授权使用地图API，可能是因为您提供的密钥不是有效的百度地图开放平台密钥，或此密钥未对本应用的百度地图JavaScriptAPI授权。您可以访问如下网址了解如何获取有效的密钥：https://lbs.baidu.com/apiconsole/key#。";switch(e.error){case 101:i="您所使用的密钥ak有问题，不支持jsapi服务，可以访问该网址了解如何获取有效密钥：http://lbsyun.baidu.com/apiconsole/key#。";break;case 102:i="MCODE参数不存在，mobile类型MCODE参数必需，详情查看：http://lbsyun.baidu.com/apiconsole/key#。";break;case 200:i="APP不存在，AK有误请检查再重试，详情查看：http://lbsyun.baidu.com/apiconsole/key#。";break;case 201:i="APP被您禁用啦，可以访问 http://lbsyun.baidu.com/apiconsole/key# 查看自己的应用具体详情，或联系我们了解详情。";break;case 202:i="APP被管理员删除啦，可以访问 http://lbsyun.baidu.com/apiconsole/key# 查看自己的应用具体详情，或联系我们了解详情。";break;case 203:i="APP类型错误，可以访问 http://lbsyun.baidu.com/apiconsole/key# 查看自己的应用具体详情，或联系我们了解详情。";break;case 210:i="APP IP校验失败，可以访问 http://lbsyun.baidu.com/apiconsole/key# 查看自己的应用具体详情，或联系我们了解详情。";break;case 220:i="APP Referer校验失败。请检查该ak设置的白名单与访问所有的域名是否一致。详情查看：http://lbsyun.baidu.com/apiconsole/key#";break;case 230:i="APP Mcode码校验失败，可以访问 http://lbsyun.baidu.com/apiconsole/key# 查看自己的应用具体详情，或联系我们了解详情。";break;case 240:i="APP服务被禁用了，可以访问 http://lbsyun.baidu.com/apiconsole/key# 查看自己的应用具体详情，或联系我们了解详情。";break;case 250:i="该用户不存在... 请登录 https://lbs.baidu.com 的控制台，注册成为开发者申请ak吧。";break;case 251:i="该用户被自己删除啦，可以访问 http://lbsyun.baidu.com/apiconsole/key# 查看自己的应用具体详情。";break;case 252:i="该用户被管理员删除啦，可以访问 http://lbsyun.baidu.com/apiconsole/key# 了解如何获取有效密钥，或请联系我们了解详情。";break;case 260:i="您所使用的密钥AK不包含该服务呢，可以访问 http://lbsyun.baidu.com/apiconsole/key# 查看服务选择情况，或请联系我们了解详情。";break;case 261:i="您所使用的密钥AK的该服务被禁用啦，可以访问 http://lbsyun.baidu.com/apiconsole/key# 查看服务选择情况，或请联系我们了解详情。";break;case 401:i="您所使用的AK并发超限了，请登录 http://lbsyun.baidu.com/cashier/quota#/home 了解详情。";break;case 302:i="您所使用的AK天配额超限了，请登录 http://lbsyun.baidu.com/cashier/quota#/home 了解详情。";break}alert(i)}};bo.frequencyCbk=function(e){if(e){window.QTFrequency=e}};bo.verify=function(){var e=e5.apiHost+"/?qt=verify&v=gl&type=webgl&ak="+gh+"&callback="+eB+".bmapVerifyCbk";hp.load(e)};bo.frequency=function(){};bo.getSeckey=function(){var e=f6+"//dlswbr.baidu.com/heicha/mw/abclite-2063-s.js";hp.load(e)};bo.apiLoad=bo.apiLoad||function(){};function fN(i,e){this._size=i;this._cache=[];this._totalGetTimes=0;this._totalHitTimes=0;this._options={clearCallback:null,removeOldCallback:null};e=e||{};for(var T in e){if(e.hasOwnProperty(T)){this._options[T]=e[T]}}}fN.prototype.setData=function(T,hU){var e=this._cache;var i=this._size;if(i===0){return}if(e.length>i){this._removeOld()}if(!e[T]){e.push(hU)}e[T]=hU;hU._key_=T};fN.prototype.getHitRate=function(){return Math.round(this._totalHitTimes/this._totalGetTimes*1000)/1000};fN.prototype.getData=function(i){var e=this._cache[i];if(e){this._totalHitTimes++}this._totalGetTimes++;return e};fN.prototype.removeData=function(hV){if(this._options.clearCallback){this._options.clearCallback(this._cache[hV])}var T=this._cache;var hW=T[hV];for(var hU=0,e=T.length;hU<e;hU++){if(T[hU]===hW){T.splice(hU,1);break}}delete T[hV]};fN.prototype._removeOld=function(){var e=this._cache;var hV=Math.round(this._size*0.6);for(var hU=0;hU<hV;hU++){var T=e[hU]._key_;if(this._options.clearCallback){this._options.clearCallback(e[T])}delete e[T]}e.splice(0,hV);if(this._options.removeOldCallback){this._options.removeOldCallback()}};fN.prototype.clear=function(){var T=this._cache;for(var hV=0,e=T.length;hV<e;hV++){var hU=T[hV]._key_;if(this._options.clearCallback){this._options.clearCallback(T[hU])}delete T[hU]}this._cache=T=[]};fN.prototype.forEach=function(hU){var T=this._cache;for(var hW=0,e=T.length;hW<e;hW++){var hV=T[hW]._key_;hU(T[hV])}};fN.prototype.getBatch=function(hV){var e=[];for(var hU=0,T=hV.length;hU<T;hU++){if(this.getData(hV[hU])){e[e.length]=this.getData(hV[hU])}}return e};fN.prototype.clearExcept=function(hW){var T=this._cache;for(var e=T.length,hV=e-1;hV>=0;hV--){var hU=this._cache[hV]._key_;if(!hW[hU]){T.splice(hV,1);if(this._options.clearCallback){this._options.clearCallback(T[hU])}delete T[hU]}}};fN.prototype.getDataCount=function(){return this._cache.length};function am(){}C.extend(am.prototype,{centerAndZoomIn:function(hZ,T,h0){var hX=this;if(!hZ&&!T){return}hZ=hZ||this.centerPoint;T=T||this.zoomLevel;T=this._getProperZoom(T).zoom;if(this.mapType===BMAP_EARTH_MAP){if(!this._earth){this.mapType=BMAPGL_NORMAL_MAP;this.temp.originMapType=BMAP_EARTH_MAP;function hY(){hX._earth=new bo.Earth(hX,{showRealSunlight:hX.config.showRealSunlight,showMilkyway:hX.config.showMilkyway,earthBackground:hX.config.earthBackground});hX._proxyEarthEvents();hX._changeEarthMapType(BMAP_EARTH_MAP);C.extend(hX,bo.EarthView.prototype);if(!hX._navigationCtrl&&hX.config.showControls){hX._navigationCtrl=new bo.NavigationControl3D(hX)}delete hX.temp.originMapType}ea.load("earth",function(){if(bo["FeatureStyle"+hX.config.style]){hY()}else{hX.loadMapStyleFiles(function(){hY()})}})}}this.lastLevel=this.zoomLevel||T;this.zoomLevel=T;var hV=new bb("onload");hV.point=hZ;hV.zoom=T;this.centerPoint=this.restrictCenter(new hv(hZ.lng,hZ.lat));if(this.centerPoint.zoom){this.zoomLevel=this.centerPoint.zoom}this.defaultZoomLevel=this.defaultZoomLevel||this.zoomLevel;this.defaultCenter=this.defaultCenter||this.centerPoint;if(!this.loaded&&!(this.temp.originMapType===BMAP_EARTH_MAP)){var i=this.config.defaultMaxBounds;var hW=new c5(i,"baidu",this.mapType);var hU=new cR({mapType:this.mapType,copyright:hW,customLayer:false,baseLayer:true,tileTypeName:"web"});hU._isInnerLayer=true;this.addTileLayer(hU);if(this.mapType===BMAP_SATELLITE_MAP&&this._isHybridShow===true){this._addHybirdMap()}}this.dispatchEvent(hV);this.loaded=true;h0=h0||{};h0.callback&&h0.callback()},_setPlatformPosition:function(h0,hZ,h3){h3=h3||{};if(h0===0&&hZ===0&&!h3.point){return}if(isNaN(h3.initMapOffsetX)){h3.initMapOffsetX=this.offsetX}if(isNaN(h3.initMapOffsetY)){h3.initMapOffsetY=this.offsetY}var h1=h0+h3.initMapOffsetX;var hY=hZ+h3.initMapOffsetY;if(h3.point){var i=this.restrictCenter(h3.point);if(!i.equals(this.centerPoint)){this.centerPoint=i.clone();this.fire(new bb("oncenter_changed"))}}else{var hU=this.offsetX-h1;var e=this.offsetY-hY;var T=this.getZoomUnits();var hX=this.centerPoint.lng;var hW=this.centerPoint.lat;var hV=new hv(hX,hW);this.centerPoint=this.restrictCenter(new hv(hV.lng+hU*T,hV.lat-e*T),T);this.fire(new bb("oncenter_changed"));if(this.zoomLevel<10){h1=this.offsetX-(this.centerPoint.lng-hV.lng)/T;hY=this.offsetY+(this.centerPoint.lat-hV.lat)/T}}this.offsetX=h1;this.offsetY=hY;var h2=this.platform.style;h2.left=h1+"px";h2.top=hY+"px";this.maskLayer.style.left=-h1+"px";this.maskLayer.style.top=-hY+"px";if(h3.dispatchEvent!==false){this.dispatchEvent(new bb("onmoving"))}},zoomTo:function(e,hX,h1){h1=h1||{};h1.zoomCenter=hX;if(h1.noAnimation!==true){this.deepZoomTo(e,h1);return}if(typeof e!=="number"){return}var hV=b6[this.mapType];if(!hV){return}var T=e;e=this._getProperZoom(e).zoom;if(e===this.zoomLevel){var hY=new bb("onzoomexceeded");hY.targetZoom=T;this.dispatchEvent(hY);h1.callback&&h1.callback();return}this.lastLevel=this.zoomLevel;if(hX){this.temp._cPoint=hX;this.temp._cPixel=this.pointToPixelIn(hX)}else{if(this.getInfoWindow()){var h0=this.getInfoWindow().getPoint();this.temp._cPixel=this.pointToPixelIn(h0);this.temp._cPoint=h0}}if(this.config.zoomCenter){hX=this.config.zoomCenter;this.temp._cPoint=hX;this.temp._cPixel=this.pointToPixelIn(hX)}if(hX||this.temp.infoWin&&this.temp.infoWin.isOpen()){var i=this.temp._cPoint;var hZ=this.temp._cPixel;var hU=this.getZoomUnits(e);var hW=new hv(i.lng+hU*(this.width/2-hZ.x),i.lat-hU*(this.height/2-hZ.y));this.centerPoint=this.restrictCenter(hW,hU,e);if(this.centerPoint.zoom){e=this.centerPoint.zoom}}if(h1.fireEvent!==false){this.dispatchEvent(new bb("onzoomstart"))}if(e!==this.zoomLevel){this.zoomLevel=e;this.dispatchEvent(new bb("onzooming"));this.dispatchEvent(new bb("onzoomstartcode"))}if(h1.fireEvent!==false){this.dispatchEvent(new bb("onzoomend"))}if(h1.callback){h1.callback()}},deepZoomMedia:function(e){var i=this;if(!i.temp.isStdCtrlBusy){i.temp.isStdCtrlBusy=true;i.deepZoomTo(i.zoomLevel+e);setTimeout(function(){i.temp.isStdCtrlBusy=false},400)}},deepZoomTo:function(hY,hU){hU=hU||{};var hW=hY-this.zoomLevel;var hV=this._getProperZoom(hY);if(hV.exceeded){var e=new bb("onzoomexceeded");e.targetZoom=hY;this.dispatchEvent(e);return}var i;if(hU.zoomCenter){i=this.pointToPixelIn(hU.zoomCenter)}else{if(this.getInfoWindow()){i=this.pointToPixelIn(this.getInfoWindow().getPoint(),{zoom:this.lastLevel})}else{var i=new ej(this.width/2,this.height/2)}}this.lastLevel=this.zoomLevel;var hX=this.deepZoom||new bE(this);var T=hW>0?1:-1;hX.zoomMap(i,hW,T,null,hU)},flyToIn:function(hZ,e){if(e===this.zoomLevel){this.panToIn(hZ);return}var hW=this._getProperZoom(e);if(hW.exceeded){var h0=new bb("onzoomexceeded");h0.targetZoom=e;this.dispatchEvent(h0);return}var hY=e-this.zoomLevel;var T=new ej(this.width/2,this.height/2);var i=this.pointToPixelIn(hZ);var hX=new d9(i.x-T.x,i.y-T.y);this.lastLevel=this.zoomLevel;if(Math.abs(hY)>=4||Math.abs(hX.width)>this.width||Math.abs(hX.height)>this.height){this.centerAndZoomIn(hZ,e);return}var hV=this.deepZoom||new bE(this);var hU=hY>0?1:-1;hV.zoomMap(i,hY,hU,hX)},panToIn:function(i,T){T=T||{};if(!i||i.equals(this.centerPoint)){T.callback&&T.callback();return}var hU=this.pointToPixelIn(i);var e=Math.round(this.width/2);var hV=Math.round(this.height/2);if(Math.abs(e-hU.x)>this.width||Math.abs(hV-hU.y)>this.height||T.noAnimation===true){this._panToIn(e-hU.x,hV-hU.y,i);T.callback&&T.callback()}else{this._panBy(e-hU.x,hV-hU.y,T)}},_panToIn:function(i,e,hU){var T=this.temp;if(T.operating===true){return}if(T.dragAni){T.dragAni.stop();T.dragAni=null;this.dispatchEvent(new bb("onmoveend"))}this.dispatchEvent(new bb("onmovestart"));this._setPlatformPosition(i,e,{point:hU});this.dispatchEvent(new bb("onmoveend"))},panBy:function(i,e,T){T=T||{};i=Math.round(i)||0;e=Math.round(e)||0;if(Math.abs(i)<=this.width&&Math.abs(e)<=this.height&&T.noAnimation!==true){this._panBy(i,e,T)}else{this._panToIn(i,e);T.callback&&T.callback()}},_panBy:function(i,e,hV){if(this.temp.operating===true){return}hV=hV||{};this.dispatchEvent(new bb("onmovestart"));var hU=this;var T=hU.temp;T.pl=hU.offsetX;T.pt=hU.offsetY;if(T.tlPan){T.tlPan.cancel()}if(T.dragAni){T.dragAni.stop();T.dragAni=null;this.dispatchEvent(new bb("onmoveend"))}T.tlPan=new o({fps:hV.fps||hU.config.fps,duration:hV.duration||hU.config.actionDuration,transition:hV.transition||cn.easeInOutQuad,render:function(hW){this.terminative=hU.temp.operating;if(hU.temp.operating){return}hU._setPlatformPosition(Math.ceil(i*hW),Math.ceil(e*hW),{initMapOffsetX:T.pl,initMapOffsetY:T.pt})},finish:function(hW){hU.dispatchEvent(new bb("onmoveend"));hU.temp.tlPan=false;if(hU.temp.stopArrow===true){hU.temp.stopArrow=false;if(hU.temp.arrow!==0){hU._arrow()}}hV.callback&&hV.callback()}})},getCenterIn:function(){return this.centerPoint},getZoom:function(){return this.zoomLevel},setTilt:function(){},getTilt:function(){return this._tilt},setHeading:function(){},getHeading:function(){return this._heading},restrictCenter:function(hY,hV,hZ){this.isRestrict=false;hV=hV||this.getZoomUnits();hZ=hZ||this.zoomLevel;var T=this.pixelToPointIn(new ej(0,0),{center:hY,zoom:hZ});var hW=this.pixelToPointIn(new ej(0,this.height),{center:hY,zoom:hZ});if(this.zoomLevel<5){if(T.lat>c8.MAX_LAT&&hW.lat<c8.MIN_LAT){this.isRestrict=true;var i=c8.MAX_LAT-hY.lat;var e=hY.lat-c8.MIN_LAT;var hX;if(i<e){hX=i/(this.height/2)}else{hX=e/(this.height/2)}var hU=18-eD(hX);this.zoomLevel=Math.ceil(hU);hY.zoom=Math.ceil(hU);return hY}}if(T.lat>c8.MAX_LAT){this.isRestrict=true;hY.lat=c8.MAX_LAT-this.height/2*hV}else{if(hW.lat<c8.MIN_LAT){this.isRestrict=true;hY.lat=c8.MIN_LAT+this.height/2*hV}}return hY}});function c8(e,T){if(typeof e==="string"){e=document.getElementById(e)}ed.call(this);this.container=e;this.width=e.clientWidth;this.height=e.clientHeight;this.offsetX=0;this.offsetY=0;this._setStyle(e);e.unselectable="on";e.innerHTML="";C.ac(e,"bmap-container");e.appendChild(this.render());this._initDate=new Date();this.platform=e.children[0];this.maskLayer=this.platform.children[0];this._panes={};this.centerPoint=new hv(0,0);this.zoomLevel=0;this._heading=0;this._tilt=0;this._bounds=new dS();this.lastLevel=0;this._lock=false;this._enableTiltZoom=7;this._enableHeadingZoom=7;this.defaultZoomLevel=null;this.defaultCenter=null;this.zoomEventStatus="idle";this.currentOperation=dU.idle;this._setConfig(T);this._initMapRenderType();this._animationInfo={};this._animationInfoUnstopable={};this.suspendLoad=false;this._customTileLabels=[];if(this._renderType==="webgl"){this._workerMgr=new gc(this);this._featureMgr=new dc();C.extend(this,c7.prototype);this.jobScheduler=new fR(this);this.benchmark=new ac();this._setupWebGLMap();this.deviceInfo={hardwareInfo:{renderer:"",vendor:""}};if(a8.ifSupportWebGL._renderer){this.deviceInfo.hardwareInfo.renderer=a8.ifSupportWebGL._renderer;this.deviceInfo.hardwareInfo.vendor=a8.ifSupportWebGL._vendor}}else{C.extend(this,am.prototype)}if(!b6[this.config.mapType]){this.config.mapType=BMAPGL_NORMAL_MAP}if(this.config.mapType===BMAP_EARTH_MAP&&!this.config.enableEarth){if(this.forceEnableEarth()===false){this.config.mapType=BMAPGL_NORMAL_MAP}}this.mapType=this.config.mapType;this.preMapType=null;if(this.config.enableEarth){var hW=this.maskLayer.style;hW.opacity=0;hW.background="#000";if(this.config.mapType===BMAP_EARTH_MAP){hW.opacity=1}setTimeout(function(){hW.WebkitTransition=hW.transition="opacity .4s"},100)}this._isHybridShow=this.config.showStreetLayer;this.temp={operating:false,arrow:0,lastDomMoveTime:0,lastLoadTileTime:0,lastMovingTime:0,canKeyboard:false,I:function(i){return C.I(i)},curSpots:[],curSpotsArray:[],curAreaSpot:null,spotsGuid:1,registerIndex:-1,hoverOnSpot:null,isStdCtrlBusy:false};window.InstanceCore=this.temp.I;this.platform.style.cursor=this.config.defaultCursor;this._bind();for(var hU=0;hU<bo._register.length;hU++){bo._register[hU](this)}this.temp.registerIndex=hU;var hV=this;if(this._renderType==="webgl"){ea.load("oppcgl",function(){hV._asyncRegister()})}else{ea.load("oppc",function(){hV._asyncRegister()})}if(this.config.mapType==="B_EARTH_MAP"){if(!bo.Earth){ea.load("earth",function(){})}else{hV._syncAndChangeMapType("B_EARTH_MAP")}}}c8.MAX_TILT=87;c8.MAX_DRAG_TILT=73;c8.MAX_DRAG_TILT_L2=50;c8.MIN_TILT=0;c8.MAX_LAT=19431424;c8.MIN_LAT=-16023552;c8.WORLD_SIZE_MC_HALF=20037726.372307256;c8.WORLD_SIZE_MC=c8.WORLD_SIZE_MC_HALF*2;c8.RIGHT_EDGE_POINT=new hv(c8.WORLD_SIZE_MC_HALF,0);c8.LEFT_EDGE_POINT=new hv(-c8.WORLD_SIZE_MC_HALF,0);c8.HIGH_RES_MIN_RATIO=1.2;c8.inherits(ed,"Map");var da={NORMAL:"B_NORMAL_MAP",EARTH:"B_EARTH_MAP",SATELLITE:"B_STREET_MAP"};bo.MapTypeId=da;C.extend(c8.prototype,{render:function(){var e=S("div",{id:"platform"});var hU=e.style;hU.overflow="visible";hU.position="absolute";hU.zIndex=5;hU.top=hU.left="0px";var i=S("div",{id:"mask","class":"BMap_mask"});var T=i.style;T.position="absolute";T.top=T.left="0px";T.zIndex="9";T.overflow="hidden";T.WebkitUserSelect="none";T.width=this.width+"px";T.height=this.height+"px";e.appendChild(i);return e},_initMapRenderType:function(){var e=this.config.forceRenderType;if(e==="dom"){this._renderType="dom";return}else{if(e==="canvas"){if(a8.isModernBrowser&&!a8.ifCanvas2dInBlackList()){this._renderType="canvas";return}else{this._renderType="dom";return}}else{if(e==="webgl"){if(a8.ifSupportWebGL()){this._renderType="webgl";return}}}}if(a8.ifSupportWebGL()&&a8.ifEnableWebGLMap()){this._renderType="webgl";return}if(a8.isModernBrowser&&a8.ifEnableCanvas2dMap()){this._renderType="canvas";return}this._renderType="dom"},_setConfig:function(i){i=i||{};this.config={bottomOffset:0,clickInterval:200,enableDragging:true,enableRotate:true,enableTilt:true,enableKeyboard:false,enableDblclickZoom:true,enableContinuousZoom:true,enableWheelZoom:false,enableRotateGestures:true,enableTiltGestures:true,enablePinchZoom:true,fixCenterWhenPinch:false,enableAutoResize:true,zoomCenter:null,fps:C.Browser.ie?30:60,zoomerDuration:240,actionDuration:450,defaultCursor:e5.defaultCursor,draggingCursor:e5.draggingCursor,coordType:BMAP_COORD_MERCATOR,mapType:BMAPGL_NORMAL_MAP,drawer:BMAP_SYS_DRAWER,enableInertialDragging:true,drawMargin:500,drawMarginGL:500,enableFulltimeSpotClick:false,enableResizeOnCenter:false,isModernBrowser:a8.isModernBrowser,forceRenderType:"",textRenderType:null,ratio:a6()>=c8.HIGH_RES_MIN_RATIO?2:1,enableEarth:a8.ifEnableEarth(),defaultMaxBounds:new dS(new hv(-21364736,-10616832),new hv(23855104,15859712)),showControls:false,showRealSunlight:true,showMilkyway:true,earthBackground:null,showStreetLayer:true,minZoom:null,maxZoom:null,style:"default",enableIconClick:false,autoSafeArea:false,ak:null,webgl2:false,restrictCenter:true,smaa:true,preserveDrawingBuffer:false};for(var T in i){if(i.hasOwnProperty(T)){this.config[T]=i[T];if(T==="fixCenterWhenResize"){this.config.enableResizeOnCenter=i[T]}}}if(i.style){if(i.style["styleId"]&&i.style["styleId"].length<32){this.config.style=i.style["styleId"]}else{this.config.style=i.style}}this._setTextRenderType();this._displayOptions={poi:true,poiText:true,poiIcon:true,overlay:true,layer:true,building:true,indoor:true,street:true,skyColors:["rgba(226, 237, 248, 0)","rgba(186, 211, 252, 1)"],isFlat:false,labelMargin:0};if(i.displayOptions){for(var e in i.displayOptions){if(i.displayOptions.hasOwnProperty(e)){this._displayOptions[e]=i.displayOptions[e]}}}if(this.config.restrictCenter===false){this._enableTiltZoom=0;this._enableHeadingZoom=0}},getMinZoom:function(){var T;if(b6[this.mapType][this._renderType]){T=b6[this.mapType][this._renderType].minZoom}else{T=b6[this.mapType].minZoom}if(this.config.minZoom!==null&&this.config.minZoom>=T){T=this.config.minZoom}if(this.mapType==="B_EARTH_MAP"){return T}var i=this.getSize();var e=this.worldSize(T);while(e<i.width){T++;e=this.worldSize(T)}return T},getMaxZoom:function(){var e;if(b6[this.mapType][this._renderType]){e=b6[this.mapType][this._renderType].maxZoom}else{e=b6[this.mapType].maxZoom}if(this.config.maxZoom!==null&&this.config.maxZoom<=e){e=this.config.maxZoom}else{if(this._renderType==="webgl"){e=21}}return e},_drawFrame:function(){this._webglMapScene._painter.draw()},_setupWebGLMap:function(){var e=this;ea.load("mapgl",function(){e._asyncRegister()})},_setStyle:function(i){var e=i.style;e.overflow="hidden";if(f1(i).position!=="absolute"){e.position="relative"}e.backgroundImage="url("+e5.imgPath+"bg.png)";e.textAlign="left";e.touchAction=e.MSTouchAction="none"},_bind:function(){var e=this;if(e._renderType!=="webgl"){e._watchSize=function(){var T=e.getContainerSize();if(e.width!==T.width||e.height!==T.height){var hX=(T.width-e.width)/2;var hZ=(T.height-e.height)/2;var hU=e.getZoomUnits();var hW=e.centerPoint;if(hW&&!e.config.enableResizeOnCenter){e.centerPoint=new hv(hW.lng+hX*hU,hW.lat-hZ*hU)}e.maskLayer.style.width=(e.width=T.width)+"px";e.maskLayer.style.height=(e.height=T.height)+"px";var hV=new bb("onresize");hV.size=T;e.dispatchEvent(hV);e.fire(new bb("onsize_changed"));var i=parseInt(e.platform.style.left,10)||0;var hY=parseInt(e.platform.style.top,10)||0;if(e.currentOperation!=="undefined"&&e.currentOperation!==dU.idle&&(e.offsetX!==i||e.offsetY!==hY)){e._setPlatformPosition(i,hY)}}}}else{e._watchSize=function(){var i=e.getContainerSize();if(e.width!==i.width||e.height!==i.height){var hU=e.getSize();e.maskLayer.style.width=(e.width=i.width)+"px";e.maskLayer.style.height=(e.height=i.height)+"px";if(a6()!==e.config.ratio){e.config.ratio=a6()}var hV=new bb("onresize");hV.size=i;e.dispatchEvent(hV);var T=new bb("onsize_changed");T.size=i;T.oldSize=hU;e.fire(T)}}}if(e.config.enableAutoResize){e.temp.autoResizeTimer=setInterval(e._watchSize,16)}this.on("size_changed",function(){var i=e.getMinZoom();if(e.zoomLevel<i){e.setZoomIn(i,{noAnimation:true})}});this.on("zoom_changed",function(){this.dispatchEvent(new bb("onzooming"))})},addControl:function(e){if(e&&bV(e._i)){e._i(this);this.dispatchEvent(new bb("onaddcontrol",e))}},removeControl:function(e){if(e&&bV(e.remove)){e.remove();this.dispatchEvent(new bb("onremovecontrol",e))}},addContextMenu:function(e){if(e){e.initialize(this);this.dispatchEvent(new bb("onaddcontextmenu",e))}},removeContextMenu:function(e){if(e){this.dispatchEvent(new bb("onremovecontextmenu",e));e.remove()}},addOverlay:function(i){if(i&&bV(i._i)){var T=new bb("onbeforeaddoverlay",i);T.overlay=i;this.dispatchEvent(T);i._i(this);T=new bb("onaddoverlay",i);T.overlay=i;this.dispatchEvent(T)}},removeOverlay:function(i){if(i&&bV(i.remove)){var T=new bb("onremoveoverlay",i);T.overlay=i;i.remove();this.dispatchEvent(T)}},clearOverlays:function(){this.dispatchEvent(new bb("onclearoverlays"))},addTileLayer:function(hV){if(!hV){return}for(var hU=0,e=this.tileMgr.tileLayers.length;hU<e;hU++){var T=this.tileMgr.tileLayers[hU];if(T===hV||T.getMapType()===hV.getMapType()){return}}hV.initialize(this);this.dispatchEvent(new bb("onaddtilelayer",hV))},removeTileLayer:function(e){if(e){e.remove();this.dispatchEvent(new bb("onremovetilelayer",e))}},getTileLayer:function(e){if(this.tileMgr){return this.tileMgr.getTileLayer(e)}return null},setMapType:function(e){var i=this;if(this.mapType===e||this._mapTypeChanging){return}if(e===BMAP_EARTH_MAP&&!this.config.enableEarth){return}if(this._earth&&this._earth.getLock()){return}this._mapTypeChanging=true;this.preMapType=this.mapType;this._boundsInPreMapType=this.getBoundsIn();if(this.preMapType===BMAP_SATELLITE_MAP){this._preStreetLayerShow=this._isHybridShow}if(e===BMAP_EARTH_MAP){if(!bo.Earth){ea.load("earth",function(){i._syncAndChangeMapType(e)});return}i._syncAndChangeMapType(e)}else{if(this.preMapType!==BMAP_EARTH_MAP){this._changeFlatMapType(e);this._mapTypeChanging=false}else{this._setMapTypeStatus(e,function(T,hU){var hV=i._earth.getEarthCanvas();i._changeFlatMapType(e,this.preMapType);if(i._mapTypeChangAni){i._mapTypeChangAni.stop()}i._mapTypeChangAni=fn.start({el:hV,style:"opacity",startValue:1,endValue:0,duration:200,callback:function(){i._mapTypeChangAni=null;i._mapTypeChanging=false}});T=en.convertLL2MC(T);if(i._renderType==="webgl"){C.extend(i,c7.prototype);i.setCenterIn(T,{noAnimation:true});i.setZoomIn(hU,{noAnimation:true})}else{C.extend(i,am.prototype);i.centerAndZoomIn(T,hU)}})}}},_changeFlatMapType:function(hX){if(!hX||!b6[hX]){return}var h5=this.preMapType;this.mapType=hX;var hU=this.getTileLayer(h5);if(hU){this.removeTileLayer(hU)}else{if(this.tileMgr.tileLayers.length){var h4=this.getTileLayer("B_NORMAL_MAP");if(h4){this.removeTileLayer(h4)}else{h4=this.getTileLayer("B_SATELLITE_MAP");h4&&this.removeTileLayer(h4)}}}this._preStreetLayerShow=this.config.showStreetLayer;if(h5===BMAP_SATELLITE_MAP&&this._preStreetLayerShow){this._removeHybirdMap()}if(this.mapType!==BMAP_EARTH_MAP||this._renderType!=="webgl"||this.baseLayerAdded!==true){var T=new dS(new hv(-21364736,-10616832),new hv(23855104,15859712));var h2=new c5(T,"baidu",hX);var hV=new cR({mapType:this.mapType,copyright:h2,dataType:this.mapType===BMAP_SATELLITE_MAP?eI:gw,customLayer:this.mapType===BMAP_SATELLITE_MAP,baseLayer:true,transparentPng:true,tileTypeName:this.mapType===BMAP_SATELLITE_MAP?"web":"na"});hV._isInnerLayer=true;hV.setZIndex(0);this.addTileLayer(hV);if(this._renderType==="webgl"&&!this.baseLayerAdded){this.baseLayerAdded=true}}if(hX===BMAP_SATELLITE_MAP){this._featureMgr.clearLabelOverlayData();this._featureMgr.setLabelData([]);if(this._preStreetLayerShow===true||typeof this._preStreetLayerShow==="undefined"){this._addHybirdMap()}}var hZ=this.tileMgr.tileLayers;for(var hY=0,hW=hZ.length;hY<hW;hY++){var h0=hZ[hY];var h3=h0.tilesDiv;if(!h3){continue}if(!h0._isInnerLayer&&h3.style.visibility==="hidden"){h3.style.visibility=""}}var h1=new bb("onmaptypechange");h1.zoomLevel=this.zoomLevel;h1.mapType=hX;h1.exMapType=h5;this.dispatchEvent(h1)},showStreetLayer:function(e){e?this._addHybirdMap():this._removeHybirdMap()},hideStreetLayer:function(e){this._hideStreetLayerOptions=e;this._removeHybirdMap(e)},_addHybirdMap:function(){this._isHybridShow=true;if(this.mapType==="B_EARTH_MAP"){if(this._earth){this._earth.showStreetLayer()}return}if(this._hybridTileLayer){this.addTileLayer(this._hybridTileLayer);var hX=new bb("onstreetlayer_show");this.dispatchEvent(hX);return}var hV=new dS(new hv(-21364736,-10616832),new hv(23855104,15859712));var T=new c5(hV,"",BMAP_HYBRID_MAP);var i=new cR({copyright:T,transparentPng:true,tileTypeName:"web"});i._isInnerLayer=true;var hU=this.isCanvasMap();i.getTilesUrl=function(hY,h3){var h1=b6.B_STREET_MAP;var h2=aD("ditu","satelliteStreet");var hZ=h2.ver;var e=h2.udt;var h0=h1.tileUrls[Math.abs(hY.x+hY.y)%h1.tileUrls.length]+"?qt=vtile&x="+(hY.x+"").replace(/-/gi,"M")+"&y="+(hY.y+"").replace(/-/gi,"M")+"&z="+h3+"&styles=sl&v="+hZ+"&udt="+e+"$scaler="+a6()+"&showtext="+(hU?0:1);return h0};this._isHybridShow=true;this.addTileLayer(i);this._hybridTileLayer=i;var hW=new bb("onstreetlayer_show");this.dispatchEvent(hW)},_removeHybirdMap:function(i){this._isHybridShow=false;if(this.mapType==="B_EARTH_MAP"){if(this._earth){this._earth.hideStreetLayer(i)}return}if(this._hybridTileLayer){this.removeTileLayer(this._hybridTileLayer);var T=new bb("onstreetlayer_hide");this.dispatchEvent(T)}},isStreetLayerShow:function(){return this._isHybridShow},getTileId:function(e,hW){var hU=b6[this.mapType];if(typeof hU!=="object"){return null}var T=hU.baseUnits*Math.pow(2,(hU.zoomLevelBase-hW));var hV=parseInt(e.lng/T,10);var i=parseInt(e.lat/T,10);return{row:hV,column:i,level:hW}},reset:function(){this.centerAndZoomIn(this.defaultCenter,this.defaultZoomLevel,true)},setOptions:function(e){e=e||{};var hU=this;for(var T in e){if(e.hasOwnProperty(T)){var i=true;if(typeof e[T]!=="object"){i=e[T]!==this.config[T]}this.config[T]=e[T];if(T==="fixCenterWhenResize"){this.config.enableResizeOnCenter=e[T]}if(!i){continue}switch(T){case"style":case"styleUrl":if(T==="style"&&e.styleUrl){break}this.fire(new bb("onstyle_willchange"));this.loadMapStyleFiles(function(){hU.fire(new bb("onstyle_changed"))});break;case"enableAutoResize":if(e[T]===true){this.enableAutoResize()}else{this.disableAutoResize()}break;case"displayOptions":this.setDisplayOptions(e[T]);break}}}},enableDragging:function(){this.config.enableDragging=true},disableDragging:function(){this.config.enableDragging=false},enableInertialDragging:function(){this.config.enableInertialDragging=true},disableInertialDragging:function(){this.config.enableInertialDragging=false},enableScrollWheelZoom:function(){this.config.enableWheelZoom=true},disableScrollWheelZoom:function(){this.config.enableWheelZoom=false},enableContinuousZoom:function(){this.config.enableContinuousZoom=true},disableContinuousZoom:function(){this.config.enableContinuousZoom=false},enableResizeOnCenter:function(){this.config.enableResizeOnCenter=true},disableResizeOnCenter:function(){this.config.enableResizeOnCenter=false},enableDoubleClickZoom:function(){this.config.enableDblclickZoom=true},disableDoubleClickZoom:function(){this.config.enableDblclickZoom=false},enableKeyboard:function(){this.config.enableKeyboard=true},disableKeyboard:function(){this.config.enableKeyboard=false},getSize:function(){return new d9(this.width,this.height)},enablePinchToZoom:function(){this.config.enablePinchZoom=true},disablePinchToZoom:function(){this.config.enablePinchZoom=false},enableTilt:function(){this.config.enableTilt=true},disableTilt:function(){this.config.enableTilt=false},enableRotate:function(){this.config.enableRotate=true},disableRotate:function(){this.config.enableRotate=false},enableAutoResize:function(){this.config.enableAutoResize=true;this._watchSize();if(!this.temp.autoResizeTimer){this.temp.autoResizeTimer=setInterval(this._watchSize,16)}},disableAutoResize:function(){this.config.enableAutoResize=false;if(this.temp.autoResizeTimer){clearInterval(this.temp.autoResizeTimer);this.temp.autoResizeTimer=null}},checkResize:function(){this._watchSize()},resize:function(){this._watchSize()},getContainerSize:function(){return new d9(this.container.clientWidth,this.container.clientHeight)},_getProperZoom:function(T){if(!T){T=this.zoomLevel}var i=this.getMinZoom();var e=this.getMaxZoom();var hU=false;if(T<i){hU=true;T=i}if(T>e){hU=true;T=e}if(this._renderType!=="webgl"){T=Math.round(T)}return{zoom:T,exceeded:hU}},getContainer:function(){return this.container},getZoomUnits:function(T){if(this.mapType===BMAP_EARTH_MAP){return Math.pow(2,18-this._earth.getImageZoom())}var e=b6[this.mapType];if(typeof e!=="object"){return null}var i=T||this.zoomLevel;return Math.pow(2,(e.zoomLevelBase-i))},pointToPixelIn:function(h3,h5){if(!h3){return}h5=h5||{};if(this.mapType===BMAP_EARTH_MAP){var hU;if(!h3._llPt){hU=en.convertMC2LL(h3);h3._llPt=hU}hU=h3._llPt;var hZ=null;var T=null;if(typeof h5.zoom==="number"){var h2=this._earth;var h4=h2._getEarthZoomByImgZoom(h5.zoom);if(h4<=3){hZ=h2._generateTmpPMatrix(h4)}T=h2._generateTmpMVMatrix(h2.getCenter(),h4)}var hV=this._earth.fromLatLngToPixel(hU,{useRound:false,isCalcOnBack:true,matrixInfo:{modelViewMatrix:T,projectionMatrix:hZ}});return hV}if((this._heading%360===0&&this._tilt===0)||!this._webglMapCamera){var h1=this.getZoomUnits(h5.zoom);var hX=h5.center||this.centerPoint;var i=this.width/2;var hW=this.height/2;var h0=(h3.lng-hX.lng)/h1+i;var hY=(hX.lat-h3.lat)/h1+hW;if(h5.useRound!==false){h0=Math.round(h0);hY=Math.round(hY)}return new ej(h0,hY)}var e=this._webglMapCamera.fromMCToScreenPixel(h3.lng,h3.lat,h5);if(h5.useRound===false){return e}e.x=Math.round(e.x);e.y=Math.round(e.y);return e},pixelToPointIn:function(e,h1){if(!e){return}h1=h1||{};if(this.mapType===BMAP_EARTH_MAP){if(typeof h1.zoom==="number"){var hZ=this._earth;var hW=null;var T=null;var h0=hZ._getEarthZoomByImgZoom(h1.zoom);if(h0<=3){hW=hZ._generateTmpPMatrix(h0)}T=hZ._generateTmpMVMatrix(hZ.getCenter(),h0)}var i=this._earth.fromPixelToLatLng(e,{matrixInfo:{modelViewMatrix:T,projectionMatrix:hW}});if(i===null){return null}return en.convertLL2MC(i)}if((this._heading%360!==0||this._tilt>0)&&this._webglMapCamera){return this._webglMapCamera.fromScreenPixelToMC(e.x,e.y,h1)}var hX=h1.center||this.centerPoint;var hY=this.getZoomUnits(h1.zoom);var hV=hX.lng+hY*(e.x-this.width/2);var hU=hX.lat-hY*(e.y-this.height/2);return new hv(hV,hU)},pointToOverlayPixelIn:function(e,hU){hU=hU||{};var T=this.pointToPixelIn(e,{zoom:hU.zoom,center:hU.center,forLabel:true,frustumTest:true,useRound:hU.useRound});if(!T){return}if(hU.fixPosition&&this.mapType!=="B_EARTH_MAP"){var hV=this.getSize();var i=this.worldSize(hU.zoom);if(T.x>hV.width){while(T.x>hV.width){T.x-=i}}else{if(T.x<0){while(T.x<0){T.x+=i}}}}if(this._renderType==="webgl"){return T}T.x-=this.offsetX;T.y-=this.offsetY;return T},overlayPixelToPointIn:function(i,e){if(!i){return}var T=i.clone();if(this._renderType!=="webgl"){T.x+=this.offsetX;T.y+=this.offsetY}return this.pixelToPointIn(T,e)},getProjection:function(){return new en()},lnglatToMercator:function(e,hU){var i=new hv(e,hU);var T=en.convertLL2MC(i);return[T.lng,T.lat]},mercatorToLnglat:function(i,e){if(isNaN(i)||isNaN(e)){return[]}i=parseFloat(i);e=parseFloat(e);var hU=new hv(i,e);var T=en.convertMC2LL(hU);return[T.lng,T.lat]},getBoundsIn:function(){var h7=arguments[0];if(this.mapType===BMAP_EARTH_MAP&&this._earth){var h1=this._earth.getCustomBounds();if(!h1){return this.config.defaultMaxBounds}var h0=h1.getSouthWest();var e=h1.getNorthEast();if(h0.lng>e.lng){e.lng=180}var iq=en.convertLL2MC(h0);var ie=en.convertLL2MC(e);var h4=this.config.defaultMaxBounds;var id=Math.max(iq.lng,h4.sw.lng);var ic=Math.max(iq.lat,h4.sw.lat);var h6=Math.min(ie.lng,h4.ne.lng);var h5=Math.min(ie.lat,h4.ne.lat);var h9=new dS(new hv(id,ic),new hv(h6,h5));h9.pointBottomLeft=new hv(id,ic);h9.pointBottomRight=new hv(h6,ic);h9.pointTopLeft=new hv(id,h5);h9.pointTopRight=new hv(h6,h5);h9.setMinMax();h9.makeNormalizedPoint(this._earth.getHeading());return h9}h7=h7||{};var hV=h7.margins||[0,0,0,0];var ik=this.pixelToPointIn({x:hV[3],y:this.height-hV[2]},h7);var ip=this.pixelToPointIn({x:this.width-hV[1],y:hV[0]},h7);var ib=typeof h7.heading==="number"?h7.heading:(this._heading%360);var T=typeof h7.tilt==="number"?h7.tilt:this._tilt;var h3=this._webglMapCamera;if((ib===0&&T===0)||!h3){this._bounds.setSouthWest(ik);this._bounds.setNorthEast(ip);this._bounds.pointBottomLeft=ik;this._bounds.pointBottomRight=new hv(ip.lng,ik.lat);this._bounds.pointTopRight=ip;this._bounds.pointTopLeft=new hv(ik.lng,ip.lat);this._bounds.setMinMax();this._bounds.makeNormalizedPoint(ib);return this._bounds}var ia=this.pixelToPointIn({x:hV[3],y:hV[0]},h7);var hU=h3.getPosition();var ir=Math.sqrt(Math.pow(ia.lng-hU[0],2)+Math.pow(ia.lat-hU[1],2));var il=this.getZoomUnits();var iu=ir/il;var ii=h3._frustumSideLen;var hZ=h3._fovy;if(iu>ii||(90-T)<hZ/2){var it=[ia.lng-hU[0],ia.lat-hU[1]];if((90-T)<hZ/2){it[0]=-it[0];it[1]=-it[1]}var ij=ii*il;var hY=[it[0]/ir*ij+hU[0],it[1]/ir*ij+hU[1]];var ig=[ip.lng-hU[0],ip.lat-hU[1]];if((90-T)<hZ/2){ig[0]=-ig[0];ig[1]=-ig[1]}var hW=[ig[0]/ir*ij+hU[0],ig[1]/ir*ij+hU[1]];ia.lng=hY[0];ia.lat=hY[1];ip.lng=hW[0];ip.lat=hW[1]}var h8=this.pixelToPointIn({x:this.width-hV[1],y:this.height-hV[2]},h7);var ih=[ik,ip,ia,h8];var io=ih[0].lng;var iv=ih[0].lat;var hX=ih[0].lng;var h2=ih[0].lat;for(var im=1;im<4;im++){if(ih[im].lng<io){io=ih[im].lng}if(ih[im].lng>hX){hX=ih[im].lng}if(ih[im].lat<iv){iv=ih[im].lat}if(ih[im].lat>h2){h2=ih[im].lat}}this._bounds.setSouthWest(new hv(io,iv));this._bounds.setNorthEast(new hv(hX,h2));this._bounds.pointTopLeft=ia;this._bounds.pointTopRight=ip;this._bounds.pointBottomRight=h8;this._bounds.pointBottomLeft=ik;this._bounds.makeNormalizedPoint(ib);this._bounds.setMinMax();return this._bounds},isLoaded:function(){return !!this.loaded},_getBestLevel:function(i,h3){var hW=0;if(this._renderType==="webgl"&&!f8()){hW=100}var hX=h3.margins||[10,10,10,10];var hU=h3.zoomFactor||0;var hY=hX[1]+hX[3];var hV=hX[0]+hX[2];var e=this.getMinZoom();var h2=this.getMaxZoom();var h1=i.toSpan();var h0=h1.width/(this.width-hY-hW);var hZ=h1.height/(this.height-hV-hW);var T=18-eD(Math.max(h0,hZ));if(T<e){T=e}if(T>h2){T=h2}T+=hU;if(this._renderType!=="webgl"){T=Math.floor(T)}return T},getViewportIn:function(h3,hV){if(this.mapType===BMAP_EARTH_MAP){h3=h3||[];var hX=[];for(var h4=0;h4<h3.length;h4++){if(!h3[h4]){continue}hX.push(en.convertMC2LL(h3[h4]))}var h5=this._earth.getViewportIn(hX,hV);var hU=h5.center;var h1=h5.zoom;var h9=en.convertLL2MC(hU);return{center:h9,zoom:h1}}var hZ={center:this.getCenterIn(),zoom:this.getZoom()};if(!h3||h3.length===0){return hZ}hV=hV||{};var hY;if(h3 instanceof dS){hY=h3}else{var hW=h3;hY=new dS();for(var h2=hW.length-1;h2>=0;h2--){hY.extend(hW[h2])}if(hY.isEmpty()){return hZ}}var h8=hY.getCenter();var e=this._getBestLevel(hY,hV);if(hV.margins){var T=hV.margins;var h7=(T[1]-T[3])/2;var h0=(T[0]-T[2])/2;var h6=this.getZoomUnits(e);h8.lng=h8.lng+h6*h7;h8.lat=h8.lat+h6*h0}return{center:h8,zoom:e}},setViewportIn:function(hU,hV){if(this.mapType===BMAP_EARTH_MAP){var hZ;if(hU&&hU.center){var T=en.convertMC2LL(hU.center);var hX=this._earth._getEarthZoomByImgZoom(hU.zoom,T);hZ={center:T,zoom:hX}}else{hZ=[];for(var hW=0;hW<hU.length;hW++){var hY=en.convertMC2LL(hU[hW]);hZ[hW]=new c4(hY.lat,hY.lng)}}this._earth.setViewportIn(hZ,hV);return}var e;if(hU&&hU.center){e=hU}else{e=this.getViewportIn(hU,hV)}hV=hV||{};if(this._renderType==="webgl"){this.centerAndZoomIn(e.center,e.zoom,hV);return}if(e.zoom===this.zoomLevel&&hV.enableAnimation!==false){this.panToIn(e.center,{duration:200,callback:hV.callback})}else{this.centerAndZoomIn(e.center,e.zoom,hV)}},addSpots:function(T,i){if(!T||T.length===0){return}i=i||{};var hW=i.zIndex||0;var hV=typeof i.enableMultiResponse==="undefined"?true:!!i.enableMultiResponse;this.spotsPool=this.spotsPool||{};var e="sp"+(this.temp.spotsGuid++);this.spotsPool[e]={spots:T.slice(0),zIndex:hW,enableMultiResponse:hV};var hU=this;ea.load("hotspot",function(){hU._asyncRegister()});return e},getSpots:function(e){return this.spotsPool[e]&&this.spotsPool[e].spots||[]},removeSpots:function(e){if(!e||!this.spotsPool[e]){return}delete this.spotsPool[e]},clearSpots:function(){delete this.spotsPool},getIconByClickPosition:function(i){if(!this.config.enableIconClick||!this._spotsMgr){return null}var e=this._spotsMgr.getSpotsByScreenPosition(i);if(e[0]&&e[0].userdata){var T=e[0].userdata;return{name:T.name,uid:T.uid,position:T.iconPoint||e[0].pt}}return null},setBounds:function(e){b6[this.mapType].bounds=e.clone()},getCoordType:function(){return this.config.coordType},getPanes:function(){return this._panes},getInfoWindow:function(){if(this.temp.infoWin&&this.temp.infoWin.isOpen()){return this.temp.infoWin}return null},getDistanceIn:function(hV,e){if(!hV||!e){return}if(hV.equals(e)){return 0}if(this.mapType===BMAP_EARTH_MAP){var hU=en.convertMC2LL(hV);var T=en.convertMC2LL(e);return this._earth.getDistance(hU,T)}var i=en.getDistanceByMC(hV,e);return i},getOverlays:function(){var hW=[];var hX=this._overlays;var hV=this._customOverlays;if(hX){for(var hU in hX){if(hX[hU] instanceof cV){hW.push(hX[hU])}}}if(hV){for(var T=0,e=hV.length;T<e;T++){hW.push(hV[T])}}return hW},getMapType:function(){return this.mapType},_asyncRegister:function(){for(var e=this.temp.registerIndex;e<bo._register.length;e++){bo._register[e](this)}this.temp.registerIndex=e},setDefaultCursor:function(e){this.config.defaultCursor=e;if(this.platform){this.platform.style.cursor=this.config.defaultCursor}},getDefaultCursor:function(){return this.config.defaultCursor},setDraggingCursor:function(e){this.config.draggingCursor=e},getDraggingCursor:function(){return this.config.draggingCursor},_syncAndChangeMapType:function(e){var i=this;if(i._renderType==="webgl"&&i.getTilt()>c8.MAX_DRAG_TILT_L2){i.setTilt(c8.MAX_DRAG_TILT_L2,{callback:function(){i._changeEarthMapType(e)}})}else{i._changeEarthMapType(e)}},_changeEarthMapType:function(T){var hU=this;var hX=hU.tileMgr.tileLayers;if(this._mapTypeChangAni){this._mapTypeChangAni.stop()}var hW;if(this._earth){hW=this._earth.getEarthCanvas()}if(!this._earth){this.maskLayer.style.opacity=1;this.maskLayer.style.zIndex=999;this.maskLayer.style.background="#000"}this._mapTypeChangAni=new o({duration:400,render:function(e){if(!hU._earth){return}hW.style.opacity=e},finish:function(){for(var e=hX.length-1,hY=e;hY>=0;hY--){var h0=hX[hY].tilesDiv;if(h0){h0.style.visibility="hidden"}if(hX[hY]._isInnerLayer&&hU._renderType!=="webgl"){hU.removeTileLayer(hX[hY])}}hU._mapTypeChangAni=null;hU._mapTypeChanging=false;function hZ(){var h4=hU.getZoom()-2;var h5=hU.getCenterIn();var h2=en.convertMC2LL(h5);hU._earth=new bo.Earth(hU,{center:h2,zoom:h4,showRealSunlight:hU.config.showRealSunlight,showMilkyway:hU.config.showMilkyway,earthBackground:hU.config.earthBackground});hU._proxyEarthEvents();var h1=hU.mapType;hU.mapType=T;var h3=new bb("onmaptypechange");h3.zoomLevel=this.zoomLevel;h3.mapType=T;h3.exMapType=h1;hU.dispatchEvent(h3);hU._setMapTypeStatus(T);C.extend(hU,bo.EarthView.prototype);if(!hU._navigationCtrl&&hU.config.showControls){hU._navigationCtrl=new eV(hU)}}if(!hU._earth){if(bo["FeatureStyle"+hU.config.style]){hZ()}else{hU.loadMapStyleFiles(function(){hZ()})}}if(parseInt(hU.maskLayer.style.opacity,10)===1){setTimeout(function(){hU.maskLayer.style.zIndex=9;hU.maskLayer.style.opacity=0},1000)}}});if(!this._earth){return}var i=this.mapType;this.mapType=T;var hV=new bb("onmaptypechange");hV.zoomLevel=this.zoomLevel;hV.mapType=T;hV.exMapType=i;this.dispatchEvent(hV);hU._setMapTypeStatus(T);C.extend(hU,bo.EarthView.prototype)},getMapStyleId:function(){if(typeof this.config.style==="string"){return this.config.style}return this.config.mapStyleId||"custom"},_setMapTypeStatus:function(T){var hY=arguments[1];if(T===BMAP_EARTH_MAP){var hW=this._earth.getEarthCanvas();if(hW){hW.style.display=""}var hZ={noAnimation:true};this._earth.setCenter(en.convertMC2LL(this.centerPoint),hZ);this._earth.setImageZoom(this.zoomLevel,hZ);this._earth.setTilt(this.getTilt(),hZ);this._earth.setHeading(this.getHeading(),hZ)}else{if(this.preMapType===BMAP_EARTH_MAP&&this._earth){var hX=this._earth;var hU=hX.getMapZoom();var hV=hX._imageRawZoom||hU;var i=hV-hU;var e=hX.getCenter();if(this._renderType==="webgl"){this._tilt=hX.getTilt();if(this.zoomLevel>7){this._heading=hX.getHeading();hY&&hY(e,hU);return}if(hX.getHeading()!==0){hX.setTilt(this.getTilt());hX.setHeading(this.getHeading(),{callback:function(){hY&&hY(e,hU)}})}else{hY&&hY(e,hU)}return}if(i<0.1&&hX.getTilt()===0&&hX.getHeading()===0){hY&&hY(e,hU);return}hX.setTilt(0);hX.setHeading(0);hX.setZoom(hX.getZoom()-i,{callback:function(){hY&&hY(e,hU)}})}}},_proxyEarthEvents:function(){var hV=this;var hW=this._earth;hW.on("tilesload",function(i){hV.fire(i)});hW.on("centerandzoom",function(i){hV.dispatchEvent(new bb("onmoveend"));hV.dispatchEvent(new bb("onzoomend"))});function hU(i){hV.fire(i)}var e=["zoomstart","zoomend","tilesload","sunlighttime_change","sunlighttime_clear","centerandzoom","animation_start","animation_stop","movestart","moveend","moving","dragstart","dragend","dragging"];for(var T=0;T<e.length;T++){hW.on(e[T],hU)}},forceEnableEarth:function(){this.config.forceEnableEarth=true;this.config.enableEarth=a8.ifEnableEarth(true);this.dispatchEvent(new bb("forceenableearth"));return this.config.enableEarth},setLock:function(e){if(this.mapType===BMAP_EARTH_MAP){this._earth.setLock(e)}this._lock=e},getLock:function(){if(this.mapType===BMAP_EARTH_MAP){return this._earth.getLock()}return this._lock},getEarth:function(){return this._earth},isSupportEarth:function(){return this.config.enableEarth},isCanvasMap:function(){return !!(this._renderType==="canvas"&&this.getMapType()!=="B_EARTH_MAP")},getCanvasMapCoordByUid:function(hV){if(this._renderType==="webgl"){var hW=this.tileMgr.tileLayers;for(var hU=0;hU<hW.length;hU++){if(hW[hU].labelProcessor){return hW[hU].labelProcessor.getLabelByUid(hV,"")}}return null}var e=this.canvas2dMapMgr._labelClick;var T=e.findLabelByUid(hV);return T?new hv(T.iconPos.geoX,T.iconPos.geoY):null},loadBizData:function(i){var e=new bb("onloadbizdata");e.data=i;this.dispatchEvent(e)},unloadBizData:function(){var e=new bb("onunloadbizdata");this.dispatchEvent(e)},zoomIn:function(e){this.setZoomIn(this.zoomLevel+1,{zoomCenter:e})},zoomOut:function(e){this.setZoomIn(this.zoomLevel-1,{zoomCenter:e})},setMaxZoom:function(e){if(this._renderType==="webgl"){this.config.maxZoom=e<=21?e:21}else{this.config.maxZoom=e<=19?e:19}},setMinZoom:function(e){this.config.minZoom=e>=3?e:3},setCenterIn:function(e,i){this.panToIn(e,i)},getRenderType:function(){return this._renderType},getSolarInfo:function(hU){hU=hU||this._initDate;var T=bz(hU);var e=en.convertLL2MC(new hv(T[0],T[1]));var h2=e.latLng;var hX=bo.Projection.convertMC2LL(this.centerPoint);var hZ=hU.getUTCHours();var h1=hZ+24*hX.lng/360;var h0=h1-12;var hY=h0*60*0.25;var hW=Math.asin(Math.sin(dK(hX.lat))*Math.sin(dK(h2.lat))+Math.cos(dK(hX.lat))*Math.cos(dK(h2.lat))*Math.cos(dK(hY)));var hV=Math.asin(Math.sin(dK(hY))*Math.cos(dK(h2.lat))/Math.cos(hW));var i="north";if(hX.lat<h2.lat){i="south"}return{zenith:e,solarAltitude:hW,solarAzimuth:hV,centerPosition:i,position:e}},setDisplayOptions:function(T){if(!T){return}for(var e in this._displayOptions){if(this._displayOptions.hasOwnProperty(e)){if(typeof T[e]==="boolean"||(e==="skyColors"&&typeof T.skyColors==="object")||(e==="labelMargin"&&typeof T.labelMargin==="number")){this._displayOptions[e]=T[e]}}}var i=this.getMapType();if(i===da.NORMAL){this.fire(new bb("ondisplayoptions_changed"))}else{if(i===da.EARTH&&this._earth){this._earth.fire(new bb("ondisplayoptions_changed"))}}},getHorizonPosY:function(e){if(!e||!this._webglMapCamera){return null}var i=this._webglMapCamera.fromMCToScreenPixel(e.lng,e.lat,{heading:0});return i.y},getIndoorInfo:function(){if(!this._indoorMgr){return}return this._indoorMgr.getData()},showIndoor:function(e,T){var i=new bb("onindoor_status_changed");i.uid=e;i.floor=T;this.fire(i)},addAreaSpot:function(e,T){if(!e||e.length===0){return}T=T||{};this.areaSpots=this.areaSpots||{};var i=T.id||("sp"+(this.temp.spotsGuid++));this.areaSpots[i]={spot:e,userData:T.userData};var hU=this;ea.load("hotspot",function(){hU._asyncRegister()});return i},getAreaSpot:function(e){if(this.areaSpots&&this.areaSpots[e]){return this.areaSpots[e]}return null},removeAreaSpot:function(e){if(!e||!this.areaSpots[e]){return}delete this.areaSpots[e]},clearAreaSpots:function(){this.areaSpots={}},resetSpotStatus:function(){this.fire(new bb("onspot_status_reset"))},hightlightSpotByUid:function(e,T){var i=new bb("onspot_highlight");i.uid=e;i.tilePosStr=T;this.fire(i)},setZoomIn:function(i,e){e=e||{};this.zoomTo(i,e.zoomCenter||null,e)},getCurrentMaxTilt:function(){var e=this.zoomLevel;if(this.mapType==="B_EARTH_MAP"){return c8.MAX_DRAG_TILT_L2}if(this.config.restrictCenter===false){return c8.MAX_DRAG_TILT}if(e>=19){return c8.MAX_DRAG_TILT}else{if(e<=18){if(e<this._enableTiltZoom){if(e>=this._enableTiltZoom-2){return(1-(this._enableTiltZoom-e)/2)*c8.MAX_DRAG_TILT_L2}return 0}return c8.MAX_DRAG_TILT_L2}else{return(c8.MAX_DRAG_TILT-c8.MAX_DRAG_TILT_L2)*(e-18)+c8.MAX_DRAG_TILT_L2}}},worldSize:function(i){var e=i||this.zoomLevel;return c8.WORLD_SIZE_MC/this.getZoomUnits(e)},setTrafficOn:function(e){if(e&&Number(e)>1){ce.setZIndex(Number(e))}this.addTileLayer(ce)},setTrafficOff:function(){this.removeTileLayer(ce)},showOverlayContainer:function(){this.setDisplayOptions({overlay:true})},hideOverlayContainer:function(){this.setDisplayOptions({overlay:false})},addLabelsToMapTile:function(T){for(var e=0;e<T.length;e++){if(typeof T[e].type==="undefined"){T[e].type="fixed"}if(typeof T[e].rank!=="number"){T[e].rank=50000}T[e].pt=T[e].position;T[e].custom=true;T[e].processedInZoom=0;this._customTileLabels.push(T[e])}this.dispatchEvent(new bb("onadd_tile_labels"))},removeLabelsFromMapTile:function(T){for(var hU=0;hU<T.length;hU++){for(var e=0;e<this._customTileLabels.length;e++){if(this._customTileLabels[e].uid===T[hU]){this._customTileLabels.splice(e,1)}}}this.dispatchEvent(new bb("onremove_tile_labels"))},clearLabels:function(){this._customTileLabels.length=0;this.dispatchEvent(new bb("onclear_labels"))},loadMapStyleFiles:function(hV){var i=this.config.style;var hU=this.config.styleUrl;var T=this;this._setTextRenderType();if(typeof i==="string"&&!hU){if(bo["FeatureStyle"+i]){T.fire(new bb("onstyle_loaded"));hV();return}bo["FeatureStyle"+i]=window.FeatureStyle;bo["iconSetInfo"+i]=window.iconSetInfo_high;bo.indoorStyle=window.indoorStyle;hp.load(e5.getMapStyleFiles(i),function(){if(T.config.style===i){bo["FeatureStyle"+i]=window.FeatureStyle;bo["iconSetInfo"+i]=window.iconSetInfo_high;bo.indoorStyle=window.indoorStyle;T.fire(new bb("onstyle_loaded"));hV()}})}else{var e=i;f.init(T);f.getStyleJson(e,function(hX){var h2=gh;var h4=bo.getGUID("custom");T.config.mapStyleId=h4;var h0={};C.extend(h0,hX);var hY=Math.floor(T.getZoom());var h1;window.styleCbk=function(h5,h6){if(h6!==h1){return}if(typeof h5==="string"){h5=JSON.parse(h5)}f.onStyleDataBack(h5,hY,h4,h0,h2);bo.customStyleLoaded=true;T.fire(new bb("onstyle_loaded"));hV()};bo.customStyleInfo={zoomRegion:{},zoomStyleBody:[],zoomFrontStyle:{}};var h3=f.getStyleUrl(hX,h2,"styleCbk",hY);var hW=h3.split("?")[0];h1=h3.split("?")[1];if(hU){hW=hU;h1=hW.split("?")[1]}if(!bo.iconSetInfoCustom){var hZ=e5.getMapStyleFiles("default");hZ.splice(1,1);hp.load(hZ,function(){bo.iconSetInfoCustom=window.iconSetInfo_high;bo.indoorStyle=window.indoorStyle;if(hW.indexOf("jsonp")>"-1"){hp.load(hW)}else{bo.customStyleInfo.xhr=gD.post(hW,h1,styleCbk)}})}else{if(hW.indexOf("jsonp")>"-1"){hp.load(hW)}else{bo.customStyleInfo.xhr=gD.post(hW,h1,styleCbk)}}})}},setCopyrightOffset:function(hU,i){var T=new bb("oncopyrightoffsetchange",{logo:hU,cpy:i});this.dispatchEvent(T)},_setTextRenderType:function(e){if(e){this.config.textRenderType=e;return}if(this.config.textRenderType!==null){return}if(f8()){this.config.textRenderType="canvas"}else{if(typeof this.config.style==="string"){this.config.textRenderType="image"}else{this.config.textRenderType="canvas"}}},destroy:function(){this._destroyed=true;this.fire(new bb("ondestroy"))},centerAndZoom:function(e,hW,T){if(Object.prototype.toString.call(hW)!=="[object Undefined]"){hW=parseInt(hW,10)}if(typeof e==="string"){var hU=this;var hV=new V();hV.getPoint(e,function(hX){e=hX;var hY=en.convertLL2MC(e);hU.centerAndZoomIn(hY,hW,T)})}else{var i=en.convertLL2MC(e);this.centerAndZoomIn(i,hW,T)}},pointToPixel:function(e,T){var i=en.convertLL2MC(e);var hU={};C.extend(hU,T);if(hU&&hU.center){hU.center=en.convertLL2MC(hU.center)}return this.pointToPixelIn(i,hU)},pixelToPoint:function(T,i){var hU={};C.extend(hU,i);if(hU&&hU.center){hU.center=en.convertLL2MC(hU.center)}var e=this.pixelToPointIn(T,hU);return en.convertMC2LL(e)},pointToOverlayPixel:function(e,T){var i=en.convertLL2MC(e);var hU={};C.extend(hU,T);if(hU&&hU.center){hU.center=en.convertLL2MC(hU.center)}return this.pointToOverlayPixelIn(i,hU)},overlayPixelToPoint:function(T,i){var hU={};C.extend(hU,i);if(hU&&hU.center){hU.center=en.convertLL2MC(hU.center)}var e=this.overlayPixelToPointIn(T,hU);return en.convertMC2LL(e)},setViewport:function(T,hU){var e;if(T&&T.center){e={};C.extend(e,T);e.center=en.convertLL2MC(e.center)}else{e=[];for(var hV=0;hV<T.length;hV++){e[hV]=en.convertLL2MC(T[hV])}}this.setViewportIn(e,hU)},getViewport:function(hW,hU){var T;if(hW&&hW.length){T=[];for(var hV=0;hV<hW.length;hV++){T[hV]=en.convertLL2MC(hW[hV])}}else{if(hW instanceof dS){T=new dS(en.convertLL2MC(hW.getSouthWest()),en.convertLL2MC(hW.getNorthEast()));T.setMinMax()}}var e=this.getViewportIn(T,hU);e.center=en.convertMC2LL(e.center);return e},getDistance:function(hV,T){var i=en.convertLL2MC(hV);var hU=en.convertLL2MC(T);var e=this.getDistanceIn(i,hU);return e},setCenter:function(e,T){if(typeof e==="string"){var hU=this;var hV=new V();hV.getPoint(e,function(hW){e=hW;var hX=en.convertLL2MC(e);hU.setCenterIn(hX,T)})}else{var i=en.convertLL2MC(e);this.setCenterIn(i,T)}},setZoom:function(T,e){var i={};C.extend(i,e);if(i&&i.zoomCenter){i.zoomCenter=en.convertLL2MC(i.zoomCenter)}this.setZoomIn(T,i)},flyTo:function(e,hU,T){var i=en.convertLL2MC(e);this.flyToIn(i,hU,T)},panTo:function(e,T){var i=en.convertLL2MC(e);this.panToIn(i,T)},getCenter:function(){var e=this.getCenterIn();return en.convertMC2LL(e)},getBounds:function(){var e=this.getBoundsIn();var i=new dS(en.convertMC2LL(e.getSouthWest()),en.convertMC2LL(e.getNorthEast()));return i},setMapStyleV2:function(e){this._setTextRenderType("canvas");this.setOptions({style:e})},startViewAnimation:function(T){var e=T._options.delay;var i=this;setTimeout(function(){T._start(i)},e)},pauseViewAnimation:function(e){e._pause(this)},continueViewAnimation:function(e){e._continue(this)},cancelViewAnimation:function(e){e._cancel(this)},getMapScreenshot:function(){return this._webglMapScene._painter._canvas.toDataURL()}});window.BMAP_NORMAL_MAP="B_NORMAL_MAP";window.BMAPGL_NORMAL_MAP="B_NORMAL_MAP";window.BMAP_SATELLITE_MAP="B_SATELLITE_MAP";window.BMAP_HYBRID_MAP="B_STREET_MAP";window.BMAP_EARTH_MAP="B_EARTH_MAP";window.BMAP_COORD_MERCATOR=1;window.BMAP_SYS_DRAWER=0;window.BMAP_SVG_DRAWER=1;window.BMAP_VML_DRAWER=2;window.BMAP_CANVAS_DRAWER=3;var f={environment:"jsapi",map:null,ontilesloaded:false,onstyle_loaded:false,init:function(i){var e=this;e.map=i;this.changeCopyright();this.setEnvironment(e.map.config.style);this.resetEventListener()},resetEventListener:function(){var e=this;this.ontilesloaded=false;this.onstyle_loaded=false;e.map.addEventListener("ontilesloaded",e.checkLoadedStatus);e.map.addEventListener("onstyle_loaded",e.checkLoadedStatus)},checkLoadedStatus:function(i){f[i.type]=true;if(f.ontilesloaded&&f.onstyle_loaded){this.dispatchEvent(new bb("onstylechangetilesloaded"));this.removeEventListener("ontilesloaded",f.checkLoadedStatus);this.removeEventListener("onstyle_loaded",f.checkLoadedStatus)}},changeCopyright:function(){var e=this;if(e.map.cpyCtrl){e.map.cpyCtrl.hide();if(e.environment!=="customEditor"){e.map.setCopyrightOffset(new d9(1,1))}}else{e.map.addEventListener("oncopyrightaddend",function(){e.map.cpyCtrl.hide();if(e.environment!=="customEditor"){e.map.setCopyrightOffset(new d9(1,1))}})}},setEnvironment:function(e){if(e.customEditor){this.environment="customEditor";bJ.map=this.map}else{if(e.sharing){this.environment="sharing"}else{if(e.preview){this.environment="preview"}else{this.environment="jsapi"}}}},getStyleJson:function(hU,hW){var hV=this;if(hU.styleJson){hW&&hW(hU.styleJson)}else{if(hU.styleId){var i=hU.styleId;var e=(Math.random()*100000).toFixed(0);bo["_cbk_si_phpui"+e]=function(hY){var hX=[];if(hY.result&&hY.result["error"]===0&&hY.content&&hY.content["status"]===0){hX=hV.parseJson(hY.content["data"]["json"]);hW&&hW(hX)}else{hW&&hW("default")}};bo["_cbk_si_api"+e]=function(hY){var hX=[];if(hY.status===0){if(hY.info){hX=hV.parseJson(hY.info["json"])}else{hX=hV.parseJson(hY.data["json"])}hW&&hW(hX)}else{hW&&hW("default")}};var T="";switch(this.environment){case"jsapi":T=eW.apiHost+"/?qt=custom_map&v=3.0&style_id="+i+"&type=publish&ak="+gh;T+="&callback="+eB+"._cbk_si_phpui"+e;break;case"sharing":T+="/apiconsole/custommap/getSharingJson";T+="?styleid="+i+"&type=edit";T+="&ck="+eB+"._cbk_si_api"+e;break;case"preview":T+="/apiconsole/custommap/getJson";T+="?styleid="+i+"&type=edit";T+="&ck="+eB+"._cbk_si_api"+e;break}hp.load(T)}else{hW&&hW("default")}}},parseJson:function(T){if(T===null||T===""){return[]}var i={t:"featureType",e:"elementType",v:"visibility",c:"color",l:"lightness",s:"saturation",w:"weight",z:"level",h:"hue",f:"fontsize",zri:"curZoomRegionId",zr:"curZoomRegion"};var hV={all:"all",g:"geometry","g.f":"geometry.fill","g.s":"geometry.stroke",l:"labels","l.t.f":"labels.text.fill","l.t.s":"labels.text.stroke","l.t":"labels.text","l.i":"labels.icon","g.tf":"geometry.topfill","g.sf":"geometry.sidefill"};var hU=T.split(",");var e=hU.map(function(hZ){var hY=hZ.split("|").map(function(h5){var h3=i[h5.split(":")[0]];var h2=(hV[h5.split(":")[1]]?hV[h5.split(":")[1]]:h5.split(":")[1]);switch(h2){case"poi":h2="poilabel";break;case"districtlabel":h2="districtlabel";break}var h4={};h4[h3]=h2;return h4});var hW=hY[0];var h1=1;if(hY[1]["elementType"]){h1=2;C.extend(hW,hY[1])}var h0={};for(var hX=h1;hX<hY.length;hX++){C.extend(h0,hY[hX])}return C.extend(hW,{stylers:h0})});return e},getStyleUrl:function(T,hV,hU,e){this.styleJson=T;var i=e5.apiHost+"/custom/v2/mapstyle?version="+4+"&ak="+hV+"&";i+="is_all=true&is_new=1&";i+="styles="+encodeURIComponent(this.styleJson2styleStringV2(T,e));return i},styleJson2styleStringV2:function(e,hZ){var h0={featureType:"t",elementType:"e",visibility:"v",color:"c",lightness:"l",saturation:"s",weight:"w",level:"z",hue:"h",fontsize:"f"};var h2={all:"all",geometry:"g","geometry.fill":"g.f","geometry.stroke":"g.s",labels:"l","labels.text.fill":"l.t.f","labels.text.stroke":"l.t.s","labels.text":"l.t","labels.icon":"l.i","geometry.topfill":"g.tf","geometry.sidefill":"g.sf"};var h3=[];for(var hU=this.map.getMinZoom();hU<=this.map.getMaxZoom();hU++){bo.customStyleInfo.zoomFrontStyle[hU]={}}bo.customStyleInfo.zoomFrontStyle.main={};var T=false;for(var hU=0;!!e[hU];hU++){var h1=e[hU];if(this.isOnlyZoomStyler(h1)){continue}hZ=this.getFrontZoom(h1,hZ);if((h1.featureType==="land"||h1.featureType==="all"||h1.featureType==="background")&&typeof h1.elementType==="string"&&(h1.elementType==="geometry"||h1.elementType==="geometry.fill"||h1.elementType==="all")&&h1.stylers&&!T){if(h1.stylers["color"]){bo.customStyleInfo.bmapLandColor=h1.stylers["color"]}if(h1.stylers["visibility"]&&h1.stylers["visibility"]==="off"){bo.customStyleInfo.bmapLandColor="#00000000"}if(h1.featureType==="land"){T=true}}if(h1.featureType==="building"&&typeof h1.elementType==="string"&&h1.elementType==="geometry.fill"){bo.customStyleInfo.buildingFill=true}if(h1.featureType==="roadarrow"&&h1.elementType==="labels.icon"&&h1.stylers){bo.customStyleInfo.zoomFrontStyle[hZ]["bmapRoadarrowVisibility"]=h1.stylers["visibility"]}var hV={};C.extend(hV,h1);var hX=hV.stylers;delete hV.stylers;C.extend(hV,hX);var hW=[];for(var hY in h0){if(hV[hY]){if(this.isEditorZoomKeys(hY)){continue}if(hY==="elementType"){hW.push(h0[hY]+":"+h2[hV[hY]])}else{switch(hV[hY]){case"poilabel":hV[hY]="poi";break;case"districtlabel":hV[hY]="label";break}hW.push(h0[hY]+":"+hV[hY])}}}if(hW.length>2){h3.push(hW.join("|"))}}return h3.join(",")},getFrontZoom:function(i,e){var T=i.stylers["level"];if(T===undefined){return"main"}else{return parseInt(T,10)}},isZoomConfig:function(e){var i=e.stylers["level"];if(i===undefined){return false}else{return true}},isOnlyZoomStyler:function(e){var i={};C.extend(i,e.stylers);delete i.curZoomRegionId;delete i.curZoomRegion;delete i.level;if(C.isEmptyObject(i)){return true}else{return false}},isSelectZoom:function(i,e){var T=i.stylers["level"];if(T===undefined){return true}else{if(T===e+""){return true}else{return false}}},isEditorZoomKeys:function(e){var i={curZoomRegionId:true,curZoomRegion:true};if(i[e]){return true}else{return false}},getZoomRegion:function(e,i){var hU=e.stylers["level"];var T={};C.extend(T,i);if(hU===undefined){return T}else{T[parseInt(hU,10)]=true;return T}},onStyleDataBack:function(hU,e,i,T,hW){if(hU.status!==0){return}if(hU.data.style.length===3){if(!bo.customStyleInfo.baseFs){bo.customStyleInfo.baseFs=hU.data.style}bo.StyleBody=hU.data.style[2]}else{bo.StyleBody=hU.data.style}var hV=bo.customStyleInfo.baseFs;bo["FeatureStyle"+i]=hV;this.updateFrontFeatureStyle()},updateFrontFeatureStyle:function(){if(bo.customStyleInfo.zoomFrontStyle.main["bmapRoadarrowVisibility"]){for(var e=this.map.getMinZoom();e<=this.map.getMaxZoom();e++){if(!bo.customStyleInfo.zoomFrontStyle[e]["bmapRoadarrowVisibility"]){bo.customStyleInfo.zoomFrontStyle[e]["bmapRoadarrowVisibility"]=bo.customStyleInfo.zoomFrontStyle.main["bmapRoadarrowVisibility"]}}}}};var bJ={map:null,labelCache:{},calcDrawMc:function(T,i,e){var hU=[];switch(i){case"fill":hU=this.calcFill(T,e);break;case"line":break;case"building3d":hU=this.calcBuilding3d(T,e);break}return hU},calcFill:function(hV,T){var hW=[];for(var hU=0;hU<hV.length;hU=hU+5){var e=this.coordToMc({x:hV[hU],y:hV[hU+1]},T.row,T.col,T.mercatorSize,T.baseTileSize);hW.push(e[0],e[1])}return hW},calcLine:function(hV,T){var hW=[];var hX=new Int16Array(hV.buffer);for(var hU=0;hU<hX.length;hU=hU+10){var e=this.coordToMc({x:hX[hU]/10,y:hX[hU+1]/10},T.row,T.col,T.mercatorSize,T.baseTileSize);hW.push(e[0],e[1])}return hW},calcBuilding3d:function(hW,T){var hX=[];var hU={};for(var hV=0;hV<hW.length/2;hV=hV+7){if(hW[hV]===hW[hV-7]&&hW[hV+1]===hW[hV-6]){continue}if(hU[hW[hV].toString()+hW[hV+1].toString()]){continue}hU[hW[hV].toString()+hW[hV+1].toString()]=true;var e=this.coordToMc({x:hW[hV],y:hW[hV+1]},T.row,T.col,T.mercatorSize,T.baseTileSize);hX.push(e[0],e[1])}return hX},coordToMc:function(hV,hU,e,i,T){return[hV.x*(i/T)+e*i,hV.y*(i/T)+hU*i]},addDrawIntoAreaSpots:function(e,hV){if(f.environment!=="customEditor"){return}if(!hV.styleIds){return}for(var T=0;T<hV.styleIds.length;T++){var hY=0;if(T>0){hY=hV.verticesLength[T-1]}end=hV.verticesLength[T];var hW=[];var hU="";if(hV.vertex){hW=hV.vertex;hU="building3d"}else{if(hV.data[0]){hW=hV.data[0];hU=hV.type}else{continue}}var hX=this.calcDrawMc(hW.slice(hY,end),hU,e);this.map.addAreaSpot(hX,{userData:{styleId:hV.styleIds[T],type:"mapstyle"}})}},addLabelIntoAreaSpots:function(e){if(f.environment!=="customEditor"){return}for(var hV=0;hV<e.length;hV++){var hW=e[hV];for(var hU=0;hU<hW.fixedLabel.length;hU++){var T=hW.fixedLabel[hU];if(!T._mcBds){continue}var hX=[T._mcBds[0].lng,T._mcBds[0].lat,T._mcBds[0].lng,T._mcBds[1].lat,T._mcBds[1].lng,T._mcBds[1].lat,T._mcBds[1].lng,T._mcBds[0].lat];if(!this.labelCache[hX.join()]){this.labelCache[hX.join()]=true;this.map.addAreaSpot(hX,{userData:{styleId:T.styleId,type:"mapstyle",name:T.name}})}}}}};function bR(i,e,hU,T){this.cx=3*i;this.bx=3*(hU-i)-this.cx;this.ax=1-this.cx-this.bx;this.cy=3*e;this.by=3*(T-e)-this.cy;this.ay=1-this.cy-this.by;this.p1x=i;this.p1y=T;this.p2x=hU;this.p2y=T}bR.prototype.sampleCurveX=function(e){return((this.ax*e+this.bx)*e+this.cx)*e};bR.prototype.sampleCurveY=function(e){return((this.ay*e+this.by)*e+this.cy)*e};bR.prototype.sampleCurveDerivativeX=function(e){return(3*this.ax*e+2*this.bx)*e+this.cx};bR.prototype.solveCurveX=function(e,hZ){if(typeof hZ==="undefined"){hZ=0.000001}var hY;var hX;var hV;var T;var hU;for(hV=e,hU=0;hU<8;hU++){T=this.sampleCurveX(hV)-e;if(Math.abs(T)<hZ){return hV}var hW=this.sampleCurveDerivativeX(hV);if(Math.abs(hW)<0.000001){break}hV=hV-T/hW}hY=0;hX=1;hV=e;if(hV<hY){return hY}if(hV>hX){return hX}while(hY<hX){T=this.sampleCurveX(hV);if(Math.abs(T-e)<hZ){return hV}if(e>T){hY=hV}else{hX=hV}hV=(hX-hY)*0.5+hY}return hV};bR.prototype.solve=function(e,i){return this.sampleCurveY(this.solveCurveX(e,i))};var cn={};function o(T){var e={duration:1000,fps:30,delay:0,transition:cn.linear,dropLastAnimation:false};if(T){for(var hU in T){e[hU]=T[hU]}}if(T.beginTime){this._beginTime=T.beginTime}this._callbacks=[];this._options=e;if(e.delay){var hV=this;setTimeout(function(){hV._doStart()},e.delay)}else{this._doStart()}this._pauseTime=0}o.INFINITE="INFINITE";o.prototype._doStart=function(){if(this._isPausing){var e=performance.now()||new Date().getTime();this._pauseTime+=e-this._isPausing;this._isPausing=undefined}if(window.requestAnimationFrame){var i=this;i._timer=window.requestAnimationFrame(function(T){i._loop(T)})}else{this._beginTime=new Date().getTime();if(this._options.duration===o.INFINITE){this._endTime=null}else{this._endTime=this._beginTime+this._options.duration}this._loop()}};o.prototype._loop=function(hU){var hX=this;hU=hU||new Date().getTime();hU=hU-this._pauseTime;if(!this._beginTime){this._beginTime=hU}if(!this._endTime&&typeof this._options.duration==="number"){this._endTime=this._beginTime+this._options.duration}if(hX._endTime!==null&&hU>=hX._endTime){if(hX._options.dropLastAnimation===false){hX._options.render(hX._options.transition(1),1,hU)}if(typeof hX._options.finish==="function"){hX._options.finish(hU,this)}for(var hW=0,e=hX._callbacks.length;hW<e;hW++){hX._callbacks[hW]()}return}var hV;if(typeof hX._options.duration==="number"){hV=(hU-hX._beginTime)/hX._options.duration;hX.schedule=hX._options.transition(hV)}else{hV=hU-hX._beginTime;hX.schedule=0}hX._options.render(hX.schedule,hV,hU);if(!hX.terminative){if(window.requestAnimationFrame){hX._timer=requestAnimationFrame(function T(i){hX._loop(i)})}else{hX._timer=setTimeout(function(){hX._loop()},1000/hX._options.fps)}}};o.prototype.stop=function(i,e){this.terminative=true;if(this._timer){if(window.cancelAnimationFrame){cancelAnimationFrame(this._timer)}else{clearTimeout(this._timer)}this._timer=null;if(typeof this._options.onStop==="function"){this._options.onStop(e)}}if(i){this._endTime=this._beginTime;this._loop()}};o.prototype.pause=function(){if(!this._isPausing){this.stop();this.terminative=undefined;this._isPausing=performance.now()||new Date().getTime()}};o.prototype.cancel=function(){this.stop()};o.prototype.append=function(e){this._callbacks.push(e);return this};cn={_p1:1,_p2:1*1.525,linear:function(e){return e},reverse:function(e){return 1-e},easeInQuad:function(e){return e*e},easeInCubic:function(e){return Math.pow(e,3)},easeInBiquad:function(e){return Math.pow(e,4)},easeInBack:function(e){return e*e*((cn._p1+1)*e-cn._p1)},easeOutQuad:function(e){return -(e*(e-2))},easeOutCubic:function(e){return Math.pow((e-1),3)+1},easeOutBiquad:function(e){return 1-Math.pow((e-1),4)},easeOutBack:function(e){return((e=e-1)*e*((cn._p1+1)*e+cn._p1)+1)},easeInOutQuad:function(e){if(e<0.5){return e*e*2}else{return -2*(e-2)*e-1}},easeInOutCubic:function(e){if(e<0.5){return Math.pow(e,3)*4}else{return Math.pow(e-1,3)*4+1}},easeInOutBiquad:function(e){if(e<0.5){return Math.pow(e,4)*8}else{return 1-(Math.pow(e-1,4)*8)}},easeInOutSine:function(e){return(1-Math.cos(Math.PI*e))/2}};cn.ease=(function(){var e=new bR(0.4,0,0.6,1);return function(i){return e.solve(i)}})();cn["ease-in"]=cn.easeInQuad;cn["ease-out"]=cn.easeOutQuad;var fn={start:function(h0){var hU=h0.el;var e=h0.style;var i=h0.startValue;var hX=h0.endValue;var hV=h0.duration||1400;var hW=h0.transition||cn.linear;var hZ=h0.callback;var hY=hX-i;var T=h0.unit||"";return new o({fps:60,duration:hV,transition:hW,render:function(h1){hU.style[e]=i+hY*h1+T},finish:function(){hZ&&hZ()}})}};function cM(hV,T){ed.call(this);this.keyframes=hV;var e={duration:1000,delay:0,transition:cn.linear,interation:1};if(T){for(var hU in T){e[hU]=T[hU]}}this._options=e}cM.inherits(ed,"ViewAnimation");cM.prototype._start=function(hW){var T=this;T.map=hW;var hV=new bb("onanimationstart");T.dispatchEvent(hV);this._initStatus(T.map);var hU=this._options.duration;var i=this._options.interation;var hX=this._options.transition;var hY=0;T.poiStatus=T.map._displayOptions.poi;if(T.poiStatus){T.map.setDisplayOptions({poi:false})}T.map.viewAnimationTime=new Date().getTime();this.animation=new o({duration:hU,transition:hX,start:function(e){},render:function(hZ,e){if(hZ===0){T._initStatus(T.map)}else{T._setViewByRate(hZ)}},finish:function(h0,hZ){if(++hY<i||i==="INFINITE"){var h1=new bb("onanimationiterations");T.dispatchEvent(h1);delete hZ._beginTime;delete hZ._endTime;hZ._doStart()}else{var h1=new bb("onanimationend");T.dispatchEvent(h1);delete T.map.viewAnimationTime;T.map.setDisplayOptions({poi:T.poiStatus})}}})};cM.prototype._getTotalDuration=function(e,i){if(e===o.INFINITE){return o.INFINITE}else{return e*i}};cM.prototype._initStatus=function(e){if(this.keyframes[0]){e.setCenter(this.keyframes[0].center,{noAnimation:true});e.setZoom(this.keyframes[0].zoom,{noAnimation:true});e.setTilt(this.keyframes[0].tilt,{noAnimation:true});e.setHeading(this.keyframes[0].heading,{noAnimation:true})}};cM.prototype._setViewByRate=function(hU){for(var e=0;e<this.keyframes.length-1;e++){var hV=this.keyframes[e];var T=this.keyframes[e+1];if(hU>=hV.percentage&&hU<T.percentage){this.map.setHeading(this._getHeadingDelta(hV,T,hU),{noAnimation:true});this.map.setTilt(this._getTiltDelta(hV,T,hU),{noAnimation:true});this.map.setCenter(this._getCenterDelta(hV,T,hU),{noAnimation:true});this.map.setZoom(this._getZoomDelta(hV,T,hU),{noAnimation:true})}}};cM.prototype._getHeadingDelta=function(T,i,e){var hV=(e-T.percentage)/(i.percentage-T.percentage);var hU=T.heading+(i.heading-T.heading)*hV;return hU};cM.prototype._getTiltDelta=function(T,i,e){var hV=(e-T.percentage)/(i.percentage-T.percentage);var hU=T.tilt+(i.tilt-T.tilt)*hV;return hU};cM.prototype._getCenterDelta=function(T,i,e){var hV=(e-T.percentage)/(i.percentage-T.percentage);var hU=T.center.add(i.center.sub(T.center).mult(hV));return hU};cM.prototype._getZoomDelta=function(hU,T,i){var hV=(i-hU.percentage)/(T.percentage-hU.percentage);var e=hU.zoom+(T.zoom-hU.zoom)*hV;return e};cM.prototype._pause=function(e){this.animation.pause()};cM.prototype._continue=function(e){this.animation._doStart()};cM.prototype._cancel=function(T){T.setDisplayOptions({poi:this.poiStatus});this.animation.cancel();delete T.viewAnimationTime;var i=new bb("onanimationcancel");this.dispatchEvent(i)};var ev=undefined;var c0={is64Bit:function(){if(/Windows/.test(navigator.userAgent)){if(/Win64; x64/.test(navigator.userAgent)){return true}else{if(/WOW64/.test(navigator.userAgent)){return true}else{return false}}}return true},isIOS112:function cQ(e){return/11_2/.test(navigator.userAgent)},canUseWebAssembly:function(i){if(ev!==undefined){i&&i(ev);return}if(window.WebAssembly&&this.is64Bit()){if(window.disableWebAssembly===true){ev=false;i&&i(ev)}else{if(!bv()){ev=true;i&&i(ev)}else{if(this.isIOS112()){ev=false;i&&i(ev)}else{var e=new Uint8Array([0,97,115,109,1,0,0,0,1,133,128,128,128,0,1,96,0,1,127,3,130,128,128,128,0,1,0,4,132,128,128,128,0,1,112,0,0,5,131,128,128,128,0,1,0,1,6,129,128,128,128,0,0,7,145,128,128,128,0,2,6,109,101,109,111,114,121,2,0,4,109,97,105,110,0,0,10,138,128,128,128,0,1,132,128,128,128,0,0,65,42,11]);WebAssembly.instantiate(e).then(function(T){ev=true;i&&i(ev)},function(T){ev=false;i&&i(ev)})}}}}else{ev=false;i&&i(ev)}}};var dw={};bo.Utils=dw;function dd(e){return e.style}function dm(i){if(C.Browser.ie>0){i.unselectable="on";i.selectstart=function(){return false};i.onmousedown=function(T){T.preventDefault();return false}}else{var e=dd(i);e.MozUserSelect="none";e.WebkitUserSelect="none";i.addEventListener("mousedown",function(T){T.preventDefault()},false)}}function hg(e){return e&&e.parentNode&&e.parentNode.nodeType!==11}function dI(i,e){i.insertAdjacentHTML("beforeEnd",e);return i.lastChild}function hE(T,i){var hU=document.createElement("div");hU.innerHTML=i;var e=hU.childNodes[0];return T.parentNode.insertBefore(e,T)}function h(i){i=i||window.event;i.stopPropagation?i.stopPropagation():i.cancelBubble=true}function bU(i){i=i||window.event;i.preventDefault?i.preventDefault():i.returnValue=false;return false}function db(i){h(i);return bU(i)}function fM(){var e=document.documentElement;var i=document.body;if(e&&(e.scrollTop||e.scrollLeft)){return[e.scrollTop,e.scrollLeft]}else{if(i){return[i.scrollTop,i.scrollLeft]}else{return[0,0]}}}function ft(hV){if(!hV){return}hV.onload=hV.onerror=null;var T=hV.attributes,hU,e,hW;if(T){e=T.length;for(hU=0;hU<e;hU+=1){hW=T[hU].name;if(typeof hV[hW]==="function"){hV[hW]=null}}}T=hV.children;if(T){e=T.length;for(hU=0;hU<e;hU+=1){ft(hV.children[hU])}}}function bG(i,hX,hW){var hV=hX.lng-hW.lng;var hU=hX.lat-hW.lat;if(hV===0){return Math.abs(i.lng-hX.lng)}if(hU===0){return Math.abs(i.lat-hX.lat)}var T=hU/hV;var e=hX.lat-T*hX.lng;return Math.abs(T*i.lng-i.lat+e)/Math.sqrt(T*T+1)}function gZ(i,e){if(!i||!e){return}return Math.round(Math.sqrt(Math.pow(i.x-e.x,2)+Math.pow(i.y-e.y,2)))}function bP(i,e){if(!i||!e){return 0}return Math.round(Math.sqrt(Math.pow(i.lng-e.lng,2)+Math.pow(i.lat-e.lat,2)))}function c1(T,i){var e=Math.round((T.x+i.x)/2);var hU=Math.round((T.y+i.y)/2);return new ej(e,hU)}function hm(e,T){var i=[];T=T||function(hV){return hV};for(var hU in e){i.push(hU+"="+T(e[hU]))}return i.join("&")}function S(T,i,hW){var hX=document.createElement(T);if(hW){hX=document.createElementNS(hW,T)}i=i||{};for(var hU in i){var hV={"for":"htmlFor","class":"cssClass"}[hU]||hU;if(hU==="style"){hX.style.cssText=i[hU];continue}if(hU==="class"){C.ac(hX,i[hU]);continue}if(hX.setAttribute){hX.setAttribute(hV,i[hU])}else{try{hX[hV]=i[hU]}catch(hX){}}}return hX}function f1(e){if(e.currentStyle){return e.currentStyle}else{if(e.ownerDocument&&e.ownerDocument.defaultView){return e.ownerDocument.defaultView.getComputedStyle(e,null)}}}function bV(e){return typeof e==="function"}var hr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function g4(hV){var T="";var h2;var h0;var hY="";var h1;var hZ;var hX;var hW="";var hU=0;var e=/[^A-Za-z0-9+/=]/g;if(!hV||e.exec(hV)){return hV}hV=hV.replace(/[^A-Za-z0-9+/=]/g,"");do{h1=hr.indexOf(hV.charAt(hU++));hZ=hr.indexOf(hV.charAt(hU++));hX=hr.indexOf(hV.charAt(hU++));hW=hr.indexOf(hV.charAt(hU++));h2=(h1<<2)|(hZ>>4);h0=((hZ&15)<<4)|(hX>>2);hY=((hX&3)<<6)|hW;T=T+String.fromCharCode(h2);if(hX!==64){T=T+String.fromCharCode(h0)}if(hW!==64){T=T+String.fromCharCode(hY)}h2=h0=hY="";h1=hZ=hX=hW=""}while(hU<hV.length);return T}(function(e){if(!e.Utils){e.Utils={}}var i=e.Utils;i.format=(function(){function T(hX,hW,hY){var hV=hY[+hW];return typeof(hV)==="function"?hV(hW):hV}function hU(hX,hW,hY){var h0=hW;var h1=[];var hV=hW.split(":");if(hV.length===2){h0=hV[0];h1.push(hV[1])}var hZ=typeof(hY[h0]);if(hZ==="function"){return hY[h0].apply(undefined,h1)}else{if(hZ==="undefined"){return hX}else{return String(hY[h0])}}}return function(hV,hW){var hY=hW.splice?T:hU;var hX=hV.splice?hV.join(""):hV;return hX.replace(/{([a-zA-Z0-9_$:.]+)}/g,function(h0,hZ){return hY(h0,hZ,hW)})}})();i.ErrorMonitor=function(hU,T,hV){};c0.canUseWebAssembly(function(T){i.canUseWebAssembly=T})})(bo);function f8(){return(bv()||eC())}function bv(){var e=navigator.userAgent;if(e.indexOf("iPhone")>-1||e.indexOf("iPad")>-1){return true}return false}function eC(){var e=navigator.userAgent;if(e.indexOf("Android")>-1){return true}return false}function dK(e){return e*Math.PI/180}function de(e){return e/Math.PI*180}function dO(e,hV){var hU=Math.pow(10,hV);if(typeof e==="number"){return Math.round(e*hU)/hU}for(var T=0;T<e.length;T++){e[T]=dO(e[T],hV)}return e}function fI(T,i,e){if(T<i){T=i}else{if(T>e){T=e}}return T}function f2(e,i){while(e<0){e+=i}return e%i}function d8(i,e){return(i>=0&&e>=0)||(i<0&&e<0)}function a5(i){if(i._gl){return i._gl}var e={alpha:true,antialias:false,failIfMajorPerformanceCaveat:false,preserveDrawingBuffer:false,stencil:false};var T=i.getContext("webgl",e)||i.getContext("experimental-webgl",e);i._gl=T;return T}function eL(hU,T){for(var e=0;e<T.length;e++){C.on(hU,T[e],h)}}function hT(i,T,e){T[e]=i.getUniformLocation(T,e)}function e2(hV,hW,e,T,i){var hU="";switch(i){case"mat4":hV.uniformMatrix4fv(hW[e],false,T);return;case"v3":hU="uniform3fv";break;case"f":hU="uniform1f";break;case"i":hU="uniform1i";break}if(hU===""){throw"error"}hV[hU](hW[e],T)}function K(h2,e){while(h2<0){h2+=360}h2=h2%360;var hU=e.width;var h1=e.height;var hX=hU;var T=h1;if(h2<90){var i=Math.sin(dK(h2))*hU;var hZ=Math.sin(dK(h2))*h1;var h0=Math.cos(dK(h2))*hU;var hW=Math.cos(dK(h2))*h1;var hX=Math.ceil(h0+hZ);var T=Math.ceil(i+hW)}else{if(h2<180){var h2=h2-90;var i=Math.sin(dK(h2))*hU;var hZ=Math.sin(dK(h2))*h1;var h0=Math.cos(dK(h2))*hU;var hW=Math.cos(dK(h2))*h1;var hX=Math.ceil(i+hW);var T=Math.ceil(h0+hZ)}else{if(h2<270){var h2=h2-180;var i=Math.sin(dK(h2))*hU;var hZ=Math.sin(dK(h2))*h1;var h0=Math.cos(dK(h2))*hU;var hW=Math.cos(dK(h2))*h1;var hX=Math.ceil(h0+hZ);var T=Math.ceil(i+hW)}else{var h2=h2-270;var i=Math.sin(dK(h2))*hU;var hZ=Math.sin(dK(h2))*h1;var h0=Math.cos(dK(h2))*hU;var hW=Math.cos(dK(h2))*h1;var hX=Math.ceil(i+hW);var T=Math.ceil(h0+hZ)}}}var hY=hX-hU;var hV=T-h1;return[0-hY/2,0-hV/2,hU+hY/2,h1+hV/2]}function gI(e){if(e.toDataURL()===gI._blankData){return true}return false}function gy(hV,hU,T){var i=[T.lng-hV.lng,T.lat-hV.lat];var e=[hU.lng-hV.lng,hU.lat-hV.lat];return i[0]*e[1]-i[1]*e[0]}function ch(hW,hV,T){var e;var hX;var hU;var i;if(hW.lng<hV.lng){e=hW.lng;hU=hV.lng}else{e=hV.lng;hU=hW.lng}if(hW.lat<hV.lat){hX=hW.lat;i=hV.lat}else{hX=hV.lat;i=hW.lat}if(T.lng<e||T.lng>hU||T.lat<hX||T.lat>i){return false}return true}function gA(hY,hX,hW,hU){var hV=gy(hW,hU,hY);var T=gy(hW,hU,hX);var i=gy(hY,hX,hW);var e=gy(hY,hX,hU);if(hV*T<0&&i*e<0){return true}else{if(hV===0&&ch(hW,hU,hY)){return true}else{if(T===0&&ch(hW,hU,hX)){return true}else{if(i===0&&ch(hY,hX,hW)){return true}else{if(e===0&&ch(hY,hX,hU)){return true}else{return false}}}}}}function hC(T,i){var e=i.parentNode;if(e.lastChild===i){e.appendChild(T)}else{e.insertBefore(T,i.nextSibling)}}function hI(h0,h1){if(h1===0){return h0}var hZ=0;var hX=0;if(!h0){throw"异常"}if(h0.length===0){return[]}for(var hV=1,T=h0.length-1;hV<T;hV++){var hY=bG(h0[hV],h0[0],h0[h0.length-1]);if(hY>hZ){hX=hV;hZ=hY}}var e=[];if(hZ>=h1){var h3=h0.slice(0,hX);var h2=h0.slice(hX,h0.length);var hW=hI(h3,h1);var hU=hI(h2,h1);for(var hV=0,T=hW.length;hV<T;hV++){e.push(hW[hV])}for(var hV=0,T=hU.length;hV<T;hV++){e.push(hU[hV])}}else{e.push(h0[0]);e.push(h0[h0.length-1])}return e}function eD(e){if(Math.log2){return Math.log2(e)}return Math.log(e)/Math.LN2}function br(T,i,e){return Math.min(e,Math.max(i,T))}function cJ(e,i){if(!i){return e}var hW=i[0];var hV=i[1];var hU=i[2];var T=i[3];var hY=[];var hX=[];hY[0]=T*e[0]+hU*e[2];hY[1]=e[1];hY[2]=-hU*e[0]+T*e[2];hX[0]=hY[0];hX[1]=hV*hY[1]-hW*hY[2];hX[2]=hW*hY[1]+hV*hY[2];return hX}var aP=Math.PI/180;var E=180/Math.PI;function bz(T){var i=(T-Date.UTC(2000,0,1,12))/86400000/36525;var e=(d3.utcDay.floor(T)-T)/86400000*360-180;return[e-U(i)*E,gF(i)*E]}function U(hU){var hV=ga(hU);var i=dL(hU);var T=aj(hU);var hW=Math.tan(f5(hU)/2);hW*=hW;return hW*Math.sin(2*T)-2*hV*Math.sin(i)+4*hV*hW*Math.sin(i)*Math.cos(2*T)-0.5*hW*hW*Math.sin(4*T)-1.25*hV*hV*Math.sin(2*i)}function gF(e){return Math.asin(Math.sin(f5(e))*Math.sin(g2(e)))}function g2(e){return bh(e)-(0.00569+0.00478*Math.sin((125.04-1934.136*e)*aP))*aP}function bh(e){return aj(e)+dR(e)}function dL(e){return(357.52911+e*(35999.05029-0.0001537*e))*aP}function aj(i){var e=(280.46646+i*(36000.76983+i*0.0003032))%360;return(e<0?e+360:e)/180*Math.PI}function dR(i){var e=dL(i);return(Math.sin(e)*(1.914602-i*(0.004817+0.000014*i))+Math.sin(e+e)*(0.019993-0.000101*i)+Math.sin(e+e+e)*0.000289)*aP}function f5(e){return ff(e)+0.00256*Math.cos((125.04-1934.136*e)*aP)*aP}function ff(e){return(23+(26+(21.448-e*(46.815+e*(0.00059-e*0.001813)))/60)/60)*aP}function ga(e){return 0.016708634-e*(0.000042037+1.267e-7*e)}function a6(){return window.devicePixelRatio||1}function aF(T){var i;var e;var hU;if(T>=0){hU=Math.floor(T/65536)*65536;i=hU;e=T-hU}else{hU=Math.floor(-T/65536)*65536;i=-hU;e=T+hU}return[i,e]}function G(e){if(e.lng>=0&&e.lat>=0){return new hv(e.lng-10000000,e.lat-6000000)}if(e.lng>=0&&e.lat<0){return new hv(e.lng-10000000,e.lat+6000000)}if(e.lng<0&&e.lat>=0){return new hv(e.lng+10000000,e.lat-6000000)}if(e.lng<0&&e.lat<0){return new hv(e.lng+10000000,e.lat+6000000)}}var fE=null;if(window.performance&&window.performance.now){fE=function(){return performance.now()}}else{if(Date.now){fE=function(){return Date.now()}}else{fE=function(){return(new Date).getTime()}}}function bL(hU,e,i){var T="mouseWheel";if(C.Platform.macintosh){if(!isNaN(hU)&&(hU<10||hU!==120)&&(e%1===0&&e<5)){T="padScroll"}if(C.Browser.firefox&&(e%1===0&&e<5&&i===0)){T="padScroll"}}if(C.Browser.safari&&hU===12){T="mouseWheel"}return T}function dg(h3,hY){var h2=h3[0];var h1=h3[1];var hU=false;for(var hX=0,hW=hY.length-2;hX<hY.length;hX+=2){var h0=hY[hX];var hV=hY[hX+1];var hZ=hY[hW];var T=hY[hW+1];var e=((hV>h1)!==(T>h1))&&(h2<(hZ-h0)*(h1-hV)/(T-hV)+h0);if(e){hU=!hU}hW=hX}return hU}function cE(T,e,i,hU){hU=hU||0.4;if(T>i){T=Math.pow(T-i+1,hU)+i-1}else{if(T<e){T=e-Math.pow(e-T+1,hU)+1}}return T}function go(hY){var hW="";for(var T=0;T<hY.length;T++){var hZ=hY.charCodeAt(T)<<1;var e=hZ.toString(2);var hV=e.length;var h2=e;if(hV<8){h2="00000000"+e;h2=h2.substr(e.length,8)}hW+=h2}var h0=5-hW.length%5;var hU=[];for(var T=0;T<h0;T++){hU[T]="0"}hW=hU.join("")+hW;var h1=[];for(var T=0;T<hW.length/5;T++){var hZ=hW.substr(T*5,5);var hX=parseInt(hZ,2)+50;h1.push(String.fromCharCode(hX))}return h1.join("")+h0.toString()}function aD(T,i){var e=bo.TILE_VERSION||window.TILE_VERSION;if(!e||!e[T]||!e[T][i]||!e[T][i].version||!e[T][i].updateDate){e=e5.tvc}return{ver:e[T][i].version,udt:e[T][i].updateDate}}function fC(){var e=bo.MSV||window.MSV;if(!e||!e.mapstyle||!e.mapstyle.updateDate||!e.mapstyle.version){e=e5.msv}return{ver:e.mapstyle.version,udt:e.mapstyle.updateDate}}function er(e,hV){var hU=e.slice(0);for(var T=0;T<hU.length;T++){hU[T]+=hV}return hU}var a4=null;function by(e){if(a4){return}e.fire(new bb("onloadtile"));a4=setTimeout(function(){a4=null},1000)}function e1(){if(cr("//map.baidu.com")||cr("//maps.baidu.com")||cr("//ditu.baidu.com")){return true}return false}dw.inMapHost=e1();if(typeof window._inMapHost==="boolean"){dw.inMapHost=window._inMapHost}function cr(i){var T=window.location;var e=document.createElement("a");e.href=i;return e.hostname===T.hostname&&e.port===T.port&&e.protocol===T.protocol}function ea(){}C.extend(ea,{Request:{INITIAL:-1,WAITING:0,LOADED:1,COMPLETED:2},Dependency:{poly:["marker"],hotspot:["poly"],infowindow:["marker","hotspot"],simpleInfowindow:["marker"],tools:["marker","poly"],mapgl:["glcommon","poly"],earth:["glcommon"],control:["scommon"],scommon:[],localSearch:["scommon"],otherSearch:["scommon"],route:["scommon"],buslineSearch:["route"],autocomplete:["scommon"]},MD5Mapping:{control:"jcx4tl",marker:"4zqkfw",poly:"4aeg4l",infowindow:"tit0pf",simpleInfowindow:"t0krnm",hotspot:"nvcc2d",menu:"bnsvv4",tools:"w4owwc",oppc:"dq4tba",oppcgl:"gzn4av",mapgl:"lvcen5",markeranimation:"zzkoer",earth:"4yk40s",glcommon:"mccnvx",localSearch:"eimaab",scommon:"mtzgka",otherSearch:"hmi2so",route:"pb3hy1",buslineSearch:"njttcj",autocomplete:"c2gzry"},Config:{baseUrl:e5.apiHost+"/getmodules?v=1.0&type=webgl",jsModPath:(dw.inMapHost?"":e5.mapHost)+"/res/newui/",timeout:5000},delayFlag:false,Module:{modules:{},modulesNeedToLoad:[]},_getMd5ModsStr:function(hW){var hV=[];for(var hY=0,T=hW.length;hY<T;hY++){var hX=hW[hY];var e=this.MD5Mapping[hX];var hU="$"+hX+"$";if(e!==hU){hV.push(hX+"_"+e)}}return hV.join(",")},load:function(i,hW,hU){var e=this.getModuleInfo(i);if(e.status===this.Request.COMPLETED){if(hU===true){hW()}}else{if(e.status===this.Request.INITIAL){this.combine(i);this.addToLoadQueue(i);var T=this;if(T.delayFlag===false){T.delayFlag=true;setTimeout(function(){var hX=T.Config.baseUrl+"&mod="+T._getMd5ModsStr(T.Module.modulesNeedToLoad);hp.load(hX);T.Module.modulesNeedToLoad.length=0;T.delayFlag=false},1)}e.status=this.Request.WAITING;function hV(hZ){var hY=T.getModuleInfo(i);if(hY.status!==T.Request.COMPLETED){if(window.map){var hX=new bb("onmod_timeout");hX.timeout=hZ/1000;hX.moduleName=i;window.map.fire(hX)}}}setTimeout(hV,this.Config.timeout,this.Config.timeout);setTimeout(hV,this.Config.timeout*2,this.Config.timeout*2)}if(hW){e.callbacks.push(hW)}}},combine:function(e){if(e&&this.Dependency[e]){var hU=this.Dependency[e];for(var T=0;T<hU.length;T++){this.combine(hU[T]);if(!this.Module.modules[hU[T]]){this.addToLoadQueue(hU[T])}}}},addToLoadQueue:function(e){var i=this.getModuleInfo(e);if(i.status===this.Request.INITIAL){i.status=this.Request.WAITING;this.Module.modulesNeedToLoad.push(e)}},run:function(T,hU){var hY=this.getModuleInfo(T);var h1=this.Dependency[T];if(h1){for(var hW=0;hW<h1.length;hW++){var hX=this.getModuleInfo(h1[hW]);if(hX.status!==this.Request.COMPLETED){hX.modsNeedToRun.push({name:T,code:hU});return}}}try{eval(hU)}catch(hZ){return}hY.status=this.Request.COMPLETED;for(var hW=0,hV=hY.callbacks.length;hW<hV;hW++){hY.callbacks[hW]()}hY.callbacks.length=0;for(hW=0;hW<hY.modsNeedToRun.length;hW++){var h0=hY.modsNeedToRun[hW];this.run(h0.name,h0.code)}hY.modsNeedToRun.length=0},getModuleInfo:function(i){var e;if(!this.Module.modules[i]){this.Module.modules[i]={status:this.Request.INITIAL,callbacks:[],modsNeedToRun:[]}}e=this.Module.modules[i];return e}});window._jsload=function(hV,hW){var i=ea.getModuleInfo(hV);i.status=ea.Request.LOADED;if(hW!==""){ea.run(hV,hW)}else{if(window.map){var e=new bb("ongetmodules_fail");e.moduleName=hV;window.map.fire(e)}var T=document.createElement("script");var hU=ea.MD5Mapping[hV];T.src=ea.Config.jsModPath+hV+"_"+hU+".js";document.getElementsByTagName("head")[0].appendChild(T)}};function ac(){this._timeData={}}var fb;if(typeof window!=="undefined"){fb=window}else{fb=self}ac.prototype.mark=function(e){this._timeData[e]=this._getTime()};ac.prototype.getMark=function(e){return this._timeData[e]};ac.prototype.getTime=function(i,e){return parseFloat((this._timeData[e]-this._timeData[i]).toFixed(2))};ac.prototype.print=function(){};ac.prototype.clear=function(){this._timeData={}};if(fb.performance&&fb.performance.now){ac.prototype._getTime=function(){return performance.now()}}else{ac.prototype._getTime=function(){return Date.now()}}!function(i,T){T(i.d3=i.d3||{})}(window,function(iB){function iT(iZ,i0,T,it){function e(i){return iZ(i=new Date(+i)),i}return e.floor=e,e.ceil=function(i){return iZ(i=new Date(i-1)),i0(i,1),iZ(i),i},e.round=function(i){var i1=e(i),i2=e.ceil(i);return i2-i>i-i1?i1:i2},e.offset=function(i,i1){return i0(i=new Date(+i),null==i1?1:Math.floor(i1)),i},e.range=function(i2,i,i1){var i3=[];if(i2=e.ceil(i2),i1=null==i1?1:Math.floor(i1),!(i>i2&&i1>0)){return i3}do{i3.push(new Date(+i2))}while(i0(i2,i1),iZ(i2),i>i2);return i3},e.filter=function(i){return iT(function(i1){for(;iZ(i1),!i(i1);){i1.setTime(i1-1)}},function(i1,i2){for(;--i2>=0;){for(;i0(i1,1),!i(i1);){}}})},T&&(e.count=function(i,i1){return iD.setTime(+i),iH.setTime(+i1),iZ(iD),iZ(iH),Math.floor(T(iD,iH))},e.every=function(i){return i=Math.floor(i),isFinite(i)&&i>0?i>1?e.filter(it?function(i1){return it(i1)%i===0}:function(i1){return e.count(0,i1)%i===0}):e:null}),e}function iI(e){return iT(function(i){i.setDate(i.getDate()-(i.getDay()+7-e)%7),i.setHours(0,0,0,0)},function(i,T){i.setDate(i.getDate()+7*T)},function(i,T){return(T-i-(T.getTimezoneOffset()-i.getTimezoneOffset())*iC)/iQ})}function iA(e){return iT(function(i){i.setUTCDate(i.getUTCDate()-(i.getUTCDay()+7-e)%7),i.setUTCHours(0,0,0,0)},function(i,T){i.setUTCDate(i.getUTCDate()+7*T)},function(i,T){return(T-i)/iQ})}var iD=new Date,iH=new Date,iO=iT(function(){},function(i,T){i.setTime(+i+T)},function(i,T){return T-i});iO.every=function(e){return e=Math.floor(e),isFinite(e)&&e>0?e>1?iT(function(i){i.setTime(Math.floor(i/e)*e)},function(i,T){i.setTime(+i+T*e)},function(i,T){return(T-i)/e}):iO:null};var iX=iO.range,iV=1000,iC=60000,iS=3600000,iK=86400000,iQ=604800000,h0=iT(function(e){e.setTime(Math.floor(e/iV)*iV)},function(i,T){i.setTime(+i+T*iV)},function(i,T){return(T-i)/iV},function(e){return e.getUTCSeconds()}),iU=h0.range,iJ=iT(function(e){e.setTime(Math.floor(e/iC)*iC)},function(i,T){i.setTime(+i+T*iC)},function(i,T){return(T-i)/iC},function(e){return e.getMinutes()}),h8=iJ.range,iw=iT(function(i){var T=i.getTimezoneOffset()*iC%iS;0>T&&(T+=iS),i.setTime(Math.floor((+i-T)/iS)*iS+T)},function(i,T){i.setTime(+i+T*iS)},function(i,T){return(T-i)/iS},function(e){return e.getHours()}),iP=iw.range,ij=iT(function(e){e.setHours(0,0,0,0)},function(i,T){i.setDate(i.getDate()+T)},function(i,T){return(T-i-(T.getTimezoneOffset()-i.getTimezoneOffset())*iC)/iK},function(e){return e.getDate()-1}),hZ=ij.range,ig=iI(0),ii=iI(1),hV=iI(2),id=iI(3),h2=iI(4),iz=iI(5),iG=iI(6),hX=ig.range,iy=ii.range,h6=hV.range,iv=id.range,iL=h2.range,ix=iz.range,iW=iG.range,iN=iT(function(e){e.setDate(1),e.setHours(0,0,0,0)},function(i,T){i.setMonth(i.getMonth()+T)},function(i,T){return T.getMonth()-i.getMonth()+12*(T.getFullYear()-i.getFullYear())},function(e){return e.getMonth()}),iY=iN.range,ic=iT(function(e){e.setMonth(0,1),e.setHours(0,0,0,0)},function(i,T){i.setFullYear(i.getFullYear()+T)},function(i,T){return T.getFullYear()-i.getFullYear()},function(e){return e.getFullYear()});ic.every=function(e){return isFinite(e=Math.floor(e))&&e>0?iT(function(i){i.setFullYear(Math.floor(i.getFullYear()/e)*e),i.setMonth(0,1),i.setHours(0,0,0,0)},function(i,T){i.setFullYear(i.getFullYear()+T*e)}):null};var h5=ic.range,iE=iT(function(e){e.setUTCSeconds(0,0)},function(i,T){i.setTime(+i+T*iC)},function(i,T){return(T-i)/iC},function(e){return e.getUTCMinutes()}),il=iE.range,ik=iT(function(e){e.setUTCMinutes(0,0,0)},function(i,T){i.setTime(+i+T*iS)},function(i,T){return(T-i)/iS},function(e){return e.getUTCHours()}),ih=ik.range,ie=iT(function(e){e.setUTCHours(0,0,0,0)},function(i,T){i.setUTCDate(i.getUTCDate()+T)},function(i,T){return(T-i)/iK},function(e){return e.getUTCDate()-1}),ib=ie.range,ia=iA(0),h9=iA(1),h7=iA(2),h4=iA(3),h3=iA(4),hY=iA(5),hW=iA(6),hU=ia.range,iu=h9.range,iR=h7.range,iF=h4.range,iM=h3.range,ir=hY.range,iq=hW.range,ip=iT(function(e){e.setUTCDate(1),e.setUTCHours(0,0,0,0)},function(i,T){i.setUTCMonth(i.getUTCMonth()+T)},function(i,T){return T.getUTCMonth()-i.getUTCMonth()+12*(T.getUTCFullYear()-i.getUTCFullYear())},function(e){return e.getUTCMonth()}),io=ip.range,h1=iT(function(e){e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},function(i,T){i.setUTCFullYear(i.getUTCFullYear()+T)},function(i,T){return T.getUTCFullYear()-i.getUTCFullYear()},function(e){return e.getUTCFullYear()});h1.every=function(e){return isFinite(e=Math.floor(e))&&e>0?iT(function(i){i.setUTCFullYear(Math.floor(i.getUTCFullYear()/e)*e),i.setUTCMonth(0,1),i.setUTCHours(0,0,0,0)},function(i,T){i.setUTCFullYear(i.getUTCFullYear()+T*e)}):null};var im=h1.range;iB.timeInterval=iT,iB.timeMillisecond=iO,iB.timeMilliseconds=iX,iB.utcMillisecond=iO,iB.utcMilliseconds=iX,iB.timeSecond=h0,iB.timeSeconds=iU,iB.utcSecond=h0,iB.utcSeconds=iU,iB.timeMinute=iJ,iB.timeMinutes=h8,iB.timeHour=iw,iB.timeHours=iP,iB.timeDay=ij,iB.timeDays=hZ,iB.timeWeek=ig,iB.timeWeeks=hX,iB.timeSunday=ig,iB.timeSundays=hX,iB.timeMonday=ii,iB.timeMondays=iy,iB.timeTuesday=hV,iB.timeTuesdays=h6,iB.timeWednesday=id,iB.timeWednesdays=iv,iB.timeThursday=h2,iB.timeThursdays=iL,iB.timeFriday=iz,iB.timeFridays=ix,iB.timeSaturday=iG,iB.timeSaturdays=iW,iB.timeMonth=iN,iB.timeMonths=iY,iB.timeYear=ic,iB.timeYears=h5,iB.utcMinute=iE,iB.utcMinutes=il,iB.utcHour=ik,iB.utcHours=ih,iB.utcDay=ie,iB.utcDays=ib,iB.utcWeek=ia,iB.utcWeeks=hU,iB.utcSunday=ia,iB.utcSundays=hU,iB.utcMonday=h9,iB.utcMondays=iu,iB.utcTuesday=h7,iB.utcTuesdays=iR,iB.utcWednesday=h4,iB.utcWednesdays=iF,iB.utcThursday=h3,iB.utcThursdays=iM,iB.utcFriday=hY,iB.utcFridays=ir,iB.utcSaturday=hW,iB.utcSaturdays=iq,iB.utcMonth=ip,iB.utcMonths=io,iB.utcYear=h1,iB.utcYears=im,Object.defineProperty(iB,"__esModule",{value:!0})});function gq(e){this._elemType=e;this._objCollection={}}gq.prototype.get=function(){var i=null;for(var e in this._objCollection){if(this._objCollection[e]&&this._objCollection[e]._free===true){this._objCollection[e]._free=false;return this._objCollection[e]}}i=S(this._elemType);e=bo.getGUID("obj_pool_");this._objCollection[e]=i;return i};gq.prototype.free=function(e){if(!e){return}e._free=true;if(e.tagName.toLowerCase()==="img"){e.src="";e.crossOrigin=null;e.onload=e.onerror=null}};gq.prototype.clear=function(){for(var e in this._objCollection){if(this._objCollection[e]&&this._objCollection[e].tagName.toLowerCase==="img"){this._objCollection[e].onload=this._objCollection[e].onerror=null}}this._objCollection={}};var gD={get:function(i,hV,e,T){var hU=new XMLHttpRequest();hU.open("GET",i,true);hU.timeout=10000;hU.ontimeout=function(){T&&T()};hU.onreadystatechange=function(hW){if(this.readyState===4){if(this.status===200){hV&&hV(hU.responseText)}else{e&&e()}}};hU.send()},post:function(i,hW,hV,e,T){var hU=new XMLHttpRequest();hU.open("POST",i,true);hU.setRequestHeader("Content-type","application/x-www-form-urlencoded");hU.timeout=10000;hU.ontimeout=function(){T&&T()};hU.onreadystatechange=function(hX){if(this.readyState===4){if(this.status===200){hV&&hV(hU.responseText,hW)}else{e&&e()}}};hU.send(hW);return hU}};var hp=(function(e){function i(hW,T,hV){var hU=S("script",{src:hW,type:"text/javascript",charset:"utf-8"});if(hU.addEventListener){hU.addEventListener("load",function(hY){var hX=hY.target;hX.parentNode.removeChild(hX);T&&T()},false);hU.addEventListener("error",function(hX){hV&&hV(null)},false)}else{if(hU.attachEvent){hU.attachEvent("onreadystatechange",function(hY){var hX=window.event.srcElement;if(hX&&(hX.readyState==="loaded"||hX.readyState==="complete")){hX.parentNode.removeChild(hX)}T&&T()})}}e.getElementsByTagName("head")[0].appendChild(hU)}return{load:function(hX,T,hU){if(typeof hX==="string"){i(hX,T,hU)}else{if(hX.length>0){var hW=hX.length;for(var hV=0;hV<hW;hV++){i(hX[hV],function(){hW--;if(hW===0&&T){T()}})}}}}}})(window.document);function cL(){}cL.instances={};cL.getInstance=function(i,T){if(cL.instances[i]){return cL.instances[i]}var e=new di(i,T);cL.instances[i]=e;return e};function di(e,i){this._name=e;this._baseZoom=18;this._opts={tileSize:256};C.extend(this._opts,i||{})}di.mapZoomBaseIndex=[8,8,8,8,7,7,6,6,5,5,4,3,3,3,2,2,1,1,0,0,0,0,0,0,0,0];di.baseScaleZoom=[19,17,15,12,10,9,7,5,3];di.baseScaleZoomMercatorSize=[512,2048,4096,32768,65536,262144,1048576,4194304,8388608];di.mapZoomBaseZoomMapping=[3,3,3,3,5,5,7,7,9,9,10,12,12,12,15,15,17,17,19,19,19,19,19,19,19,19];di.mapZoomStartZoomMapping=[3,3,3,3,4,4,6,6,8,8,10,11,11,11,14,14,16,16,18,18,18,18,18,18,18,18];di.baseScaleTileSize=[1024,1024,512,512,256,512,512,512,256];di.mapZoomTileSize=[256,256,256,256,256,512,256,512,256,512,256,256,512,1024,256,512,512,1024,512,1024,2048,4096,4096*2,4096*2*2,4096*2*2*2,4096*2*2*2*2];di.baseZoomInfo={"3":[3],"5":[4,5],"7":[6,7],"9":[8,9],"10":[10],"12":[11,12,13],"15":[14,15],"17":[16,17],"19":[18,19,20,21,22,23,24,25]};di.prototype={getName:function(){return this._name},getTileSize:function(e){e=Math.floor(e);if(e<3){e=3}if(this._name==="na"){return di.mapZoomTileSize[e]}return this._opts.tileSize},getBaseTileSize:function(i){i=Math.floor(i);if(this._name==="na"){var e=di.mapZoomBaseZoomMapping[i];return di.mapZoomTileSize[e]}return this._opts.tileSize},getDataZoom:function(e){e=Math.floor(e);if(this._name==="na"){return di.mapZoomBaseZoomMapping[e]}return e},getZoomUnits:function(e){return Math.pow(2,(this._baseZoom-e))},getMercatorSize:function(T,i){if(this._name==="na"){T=Math.floor(T);var e=di.mapZoomBaseIndex[T];return di.baseScaleZoomMercatorSize[e]}return this._opts.tileSize*this.getZoomUnits(i)},getBaseZoom:function(){return this._baseZoom},getParentTile:function(hU,h0,hZ,T,i){if(this._name==="na"){var hV=di.baseZoomInfo[hZ];T--;if(hV.indexOf(T)>-1){return{col:hU,row:h0,zoom:hZ,useZoom:T}}else{var hX=di.mapZoomBaseIndex[hZ];var hW=di.baseScaleZoom[hX+1];if(!hW){return null}var hY=this.getFactorByZooms(hW,hZ);var e=di.baseZoomInfo[hW];return{col:Math.floor(hU/hY),row:Math.floor(h0/hY),zoom:hW,useZoom:e[e.length-1]}}return null}if(hZ-1<i){return null}return{col:Math.floor(hU/2),row:Math.floor(h0/2),zoom:hZ-1,useZoom:hZ-1}},getChildTiles:function(hV,hX,e,T,h4,ia){if(this._name==="na"){var hU=di.baseZoomInfo[e];T+=ia;if(hU.indexOf(T)>-1){return[{col:hV,row:hX,zoom:e,useZoom:T}]}else{var h8=0;var h5=e;while(h8<ia){var h9=di.mapZoomBaseIndex[h5];var hZ=di.baseScaleZoom[h9-1];if(!hZ){return null}var h0=di.baseZoomInfo[hZ];if(h0[ia-1]){var h1=[];var h3=this.getFactorByZooms(e,hZ);var i=hV*h3;var h2=hX*h3;for(var h7=0;h7<h3;h7++){var hW=i+h7;for(var h6=0;h6<h3;h6++){var hY=h2+h6;h1.push({col:hW,row:hY,zoom:hZ,useZoom:h0[ia-1]})}}return h1}h8+=h0.length;if(ia===h0.length){h5=hZ}}}return null}var h1=[];if(e+ia>h4){return null}var h3=Math.pow(2,ia);var i=hV*h3;var h2=hX*h3;var hZ=e+ia;var h1=[];for(var h7=0;h7<2;h7++){var hW=i+h7;for(var h6=0;h6<2;h6++){var hY=h2+h6;h1.push({col:hW,row:hY,zoom:hZ,useZoom:hZ})}}return h1},getFactorByZooms:function(i,hU){var T=di.mapZoomBaseIndex[i];var hV=di.mapZoomBaseIndex[hU];var e=di.baseScaleZoomMercatorSize[T];var hW=di.baseScaleZoomMercatorSize[hV];return e/hW}};var a8={};var ag=["swiftshader","microsoft basic render driver"];var cl=["intel","nvidia","amd","apple","geforce"];function dv(e){e=e.toLowerCase();if(ag.indexOf(e)>=0){return true}if(e.indexOf("mobile")>=0){return true}return false}function fG(T){T=T.toLowerCase();for(var e=0;e<cl.length;e++){if(T.indexOf(cl[e])>=0){return true}}return false}function dY(e){if(!e){return false}if(dv(e)){return false}if(fG(e)){return true}return false}a8.ifEnableEarth=function(i){var e=a8.ifEnableEarth;if(!i&&typeof e._enable==="boolean"){return e._enable}if(a8.ifSupportWebGL()){e._enable=true;return true}e._enable=false;return false};a8.ifEnableWebGLMap=function(i){var e=a8.ifEnableWebGLMap;if(!i&&typeof e._enable==="boolean"){return e._enable}if(a8.ifSupportWebGL()){if(dw.inMapHost){e._enable=true;return true}else{if(window.Blob||window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder){e._enable=true;return true}else{e._enable=false;return false}}}e._enable=false;return false};a8.params={};a8.ifSupportWebGL=function(){var i=a8.ifSupportWebGL;if(typeof i._supportWebGL==="boolean"){return i._supportWebGL}if(!window.WebGLRenderingContext){i._supportWebGL=false;return false}var T=document.createElement("canvas");T.width=300;T.height=150;var hV=null;var h1={alpha:true,antialias:false,failIfMajorPerformanceCaveat:true,preserveDrawingBuffer:false,stencil:false};try{hV=T.getContext("webgl",h1)||T.getContext("experimental-webgl",h1)}catch(hX){i._supportWebGL=false}if(hV===null){i._supportWebGL=false}else{i._supportWebGL=true;var hZ=hV.getExtension("WEBGL_debug_renderer_info");var hY="";if(hZ){hY=hV.getParameter(hZ.UNMASKED_RENDERER_WEBGL);if(dY(hY)===true){i._supportWebGL=true}var h0=hV.getParameter(hZ.UNMASKED_VENDOR_WEBGL);i._renderer=hY;i._vendor=h0}if(!hZ&&C.Browser.firefox){i._supportWebGL=true}if(!hZ&&C.Platform.macintosh){i._supportWebGL=true}if(hV.drawingBufferWidth!==T.width||hV.drawingBufferHeight!==T.height){i._supportWebGL=false}if(hV.getParameter(hV.MAX_VERTEX_TEXTURE_IMAGE_UNITS)<4){i._supportWebGL=false}var hU=hV.getParameter(hV.MAX_TEXTURE_SIZE);a8.params.maxTextureSize=hU;if(hU<4096){i._supportWebGL=false}var hW=hV.getParameter(hV.MAX_TEXTURE_IMAGE_UNITS);if(hW<8){i._supportWebGL=false}if(!hV.getShaderPrecisionFormat||hV.getShaderPrecisionFormat(hV.FRAGMENT_SHADER,hV.HIGH_FLOAT).precision<23){i._supportWebGL=false}}return i._supportWebGL};a8.ifSupportCanvas2d=function(){var hV=a8.ifSupportCanvas2d;if(typeof hV.supportCanvas2d==="boolean"){return hV.supportCanvas2d}var T=document.createElement("canvas");var i=null;try{i=T.getContext("2d")}catch(hU){hV.supportCanvas2d=false}if(i===null){hV.supportCanvas2d=false}else{hV.supportCanvas2d=true}return hV.supportCanvas2d};a8.ifCanvas2dInBlackList=function(){return true};a8.ifEnableCanvas2dMap=function(){return false;var i=navigator.userAgent;var e=0;var hU=0;var hV=0;if(/macintosh/ig.test(i)){var T=0;if(/(\d+\.\d)?(?:\.\d)?\s+safari\/?(\d+\.\d+)?/i.test(i)&&!/chrome/i.test(i)){T=parseInt((RegExp["\x241"]||RegExp["\x242"]),10)}if(T>0){return false}return true}if(/windows nt (\d+\.\d)/ig.test(i)){hU=parseFloat(RegExp.$1);if(hU>=6.1){if(/chrome\/(\d+\.\d)/i.test(i)){e=parseFloat(RegExp.$1);if(e>=31){return true}}if(/MSIE (\d+(\.\d+)?)/.test(i)){hV=parseFloat(RegExp.$1);if(hV>=10){return true}}if(/Firefox/.test(i)){return true}if(/rv:11.0/ig.test(i)){return true}if(/edge/ig.test(i)){return true}}}return false};a8.ifSupportCSS3=function(hY,i){var hX=document.createElement("div");var hW="Webkit Moz O ms".split(" ");var e=hW.length;var T="";var hU=hX.style;if(hY in hU){T=hY}hY=hY.replace(/^[a-z]/,function(hZ){return hZ.toUpperCase()});while(e--){var hV=hW[e]+hY;if(hV in hU){T=hV;break}}if(i){return T}else{return T.length>0?true:false}};a8.isModernBrowser=a8.ifSupportCanvas2d()&&a8.ifSupportCSS3("transform");function e0(i,e){this._size=i;this._curSize=0;this._cache={};this._least=null;this._most=null;this._options={clearCallback:null,removeOldCallback:null};e=e||{};for(var T in e){this._options[T]=e[T]}this._getDataTimes=0;this._hitTimes=0}e0.prototype.setData=function(hU,hW){var i=this._cache;var T=this._size;if(T===0){return}var e=this._curSize;if(e===T){this._removeOld()}var hV;if(!i[hU]){hV={key:hU,data:hW,older:null,newwer:null};i[hU]=hV;if(this._least===null){this._least=hV}if(this._most===null){this._most=hV}this._curSize++}else{hV=i[hU];hV.data=hW;if(this._most===hV){return}hV.older&&(hV.older.newer=hV.newer);hV.newer&&(hV.newer.older=hV.older);if(this._least===hV){this._least=hV.newer}}if(this._most&&this._most!==hV){this._most.newer=hV;hV.older=this._most;this._most=hV;hV.newer=null}};e0.prototype.getData=function(e){var i=this._cache[e];this._getDataTimes++;if(i){this._hitTimes++;var T=i.data;if(this._most===i){return T}i.older&&(i.older.newer=i.newer);i.newer&&(i.newer.older=i.older);if(this._least===i){this._least=i.newer}this._most.newer=i;i.older=this._most;i.newer=null;this._most=i;return T}return null};e0.prototype.getAllData=function(){return this._cache};e0.prototype.getHitRate=function(){return this._hitTimes/this._getDataTimes};e0.prototype.removeData=function(i){var e=this._cache;var T=e[i];if(!T){return}if(this._options.clearCallback){this._options.clearCallback(T.data,T.key)}T.older&&(T.older.newer=T.newer);T.newer&&(T.newer.older=T.older);if(this._least===T){this._least=T.newer}if(this._most===T){this._most=T.older}delete e[i];this._curSize--};e0.prototype._removeOld=function(){var e=this._cache;var hU=Math.round(this._size*0.6);var T=0;while(this._least&&T<hU){var i=this._least;this._least=i.newer;i.newer&&(i.newer.older=null);if(this._options.clearCallback){this._options.clearCallback(i.data,i.key)}delete e[i.key];T++}this._curSize-=T;if(this._options.removeOldCallback){this._options.removeOldCallback()}};e0.prototype.clear=function(){var e=this._cache;var i=this._least;if(this._options.clearCallback){while(i){this._options.clearCallback(i.data,i.key);i=i.newer}}this._least=this._most=null;this._cache={};this._curSize=0};e0.prototype.forEach=function(e){var i=this._least;while(i){e(i.data);i=i.newer}};e0.prototype.clearExcept=function(i){var e=this._cache;var T=this._least;while(T){if(!i[T.key]){if(this._options.clearCallback){this._options.clearCallback(T.data,T.key)}T.older&&(T.older.newer=T.newer);T.newer&&(T.newer.older=T.older);if(this._least===T){this._least=T.newer}if(this._most===T){this._most=T.older}delete e[T.key];this._curSize--}T=T.newer}};var g3={ColorRefTable:{aliceblue:["#f0f8ff","rgb(240,248,255)"],antiquewhite:["#faebd7","rgb(250,235,215)"],aqua:["#00ffff","rgb(0,255,255)"],aquamarine:["#7fffd4","rgb(127,255,212)"],azure:["#f0ffff","rgb(240,255,255)"],beige:["#f5f5dc","rgb(245,245,220)"],bisque:["#ffe4c4","rgb(255,228,196)"],black:["#000000","rgb(0,0,0)"],blanchedalmond:["#ffebcd","rgb(255,235,205)"],blue:["#0000ff","rgb(0,0,255)"],blueviolet:["#8a2be2","rgb(138,43,226)"],brown:["#a52a2a","rgb(165,42,42)"],burlywood:["#deb887","rgb(222,184,135)"],cadetblue:["#5f9ea0","rgb(95,158,160)"],chartreuse:["#7fff00","rgb(127,255,0)"],chocolate:["#d2691e","rgb(210,105,30)"],coral:["#ff7f50","rgb(255,127,80)"],cornflowerblue:["#6495ed","rgb(100,149,237)"],cornsilk:["#fff8dc","rgb(255,248,220)"],crimson:["#dc143c","rgb(220,20,60)"],cyan:["#00ffff","rgb(0,255,255)"],darkblue:["#00008b","rgb(0,0,139)"],darkcyan:["#008b8b","rgb(0,139,139)"],darkgoldenrod:["#b8860b","rgb(184,134,11)"],darkgray:["#a9a9a9","rgb(169,169,169)"],darkgreen:["#006400","rgb(0,100,0)"],darkgrey:["#a9a9a9","rgb(169,169,169)"],darkkhaki:["#bdb76b","rgb(189,183,107)"],darkmagenta:["#8b008b","rgb(139,0,139)"],darkolivegreen:["#556b2f","rgb(85,107,47)"],darkorange:["#ff8c00","rgb(255,140,0)"],darkorchid:["#9932cc","rgb(153,50,204)"],darkred:["#8b0000","rgb(139,0,0)"],darksalmon:["#e9967a","rgb(233,150,122)"],darkseagreen:["#8fbc8f","rgb(143,188,143)"],darkslateblue:["#483d8b","rgb(72,61,139)"],darkslategray:["#2f4f4f","rgb(47,79,79)"],darkslategrey:["#2f4f4f","rgb(47,79,79)"],darkturquoise:["#00ced1","rgb(0,206,209)"],darkviolet:["#9400d3","rgb(148,0,211)"],deeppink:["#ff1493","rgb(255,20,147)"],deepskyblue:["#00bfff","rgb(0,191,255)"],dimgray:["#696969","rgb(105,105,105)"],dimgrey:["#696969","rgb(105,105,105)"],dodgerblue:["#1e90ff","rgb(30,144,255)"],firebrick:["#b22222","rgb(178,34,34)"],floralwhite:["#fffaf0","rgb(255,250,240)"],forestgreen:["#228b22","rgb(34,139,34)"],fuchsia:["#ff00ff","rgb(255,0,255)"],gainsboro:["#dcdcdc","rgb(220,220,220)"],ghostwhite:["#f8f8ff","rgb(248,248,255)"],gold:["#ffd700","rgb(255,215,0)"],goldenrod:["#daa520","rgb(218,165,32)"],gray:["#808080","rgb(128,128,128)"],green:["#008000","rgb(0,128,0)"],greenyellow:["#adff2f","rgb(173,255,47)"],grey:["#808080","rgb(128,128,128)"],honeydew:["#f0fff0","rgb(240,255,240)"],hotpink:["#ff69b4","rgb(255,105,180)"],indianred:["#cd5c5c","rgb(205,92,92)"],indigo:["#4b0082","rgb(75,0,130)"],ivory:["#fffff0","rgb(255,255,240)"],khaki:["#f0e68c","rgb(240,230,140)"],lavender:["#e6e6fa","rgb(230,230,250)"],lavenderblush:["#fff0f5","rgb(255,240,245)"],lawngreen:["#7cfc00","rgb(124,252,0)"],lemonchiffon:["#fffacd","rgb(255,250,205)"],lightblue:["#add8e6","rgb(173,216,230)"],lightcoral:["#f08080","rgb(240,128,128)"],lightcyan:["#e0ffff","rgb(224,255,255)"],lightgoldenrodyellow:["#fafad2","rgb(250,250,210)"],lightgray:["#d3d3d3","rgb(211,211,211)"],lightgreen:["#90ee90","rgb(144,238,144)"],lightgrey:["#d3d3d3","rgb(211,211,211)"],lightpink:["#ffb6c1","rgb(255,182,193)"],lightsalmon:["#ffa07a","rgb(255,160,122)"],lightseagreen:["#20b2aa","rgb(32,178,170)"],lightskyblue:["#87cefa","rgb(135,206,250)"],lightslategray:["#778899","rgb(119,136,153)"],lightslategrey:["#778899","rgb(119,136,153)"],lightsteelblue:["#b0c4de","rgb(176,196,222)"],lightyellow:["#ffffe0","rgb(255,255,224)"],lime:["#00ff00","rgb(0,255,0)"],limegreen:["#32cd32","rgb(50,205,50)"],linen:["#faf0e6","rgb(250,240,230)"],magenta:["#ff00ff","rgb(255,0,255)"],maroon:["#800000","rgb(128,0,0)"],mediumaquamarine:["#66cdaa","rgb(102,205,170)"],mediumblue:["#0000cd","rgb(0,0,205)"],mediumorchid:["#ba55d3","rgb(186,85,211)"],mediumpurple:["#9370db","rgb(147,112,219)"],mediumseagreen:["#3cb371","rgb(60,179,113)"],mediumslateblue:["#7b68ee","rgb(123,104,238)"],mediumspringgreen:["#00fa9a","rgb(0,250,154)"],mediumturquoise:["#48d1cc","rgb(72,209,204)"],mediumvioletred:["#c71585","rgb(199,21,133)"],midnightblue:["#191970","rgb(25,25,112)"],mintcream:["#f5fffa","rgb(245,255,250)"],mistyrose:["#ffe4e1","rgb(255,228,225)"],moccasin:["#ffe4b5","rgb(255,228,181)"],navajowhite:["#ffdead","rgb(255,222,173)"],navy:["#000080","rgb(0,0,128)"],oldlace:["#fdf5e6","rgb(253,245,230)"],olive:["#808000","rgb(128,128,0)"],olivedrab:["#6b8e23","rgb(107,142,35)"],orange:["#ffa500","rgb(255,165,0)"],orangered:["#ff4500","rgb(255,69,0)"],orchid:["#da70d6","rgb(218,112,214)"],palegoldenrod:["#eee8aa","rgb(238,232,170)"],palegreen:["#98fb98","rgb(152,251,152)"],paleturquoise:["#afeeee","rgb(175,238,238)"],palevioletred:["#db7093","rgb(219,112,147)"],papayawhip:["#ffefd5","rgb(255,239,213)"],peachpuff:["#ffdab9","rgb(255,218,185)"],peru:["#cd853f","rgb(205,133,63)"],pink:["#ffc0cb","rgb(255,192,203)"],plum:["#dda0dd","rgb(221,160,221)"],powderblue:["#b0e0e6","rgb(176,224,230)"],purple:["#800080","rgb(128,0,128)"],red:["#ff0000","rgb(255,0,0)"],rosybrown:["#bc8f8f","rgb(188,143,143)"],royalblue:["#4169e1","rgb(65,105,225)"],saddlebrown:["#8b4513","rgb(139,69,19)"],salmon:["#fa8072","rgb(250,128,114)"],sandybrown:["#f4a460","rgb(244,164,96)"],seagreen:["#2e8b57","rgb(46,139,87)"],seashell:["#fff5ee","rgb(255,245,238)"],sienna:["#a0522d","rgb(160,82,45)"],silver:["#c0c0c0","rgb(192,192,192)"],skyblue:["#87ceeb","rgb(135,206,235)"],slateblue:["#6a5acd","rgb(106,90,205)"],slategray:["#708090","rgb(112,128,144)"],slategrey:["#708090","rgb(112,128,144)"],snow:["#fffafa","rgb(255,250,250)"],springgreen:["#00ff7f","rgb(0,255,127)"],steelblue:["#4682b4","rgb(70,130,180)"],tan:["#d2b48c","rgb(210,180,140)"],teal:["#008080","rgb(0,128,128)"],thistle:["#d8bfd8","rgb(216,191,216)"],tomato:["#ff6347","rgb(255,99,71)"],turquoise:["#40e0d0","rgb(64,224,208)"],violet:["#ee82ee","rgb(238,130,238)"],wheat:["#f5deb3","rgb(245,222,179)"],white:["#ffffff","rgb(255,255,255)"],whitesmoke:["#f5f5f5","rgb(245,245,245)"],yellow:["#ffff00","rgb(255,255,0)"],yellowgreen:["#9acd32","rgb(154,205,50)"]},parseHexToRgbaArray:function(hW){var hX=hW.replace("#","");if(hX.length===3){hX+="f"}else{if(hX.length===6){hX+="ff"}}var e=[];var hV=hX.length;var hU=hV===8?2:1;for(var T=0;T<hV;T=T+hU){if(hU===2){e.push(parseInt(hX.slice(T,T+2),16))}else{e.push(parseInt(hX.slice(T,T+1)+hX.slice(T,T+1),16))}}return e},parseRgbaStrToArray:function(i){var e=[0,0,0,255];if(i.indexOf("rgba(")===0){var hU=i.replace("rgba(","").replace(")","");var T=hU.split(",");e[0]=parseInt(T[0],10);e[1]=parseInt(T[1],10);e[2]=parseInt(T[2],10);e[3]=Math.round(parseFloat(T[3])*255)}else{if(i.indexOf("rgb(")===0){var hU=i.replace("rgb(","").replace(")","");var hV=hU.split(",");e[0]=parseInt(hV[0],10);e[1]=parseInt(hV[1],10);e[2]=parseInt(hV[2],10);e[3]=255}}return e},parseHexAndOpacityToRgbaArray:function(hV,hW){var T=[];var hZ=/^#([0-9a-fA-f]{3}|[0-9a-fA-f]{6})$/;var hY=hV.toLowerCase();if(hZ.test(hY)){if(hY.length===4){var e="#";for(var hX=1;hX<4;hX++){e+=hY.slice(hX,hX+1).concat(hY.slice(hX,hX+1))}hY=e}for(var hU=1;hU<7;hU+=2){T.push(parseInt(hY.slice(hU,hU+2),16))}T.push(hW)}return T},parseCSSColor:function(e){if(e.indexOf("#")===0){return g3.parseHexToRgbaArray(e)}return g3.parseRgbaStrToArray(e)},rgbToHSV:function(hV){var e=hV[0]/255;var T=hV[1]/255;var hW=hV[2]/255;var hZ=Math.max(e,T,hW);var hU=Math.min(e,T,hW);var hY=hZ-hU;var i;if(hY===0){i=0}else{if(hZ===e){i=60*(((T-hW)/hY)%6)}else{if(hZ===T){i=60*((hW-e)/hY+2)}else{if(hZ===hW){i=60*((e-T)/hY+4)}}}}var h0=hZ===0?0:(hY/hZ);var hX=hZ;while(i<0){i+=360}return[i,h0,hX]},hsvToRGB:function(hU){var hY=hU[2]*hU[1];var T=hY*(1-Math.abs((hU[0]/60)%2-1));var i=hU[2]-hY;var hV=hU[0];var hX;var hW;var e;if(hV>=0&&hV<60){hX=hY;hW=T;e=0}else{if(hV>=60&&hV<120){hX=T;hW=hY;e=0}else{if(hV>=120&&hV<180){hX=0;hW=hY;e=T}else{if(hV>=180&&hV<240){hX=0;hW=T;e=hY}else{if(hV>=240&&hV<300){hX=T;hW=0;e=hY}else{if(hV>=300&&hV<360){hX=hY;hW=0;e=T}}}}}}hX=(hX+i)*255>255?255:(hX+i)*255;hW=(hW+i)*255>255?255:(hW+i)*255;e=(e+i)*255>255?255:(e+i)*255;return[Math.round(hX),Math.round(hW),Math.round(e)]},formatColorCssToRgbaArray:function(hW,T,hU){hU=(typeof hU!=="boolean")?true:hU;if(typeof hW!=="string"){return hU?[0,0,0,1]:[0,0,0,255]}var i=(hW||"Black").trim().toLowerCase();var e=[];var hV=g3.ColorRefTable[i];if(hV!==undefined){i=hV[0]}e=g3.parseCSSColor(i);if(T!==undefined&&!isNaN(Number(T))){T=Number(T);e[3]=g3.fitTo(T,0,1)}else{e[3]=Number((e[3]/255).toFixed(2))}if(!hU){e[3]=Math.floor(e[3]*255)}return e},fitTo:function(T,i,e){if(T<i){T=i}else{if(T>e){T=e}}return T}};(function(hW){function h6(ib,ie){var id=(ib&65535)+(ie&65535);var ic=(ib>>16)+(ie>>16)+(id>>16);return(ic<<16)|(id&65535)}function h5(ib,ic){return(ib<<ic)|(ib>>>(32-ic))}function h0(ih,id,ic,ib,ig,ie){return h6(h5(h6(h6(id,ih),h6(ib,ie)),ig),ic)}function e(id,ic,ii,ih,ib,ig,ie){return h0((ic&ii)|(~ic&ih),id,ic,ib,ig,ie)}function hX(id,ic,ii,ih,ib,ig,ie){return h0((ic&ih)|(ii&~ih),id,ic,ib,ig,ie)}function h3(id,ic,ii,ih,ib,ig,ie){return h0(ic^ii^ih,id,ic,ib,ig,ie)}function h9(id,ic,ii,ih,ib,ig,ie){return h0(ii^(ic|~ih),id,ic,ib,ig,ie)}function T(im,ih){im[ih>>5]|=128<<(ih%32);im[((ih+64)>>>9<<4)+14]=ih;var id;var ig;var ie;var ic;var ib;var il=1732584193;var ik=-271733879;var ij=-1732584194;var ii=271733878;for(id=0;id<im.length;id+=16){ig=il;ie=ik;ic=ij;ib=ii;il=e(il,ik,ij,ii,im[id],7,-680876936);ii=e(ii,il,ik,ij,im[id+1],12,-389564586);ij=e(ij,ii,il,ik,im[id+2],17,606105819);ik=e(ik,ij,ii,il,im[id+3],22,-1044525330);il=e(il,ik,ij,ii,im[id+4],7,-176418897);ii=e(ii,il,ik,ij,im[id+5],12,1200080426);ij=e(ij,ii,il,ik,im[id+6],17,-1473231341);ik=e(ik,ij,ii,il,im[id+7],22,-45705983);il=e(il,ik,ij,ii,im[id+8],7,1770035416);ii=e(ii,il,ik,ij,im[id+9],12,-1958414417);ij=e(ij,ii,il,ik,im[id+10],17,-42063);ik=e(ik,ij,ii,il,im[id+11],22,-1990404162);il=e(il,ik,ij,ii,im[id+12],7,1804603682);ii=e(ii,il,ik,ij,im[id+13],12,-40341101);ij=e(ij,ii,il,ik,im[id+14],17,-1502002290);ik=e(ik,ij,ii,il,im[id+15],22,1236535329);il=hX(il,ik,ij,ii,im[id+1],5,-165796510);ii=hX(ii,il,ik,ij,im[id+6],9,-1069501632);ij=hX(ij,ii,il,ik,im[id+11],14,643717713);ik=hX(ik,ij,ii,il,im[id],20,-373897302);il=hX(il,ik,ij,ii,im[id+5],5,-701558691);ii=hX(ii,il,ik,ij,im[id+10],9,38016083);ij=hX(ij,ii,il,ik,im[id+15],14,-660478335);ik=hX(ik,ij,ii,il,im[id+4],20,-405537848);il=hX(il,ik,ij,ii,im[id+9],5,568446438);ii=hX(ii,il,ik,ij,im[id+14],9,-1019803690);ij=hX(ij,ii,il,ik,im[id+3],14,-187363961);ik=hX(ik,ij,ii,il,im[id+8],20,1163531501);il=hX(il,ik,ij,ii,im[id+13],5,-1444681467);ii=hX(ii,il,ik,ij,im[id+2],9,-51403784);ij=hX(ij,ii,il,ik,im[id+7],14,1735328473);ik=hX(ik,ij,ii,il,im[id+12],20,-1926607734);il=h3(il,ik,ij,ii,im[id+5],4,-378558);ii=h3(ii,il,ik,ij,im[id+8],11,-2022574463);ij=h3(ij,ii,il,ik,im[id+11],16,1839030562);ik=h3(ik,ij,ii,il,im[id+14],23,-35309556);il=h3(il,ik,ij,ii,im[id+1],4,-1530992060);ii=h3(ii,il,ik,ij,im[id+4],11,1272893353);ij=h3(ij,ii,il,ik,im[id+7],16,-155497632);ik=h3(ik,ij,ii,il,im[id+10],23,-1094730640);il=h3(il,ik,ij,ii,im[id+13],4,681279174);ii=h3(ii,il,ik,ij,im[id],11,-358537222);ij=h3(ij,ii,il,ik,im[id+3],16,-722521979);ik=h3(ik,ij,ii,il,im[id+6],23,76029189);il=h3(il,ik,ij,ii,im[id+9],4,-640364487);ii=h3(ii,il,ik,ij,im[id+12],11,-421815835);ij=h3(ij,ii,il,ik,im[id+15],16,530742520);ik=h3(ik,ij,ii,il,im[id+2],23,-995338651);il=h9(il,ik,ij,ii,im[id],6,-198630844);ii=h9(ii,il,ik,ij,im[id+7],10,1126891415);ij=h9(ij,ii,il,ik,im[id+14],15,-1416354905);ik=h9(ik,ij,ii,il,im[id+5],21,-57434055);il=h9(il,ik,ij,ii,im[id+12],6,1700485571);ii=h9(ii,il,ik,ij,im[id+3],10,-1894986606);ij=h9(ij,ii,il,ik,im[id+10],15,-1051523);ik=h9(ik,ij,ii,il,im[id+1],21,-2054922799);il=h9(il,ik,ij,ii,im[id+8],6,1873313359);ii=h9(ii,il,ik,ij,im[id+15],10,-30611744);ij=h9(ij,ii,il,ik,im[id+6],15,-1560198380);ik=h9(ik,ij,ii,il,im[id+13],21,1309151649);il=h9(il,ik,ij,ii,im[id+4],6,-145523070);ii=h9(ii,il,ik,ij,im[id+11],10,-1120210379);ij=h9(ij,ii,il,ik,im[id+2],15,718787259);ik=h9(ik,ij,ii,il,im[id+9],21,-343485551);il=h6(il,ig);ik=h6(ik,ie);ij=h6(ij,ic);ii=h6(ii,ib)}return[il,ik,ij,ii]}function h4(ic){var id;var ib="";var ie=ic.length*32;for(id=0;id<ie;id+=8){ib+=String.fromCharCode((ic[id>>5]>>>(id%32))&255)}return ib}function hZ(ic){var ie;var ib=[];ib[(ic.length>>2)-1]=undefined;for(ie=0;ie<ib.length;ie+=1){ib[ie]=0}var id=ic.length*8;for(ie=0;ie<id;ie+=8){ib[ie>>5]|=(ic.charCodeAt(ie/8)&255)<<(ie%32)}return ib}function hY(ib){return h4(T(hZ(ib),ib.length*8))}function ia(id,ih){var ic;var ig=hZ(id);var ib=[];var ie=[];var ii;ib[15]=ie[15]=undefined;if(ig.length>16){ig=T(ig,id.length*8)}for(ic=0;ic<16;ic+=1){ib[ic]=ig[ic]^909522486;ie[ic]=ig[ic]^1549556828}ii=T(ib.concat(hZ(ih)),512+ih.length*8);return h4(T(ie.concat(ii),512+128))}function h8(ie){var id="0123456789abcdef";var ic="";var ib;var ig;for(ig=0;ig<ie.length;ig+=1){ib=ie.charCodeAt(ig);ic+=id.charAt((ib>>>4)&15)+id.charAt(ib&15)}return ic}function h1(ib){return unescape(encodeURIComponent(ib))}function hU(ib){return hY(h1(ib))}function h2(ib){return h8(hU(ib))}function i(ib,ic){return ia(h1(ib),h1(ic))}function h7(ib,ic){return h8(i(ib,ic))}function hV(ic,id,ib){if(!id){if(!ib){return h2(ic)}return hU(ic)}if(!ib){return h7(id,ic)}return i(id,ic)}if(typeof define==="function"&&define.amd){define(function(){return hV})}else{if(typeof module==="object"&&module.exports){module.exports=hV}else{hW.md5=hV}}})(this);var cB={request:function(h1,hV,T,h3,hU){var hX=new Date().getTime();var h0=(Math.random()*100000).toFixed(0);bo._rd["_cbk"+h0]=function(h4){if(h4.result&&h4.result["error"]&&h4.result["error"]===202){alert("该AK因为恶意行为已经被管理员封禁！");return}T=T||{};h1&&h1(h4,T);delete bo._rd["_cbk"+h0]};h3=h3||"";var h2;if(T&&T.useEncodeURI){h2=hm(hV,encodeURI)}else{h2=hm(hV,encodeURIComponent)}var hZ=this;var i=e5.apiHost+"/"+h3+"?"+h2+"&ie=utf-8&oue=1&fromproduct=jsapi";if(!hU){i+="&res=api"}i+="&callback="+eB+"._rd._cbk"+h0;function hY(h5){var h4;var h6=new RegExp("(^| )"+h5+"=([^;]*)(;|$)");if(h4=document.cookie.match(h6)){return unescape(h4[2])}else{return -1}}var e=hY("BMAP_SECKEY");var hW=hY("SECKEY_CID1");i+="&ak="+gh+"&v=gl&seckey="+e+"&timeStamp="+hX+"&cid="+hW;hp.load(i)}};window.srqtimer=null;window.firstTime=true;window.srqcount=0;bo._rd={};var D={request:function(hV,e){if(e){var hU=(Math.random()*100000).toFixed(0);BMapGL._rd["_cbk"+hU]=function(hY){e&&e(hY);delete BMapGL._rd["_cbk"+hU]};hV+="&callback=BMapGL._rd._cbk"+hU}function T(hZ){var hY;var h0=new RegExp("(^| )"+hZ+"=([^;]*)(;|$)");if(hY=document.cookie.match(h0)){return unescape(hY[2])}else{return -1}}var hW=T("BMAP_SECKEY");var hX=T("SECKEY_CID1");hV+="&seckey="+hW+"&cid="+hX;var i=S("script",{src:hV,type:"text/javascript",charset:"utf-8"});if(i.addEventListener){i.addEventListener("load",function(hZ){var hY=hZ.target;hY.parentNode.removeChild(hY)},false);i.addEventListener("error",function(hY){e&&e([,,,,,])},false)}else{if(i.attachEvent){i.attachEvent("onreadystatechange",function(hZ){var hY=window.event.srcElement;if(hY&&(hY.readyState=="loaded"||hY.readyState=="complete")){hY.parentNode.removeChild(hY)}})}}document.getElementsByTagName("head")[0].appendChild(i);i=null}};function a7(){this._map=null;this._container;this._type="control";this.blockInfoWindow=true;this._visible=true}a7.inherits(ed,"Control");C.extend(a7.prototype,{initialize:function(e){this._map=e;if(this._container){if(this._opts&&this._opts.container){this._opts.container.appendChild(this._container)}else{e.container.appendChild(this._container)}return this._container}return},_i:function(e){if(!this._container&&this.initialize&&bV(this.initialize)){this._container=this.initialize(e)}this._opts=this._opts||{printable:false};this._setStyle();this._setPosition();if(this._container){this._container._jsobj=this}},_setStyle:function(){var i=this._container;if(i){var e=i.style;e.position="absolute";e.zIndex=this._cZIndex||"10";e.MozUserSelect="none";if(!this._opts.printable){C.ac(i,"BMap_noprint")}C.on(i,"contextmenu",db)}},remove:function(){this._map=null;if(!this._container){return}this._container.parentNode&&this._container.parentNode.removeChild(this._container);this._container._jsobj=null;this._container=null},_render:function(e){if(this._opts&&this._opts.container){this._container=dI(this._opts.container,'<div unselectable="on"></div>')}else{var i='<div unselectable="on"></div>';if(e&&e.config.autoSafeArea&&bv()){this._safeAreaContainer=dI(this._map.container,i);this._safeAreaContainer.style.position="absolute";this._safeAreaContainer.style.bottom="env(safe-area-inset-bottom)";this._container=dI(this._safeAreaContainer,i)}else{this._container=dI(this._map.container,i)}}if(this._visible===false){this._container.style.display="none"}return this._container},_setPosition:function(){this.setAnchor(this._opts.anchor)},setAnchor:function(hU){if(this.anchorFixed||typeof hU!=="number"||isNaN(hU)||hU<BMAP_ANCHOR_TOP_LEFT||hU>BMAP_ANCHOR_BOTTOM_RIGHT){hU=this.defaultAnchor}this._opts.offset=this._opts.offset||this.defaultOffset;var T=this._opts.anchor;this._opts.anchor=hU;if(!this._container){return}var hW=this._container;var e=this._opts.offset.width;var hV=this._opts.offset.height;hW.style.left=hW.style.top=hW.style.right=hW.style.bottom="auto";switch(hU){case BMAP_ANCHOR_TOP_LEFT:hW.style.top=hV+"px";hW.style.left=e+"px";break;case BMAP_ANCHOR_TOP_RIGHT:hW.style.top=hV+"px";hW.style.right=e+"px";break;case BMAP_ANCHOR_BOTTOM_LEFT:hW.style.bottom=hV+"px";hW.style.left=e+"px";break;case BMAP_ANCHOR_BOTTOM_RIGHT:hW.style.bottom=hV+"px";hW.style.right=e+"px";break;default:break}var i=["TL","TR","BL","BR"];C.rc(this._container,"anchor"+i[T]);C.ac(this._container,"anchor"+i[hU])},getAnchor:function(){return this._opts.anchor},setOffset:function(e){if(!e){return}this._opts=this._opts||{};this._opts.offset=new d9(e.width,e.height);if(!this._container){return}this.setAnchor(this._opts.anchor)},getOffset:function(){return this._opts.offset},getDom:function(){return this._container},show:function(){if(this._visible===true){return}this._visible=true;if(this._container){this._container.style.display=""}this.dispatchEvent(new bb("onshow"))},hide:function(){if(this._visible===false){return}this._visible=false;if(this._container){this._container.style.display="none"}this.dispatchEvent(new bb("onhide"))},isPrintable:function(){return !!this._opts.printable},isVisible:function(){if(!this._container&&!this._map){return false}return !!this._visible},_asyncLoadCode:function(){var e=this;ea.load("control",function(){if(e._asyncDraw){e._asyncDraw()}})}});var hG={TOP_LEFT:0,TOP_RIGHT:1,BOTTOM_LEFT:2,BOTTOM_RIGHT:3};bo.ControlAnchor=hG;window.BMAP_ANCHOR_TOP_LEFT=0;window.BMAP_ANCHOR_TOP_RIGHT=1;window.BMAP_ANCHOR_BOTTOM_LEFT=2;window.BMAP_ANCHOR_BOTTOM_RIGHT=3;function dH(e){a7.call(this);e=e||{};this._opts={printable:false};C.extend(this._opts,e);this._copyrightCollection=[];this.defaultAnchor=BMAP_ANCHOR_BOTTOM_LEFT;this.defaultOffset=new d9(5,2);this.setAnchor(e.anchor);this._canShow=true;this.sateMapStyle=false;this.blockInfoWindow=false;this._asyncLoadCode()}dH.inherits(a7,"CopyrightControl");C.extend(dH.prototype,{initialize:function(e){this._map=e;return this._container},addCopyright:function(hU){var e={minZoom:0,bounds:null,content:"",mapType:""};for(var T in hU){e[T]=hU[T]}if(this._map){var hX=e.minZoom;if(hX===-1||hX<this._map.getMinZoom()||hX>this._map.getMaxZoom()){e.minZoom=this._map.getMinZoom()}if(e.mapType!==""&&!b6[e.mapType]){e.mapType=BMAPGL_NORMAL_MAP}}var hV=this.getCopyright(hU.id);if(hV){for(var hW in e){hV[hW]=e[hW]}}else{this._copyrightCollection.push(e)}},getCopyright:function(hU){for(var T=0,e=this._copyrightCollection.length;T<e;T++){if(this._copyrightCollection[T].id===hU){return this._copyrightCollection[T]}}},addSateMapStyle:function(){this.sateMapStyle=true;if(this._container){C.ac(this._container,"BMap_cpyCtrl_w")}},removeSateMapStyle:function(){this.sateMapStyle=false;if(this._container){C.rc(this._container,"BMap_cpyCtrl_w")}}});function eb(e){a7.call(this);e=e||{};this.canCheckSize=e.canCheckSize===false?false:true;this.curCityName="";this.curCityCode="";this.defaultOffset=new d9(10,10);this.defaultAnchor=hG.TOP_LEFT;this.onChangeBefore=[];this.onChangeAfter=[];this.onChangeSuccess=[];this._opts={printable:false,offset:e.offset||this.defaultOffset,anchor:e.anchor||this.defaultAnchor,expand:!!(e.expand)};if(e.onChangeBefore&&bV(e.onChangeBefore)){this.onChangeBefore.push(e.onChangeBefore)}if(e.onChangeAfter&&bV(e.onChangeAfter)){this.onChangeAfter.push(e.onChangeAfter)}if(e.onChangeSuccess&&bV(e.onChangeSuccess)){this.onChangeSuccess.push(e.onChangeSuccess)}this.setAnchor(e.anchor);this._asyncLoadCode()}eb.inherits(a7,"CityListControl");C.extend(eb.prototype,{initialize:function(e){this._map=e;return this._container}});function hk(e){a7.call(this);e=e||{};this._opts={printable:false};this._opts=C.extend(C.extend(this._opts,{unit:"metric"}),e);this.defaultAnchor=BMAP_ANCHOR_BOTTOM_LEFT;this.defaultOffset=new d9(81,18);if(f8()){this.defaultOffset=new d9(75,10)}this.setAnchor(e.anchor);this._units={metric:{name:"metric",conv:1,incon:1000,u1:"米",u2:"公里"},us:{name:"us",conv:3.2808,incon:5280,u1:"英尺",u2:"英里"}};this.sateMapStyle=false;if(!this._units[this._opts.unit]){this._opts.unit="metric"}this._scaleText=null;this._numberArray={};this._asyncLoadCode()}window.BMAP_UNIT_METRIC="metric";window.BMAP_UNIT_IMPERIAL="us";hk.inherits(a7,"ScaleControl");C.extend(hk.prototype,{initialize:function(e){this._map=e;return this._container},setUnit:function(e){this._opts.unit=this._units[e]&&this._units[e].name||this._opts.unit},getUnit:function(){return this._opts.unit},addSateMapStyle:function(){this.sateMapStyle=true;var e=this._container;if(e){C.ac(e.children[0],"dark")}},removeSateMapStyle:function(){this.sateMapStyle=false;var e=this._container;if(e){C.rc(e.children[0],"dark")}}});window.BMAP_NAVIGATION_CONTROL_LARGE=0;window.BMAP_NAVIGATION_CONTROL_SMALL=1;window.BMAP_NAVIGATION_CONTROL_PAN=2;window.BMAP_NAVIGATION_CONTROL_ZOOM=3;window.BMAP_NAVIGATION_CONTROL_ANIM=4;function dt(e){a7.call(this);e=e||{};this._opts={printable:false};C.extend(this._opts,e);this.controlHeight=[{width:65,height:227,zoomHeight:227,zoomWidth:37,sliderHeight:180},{width:65,height:47,zoomHeight:(this._opts.forceNew===true)?56:47,zoomWidth:37,sliderHeight:0},{width:37,height:57,zoomHeight:0,zoomWidth:0,sliderHeight:0},{width:26,height:56,zoomHeight:56,zoomWidth:6,sliderHeight:0},{width:56,height:47,zoomHeight:47,zoomWidth:37,sliderHeight:180}];this.defaultAnchor=BMAP_ANCHOR_TOP_LEFT;this.defaultOffset=new d9(10,10);this.setAnchor(e.anchor);this.setType(e.type);this._maxTotalZoomLv=19;this._minZoomLevel=-1;this._maxZoomLevel=-1;this._totalZoomLv=-1;this._sliderInterval=10;this._sliderHeight=180;this._minBarY=1;this._maxBarY=-1;this._curBarY=-1;this._zoomDom=null;this._zoomBtnDom=null;this._sliderDom=null;this._sliderBaseDom=null;this._cZIndex="1100";this._asyncLoadCode()}dt.inherits(a7,"NavigationControl");C.extend(dt.prototype,{initialize:function(e){this._map=e;return this._container},setType:function(e){if(typeof e=="number"&&e>=BMAP_NAVIGATION_CONTROL_LARGE&&e<=BMAP_NAVIGATION_CONTROL_ANIM){this._opts.type=e}else{this._opts.type=BMAP_NAVIGATION_CONTROL_LARGE}},getType:function(){return this._opts.type}});function bC(i){a7.call(this);i=i||{};this._opts={printable:false};this.defaultAnchor=BMAP_ANCHOR_TOP_RIGHT;this.defaultOffset=new d9(10,10);this.setAnchor(i.anchor);this._opts=C.extend(C.extend(this._opts,{offset:this.defaultOffset,enableSwitch:true}),i);var e=this;ea.load("control",function(){e._asyncDraw()})}bC.inherits(a7,"MapTypeControl");C.extend(bC.prototype,{initialize:function(e){this._map=e;return this._container},showStreetLayer:function(e){this._map.showStreetLayer(e)}});function cy(e){a7.call(this);e=e||{};this._opts={};this._opts=C.extend(this._opts,e);this._zoomInDisabled=false;this._zoomOutDisabled=false;this._zoomInTapped=false;this._zoomOutTapped=false;this.defaultAnchor=hG.BOTTOM_RIGHT;this.defaultOffset=new d9(15,20);this.setAnchor(e.anchor);this._asyncLoadCode()}cy.inherits(a7,"ZoomControl");C.extend(cy.prototype,{initialize:function(e){this._map=e;return this._container}});function bA(e){a7.call(this);e=e||{};this._opts={autoZoom:true,autoViewport:true};this._opts=C.extend(this._opts,e);this.defaultAnchor=hG.BOTTOM_LEFT;this.defaultOffset=new d9(10,50);this.watchPosition=this._opts.watchPosition||false;this.useCompass=this._opts.useCompass||false;this.locMarker=null;this.locLevel=16;this.setAnchor(this._opts.anchor);this.onLocationStart=e.onLocationStart||null;this._asyncLoadCode()}bA.inherits(a7,"LocationControl");C.extend(bA.prototype,{initialize:function(e){this._map=e;return this._container},startLocation:function(){this._startLocationCalled=true},stopLocationTrace:function(){},setOptions:function(e){e=e||{};C.extend(this._opts,e)}});function af(e){a7.call(this);e=e||{};this._opts={};this._opts=C.extend(this._opts,e);this.defaultAnchor=hG.BOTTOM_LEFT;this.defaultOffset=new d9(5,15);if(f8()){this.defaultOffset=new d9(10,10)}this.setAnchor(e.anchor)}af.inherits(a7,"LogoControl");C.extend(af.prototype,{initialize:function(i){this._map=i;var e=this._container=document.createElement("div");e.innerHTML='<img src="'+e5.apiHost+'/images/logo_hd.png"  style="height:21px;width:62px;"/>';i.getContainer().appendChild(e);return e}});function gE(e,i){this._map=e;this._indoorInfo=i;this._visible=true;this._adjustVisible=true;this._isMobile=f8();this._sizeConfig={FLOOR_BTN_HEIGHT:this._isMobile?35:26,SWITCH_ARROW_HEIGHT:this._isMobile?20:15};this._init()}gE.prototype._init=function(){this._render();this._bindDom();this._bind();this._adjustDisplayHeight();var e=new bb("onindoor_bar_show");e.uid=this._indoorInfo.uid;this._map.dispatchEvent(e)};gE.prototype._render=function(){if(!this._indoorInfo){return}var hY=this._isMobile;var e=this._div=S("div");C.ac(e,"floor-select-container");hY&&C.ac(e,"mobile");hY&&C.ac(e,"all-border-radius");var i=this._btnTop=S("button");C.ac(i,"floor-switch-top");C.ac(i,"top-border-radius");var hW=S("div");C.ac(hW,"floor-switch-top-icon");i.appendChild(hW);var hV=this._btnBottom=S("button");var T=S("div");C.ac(T,"floor-switch-bottom-icon");hV.appendChild(T);C.ac(hV,"floor-switch-bottom");C.ac(hV,"bottom-border-radius");var hU=this._floorsContainer=S("div");C.ac(hU,"floors-container");hU.appendChild(this._createFloorsDom());this._div.appendChild(i);this._div.appendChild(hU);this._div.appendChild(hV);var hZ=0;if(this._btnTop.style.display===""){hZ=2*this._sizeConfig.SWITCH_ARROW_HEIGHT}this._div.style.height=parseInt(this._floorsContainer.style.height,10)+hZ+"px";this._map.getContainer().appendChild(this._div);if(!hY){var hX=this;setTimeout(function(){hX._div.style.right="20px"},20)}};gE.prototype._createFloorsDom=function(){if(!this._indoorInfo){return}var T=this._ol=S("ol");var hW=this._indoorInfo.currentFloor;for(var hV=this._indoorInfo.floors.length-1;hV>=0;hV--){var hX=this._indoorInfo.floors[hV].floorName;var e=S("li");var hU=S("button");C.ac(hU,"btn-select-floor");if(hV===hW){C.ac(hU,"selected")}hU.setAttribute("data-floor",hV);hU.innerHTML=hX;e.appendChild(hU);T.appendChild(e)}return T};gE.prototype._updateUI=function(){if(!this._ol){this._render();this._bind();this._adjustDisplayHeight();return}this._ol=null;this._ol=this._createFloorsDom();this._floorsContainer.innerHTML="";this._floorsContainer.appendChild(this._ol);this._adjustDisplayHeight()};gE.prototype._bindDom=function(){var e=this;C.on(this._floorsContainer,"click",function(hU){var T=hU.target||hU.srcElement;if(T.tagName.toLowerCase()==="button"){e._map.showIndoor(e._indoorInfo.uid,parseInt(T.getAttribute("data-floor"),10));var i=new bb("onindoor_bar_click");i.uid=e._indoorInfo.uid;e._map.dispatchEvent(i)}});C.on(this._floorsContainer,"mouseover",function(T){var i=T.target;if(i.tagName.toLowerCase()==="button"){C.ac(i,"hover")}});C.on(this._floorsContainer,"mouseout",function(T){var i=T.target;if(i.tagName.toLowerCase()==="button"){C.rc(i,"hover")}});C.on(this._floorsContainer,"touchstart",function(T){var i=T.target;if(i.tagName.toLowerCase()==="button"){C.ac(i,"onmousedown")}});C.on(this._floorsContainer,"touchend",function(T){var i=T.target;if(i.tagName.toLowerCase()==="button"){C.rc(i,"onmousedown")}});C.on(this._btnTop,"mouseover",function(i){if(this._disable){return}C.ac(this,"hover")});C.on(this._btnTop,"mouseout",function(i){C.rc(this,"hover")});C.on(this._btnBottom,"mouseover",function(i){if(this._disable){return}C.ac(this,"hover")});C.on(this._btnBottom,"mouseout",function(i){C.rc(this,"hover")});C.on(this._btnTop,"touchstart",function(i){if(this.className.indexOf("disable")>-1){return}C.ac(this,"onmousedown")});C.on(this._btnTop,"touchend",function(i){C.rc(this,"onmousedown")});C.on(this._btnBottom,"touchstart",function(i){if(this.className.indexOf("disable")>-1){return}C.ac(this,"onmousedown")});C.on(this._btnBottom,"touchend",function(i){C.rc(this,"onmousedown")});C.on(this._btnTop,"click",function(i){e._setBarSliderTop(parseInt(e._ol.style.top,10)+26)});C.on(this._btnBottom,"click",function(i){e._setBarSliderTop(parseInt(e._ol.style.top,10)-26)});C.on(this._div,"mousemove",h);C.on(this._div,"wheel",db);C.on(this._div,"mousewheel",db);this._map.addEventListener("resize",function(){e._adjustDisplayHeight()})};gE.prototype._adjustDisplayHeight=function(){if(!this._indoorInfo){return}var hW=this._map.getSize().height;var hX=this._sizeConfig.FLOOR_BTN_HEIGHT;var hY=hW-291-100;if(this._isMobile){hY=hW-12-108-this._map.config.bottomOffset}var e=this._indoorInfo.floors.length;var T=e*hX;var hU=e;var h0=0;var h1=this._floorsContainer.children[0];if(T>hY){this._showArrow=true;C.rc(h1.children[0].children[0],"top-border-radius");C.rc(h1.children[e-1].children[0],"bottom-border-radius")}else{this._showArrow=false;C.ac(h1.children[0].children[0],"top-border-radius");C.ac(h1.children[e-1].children[0],"bottom-border-radius")}while(T>hY){if(hU===0){break}hU--;h0=2*this._sizeConfig.SWITCH_ARROW_HEIGHT;T=hU*hX+h0}this._currentDisplayHeight=T;if(hU<3){this._setAdjustVisbile(false)}else{this._setAdjustVisbile(true)}this._floorsContainer.style.height=hU*hX+"px";var hV=this._indoorInfo.currentFloor;var i=e-hV;var hZ=hV-1;this._div.style.height=parseInt(this._floorsContainer.style.height,10)+h0+"px";var h2=-(e-(hV+Math.round(hU/2)))*hX;this._setBarSliderTop(h2);if(hU<e){C.show(this._btnTop);C.show(this._btnBottom)}else{C.hide(this._btnTop);C.hide(this._btnBottom);this._setBarSliderTop(0)}if(this._isMobile){this._div.style.bottom=108+this._map.config.bottomOffset+"px"}};gE.prototype._setBarSliderTop=function(hU){var T=26;var i=this._indoorInfo.floors.length;var e=i*T;if(this._currentDisplayHeight){if(this._showArrow){e=this._currentDisplayHeight-30}else{e=this._currentDisplayHeight}}if(e-hU>=i*T){hU=e-i*T;C.ac(this._btnBottom,"disable");C.rc(this._btnBottom,"hover");this._btnBottom._disable=true}else{C.rc(this._btnBottom,"disable");this._btnBottom._disable=false}if(hU>=0){hU=0;C.ac(this._btnTop,"disable");C.rc(this._btnTop,"hover");this._btnTop._disable=true}else{C.rc(this._btnTop,"disable");this._btnTop._disable=false}this._ol.style.top=hU+"px"};gE.prototype._setAdjustVisbile=function(e){if(this._adjustVisible===e){return}this._adjustVisible=e;if(e&&this._visible){this._div.style.right="20px"}else{this._div.style.right="-30px"}};gE.prototype._bind=function(){var i=this._map;var e=this;i.on("indoor_status_changed",function(hY){if(e._visible===false){return}var T=e._ol;var hW=hY.uid;if(!hW){return}var hX=hY.floor;for(var hV=0;hV<T.children.length;hV++){var hU=T.children[hV].children[0];if(parseInt(hU.getAttribute("data-floor"),10)===hX){C.ac(hU,"selected")}else{C.rc(hU,"selected")}}});i.on("zoomend",function(T){if(this.getZoom()<17){e._setAdjustVisbile(false)}else{e._setAdjustVisbile(true)}})};gE.prototype.setInfo=function(e){if(this._indoorInfo&&this._indoorInfo.uid===e.uid){return}this._indoorInfo=e;this._updateUI()};gE.prototype.show=function(){if(this._visible===true){return}this._visible=true;if(!this._isMobile){this._div.style.right="20px"}else{this._div.style.display=""}var e=new bb("onindoor_bar_show");e.uid=this._indoorInfo.uid;this._map.dispatchEvent(e)};gE.prototype.hide=function(){if(this._visible===false){return}this._visible=false;if(!this._isMobile){this._div.style.right="-30px"}else{this._div.style.display="none"}};function eV(e){this._opts=e||{};this.defaultOffset=new d9(2,80);this.defaultAnchor=BMAP_ANCHOR_TOP_RIGHT;if(this._opts.anchor===undefined){this.setAnchor(this.defaultAnchor)}else{this.setAnchor(this._opts.anchor)}this._firstAnimation=true}eV.inherits(a7,"NavigationControl3D");C.extend(eV.prototype,{initialize:function(T){this._map=T;this._createDom();this._bindDom();this._bind();if(!f8()){this._headingControl=new hJ(this._map,this._div)}this._tiltControl=new es(this._map,this._div);this._render();var i=this._map.getMapType();var e=this;if(i==="B_EARTH_MAP"||this._map._renderType==="webgl"){e._div.style.opacity="1";e._div.style.visibility="visible"}else{e._div.style.opacity="0";e._div.style.visibility="hidden"}return this._container},_createDom:function(){var i=this._div=document.createElement("div");this._container=i;var e=i.style;e.position="absolute";e.zIndex=5;e.width="52px";e.height="82px";e.right="-3px";e.bottom="79px";e.opacity="0";e.visibility="hidden";e.WebkitTransition=e.transition="opacity .3s ease-out,visibility .3s ease-out"},_render:function(){var e=document.getElementById("map-operate");if(e){e.appendChild(this._div)}else{this._map.getContainer().appendChild(this._div)}},_bindDom:function(){this._div.addEventListener("mousemove",h)},_bind:function(){if(this._map._renderType==="webgl"){return}var e=this;this._map.on("maptypechange",function(){if(this.mapType==="B_EARTH_MAP"){if(e._firstAnimation){e._firstAnimation=false;setTimeout(function(){e._div.style.opacity="1";e._div.style.visibility="visible"},300)}else{e._div.style.opacity="1";e._div.style.visibility="visible"}}else{e._div.style.opacity="0";e._div.style.visibility="hidden"}})}});function hJ(T,i){this._map=T;this._target=T;var hU=T.temp.originMapType||T.mapType;if(hU==="B_EARTH_MAP"&&T._earth){this._target=T._earth}this._outContainer=i||T.getContainer();this._imgRatio=a6()>=c8.HIGH_RES_MIN_RATIO?2:1;this._imgPath=e5.imgPath+"earth-navi-control-pc4"+(this._imgRatio===2?"-2x.png":".png");this._enabled=true;var e=this;this._setHeadingOptions={callback:function(){e._target.setLock(false)}};this._init()}C.extend(hJ.prototype,{_init:function(){this._createDom();this._render();this._bindDom();this._bind();this._updateUI();this._checkEnable()},_checkEnable:function(){if(this._target.getZoom()>=this._target._enableHeadingZoom){this.enable()}else{this.disable()}},_createDom:function(){var i=this._div=S("div");var e=i.style;e.position="absolute";e.zIndex=5;e.top="0";e.left="0";e.width="52px";e.height="54px";e.background="url("+this._imgPath+") no-repeat";e.backgroundSize="266px auto";this._rotateCCW=this._createButton();this._rotateCCW.title="逆时针转动";e=this._rotateCCW.style;e.left="2px";e.top="5px";e.zIndex="1";e.width="15px";e.height="42px";e.backgroundPosition="-75px -5px";this._rotateCW=this._createButton();this._rotateCW.title="顺时针转动";e=this._rotateCW.style;e.right="2px";e.top="5px";e.zIndex="1";e.width="15px";e.height="42px";e.backgroundPosition="-75px -5px";e.WebkitTransform=e.transform="scaleX(-1)";this._compass=this._createButton();this._compass.title="恢复正北方向";e=this._compass.style;e.left="19px";e.top="4px";e.width="14px";e.height="44px";e.backgroundPosition="-56px -4px";e.WebkitTransform=e.transform="rotate(0deg)";this._div.appendChild(this._rotateCCW);this._div.appendChild(this._compass);this._div.appendChild(this._rotateCW);this._domRendered=true},_createButton:function(){var e=S("button");var i=e.style;i.position="absolute";i.outline="none";i.border="none";i.background="url("+this._imgPath+") no-repeat";i.backgroundSize="266px auto";i.cursor="pointer";return e},_render:function(){this._outContainer.appendChild(this._div)},enable:function(){this._enabled=true;if(this._domRendered){this._rotateCCW.style.cursor="pointer";this._rotateCCW.style.opacity=1;this._rotateCW.style.cursor="pointer";this._rotateCW.style.opacity=1;this._compass.style.cursor="pointer";this._compass.style.opacity=1}},disable:function(){this._enabled=false;if(this._domRendered){this._rotateCCW.style.cursor="";this._rotateCCW.style.opacity=0.4;this._rotateCW.style.cursor="";this._rotateCW.style.opacity=0.4;this._compass.style.cursor="";this._compass.style.opacity=0.4}},_bindDom:function(){eL(this._div,["mousedown","click","dblclick"]);var i=this._map;var e=this;this._rotateCW.addEventListener("click",function(){if(e._isOperating||e._enabled===false){return}if(e._target.getLock()){return}if(e._target.getHeading()===360){e._target.setHeading(0)}e._target.setLock(true);e._target.setHeading(e._target.getHeading()+90,e._setHeadingOptions);i.fire(new bb("onrotatecwclick"))},false);this._rotateCCW.addEventListener("click",function(){if(e._isOperating||e._enabled===false){return}if(e._target.getLock()){return}if(e._target.getHeading()===-360){e._target.setHeading(0)}e._target.setLock(true);e._target.setHeading(e._target.getHeading()-90,e._setHeadingOptions);i.fire(new bb("onrotateccwclick"))},false);this._rotateCW.addEventListener("mouseover",function(){if(e._enabled===false){return}this.style.backgroundPosition="-89px -5px"},false);this._rotateCW.addEventListener("mouseout",function(){if(e._enabled===false){return}this.style.backgroundPosition="-75px -5px"},false);this._rotateCCW.addEventListener("mouseover",function(){if(e._enabled===false){return}this.style.backgroundPosition="-89px -5px"},false);this._rotateCCW.addEventListener("mouseout",function(){if(e._enabled===false){return}this.style.backgroundPosition="-75px -5px"},false);this._compass.addEventListener("click",function(){if(e._isOperating||e._enabled===false){return}if(e._target.getLock()){return}e._target.setLock(true);var T=false;if(e._target.getTilt()!==0){T=true;e._target.setTilt(0,e._setHeadingOptions)}if(e._target.getHeading()%360!==0){T=true;e._target.resetHeading(e._setHeadingOptions)}if(!T){e._target.setLock(false)}i.fire(new bb("oncompassclick"))},false)},_bind:function(){var e=this;this._bindTarget(this._target);if(this._map._renderType==="webgl"){this._map.addEventListener("maptypechange",function(i){if(this.mapType==="B_EARTH_MAP"){e._target=e._map._earth}else{e._target=e._map}e._bindTarget(e._target);e._checkEnable()})}},_bindTarget:function(i){if(i===this._map&&this._mapBinded){return}if(i===this._map._earth&&this._earthBinded){return}var e=this;i.addEventListener("heading_changed",function(T){e._updateUI()});i.addEventListener("animation_start",function(T){e._isOperating=true});i.addEventListener("animation_end",function(T){e._isOperating=false});i.on("load",function(){e._checkEnable()});i.on("zoom_changed",function(){e._checkEnable()});if(i===this._map){this._mapBinded=true}else{this._earthBinded=true}},_updateUI:function(){var e=this._target.getHeading();var i=this._compass.style;i.WebkitTransform=i.transform="rotate("+e+"deg)"},hide:function(){this._div.style.display="none"},show:function(){this._div.style.display="block"}});function es(T,i){this._map=T;this._target=T;var hU=T.temp.originMapType||T.mapType;if(hU==="B_EARTH_MAP"&&T._earth){this._target=T._earth}this._outContainer=i||T.getContainer();this._imgRatio=a6()>=c8.HIGH_RES_MIN_RATIO?2:1;this._imgPath=e5.imgPath+"gl-navi-control-pc4"+(this._imgRatio===2?"-2x.png":".png");this._enabled=true;var e=this;this._setTiltOptions={callback:function(){e._target.setLock(false)}};this._init()}C.extend(es.prototype,{_init:function(){this._createDom();this._render();this._bindDom();this._bind();this._checkEnable()},_checkEnable:function(){if(this._target.getZoom()>=this._target._enableTiltZoom){this.enable()}else{this.disable()}},_createDom:function(){var e=this._div=S("button");e.title="倾斜";var i=e.style;i.position="absolute";i.zIndex=5;i.outline="none";i.border="none";i.cursor="pointer";i.width="26px";i.height="26px";i.top="56px";i.right="13px";i.background="url("+this._imgPath+") no-repeat #fff";i.backgroundSize="266px auto";i.backgroundPosition="-110px 1px";i.boxShadow="1px 2px 1px rgba(0, 0, 0, 0.15)"},enable:function(){this._enabled=true;if(this._div){this._div.style.cursor="pointer"}this._updateUI()},disable:function(){this._enabled=false;if(this._div){this._div.style.cursor=""}this._updateUI()},_render:function(){this._outContainer.appendChild(this._div)},_bindDom:function(){var e=this;this._div.addEventListener("mousedown",function(hU){if(!e._enabled){return}if(e._target.getLock()){return}var i=e._target.getTilt();var T;if(i===e._map.getCurrentMaxTilt()){T="out"}else{if(i===0){T="in"}else{T=e._preTrend?e._preTrend:"in"}}e._curTrend=T;e._clickTimer=setTimeout(function(){e._map.fire(new bb("ontiltmsdown"));e._tiltAni=new o({duration:9999999,render:function(hV){i=e._target.getTilt();if(T==="in"&&i<e._map.getCurrentMaxTilt()){e._target.setTilt(i+1,{noAnimation:true})}else{if(T==="out"&&i>0){e._target.setTilt(i-1,{noAnimation:true})}}},finish:function(){e._tiltAni=null}});e._clickTimer=null},200);hU.stopPropagation()},false);this._div.addEventListener("mouseup",function(i){if(!e._enabled){return}if(e._tiltAni){e._tiltAni.stop()}e._preTrend=e._curTrend},false);this._div.addEventListener("click",function(hU){if(!e._enabled){return}if(!e._clickTimer){return}if(e._target.getLock()){return}clearTimeout(e._clickTimer);e._map.fire(new bb("ontiltclick"));var i=e._target.getTilt();e._target.setLock(true);hU.stopPropagation();var T=e._map.getCurrentMaxTilt();if(e._curTrend==="in"){e._target.setTilt(T,e._setTiltOptions)}else{if(e._curTrend==="out"){e._target.setTilt(0,e._setTiltOptions)}else{if(i<T){e._target.setTilt(T,e._setTiltOptions)}else{e._target.setTilt(0,e._setTiltOptions)}}}},false);this._div.addEventListener("mouseover",function(i){if(!e._enabled){return}e._mouseOver=true;e._updateUI()},false);this._div.addEventListener("mouseout",function(i){if(!e._enabled){return}e._mouseOver=false;e._updateUI()},false);eL(this._div,["mousedown","click","dblclick"])},_bind:function(){var e=this;var i=this._map;this._bindTarget(this._target);if(this._map._renderType==="webgl"){this._map.addEventListener("maptypechange",function(T){if(this.mapType==="B_EARTH_MAP"){e._target=e._map._earth}else{e._target=e._map}e._bindTarget(e._target);e._checkEnable()})}},_bindTarget:function(i){if(i===this._map&&this._mapBinded){return}if(i===this._map._earth&&this._earthBinded){return}var e=this;i.on("load",function(){e._checkEnable()});i.on("zoom_changed",function(){e._checkEnable()});i.on("tilt_changed",function(){e._updateUI()});if(i===this._map){this._mapBinded=true}else{this._earthBinded=true}},_updateUI:function(){var T=this._target.getTilt();var i=0;var hU=0;var e=0;if(T>0){i=78}if(this._mouseOver){e=52}if(this._enabled===false){hU=26;e=0;i=0}var hV="-"+(110+i+hU+e)+"px 1px";this._div&&(this._div.style.backgroundPosition=hV);if(this._enabled){if(T>0){this._div&&(this._div.title="恢复")}else{this._div&&(this._div.title="倾斜")}}else{this._div&&(this._div.title="请放大地图后操作")}},hide:function(){this._div.style.display="none"},show:function(){this._div.style.display="block"}});function cf(i){ed.call(this);this._opts={container:null,cursor:"default"};this._opts=C.extend(this._opts,i);this._type="contextmenu";this._map=null;this._container;this._left=0;this._top=0;this._items=[];this._rItems=[];this._dividers=[];this._enable=true;this.curPixel=null;this.curPoint=null;this._isOpen=false;var e=this;ea.load("menu",function(){e._draw()})}cf.inherits(ed,"ContextMenu");C.extend(cf.prototype,{initialize:function(e){this._map=e},remove:function(){this._map=null},addItem:function(hV,e){if(!hV||hV._type!="menuitem"||hV._text==""||hV._width<=0){return}for(var hU=0,T=this._items.length;hU<T;hU++){if(this._items[hU]===hV){return}}if(e===undefined||e>this._items.length-1){e=-1}hV._insertIndex=e;if(e===-1){this._items.push(hV);this._rItems.push(hV)}else{this._items.splice(e,0,hV);this._rItems.splice(e,0,hV)}},removeItem:function(hU){if(!hU||hU._type!="menuitem"){return}for(var T=0,e=this._items.length;T<e;T++){if(this._items[T]===hU){this._items[T].remove();this._items.splice(T,1);delete hU._insertIndex;e--}}for(var T=0,e=this._rItems.length;T<e;T++){if(this._rItems[T]===hU){this._rItems[T].remove();this._rItems.splice(T,1);delete hU._insertIndex;e--}}},addSeparator:function(e){if(e===undefined||e>this._items.length-1){e=-1}var i={_type:"divider",_dIndex:this._dividers.length,_insertIndex:e};this._dividers.push({dom:null});if(e===-1){this._items.push(i)}else{this._items.splice(e,0,i)}},removeSeparator:function(T){if(!this._dividers[T]){return}for(var hU=0,e=this._items.length;hU<e;hU++){if(this._items[hU]&&this._items[hU]._type=="divider"&&this._items[hU]._dIndex==T){this._items.splice(hU,1);e--}if(this._items[hU]&&this._items[hU]._type=="divider"&&this._items[hU]._dIndex>T){this._items[hU]._dIndex--}}this._dividers.splice(T,1)},getDom:function(){return this._container},show:function(){if(this._isOpen==true){return}this._isOpen=true},hide:function(){if(this._isOpen==false){return}this._isOpen=false},setCursor:function(e){if(!e){return}this._opts.cursor=e},getItem:function(e){return this._rItems[e]},enable:function(){this._enable=true},disable:function(){this._enable=false}});function fB(T,hU,i){if(!T||!hU||typeof hU!="function"){return}ed.call(this);this._opts={width:100,id:""};i=i||{};this._opts.width=(i.width*1)?i.width:100;this._opts.id=i.id?i.id:"";this._text=T+"";this._callback=hU;this._map=null;this._type="menuitem";this._contextmenu=null;this._container=null;this._enabled=true;var e=this;ea.load("menu",function(){e._draw()})}fB.inherits(ed,"MenuItem");C.extend(fB.prototype,{initialize:function(e,i){this._map=e;this._contextmenu=i},remove:function(){this._contextmenu=null;this._map=null},setText:function(e){if(!e){return}this._text=e+""},getDom:function(){return this._container},enable:function(){this._enabled=true},disable:function(){this._enabled=false}});function dS(e,i){this.setSouthWest(e);this.setNorthEast(i)}C.extend(dS.prototype,{isEmpty:function(){return this.sw===null&&this.ne===null},equals:function(e){if(!e||e.isEmpty()||this.isEmpty()){return false}return this.sw.equals(e.sw)&&this.ne.equals(e.ne)},containsBounds:function(e){if(!e||e.isEmpty()||this.isEmpty()){return false}return(e.sw.lng>this.sw.lng&&e.ne.lng<this.ne.lng&&e.sw.lat>this.sw.lat&&e.ne.lat<this.ne.lat)},getCenter:function(){if(this.isEmpty()){return null}return new hv((this.sw.lng+this.ne.lng)/2,(this.sw.lat+this.ne.lat)/2)},intersects:function(T){if(!T||T.isEmpty()||this.isEmpty()){return null}if(Math.max(T.sw.lng,T.ne.lng)<Math.min(this.sw.lng,this.ne.lng)||Math.min(T.sw.lng,T.ne.lng)>Math.max(this.sw.lng,this.ne.lng)||Math.max(T.sw.lat,T.ne.lat)<Math.min(this.sw.lat,this.ne.lat)||Math.min(T.sw.lat,T.ne.lat)>Math.max(this.sw.lat,this.ne.lat)){return null}var hV=Math.max(this.sw.lng,T.sw.lng);var i=Math.min(this.ne.lng,T.ne.lng);var hU=Math.max(this.sw.lat,T.sw.lat);var e=Math.min(this.ne.lat,T.ne.lat);return new dS(new hv(hV,hU),new hv(i,e))},setMinMax:function(){this.minX=this.sw?this.sw.lng:null;this.minY=this.sw?this.sw.lat:null;this.maxX=this.ne?this.ne.lng:null;this.maxY=this.ne?this.ne.lat:null},containsPoint:function(e){if(!e){return}return(e.lng>=this.sw.lng&&e.lng<=this.ne.lng&&e.lat>=this.sw.lat&&e.lat<=this.ne.lat)},extend:function(e){if(!e){return}var i=e.lng;var T=e.lat;if(!this.sw){this.sw=e.clone()}if(!this.ne){this.ne=e.clone()}if(this.sw.lng>i){this.sw.lng=i}if(this.ne.lng<i){this.ne.lng=i}if(this.sw.lat>T){this.sw.lat=T}if(this.ne.lat<T){this.ne.lat=T}},getMin:function(){return this.sw},getMax:function(){return this.ne},getSouthWest:function(){return this.sw},getNorthEast:function(){return this.ne},setSouthWest:function(e){this.sw=e?e.clone():null},setNorthEast:function(e){this.ne=e?e.clone():null},clone:function(){return new dS(this.sw,this.ne)},toSpan:function(){if(this.isEmpty()){return new d9(0,0)}return new d9(Math.abs(this.ne.lng-this.sw.lng),Math.abs(this.ne.lat-this.sw.lat))},div:function(e){if(!e||e.isEmpty()||this.isEmpty()){return 0}return((this.ne.lng-this.sw.lng)*(this.ne.lat-this.sw.lat))/((e.ne.lng-e.sw.lng)*(e.ne.lat-e.sw.lat))},makeNormalizedPoint:function(e){this.normalizedTopLeft=this.pointTopLeft.clone();this.normalizedTopRight=this.pointTopRight.clone();this.normalizedBottomRight=this.pointBottomRight.clone();this.normalizedBottomLeft=this.pointBottomLeft.clone();while(e<0){e+=360}e=e%360;if(e>=0&&e<90||e>=270&&e<360){if(this.normalizedTopRight.lng<this.normalizedTopLeft.lng){this.normalizedTopRight.lng+=c8.WORLD_SIZE_MC}if(this.normalizedBottomRight.lng<this.normalizedBottomLeft.lng){this.normalizedBottomRight.lng+=c8.WORLD_SIZE_MC}}else{if(this.normalizedTopLeft.lng<this.normalizedTopRight.lng){this.normalizedTopLeft.lng+=c8.WORLD_SIZE_MC}if(this.normalizedBottomLeft.lng<this.normalizedBottomRight.lng){this.normalizedBottomLeft.lng+=c8.WORLD_SIZE_MC}}},toString:function(){return"Bounds"}});function hv(e,i){if(isNaN(e)){e=g4(e);e=isNaN(e)?0:e}if(typeof e==="string"){e=parseFloat(e)}if(isNaN(i)){i=g4(i);i=isNaN(i)?0:i}if(typeof i==="string"){i=parseFloat(i)}this.lng=e;this.lat=i}hv.prototype.equals=function(i){if(!i){return false}var hU=Math.abs(this.lat-i.lat);var T=Math.abs(this.lng-i.lng);var e=1e-8;if(hU<e&&T<e){return true}return false};hv.prototype.clone=function(){return new hv(this.lng,this.lat)};hv.prototype.add=function(e){return new hv(this.lng+e.lng,this.lat+e.lat)};hv.prototype.sub=function(e){return new hv(this.lng-e.lng,this.lat-e.lat)};hv.prototype.mult=function(e){return new hv(this.lng*e,this.lat*e)};hv.prototype.div=function(e){return new hv(this.lng/e,this.lat/e)};hv.prototype.mag=function(){return Math.sqrt(this.lng*this.lng+this.lat*this.lat)};hv.prototype.toString=function(){return"Point"};function en(){}C.extend(en,{EARTHRADIUS:6370996.81,MCBAND:[12890594.86,8362377.87,5591021,3481989.83,1678043.12,0],LLBAND:[86,60,45,30,15,0],MC2LL:[[1.410526172116255e-8,0.00000898305509648872,-1.9939833816331,200.9824383106796,-187.2403703815547,91.6087516669843,-23.38765649603339,2.57121317296198,-0.03801003308653,17337981.2],[-7.435856389565537e-9,0.000008983055097726239,-0.78625201886289,96.32687599759846,-1.85204757529826,-59.36935905485877,47.40033549296737,-16.50741931063887,2.28786674699375,10260144.86],[-3.030883460898826e-8,0.00000898305509983578,0.30071316287616,59.74293618442277,7.357984074871,-25.38371002664745,13.45380521110908,-3.29883767235584,0.32710905363475,6856817.37],[-1.981981304930552e-8,0.000008983055099779535,0.03278182852591,40.31678527705744,0.65659298677277,-4.44255534477492,0.85341911805263,0.12923347998204,-0.04625736007561,4482777.06],[3.09191371068437e-9,0.000008983055096812155,0.00006995724062,23.10934304144901,-0.00023663490511,-0.6321817810242,-0.00663494467273,0.03430082397953,-0.00466043876332,2555164.4],[2.890871144776878e-9,0.000008983055095805407,-3.068298e-8,7.47137025468032,-0.00000353937994,-0.02145144861037,-0.00001234426596,0.00010322952773,-0.00000323890364,826088.5]],LL2MC:[[-0.0015702102444,111320.7020616939,1704480524535203,-10338987376042340,26112667856603880,-35149669176653700,26595700718403920,-10725012454188240,1800819912950474,82.5],[0.0008277824516172526,111320.7020463578,647795574.6671607,-4082003173.641316,10774905663.51142,-15171875531.51559,12053065338.62167,-5124939663.577472,913311935.9512032,67.5],[0.00337398766765,111320.7020202162,4481351.045890365,-23393751.19931662,79682215.47186455,-115964993.2797253,97236711.15602145,-43661946.33752821,8477230.501135234,52.5],[0.00220636496208,111320.7020209128,51751.86112841131,3796837.749470245,992013.7397791013,-1221952.21711287,1340652.697009075,-620943.6990984312,144416.9293806241,37.5],[-0.0003441963504368392,111320.7020576856,278.2353980772752,2485758.690035394,6070.750963243378,54821.18345352118,9540.606633304236,-2710.55326746645,1405.483844121726,22.5],[-0.0003218135878613132,111320.7020701615,0.00369383431289,823725.6402795718,0.46104986909093,2351.343141331292,1.58060784298199,8.77738589078284,0.37238884252424,7.45]],getDistanceByMC:function(hW,hU){if(!hW||!hU){return 0}var i;var hV;var e;var T;hW=this.convertMC2LL(hW);if(!hW){return 0}i=dK(hW.lng);hV=dK(hW.lat);hU=this.convertMC2LL(hU);if(!hU){return 0}e=dK(hU.lng);T=dK(hU.lat);return this.getDistance(i,e,hV,T)},getDistanceByLL:function(hW,hU){if(!hW||!hU){return 0}hW.lng=this.getLoop(hW.lng,-180,180);hW.lat=this.getRange(hW.lat,-80,84);hU.lng=this.getLoop(hU.lng,-180,180);hU.lat=this.getRange(hU.lat,-80,84);var i;var e;var hV;var T;i=dK(hW.lng);hV=dK(hW.lat);e=dK(hU.lng);T=dK(hU.lat);return this.getDistance(i,e,hV,T)},proximityCovertMC2LL:function(e){if(e===null){return e}if(e.lng<180&&e.lng>-180&&e.lat<90&&e.lat>-90){return e}return this.convertMC2LL(e)},convertMC2LL:function(e){if(e===null){return e}if(!e){return new hv(0,0)}var T;var hV;T=new hv(Math.abs(e.lng),Math.abs(e.lat));for(var hU=0;hU<this.MCBAND.length;hU++){if(T.lat>=this.MCBAND[hU]){hV=this.MC2LL[hU];break}}var hW=this.convertor(e,hV);return new c4(hW.lat,hW.lng)},convertLL2MC:function(hX){if(!hX){return new hv(0,0)}var hZ=hX.lat;var hU=hX.lng;hU=this.getLoop(hX.lng,-180,180);hZ=fI(hZ,-85,85);var hW;for(var hV=0;hV<this.LLBAND.length;hV++){if(hZ>=this.LLBAND[hV]){hW=this.LL2MC[hV];break}}if(!hW){for(hV=0;hV<this.LLBAND.length;hV++){if(hZ<=-this.LLBAND[hV]){hW=this.LL2MC[hV];break}}}var T=new hv(hU,hZ);var hY=this.convertor(T,hW);var e=new hv(hY.lng,hY.lat);e.latLng=new c4(hX.lat,hX.lng);return e},convertor:function(T,hU){if(!T||!hU){return}var e=hU[0]+hU[1]*Math.abs(T.lng);var i=Math.abs(T.lat)/hU[9];var hV=hU[2]+hU[3]*i+hU[4]*i*i+hU[5]*i*i*i+hU[6]*i*i*i*i+hU[7]*i*i*i*i*i+hU[8]*i*i*i*i*i*i;e*=(T.lng<0?-1:1);hV*=(T.lat<0?-1:1);return new hv(e,hV)},getDistance:function(i,e,hU,T){return this.EARTHRADIUS*Math.acos((Math.sin(hU)*Math.sin(T)+Math.cos(hU)*Math.cos(T)*Math.cos(e-i)))},getRange:function(T,i,e){if(i!=null){T=Math.max(T,i)}if(e!=null){T=Math.min(T,e)}return T},getLoop:function(T,i,e){while(T>e){T-=e-i}while(T<i){T+=e-i}return T}});C.extend(en.prototype,{lnglatToMercator:function(e){return en.convertLL2MC(e)},lngLatToPoint:function(e){var i=en.convertLL2MC(e);return new ej(i.lng,i.lat)},mercatorToLnglat:function(e){return en.convertMC2LL(e)},pointToLngLat:function(i){var e=new hv(i.x,i.y);var T=en.convertMC2LL(e);return new c4(T.lat,T.lng)},pointToPixel:function(i,hW,hV,hU){if(!i){return}i=this.lnglatToMercator(i);var T=this.getZoomUnits(hW);var e=Math.round((i.lng-hV.lng)/T+hU.width/2);var hX=Math.round((hV.lat-i.lat)/T+hU.height/2);return new ej(e,hX)},mercatorToPixel:function(hW,hV,hU,T){if(!hW){return}var i=this.getZoomUnits(hV);var e=Math.round((hW.lng-hU.lng)/i+T.width/2);var hX=Math.round((hU.lat-hW.lat)/i+T.height/2);return new ej(e,hX)},pixelToPoint:function(hU,hX,hW,hV){if(!hU){return}var i=this.getZoomUnits(hX);var T=hW.lng+i*(hU.x-hV.width/2);var hY=hW.lat-i*(hU.y-hV.height/2);var e=new hv(T,hY);return this.mercatorToLnglat(e)},tileToBound:function(hU,hY){var i=hU.col;var h1=hU.row;var h0=hU.baseTileSize;var hZ=this.getZoomUnits(hU.zoom);var T={x:Math.round(hY.lng/hZ),y:Math.round(hY.lat/hZ)};var hW={lbx:i*h0,lby:h1*h0,rtx:(i+1)*h0,rty:(h1+1)*h0};var e={lbx:hY.lng+(hW.lbx-T.x)*hZ,lby:hY.lat+(hW.lby-T.y)*hZ,rtx:hY.lng+(hW.rtx-T.x)*hZ,rty:hY.lat+(hW.rty-T.y)*hZ};var hV=en.convertMC2LL(new hv(e.lbx,e.lby));var hX=en.convertMC2LL(new hv(e.rtx,e.rty));return{MC:new dS(new hv(e.lbx,e.lby),new hv(e.rtx,e.rty)),LL:new dS(hV,hX)}},getZoomUnits:function(e){return Math.pow(2,(18-e))},setCoordType:function(e){this.coordsType=e}});function eu(){}C.extend(eu,{RADIUS:6378137,EXTENT4326:[-180,-90,180,90],WORLD_EXTENT:[-180,-85,180,85],HALF_SIZE:20037508.342789244,METERS_PER_UNIT:111319.49079327358,EXTENT3857:[-20037508.342789244,-20037508.342789244,20037508.342789244,20037508.342789244],MAX_SAFE_Y:238107693.26496765,origin:[-20037508.342789244,20037508.342789244],size:156543.03392804097,gridSize:[256,256],resolutions:[],calcResolutions:function(i){this.resolutions=[];for(var e=0;e<i;++e){this.resolutions.push(this.size/Math.pow(2,e))}return this.resolutions},forEachTileCoord:function(hV,hX,hZ){var hY=this.getTileRangeForExtentAndZ(hV,hX);for(var T=hY.minX,hU=hY.maxX;T<=hU;++T){for(var e=hY.minY,hW=hY.maxY;e<=hW;++e){hZ([hX,T,e])}}},getTileRangeForExtentAndZ:function(T,hV,hU){var i=[0,0,0];this.getTileCoordForXYAndZ_(T[0],T[3],hV,false,i);var e=i[1];var hW=i[2];this.getTileCoordForXYAndZ_(T[2],T[1],hV,true,i);return this.createOrUpdateTileRange(e,i[1],hW,i[2],hU)},getTileCoordForXYAndZ_:function(h1,h0,hY,hZ,e){var h2=this.origin;var i=(this.resolutions.length===0?this.calcResolutions(18)[hY]:this.resolutions[hY]);var h4=this.gridSize;var hU=hZ?0.5:0;var T=hZ?0.5:0;var h3=Math.floor((h1-h2[0])/i+hU);var hW=Math.floor((h2[1]-h0)/i+T);var hX=h3/h4[0];var hV=hW/h4[1];if(hZ){hX=Math.ceil(hX)-1;hV=Math.ceil(hV)-1}else{hX=Math.floor(hX);hV=Math.floor(hV)}return this.createOrUpdateTileCoord(hY,hX,hV,e)},getTileCoordForCoordAndZ:function(T,i,e){return this.getTileCoordForXYAndZ_(T[0],T[1],i,false,e)},getTileRangeExtent:function(T,hX){var hY=this.origin;if(this.resolutions.length===0){this.calcResolutions(23)}var hV=this.resolutions[T[0]];var hZ=this.gridSize;var hW=hY[0]+T[1]*hZ[0]*hV;var hU=hY[1]-(T[2]+1)*hZ[1]*hV;var i=hW+hZ[0]*hV;var e=hU+hZ[1]*hV;return this.createOrUpdateTileRange(hW,i,hU,e,hX)},getTileCoordCenter:function(T){var e=this.origin;if(this.resolutions.length===0){this.calcResolutions(23)}var i=this.resolutions[T[0]];var hU=this.gridSize;return[e[0]+(T[1]+0.5)*hU[0]*i,e[1]-(T[2]+0.5)*hU[1]*i,]},createOrUpdateTileCoord:function(T,e,hU,i){if(i!==undefined){i[0]=T;i[1]=e;i[2]=hU;return i}else{return[T,e,hU]}},createOrUpdateTileRange:function(e,hU,hV,T,i){if(i!==undefined){i.minX=e;i.maxX=hU;i.minY=hV;i.maxY=T;return i}else{return{minX:e,maxX:hU,minY:hV,maxY:T}}},fromEPSG4326:function(T,hZ,hX){var hV=T.length;var hW=hX>1?hX:2;var e=hZ;if(e===undefined){if(hW>2){e=T.slice()}else{e=new Array(hV)}}for(var hU=0;hU<hV;hU+=hW){e[hU]=(this.HALF_SIZE*T[hU])/180;var hY=this.RADIUS*Math.log(Math.tan((Math.PI*(+T[hU+1]+90))/360));if(hY>this.MAX_SAFE_Y){hY=this.MAX_SAFE_Y}else{if(hY<-this.MAX_SAFE_Y){hY=-this.MAX_SAFE_Y}}e[hU+1]=hY}return e},toEPSG4326:function(T,hY,hX){var hV=T.length;var hW=hX>1?hX:2;var e=hY;if(e===undefined){if(hW>2){e=T.slice()}else{e=new Array(hV)}}for(var hU=0;hU<hV;hU+=hW){e[hU]=(180*T[hU])/this.HALF_SIZE;e[hU+1]=(360*Math.atan(Math.exp(T[hU+1]/this.RADIUS)))/Math.PI-90}return e},findParentGridAndPosition:function(hU,h4,h3,hY,hZ,h1,hX){if(h3-1<0){return false}var h5=hU;var h0=h4;var T=h3;for(var hW=1;hW<=hX;hW++){var e=this.findParent(h5,h0,T,hW);if(!e){return false}var h2=this.getTileKey(e);var hV=hY.getData(h2);if(hV&&hV.status==="ready"){if(hZ[h2]){continue}h1.setData(hV,this.drawIndex,0);hZ[h2]=true;return true}h5=e.col;h0=e.row;T=e.zoom}},findParent:function(i,hV,T,hU){if(T-1<0){return null}var e=i%2;var hW=hV%2;return{col:Math.floor(i/2),row:Math.floor(hV/2),sonX:e,sonY:hW,thumbLB:[e*0.5,1-hW*0.5-0.5],thumbRT:[e*0.5+0.5,1-hW*0.5],radio:Math.pow(2,hU),zoom:T-1,useZoom:T-1}},getTileKey:function(e,hU){hU=hU||{};var i=typeof hU.useZoom==="number"?hU.useZoom:e.useZoom;var T=e.style||this.mapStyleId||"default";return this.mapType+"_"+T+"_"+e.col+"_"+e.row+"_"+e.zoom+"_"+i},lon2tile:function(i,e){return(Math.floor((i+180)/360*Math.pow(2,e)))},lat2tile:function(T,i){var e=Math.tan(T*Math.PI/180)+1/Math.cos(T*Math.PI/180);return(Math.floor((1-Math.log(e)/Math.PI)/2*Math.pow(2,i)))},tile2long:function(e,i){return(e/Math.pow(2,i)*360-180)},tile2lat:function(T,e){var i=Math.PI-2*Math.PI*T/Math.pow(2,e);return(180/Math.PI*Math.atan(0.5*(Math.exp(i)-Math.exp(-i))))}});function c4(i,e){if(i<-90){i=-90}else{if(i>90){i=90}}while(e<-180){e+=360}while(e>180){e-=360}e=e||0;i=i||0;hv.call(this,e,i)}c4.inherits(hv,"LatLng");C.extend(c4.prototype,{equals:function(e){return(this.lat===e.lat&&this.lng===e.lng)},clone:function(){return new c4(this.lat,this.lng)},add:function(e){return new c4(this.lng+e.lng,this.lat+e.lat)},sub:function(e){return new c4(this.lat-e.lat,this.lng-e.lng)},mult:function(e){return new c4(this.lng*e,this.lat*e)},div:function(e){return new c4(this.lng/e,this.lat/e)},mag:function(){return Math.sqrt(this.lng*this.lng+this.lat*this.lat)},getLngSpan:function(e){var i=this.lng;var T=Math.abs(e-i);if(T>180){T=360-T}return T},toString:function(){return"LatLng"}});function eH(e,i){if(e&&!i){i=e}this._sw=this._ne=null;this._swLng=this._swLat=null;this._neLng=this._neLat=null;if(e){this._sw=new c4(e.lat,e.lng);this._ne=new c4(i.lat,i.lng);this._swLng=e.lng;this._swLat=e.lat;this._neLng=i.lng;this._neLat=i.lat}}C.extend(eH.prototype,{isEmpty:function(){return !this._sw||!this._ne},equals:function(e){if(this.isEmpty()){return false}return this.getSouthWest().equals(e.getSouthWest())&&this.getNorthEast().equals(e.getNorthEast())},getSouthWest:function(){return this._sw},getNorthEast:function(){return this._ne},containsBounds:function(e){if(this.isEmpty()||e.isEmpty()){return false}return(e._swLng>this._swLng&&e._neLng<this._neLng&&e._swLat>this._swLat&&e._neLat<this._neLat)},getCenter:function(){if(this.isEmpty()){return null}return new c4((this._swLat+this._neLat)/2,(this._swLng+this._neLng)/2)},intersects:function(T){if(Math.max(T._swLng,T._neLng)<Math.min(this._swLng,this._neLng)||Math.min(T._swLng,T._neLng)>Math.max(this._swLng,this._neLng)||Math.max(T._swLat,T._neLat)<Math.min(this._swLat,this._neLat)||Math.min(T._swLat,T._neLat)>Math.max(this._swLat,this._neLat)){return false}var hV=Math.max(this._swLng,T._swLng);var i=Math.min(this._neLng,T._neLng);var hU=Math.max(this._swLat,T._swLat);var e=Math.min(this._neLat,T._neLat);this._sw=new c4(hU,hV);this._ne=new c4(e,i);this._swLng=hV;this._swLat=hU;this._neLng=i;this._neLat=e;return true},containsPoint:function(e){if(this.isEmpty()){return false}return(e.lng>=this._swLng&&e.lng<=this._neLng&&e.lat>=this._swLat&&e.lat<=this._neLat)},extend:function(e){var i=e.lng;var T=e.lat;if(!this._sw){this._sw=new c4(0,0)}if(!this._ne){this._ne=new c4(0,0)}if(!this._swLng||this._swLng>i){this._sw.lng=this._swLng=i}if(!this._neLng||this._neLng<i){this._ne.lng=this._neLng=i}if(!this._swLat||this._swLat>T){this._sw.lat=this._swLat=T}if(!this._neLat||this._neLat<T){this._ne.lat=this._neLat=T}},toSpan:function(){if(this.isEmpty()){return new c4(0,0)}return new c4(Math.abs(this._neLat-this._swLat),Math.abs(this._neLng-this._swLng))},union:function(i){if(i.isEmpty()){return false}var e=i.getSouthWest();var T=i.getNorthEast();if(this._swLat>e.lat){this._swLat=e.lat}if(this._swLng>e.lng){this._swLng=e.lng}if(this._neLat<T.lat){this._neLat=T.lat}if(this._neLng<T.lng){this._neLng=T.lng}this._sw=new c4(this._swLat,this._swLng);this._ne=new c4(this._neLat,this._neLng);return true},toString:function(){return this._swLat+", "+this._swLng+", "+this._neLat+", "+this._neLng}});window.COORDINATES_WGS84=1;window.COORDINATES_WGS84_MC=2;window.COORDINATES_GCJ02=3;window.COORDINATES_GCJ02_MC=4;window.COORDINATES_BD09=5;window.COORDINATES_BD09_MC=6;window.COORDINATES_MAPBAR=7;window.COORDINATES_51=8;function ax(){}ax.inherits(ed,"Convertor");C.extend(ax.prototype,{translate:function(i,hV,hU,T){hV=hV||1;hU=hU||5;if(i.length>10){T&&T({status:25});return}var e=e5.apiHost+"/geoconv/v1/?coords=";C.each(i,function(hW){e+=hW.lng+","+hW.lat+";"});e=e.replace(/;$/gi,"");e=e+"&from="+hV+"&to="+hU+"&v=gl&type=webgl&ak="+gh;D.request(e,function(hX){if(hX.status===0){var hW=[];C.each(hX.result,function(hY){hW.push(new hv(hY.x,hY.y))});delete hX.result;hX.points=hW}T&&T(hX)})}});var dU={idle:0,freeze:1,zooming:2,dragging:3,moving:4,readyToDrag:5,readyToPinch:6,pinching:7,stdMapCtrlDrag:8,KEY_LEFT:37,KEY_UP:38,KEY_RIGHT:39,KEY_DOWN:40,arrowOpCodes:{37:1,38:2,39:4,40:8}};var eh={_map:null,_html:"<div class='BMap_opMask' unselectable='on'></div>",_maskElement:null,_cursor:"default",inUse:false,show:function(e){if(!this._map){this._map=e}this.inUse=true;if(!this._maskElement){this._createMask(e)}this._maskElement.style.display="block"},_createMask:function(i){if(!this._map){this._map=i}if(!this._map){return}var e=this._maskElement=dI(this._map.container,this._html);C.on(e,"mouseup",function(T){if(T.button==2){db(T)}});C.on(e,"contextmenu",db);e.style.display="none"},getDrawPoint:function(hU,hX,hV){hU=window.event||hU;var i=hU.offsetX||hU.layerX||0;var hW=parseInt(hU.offsetY)||parseInt(hU.layerY)||0;var T=hU.target||hU.srcElement;if(T!=eh.getDom(this._map)&&hX==true){while(T&&T!=this._map.container){if(!(T.clientWidth==0&&T.clientHeight==0&&T.offsetParent&&T.offsetParent.nodeName.toLowerCase()=="td")){i+=T.offsetLeft;hW+=T.offsetTop}T=T.offsetParent}}if(T!=eh.getDom(this._map)&&T!=this._map.container){return}if(typeof i==="undefined"||typeof hW==="undefined"){return}if(isNaN(i)||isNaN(hW)){return}if(hV){i=i+hV.x;hW=hW+hV.y}return this._map.pixelToPointIn(new ej(i,hW))},hide:function(){if(!this._map){return}this.inUse=false;if(this._maskElement){this._maskElement.style.display="none"}},getDom:function(e){if(!this._maskElement){this._createMask(e)}return this._maskElement},setCursor:function(e){this._cursor=e||"default";if(this._maskElement){this._maskElement.style.cursor=this._cursor}}};function bl(){this._type="overlay"}bl.inherits(C.BaseClass,"Overlay");bl.getZIndex=function(i,e){i=i*1;if(!i){return 0}if(e){i=en.convertMC2LL(new hv(0,i)).lat}return(i*-100000)<<1};C.extend(bl.prototype,{_i:function(e){this._map=e;if(!this.domElement&&bV(this.initialize)){this.domElement=this.initialize(e);if(this.domElement){this.domElement.style.WebkitUserSelect="none"}}this.draw()},initialize:function(e){throw"initialize方法未实现"},draw:function(){throw"draw方法未实现"},remove:function(){if(this.domElement&&this.domElement.parentNode){this.domElement.parentNode.removeChild(this.domElement)}this.domElement=null;this.dispatchEvent(new bb("onremove"))},hide:function(){this._visible=false;C.hide(this.domElement)},show:function(){this._visible=true;C.show(this.domElement)},getMap:function(){return this._map},dispose:function(){C.BaseClass.prototype.decontrol.call(this)}});function cV(){C.BaseClass.call(this);bl.call(this);this._visible=true;this._visibleInternal=true;this.infoWindow=null;this._dblclickTime=0}cV.inherits(bl,"OverlayInternal");C.extend(cV.prototype,{initialize:function(e){this.map=e;C.BaseClass.call(this,this.hashCode);return null},draw:function(){},remove:function(){this.decontrol();bl.prototype.remove.call(this)},hide:function(){this._visible=false},show:function(){this._visible=true},getDom:function(){return this.domElement},getContainer:function(){return this.domElement},setClassName:function(){},setConfig:function(i){if(!i){return}for(var e in i){if(i.hasOwnProperty(e)){this._config[e]=i[e]}}},getPoint:function(T,hU){if(!T){return this.point}else{var e=hU?hU.width:0;var hV=hU?hU.height:0;if(this.map){var i=this.map.pointToPixelIn(this.point);if(this._config&&this._config.offset){i.x=i.x+this._config.offset.width+e;i.y=i.y+this._config.offset.height+hV}else{i.x=i.x+e;i.y=i.y+hV}return this.map.pixelToPointIn(i)}}},setZIndex:function(e){this.zIndex=e},isVisible:function(){if(!this.domElement){return false}return !!this._visible},enableMassClear:function(){this._config.enableMassClear=true},disableMassClear:function(){this._config.enableMassClear=false},showInternal:function(){this._visibleInternal=true},hideInternal:function(e){this._visibleInternal=false;this._hideInternalReason=e}});function eY(e){this.map=e;this._overlays={};this._overlayArray=[];this._customOverlays=[];e._overlays=this._overlays;e._overlayArray=this._overlayArray;e._customOverlays=this._customOverlays;this._zoomingOrMoving=false;this._init()}eY.prototype._init=function(){if(this.map._renderType!=="webgl"){this._createOverlayContainers()}else{this._createWebGLOverlayContainers()}this._bind()};eY.prototype._createOverlayContainers=function(){var e=this.map;e.temp.overlayDiv=e.overlayDiv=this._createOverlayDiv(e.platform,200);e.temp.overlayDivEx=e.overlayDivEx=this._createOverlayDiv(e.platform,50);e._panes.floatPane=this._createOverlayDiv(e.temp.overlayDiv,800);e._panes.markerMouseTarget=this._createOverlayDiv(e.temp.overlayDiv,700);e._panes.floatShadow=this._createOverlayDiv(e.temp.overlayDiv,600);e._panes.labelPane=this._createOverlayDiv(e.temp.overlayDiv,500);e._panes.markerPane=this._createOverlayDiv(e.temp.overlayDiv,400);if(e.isCanvasMap()){e._panes.mapPane=this._createOverlayDiv(e.temp.overlayDivEx,50)}else{e._panes.mapPane=this._createOverlayDiv(e.temp.overlayDiv,200)}};eY.prototype._createWebGLOverlayContainers=function(){var e=this.map;e.temp.overlayDiv=e.overlayDiv=this._createOverlayDiv(e.platform,200);e._panes.floatPane=this._createOverlayDiv(e.temp.overlayDiv,800);e._panes.markerMouseTarget=this._createOverlayDiv(e.temp.overlayDiv,700);e._panes.floatShadow=this._createOverlayDiv(e.temp.overlayDiv,600);e._panes.labelPane=this._createOverlayDiv(e.temp.overlayDiv,500);e._panes.markerPane=this._createOverlayDiv(e.temp.overlayDiv,400)};eY.prototype._createOverlayDiv=function(e,hU){var T=S("div");var i=T.style;i.position="absolute";i.top=i.left=i.width=i.height="0";i.zIndex=hU;e.appendChild(T);return T};eY.prototype._bind=function(){var hV=this.map;var hU=this;function i(hX){hU.draw(hX)}if(hV._renderType!=="webgl"){hV.addEventListener("load",i);hV.addEventListener("moveend",i);hV.addEventListener("resize",i);hV.addEventListener("zoomend",i);hV.addEventListener("zooming_inner",i)}else{hV.on("update",i)}hV.addEventListener("zoomend",function(hX){if(this.mapType==="B_EARTH_MAP"){if(this._earth.getZoom()<this._earth.zoomForNight+1){this.temp.overlayDiv.style.display="none";if(this.temp.overlayDivEx){this.temp.overlayDivEx.style.display="none"}}else{if(this.temp.overlayDiv.style.display==="none"){this.temp.overlayDiv.style.display="";if(this.temp.overlayDivEx){this.temp.overlayDivEx.style.display=""}if(this.temp.infoWin&&this.temp.infoWin.isOpen()){this.temp.infoWin.redraw()}}}}});hV.addEventListener("oncenterandzoom",function(hX){hU.draw(hX);if(this.mapType==="B_EARTH_MAP"){if(this._earth.getZoom()<this._earth.zoomForNight+1){this.temp.overlayDiv.style.display="none";if(this.temp.overlayDivEx){this.temp.overlayDivEx.style.display="none"}}else{if(this.temp.overlayDiv.style.display==="none"){this.temp.overlayDiv.style.display="";if(this.temp.overlayDivEx){this.temp.overlayDivEx.style.display=""}if(this.temp.infoWin&&this.temp.infoWin.isOpen()){this.temp.infoWin.redraw()}}}}});hV.addEventListener("maptypechange",function(hX){if(this.mapType==="B_EARTH_MAP"){if(this._panes.mapPane){this._panes.mapPane.style.display="none"}if(this._earth.getZoom()<this._earth.zoomForNight+1){this.temp.overlayDiv.style.display="none";if(this.temp.overlayDivEx){this.temp.overlayDivEx.style.display="none"}}else{if(this.temp.overlayDiv.style.display==="none"){this.temp.overlayDiv.style.display="";if(this.temp.overlayDivEx){this.temp.overlayDivEx.style.display=""}if(this.temp.infoWin&&this.temp.infoWin.isOpen()){this.temp.infoWin.redraw()}}}if(this._panes.markerPane){this._panes.markerPane.style.display="none"}}else{if(this._panes.mapPane){this._panes.mapPane.style.display=""}if(this._panes.markerPane){this._panes.markerPane.style.display=""}if(this.temp.overlayDiv.style.display==="none"){this.temp.overlayDiv.style.display="";if(this.temp.overlayDivEx){this.temp.overlayDivEx.style.display=""}if(this.temp.infoWin&&this.temp.infoWin.isOpen()){this.temp.infoWin.redraw()}}}hU.draw(hX)});hV.on("earthstatuschange",function hW(hX){hU.draw(hX)});hV.addEventListener("addoverlay",function(h1){var hY=h1.target;if(hY instanceof cV){if(!hU._overlays[hY.hashCode]){hU._overlays[hY.hashCode]=hY;hU._overlayArray.push(hY)}}else{var h0=false;for(var hZ=0,hX=hU._customOverlays.length;hZ<hX;hZ++){if(hU._customOverlays[hZ]===hY){h0=true;break}}if(!h0){hU._customOverlays.push(hY)}}});hV.addEventListener("removeoverlay",function(h0){var hY=h0.target;if(hY instanceof cV){delete hU._overlays[hY.hashCode];for(var hZ=0;hZ<hU._overlayArray.length;hZ++){if(hU._overlayArray[hZ]===hY){hU._overlayArray.splice(hZ,1);break}}}else{for(var hZ=0,hX=hU._customOverlays.length;hZ<hX;hZ++){if(hU._customOverlays[hZ]===hY){hU._customOverlays.splice(hZ,1);break}}}});hV.addEventListener("clearoverlays",function(hZ){this.closeInfoWindow();this.closeSimpleInfoWindow();for(var hY in hU._overlays){if(hU._overlays[hY]._config.enableMassClear){this.removeOverlay(hU._overlays[hY])}}for(var hX=hU._customOverlays.length-1;hX>0;hX--){if(hU._customOverlays[hX].enableMassClear!==false){this.removeOverlay(hU._customOverlays[hX]);hU._customOverlays.splice(hX,1)}}});hV.addEventListener("infowindowopen",function(hY){var hX=this.infoWindow;if(hX){C.hide(hX.popDom);C.hide(hX.shadowDom)}});function T(){if(this.getMapType()==="B_EARTH_MAP"||this._renderType==="webgl"){if(hU._zoomingOrMoving===false){this._panes.markerMouseTarget.style.display="none";hU._zoomingOrMoving=true}}}function e(hZ){if(this.getMapType()==="B_EARTH_MAP"||this._renderType==="webgl"){if(hU._zoomingOrMoving===true){this._panes.markerMouseTarget.style.display="";hU._zoomingOrMoving=false;for(var hY=0;hY<hU._overlayArray.length;hY++){var hX=hU._overlayArray[hY];if(hX instanceof dr===true){hX.draw(hZ)}}}}}hV.addEventListener("movestart",T);hV.addEventListener("moveend",e);hV.addEventListener("zoomstart",T);hV.addEventListener("zoomend",e);hV.addEventListener("animation_start",T);hV.addEventListener("animation_end",e);hV.addEventListener("displayoptions_changed",function(hX){if(this._displayOptions.overlay===false){this.temp.overlayDiv.style.display="none"}else{this.temp.overlayDiv.style.display=""}})};eY.prototype.draw=function(hX){hX=hX||{};if(this.map.getMapType()==="B_EARTH_MAP"){for(var hV=0;hV<this._overlayArray.length;hV++){var T=this._overlayArray[hV];if(T instanceof w===true){continue}if(this._zoomingOrMoving){if(T instanceof dr===true){continue}}T.draw(hX)}}else{for(var hV=0,hU=this._overlayArray.length;hV<hU;hV++){var T=this._overlayArray[hV];if(this._zoomingOrMoving&&T instanceof dr===true){continue}T.draw(hX)}}C.each(this._customOverlays,function(e){e.draw(hX)});if(this.map.temp.infoWin){this.map.temp.infoWin.setPosition(hX.center,hX.zoom)}if(this.map.getMapType()!=="B_EARTH_MAP"&&this.map._renderType!=="webgl"){if(bo.DrawerSelector){var hW=bo.DrawerSelector.getDrawer(this.map);hW.setPalette()}}};bo.register(function(e){e._overlayMgr=new eY(e)});function w(e){cV.call(this);this._config={strokeColor:"#000",strokeWeight:2,strokeOpacity:1,strokeStyle:"solid",dashArray:null,strokeLineCap:"round",strokeLineJoin:"round",enableMassClear:true,getParseTolerance:null,getParseCacheIndex:null,enableParse:true,enableEditing:false,mouseOverTolerance:5,geodesic:false,clip:true,texture:null,textureSize:null,textureZoomWithMap:false,textureRepeat:true};this.setConfig(e);if(this._config.strokeOpacity<0||this._config.strokeOpacity>1){this._config.strokeOpacity=1}if(this._config.fillOpacity<0||this._config.fillOpacity>1){this._config.fillOpacity=1}if(this._config.strokeStyle!=="solid"&&this._config.strokeStyle!=="dashed"&&this._config.strokeStyle!=="dotted"){this._config.strokeStyle="solid"}this.domElement=null;this._bounds=new dS();this.points=[];this.greatCirclePoints=[];this._parseCache=[];this._holesCache=[];this._parseCacheGL=[];this._parseCacheGLRaw=[];this._areaCacheGL=[];this._strokeStyleInfoForGL=[[]];this._fillStyleInfoForGL="";this.vertexMarkers=[];this._temp={}}w.JOININDEX={miter:0,round:1,bevel:2};w.CAPINDEX={round:0,butt:1,square:2};w.inherits(cV,"Graph");w.getGraphPoints=function(i){var e=[];if(!i||i.length===0){return e}if(typeof i==="string"){var T=i.split(";");C.each(T,function(hV){var hU=hV.split(",");e.push(new hv(hU[0],hU[1]))})}if(i.constructor===Array&&i.length>0){e=i}return e};w.parseTolerance={0:[0.09,0.005,0.0001,0.00001],1:[9000,500,20,1]};C.extend(w.prototype,{initialize:function(e){this.map=e;return null},draw:function(){},setPoints:function(e){this._clearCache();this.points=w.getGraphPoints(e).slice(0);this._calcBounds()},setPathIn:function(e){this.setPoints(e)},_calcBounds:function(){if(!this.points){return}var e=this;e._bounds=new dS();if(!this.hasMultipleParts){C.each(this.points,function(i){e._bounds.extend(i)})}else{C.each(this.points,function(i){C.each(i,function(T){e._bounds.extend(T)})})}},getPoints:function(){return this.points},getPathIn:function(){return this.points},setPointAt:function(i,e){if(!e||!this.points[i]){return}this._clearCache();this.points[i]=new hv(e.lng,e.lat);this._calcBounds()},setPositionAt:function(i,e){if(!e||!this.points[i]){return}var T=en.convertLL2MC(e);this.setPointAt(i,T)},setOptions:function(i){i=i||{};for(var e in i){if(i.hasOwnProperty(e)){this._config[e]=i[e]}}},setStrokeColor:function(e){this._config.strokeColor=e},getStrokeColor:function(){return this._config.strokeColor},setStrokeLineCap:function(e){this._config.strokeLineCap=e},getStrokeLineCap:function(){return this._config.strokeLineCap},setStrokeLineJoin:function(e){this._config.strokeLineJoin=e},getStrokeLineJoin:function(){return this._config.strokeLineJoin},setStrokeWeight:function(e){if(e>0){this._config.strokeWeight=e}},getStrokeWeight:function(){return this._config.strokeWeight},setStrokeOpacity:function(e){if(!e||e>1||e<0){return}this._config.strokeOpacity=e},getStrokeOpacity:function(){return this._config.strokeOpacity},setFillOpacity:function(e){if(e>1||e<0){return}this._config.fillOpacity=e},getFillOpacity:function(){return this._config.fillOpacity},setStrokeStyle:function(e){if(e!=="solid"&&e!=="dashed"&&e!=="dotted"){return}this._config.strokeStyle=e},getStrokeStyle:function(){return this._config.strokeStyle},setFillColor:function(e){this._config.fillColor=e||""},getFillColor:function(){return this._config.fillColor},getBoundsIn:function(){this._bounds.setMinMax();return this._bounds},getBounds:function(){var e=this.getBoundsIn();var i=new dS(en.convertMC2LL(e.getSouthWest()),en.convertMC2LL(e.getNorthEast()));i.setMinMax();return i},remove:function(){if(this.map){this.map.removeEventListener("onmousemove",this._graphMouseEvent);this.map.removeEventListener("onclick",this._graphClickEvent)}cV.prototype.remove.call(this);this._clearCache();var e=new bb("onlineupdate");e.action="remove";e.overlay=this;this.fire(e)},enableEditing:function(){if(this.points.length<2){return}this._config.enableEditing=true;var e=this;ea.load("poly",function(){e.addVertexs()},true)},disableEditing:function(){this._config.enableEditing=false;var e=this;ea.load("poly",function(){e.clearVertexs()},true)},getLength:function(){if(typeof this._length==="number"){return this._length}if(typeof this._config.totalLength==="number"){this._length=this._config.totalLength;return this._length}var T=0;if(this.points.length<=1){this._length=0;return T}for(var e=0;e<this.points.length-1;e++){T+=bP(this.points[e],this.points[e+1])}this._length=T;return T},getParsedPoints:function(){var e=this._simplification(this.points);if(this.hasMultipleParts){return e}return[e]},_simplification:function(hY){var e=this.map;var hX=this.getParseCacheIndex(e.getZoom());var h0;if(this._parseCache[hX]){h0=this._parseCache[hX]}else{var hV=hY;if(this.greatCirclePoints.length>0){hV=this.greatCirclePoints}var hW=this.getParseTolerance(e.getZoom(),e.config.coordType);if(!this.hasMultipleParts){var hZ=hI(hV,hW)}else{var hZ=[];for(var T=0;T<hV.length;T++){var hU=hI(hV[T],hW);hZ.push(hU)}}h0=this._parseCache[hX]=hZ}return h0},_clearCache:function(){this._length=null;this._parseCache.length=0;this._parseCacheGL.length=0;this._parseCacheGLRaw.length=0;this._areaCacheGL.length=0},canRenderDataBeMerged:function(){var e=this._config;if(e.texture){return false}return true}});if(C.Browser.ie&&document.namespaces&&!document.namespaces.olv){document.namespaces.add("olv","urn:schemas-microsoft-com:vml")}function he(hW,hU,T){if(!hW||!hU){return}this.imageUrl=null;this.imageDom=null;if(typeof hW==="string"){this.imageUrl=hW}else{this.imageDom=hW;if(!this.imageDom.id){this.imageDom.id=bo.getGUID("icon_dom_")}}this.size=hU;var hV=new d9(Math.floor(hU.width/2),Math.floor(hU.height/2));var i={offset:hV,imageOffset:new d9(0,0)};T=T||{};for(var e in T){i[e]=T[e]}if(T.anchor){i.offset=T.anchor}this.anchor=this.offset=i.offset;this.imageOffset=i.imageOffset;this.infoWindowOffset=T.infoWindowOffset||this.offset;this.printImageUrl=T.printImageUrl||"";this.imageSize=T.imageSize||this.size;this.srcSetObject={};this.setImageSrcset(T.srcset||T.srcSet)}he.prototype.setImageUrl=function(e){if(!e){return}this.imageUrl=e;this._renderData=null};he.prototype.getCurrentImageUrl=function(){if(window.devicePixelRatio>1&&this.srcSetObject["2x"]){return this.srcSetObject["2x"]}return this.imageUrl};he.prototype.setPrintImageUrl=function(e){if(!e){return}this.printImageUrl=e};he.prototype.setSize=function(e){if(!e){return}this.size=new d9(e.width,e.height);this._renderData=null};he.prototype.setOffset=function(e){if(!e){return}this.anchor=this.offset=new d9(e.width,e.height);this._renderData=null};he.prototype.setAnchor=function(e){this.setOffset(e)};he.prototype.setImageOffset=function(e){if(!e){return}this.imageOffset=new d9(e.width,e.height);this._renderData=null};he.prototype.setInfoWindowOffset=function(e){if(!e){return}this.infoWindowOffset=new d9(e.width,e.height)};he.prototype.setImageSize=function(e){if(!e){return}this.imageSize=new d9(e.width,e.height)};he.prototype.setImageSrcset=function(T){var e="";if(!T){return}for(var i in T){if(T.hasOwnProperty(i)){this.srcSetObject[i]=T[i];e=T[i]+" "+i+","}}this.srcSet=e};he.prototype.toString=function(){return"Icon"};he.prototype.generateRenderData=function(hW){var T=this.offset;var e=this.size;var hY=this.imageOffset;var hX=[];hX.push(-T.width,T.height-e.height,0);hX.push(e.width-T.width,T.height-e.height,0);hX.push(e.width-T.width,T.height,0);hX.push(-T.width,T.height-e.height,0);hX.push(e.width-T.width,T.height,0);hX.push(-T.width,T.height,0);if(hW!==0){for(var hV=0;hV<hX.length;hV+=3){var hU=vec2.fromValues(hX[hV],hX[hV+1]);vec2.rotate(hU,hU,[0,0],dK(-hW));hX[hV]=hU[0];hX[hV+1]=hU[1]}}return{vertex:hX}};he.prototype.getRenderData=function(e){this._renderData=this.generateRenderData(e);return this._renderData};function an(T,i){C.BaseClass.call(this);this.content=T;this.map=null;this._config={width:0,height:0,maxWidth:600,offset:new d9(0,0),title:"",maxContent:"",enableMaximize:false,enableAutoPan:true,enableCloseOnClick:true,margin:[10,10,40,10],collisions:[[10,10],[10,10],[10,10],[10,10]],ifMaxScene:false,onClosing:function(){return true}};this.setConfig(i);if(this._config.width!==0){if(this._config.width<220){this._config.width=220}if(this._config.width>730){this._config.width=730}}if(this._config.height!==0){if(this._config.height<60){this._config.height=60}if(this._config.height>650){this._config.height=650}}if(this._config.maxWidth!==0){if(this._config.maxWidth<220){this._config.maxWidth=220}if(this._config.maxWidth>730){this._config.maxWidth=730}}this.isWinMax=false;this.IMG_PATH=e5.imgPath;this.overlay=null;var e=this;ea.load("infowindow",function(){e._draw()})}an.inherits(C.BaseClass,"InfoWindow");C.extend(an.prototype,{setWidth:function(e){e=e*1;if(!e&&e!==0||isNaN(e)||e<0){return}if(e!==0){if(e<220){e=220}if(e>730){e=730}}this._config.width=e},setHeight:function(e){e=e*1;if(!e&&e!==0||isNaN(e)||e<0){return}if(e!==0){if(e<60){e=60}if(e>650){e=650}}this._config.height=e},setMaxWidth:function(e){e=e*1;if(!e&&e!==0||isNaN(e)||e<0){return}if(e!==0){if(e<220){e=220}if(e>730){e=730}}this._config.maxWidth=e},setTitle:function(e){this._config.title=e||""},setContent:function(e){this.content=e||""},getContent:function(){return this.content},setMaxContent:function(e){this._config.maxContent=e||""},redraw:function(){},enableAutoPan:function(){this._config.enableAutoPan=true},disableAutoPan:function(){this._config.enableAutoPan=false},enableCloseOnClick:function(){this._config.enableCloseOnClick=true},disableCloseOnClick:function(){this._config.enableCloseOnClick=false},enableMaximize:function(){this._config.enableMaximize=true},disableMaximize:function(){this._config.enableMaximize=false},show:function(){this._visible=true},hide:function(){this._visible=false},close:function(){this.hide()},dispose:function(){C.BaseClass.prototype.decontrol.call(this)},maximize:function(){this.isWinMax=true},restore:function(){this.isWinMax=false},setConfig:function(i){if(!i){return}for(var e in i){if(typeof(this._config[e])===typeof(i[e])){this._config[e]=i[e]}}},isVisible:function(){return this.isOpen()},isOpen:function(){return false},getPointIn:function(){if(this.overlay&&this.overlay.getPoint){return this.overlay.getPoint()}},getTitle:function(){return this._config.title||""},getPosition:function(){return this.latLng;var e=this.getPointIn();return en.convertMC2LL(e)},getPoint:function(){var e=this.getPointIn();return en.convertMC2LL(e)},getOffset:function(){return this._config.offset},dispose:function(){C.BaseClass.prototype.decontrol.call(this)},toString:function(){return"InfoWindow"}});c8.prototype.openInfoWindow=function(T,e){T.latLng=new c4(e.lat,e.lng);var i=en.convertLL2MC(e);this.openInfoWindowIn(T,i)};c8.prototype.closeInfoWindow=function(){var e=this.temp.infoWin||this.temp._infoWin;if(e&&e.overlay){e.overlay.closeInfoWindow()}};c8.prototype.openInfoWindowIn=function(hU,e){if(!hU||hU.toString()!=="InfoWindow"||!e||e.toString()!=="Point"){return}var i=this.temp;if(!i.marker){var T=new he(e5.imgPath+"blank.gif",{width:1,height:1});i.marker=new dr(e,{icon:T,width:1,height:1,offset:new d9(0,0),infoWindowOffset:new d9(0,0),clickable:false});i.marker._fromMap=1}else{i.marker.setPoint(e)}this.addOverlay(i.marker);i.marker.show();i.marker.openInfoWindow(hU)};cV.prototype.openInfoWindow=function(e){if(this.map){this.map.closeInfoWindow();e._visible=true;this.map.temp._infoWin=e;e.overlay=this;C.BaseClass.call(e,e.hashCode)}};cV.prototype.closeInfoWindow=function(){if(this.map&&this.map.temp._infoWin){this.map.temp._infoWin._visible=false;this.map.temp._infoWin.decontrol();this.map.temp._infoWin=null}};function aM(T,i){cV.call(this);this.content=T;this.map=null;this.domElement=null;this._config={width:0,offset:new d9(0,0),styles:{backgroundColor:"#fff",border:"1px solid #f00",padding:"1px",whiteSpace:"nowrap",fontSize:"12px",zIndex:"80",MozUserSelect:"none"},point:null,enableMassClear:true};i=i||{};this.setConfig(i);if(this._config.width<0){this._config.width=0}this.point=this._config.point;var e=this;ea.load("marker",function(){e._draw()})}aM.inherits(cV,"Label");C.extend(aM.prototype,{setPoint:function(e){if(e&&e.toString()==="Point"&&!this.getMarker()){this.point=this._config.point=new hv(e.lng,e.lat)}},setContent:function(e){this.content=e},getContent:function(e){return this.content},setOpacity:function(e){if(e>=0&&e<=1){this._config.opacity=e}},setOffset:function(e){if(!e||e.toString()!=="Size"){return}this._config.offset=new d9(e.width,e.height)},getOffset:function(){return this._config.offset},setStyle:function(e){e=e||{};this._config.styles=C.extend(this._config.styles,e)},setStyles:function(e){this.setStyle(e)},setTitle:function(e){this._config.title=e||""},getTitle:function(){return this._config.title},setMarker:function(e){if(this._marker&&this._marker!==e){this._marker._config.label=null}this._marker=e;if(e){this.point=this._config.point=e.getPoint()}else{this.point=this._config.point=null}},getMarker:function(){return this._marker||null},getPositionIn:function(){return this.getPoint()},});function fS(T,i){var hU={};for(var e in i){if(i.hasOwnProperty(e)){if(e==="position"){hU.point=en.convertLL2MC(i[e]);this.latLng=new c4(i[e]["lat"],i[e]["lng"])}else{hU[e]=i[e]}}}aM.call(this,T,hU)}fS.inherits(aM,"LabelOut");C.extend(fS.prototype,{toString:function(){return"Label"},setPosition:function(e){this.latLng=new c4(e.lat,e.lng);var i=en.convertLL2MC(e);this.setPoint(i)},getPosition:function(){return this.latLng;var e=this.getPositionIn();return en.convertMC2LL(e)}});window.BMAP_ANIMATION_DROP=1;window.BMAP_ANIMATION_BOUNCE=2;function dr(e,i){cV.call(this);i=i||{};this.point=e;this._rotation=0;this.map=null;this._animation=null;this.domElement=null;this.iconDom=null;this.infoWindowDom=null;this.siblingElement=null;this.textureCoord=null;this.textureCoordGLMap=null;this.collisionDetectionFailed=false;this._config={offset:new d9(0,0),opacity:1,icon:null,title:"",infoWindow:null,label:null,baseZIndex:0,clickable:true,zIndexFixed:false,isTop:false,enableMassClear:true,enableDragging:false,raiseOnDrag:false,restrictDraggingArea:false,startAnimation:"",enableCollisionDetection:false,rank:0,enableDraggingMap:false};this.setConfig(i);if(!i.icon){this._config.icon=new he(e5.imgPath+"marker_red.png",new d9(23,25),{offset:new d9(10,25),infoWindowOffset:new d9(10,0)})}this._isDragging=false;var T=this;ea.load("marker",function(){T._draw()})}dr.TOP_ZINDEX=bl.getZIndex(-90)+1000000;dr.DRAG_ZINDEX=dr.TOP_ZINDEX+1000000;dr._injectMethond=function(e){C.extend(dr.prototype,e)};dr.inherits(cV,"Marker");C.extend(dr.prototype,{toString:function(){return"Marker"},setIcon:function(e){if(e){this._config.icon=e;this.textureCoord=this.textureCoordGLMap=null}},getIcon:function(){return this._config.icon},setLabel:function(e){if(!(e instanceof aM)){return}this._config.label=e;e._config.enableMassClear=this._config.enableMassClear;e.setPoint(this.point)},getLabel:function(){return this._config.label},enableDragging:function(){this._config.enableDragging=true},disableDragging:function(){this._config.enableDragging=false},setPoint:function(e){if(e){this.point=this._config.point=new hv(e.lng,e.lat);this.latLng=en.convertMC2LL(e)}},setPositionIn:function(e){this.setPoint(e)},getPositionIn:function(){return this.getPoint()},setTop:function(i,e){this._config.isTop=!!i;if(i){this._addi=e||0}},setTitle:function(e){this._config.title=e||""},getTitle:function(){return this._config.title},setOffset:function(e){if(e){this._config.offset=e}},getOffset:function(){return this._config.offset},setAnimation:function(e){this._animation=e},setRank:function(e){this._config.rank=e},getRank:function(){return this._config.rank},setRotation:function(e){while(e<0){e+=360}this._rotation=e%360},getRotation:function(){return this._rotation}});function aC(e,T){this.latLng=new c4(e.lat,e.lng);var i=en.convertLL2MC(e);dr.call(this,i,T)}aC.inherits(dr,"MarkerOut");C.extend(aC.prototype,{toString:function(){return"Marker"},setPosition:function(e){this.latLng=new c4(e.lat,e.lng);var i=en.convertLL2MC(e);this.setPositionIn(i)},getPosition:function(){return this.latLng;var e=this.getPositionIn();return en.convertMC2LL(e)},});window.BMAP_SHAPE_CIRCLE=1;window.BMAP_SHAPE_RECT=2;function bd(i,e,T){cV.call(this,e,T);this.domElement=null;this.point=i;T=T||{};this._config={};this._config.height=e||0;this._config.size=typeof T.size==="number"?T.size:50;this._config.fillOpacity=typeof T.fillOpacity==="number"?T.fillOpacity:0.8;this._config.shape=typeof T.shape==="number"?T.shape:1;fI(this._config.fillOpacity,0,1);if(T.fillColor===""){this._config.fillColor=""}else{this._config.fillColor=T.fillColor?T.fillColor:"#f00"}this._config.icon=T.icon instanceof he?T.icon:"";this._config.enableMassClear=T.enableMassClear||true;var hU=this;ea.load("marker",function(){hU._draw()})}bd.inherits(cV,"Marker3D");C.extend(bd.prototype,{setPoint:function(e){this.point=this._config.point=new hv(e.lng,e.lat);this.latLng=en.convertMC2LL(e);var i=new bb("onstatus_change");i.overlay=this;i.action="setPoint";this.fire(i)},setPositionIn:function(e){this.setPoint(e)},getPositionIn:function(){return this.getPoint()},setDomAttribute:function(i,T){var e=new bb("onlineupdate");e.overlay=this;this.dispatchEvent(e)}});function cv(i,e,hU){this.latLng=new c4(i.lat,i.lng);var T=en.convertLL2MC(i);bd.call(this,T,e,hU)}cv.inherits(bd,"Marker3d");C.extend(cv.prototype,{toString:function(){return"Marker3D"},setHeight:function(e){this._config.height=Number(e);this.draw();var i=new bb("onlineupdate");i.overlay=this;this.dispatchEvent(i)},getHeight:function(){return this._config.height},setFillOpacity:function(e){if(e>1||e<0){return}this._config.fillOpacity=e;this.setDomAttribute("fillopacity",e)},getFillOpacity:function(){return this._config.fillOpacity},setFillColor:function(e){this._config.fillColor=e||"";this.setDomAttribute("fillcolor",e)},getFillColor:function(){return this._config.fillColor},setIcon:function(i){if(!i||!this.map){return}this._config.icon=i;if(this._config.icon){var e=this._config.icon.getCurrentImageUrl();var hU=i.getCurrentImageUrl()!==e;this._config.icon=i;this.textureCoord=this.textureCoordGLMap=null;this.draw();var T=new bb("onstatus_change");T.overlay=this;T.action="setIcon";T.imageUrlChanged=hU;this.fire(T)}},getIcon:function(){return this._config.icon},setPosition:function(e){this.latLng=new c4(e.lat,e.lng);var i=en.convertLL2MC(e);this.setPositionIn(i)},getPosition:function(){var e=this.getPositionIn();return en.convertMC2LL(e)}});function a(T,e){w.call(this,e);this._normalizedBounds=new dS();this.setPoints(T);var i=this;ea.load("poly",function(){i._draw()})}a.inherits(w,"Polyline");C.extend(a.prototype,{getBoundsIn:function(e){if(!e){this._bounds.setMinMax();return this._bounds}this._normalizedBounds.setMinMax();return this._normalizedBounds},setPoints:function(T){this._clearCache();this.points=w.getGraphPoints(T).slice(0);if(this._config.geodesic===true){this.greatCirclePoints.length=0;for(var e=0;e<this.points.length-1;e++){this.calcGreatCirclePoints(this.points[e],this.points[e+1])}}this._calcBounds()},_calcBounds:function(){if(!this.points){return}var e=this;e._bounds.setNorthEast(null);e._bounds.setSouthWest(null);if(e.greatCirclePoints&&e.greatCirclePoints.length>0){C.each(e.greatCirclePoints,function(i){e._bounds.extend(i)})}else{C.each(e.points,function(i){e._bounds.extend(i)})}e._normalizedBounds.setSouthWest(e._bounds.getSouthWest());e._normalizedBounds.setNorthEast(e._bounds.getNorthEast());if(e._normalizedBounds.sw.lng<-c8.WORLD_SIZE_MC_HALF||e._normalizedBounds.ne.lng>c8.WORLD_SIZE_MC_HALF){e._normalizedBounds.sw.lng=-c8.WORLD_SIZE_MC_HALF;e._normalizedBounds.ne.lng=c8.WORLD_SIZE_MC_HALF}},calcGreatCirclePoints:function(hU,T){var hW=hU.latLng;var hV=T.latLng;if(hW.equals(hV)){return}var e=en.getDistance(dK(hW.lng),dK(hW.lat),dK(hV.lng),dK(hV.lat));if(e<250000){return}var h0=Math.round(e/150000);var h4=this.calcAngularDistance(hW,hV);this.greatCirclePoints.push(hU);var h3=hW.lng;var h2=hU;for(var hX=0;hX<h0;hX++){var hZ=this.calcMiddlePoint(hW,hV,hX/h0,h4);var h1=en.convertLL2MC(hZ);var hY=h1.lng;var h5=bP(h1,h2);if(h5>30037726){if(h1.lng<h2.lng){h1.lng+=c8.WORLD_SIZE_MC}else{h1.lng-=c8.WORLD_SIZE_MC}}this.greatCirclePoints.push(h1);h2=h1}var h5=bP(T,h2);if(h5>30037726){if(T.lng<h2.lng){T.lng+=c8.WORLD_SIZE_MC}else{T.lng-=c8.WORLD_SIZE_MC}}this.greatCirclePoints.push(T)},calcMiddlePoint:function(h1,h0,h2,h6){var hV=h1.lat;var hU=h0.lat;var h5=h1.lng;var h3=h0.lng;var h7=dK(hV);var h4=dK(hU);var i=dK(h5);var e=dK(h3);var h9=Math.sin((1-h2)*h6)/Math.sin(h6);var h8=Math.sin(h2*h6)/Math.sin(h6);var hY=h9*Math.cos(h7)*Math.cos(i)+h8*Math.cos(h4)*Math.cos(e);var hX=h9*Math.cos(h7)*Math.sin(i)+h8*Math.cos(h4)*Math.sin(e);var hW=h9*Math.sin(h7)+h8*Math.sin(h4);var T=Math.atan2(hW,Math.sqrt(Math.pow(hY,2)+Math.pow(hX,2)));var hZ=Math.atan2(hX,hY);return new hv(de(hZ),de(T))},calcAngularDistance:function(hV,i){var hW=dK(hV.lat);var hU=dK(i.lat);var T=dK(hV.lng);var e=dK(i.lng);return Math.acos(Math.sin(hW)*Math.sin(hU)+Math.cos(hW)*Math.cos(hU)*Math.cos(Math.abs(e-T)))}});function ak(hV,e){if(!hV||hV.length===0){return}var hU=[];for(var T=0;T<hV.length;T++){hU[T]=en.convertLL2MC(hV[T])}a.call(this,hU,e)}ak.inherits(a,"PolylineOut");C.extend(ak.prototype,{toString:function(){return"Polyline"},setPath:function(hU){if(!hU||hU.length===0){return}var T=[];for(var e=0;e<hU.length;e++){T[e]=en.convertLL2MC(hU[e])}this.setPathIn(T)},getPath:function(){var e=this.getPathIn();if(!e||e.length===0){return[]}var hU=[];for(var T=0;T<e.length;T++){hU[T]=en.convertMC2LL(e[T])}return hU},getBounds:function(i){var e=this.getBoundsIn(i);var T=new dS(en.convertMC2LL(e.getSouthWest()),en.convertMC2LL(e.getNorthEast()));return T}});function ep(T,hU,e){w.call(this,e);this._normalizedBounds=new dS();this._cps=hU;this._path=T;this.setPoints(T);var i=this;ea.load("poly",function(){i._draw()})}ep.inherits(a,"BezierCurve");C.extend(ep.prototype,{getBoundsIn:function(e){if(!e){this._bounds.setMinMax();return this._bounds}this._normalizedBounds.setMinMax();return this._normalizedBounds},setPoints:function(e){this._clearCache();this.points=w.getGraphPoints(e).slice(0);this.points=this.calcBezierPoints(this.points,this._cps);this._calcBounds()},_calcBounds:function(){if(!this.points){return}var e=this;e._bounds.setNorthEast(null);e._bounds.setSouthWest(null);if(e.greatCirclePoints&&e.greatCirclePoints.length>0){C.each(e.greatCirclePoints,function(i){e._bounds.extend(i)})}else{C.each(e.points,function(i){e._bounds.extend(i)})}e._normalizedBounds.setSouthWest(e._bounds.getSouthWest());e._normalizedBounds.setNorthEast(e._bounds.getNorthEast());if(e._normalizedBounds.sw.lng<-c8.WORLD_SIZE_MC_HALF||e._normalizedBounds.ne.lng>c8.WORLD_SIZE_MC_HALF){e._normalizedBounds.sw.lng=-c8.WORLD_SIZE_MC_HALF;e._normalizedBounds.ne.lng=c8.WORLD_SIZE_MC_HALF}},getPathIn:function(){return this._path},setPathIn:function(e){this._path=e;this.setPoints(e)},getCpsIn:function(){return this._cps},setCpsIn:function(e){this._cps=e;this.setPoints(this._path)},calcBezierPoints:function(hU,hW){var T=[];for(var e=0;e<hU.length-1;e++){var hV=[hU[e],hW[e][0],hW[e][1],hU[e+1]];T=T.concat((this.bezierbetweenTwoP(hV)))}return T},bezierbetweenTwoP:function(hW){var T=100;var hV=1/T;var e=[];for(var hU=0;hU<T;hU++){e.push(this.getPointOnCubicBezier(hW,hU*hV))}return e},getPointOnCubicBezier:function(hX,h1){var i;var hW;var hU;var h2;var hV;var T;var h0;var e;var hZ;var hY;hU=3*(hX[1].lng-hX[0].lng);hW=3*(hX[2].lng-hX[1].lng)-hU;i=hX[3].lng-hX[0].lng-hU-hW;T=3*(hX[1].lat-hX[0].lat);hV=3*(hX[2].lat-hX[1].lat)-T;h2=hX[3].lat-hX[0].lat-T-hV;h0=h1*h1;e=h0*h1;hZ=(i*e)+(hW*h0)+(hU*h1)+hX[0].lng;hY=(h2*e)+(hV*h0)+(T*h1)+hX[0].lat;return new hv(hZ,hY)}});function fq(hV,hX,e){if(!hV||hV.length===0){return}this.userPath=hV;this.userCps=hX;var hU=[];for(var T=0;T<hV.length;T++){hU[T]=en.convertLL2MC(hV[T])}if(!hX||hX.length===0){return}var hW=[];for(var T=0;T<hX.length;T++){hW[T]=[];hW[T][0]=en.convertLL2MC(hX[T][0]);if(hX[T][1]){hW[T][1]=en.convertLL2MC(hX[T][1])}else{hW[T][1]=en.convertLL2MC(hX[T][0])}}ep.call(this,hU,hW,e)}fq.inherits(ep,"BezierCurveOut");C.extend(fq.prototype,{toString:function(){return"BezierCurve"},setPath:function(hU){if(!hU||hU.length===0){return}this.userPath=hU;var T=[];for(var e=0;e<hU.length;e++){T[e]=en.convertLL2MC(hU[e])}this.setPathIn(T)},getPath:function(){return this.userPath;var e=this.getPathIn();if(!e||e.length===0){return[]}var hU=[];for(var T=0;T<e.length;T++){hU[T]=en.convertMC2LL(e[T])}return hU},getControlPoints:function(){return this.userCps;var e=this.getCpsIn();if(!e||e.length===0){return[]}var hU=[];for(var T=0;T<e.length;T++){hU[T]=[];hU[T][0]=en.convertMC2LL(e[T][0]);hU[T][1]=en.convertMC2LL(e[T][1])}return hU},setControlPoints:function(hU){if(!hU||hU.length===0){return}this.userCps=hU;var T=[];for(var e=0;e<hU.length;e++){T[e]=[];T[e][0]=en.convertLL2MC(hU[e][0]);if(hU[e][1]){T[e][1]=en.convertLL2MC(hU[e][1])}else{T[e][1]=en.convertLL2MC(hU[e][0])}}this.setCpsIn(T)},getBounds:function(i){var e=this.getBoundsIn(i);var T=new dS(en.convertMC2LL(e.getSouthWest()),en.convertMC2LL(e.getNorthEast()));return T}});function fo(e,T){w.call(this,T);this._normalizedBounds=new dS();this.setPoints(e);var i=this;ea.load("poly",function(){i._draw()})}fo.inherits(a,"PolylineMultipart");C.extend(fo.prototype,{setPoints:function(e){if(!e){return}this._clearCache();this.points=this._unifyArgs(e);this._calcBounds()},_unifyArgs:function(T){var e=[];var i=[];if(T.constructor===Array){if(T[0].constructor===hv){i.push(T)}else{i=T}}else{if(typeof T==="string"){i.push(T)}}C.each(i,function(hU){e.push(w.getGraphPoints(hU))});return e},setPointAt:function(i,e,T){T=T||0;if(!e||!this.points[T]||!this.points[T][i]){return}this._clearCache();this.points[T][i]=new hv(e.lng,e.lat);this._calcBounds()},getBoundsIn:function(e){if(!e){this._bounds.setMinMax();return this._bounds}this._normalizedBounds.setMinMax();return this._normalizedBounds},_calcBounds:function(){if(!this.points){return}var e=this;e._bounds.setNorthEast(null);e._bounds.setSouthWest(null);if(e.greatCirclePoints&&e.greatCirclePoints.length>0){C.each(e.greatCirclePoints,function(i){e._bounds.extend(i)})}else{C.each(e.points,function(i){C.each(i,function(T){e._bounds.extend(T)})})}e._normalizedBounds.setSouthWest(e._bounds.getSouthWest());e._normalizedBounds.setNorthEast(e._bounds.getNorthEast());if(e._normalizedBounds.sw.lng<-c8.WORLD_SIZE_MC_HALF||e._normalizedBounds.ne.lng>c8.WORLD_SIZE_MC_HALF){e._normalizedBounds.sw.lng=-c8.WORLD_SIZE_MC_HALF;e._normalizedBounds.ne.lng=c8.WORLD_SIZE_MC_HALF}}});function aQ(T,e){w.call(this,e);e=e||{};if(typeof e.fillOpacity==="number"){this._config.fillOpacity=e.fillOpacity}else{this._config.fillOpacity=0.6}fI(this._config.fillOpacity,0,1);if(e.fillColor===""){this._config.fillColor=""}else{this._config.fillColor=e.fillColor?e.fillColor:"#fff"}this._parseFillCacheWebGL=[];this.setPoints(T,e);var i=this;ea.load("poly",function(){i._draw()})}aQ.inherits(w,"Polygon");C.extend(aQ.prototype,{setPoints:function(hW){var hU=[];if(typeof hW==="string"||hW[0] instanceof hv||hW[0] instanceof c4||this instanceof gb||hW.length===0){var e=this._processSinglePointArray(hW);this._userPoints=e.userPoints;hU=e.innerPoints;this.hasMultipleParts=false}else{this._userPoints=[];for(var hV=0;hV<hW.length;hV++){var T=this._processSinglePointArray(hW[hV]);this._userPoints.push(T.userPoints);hU.push(T.innerPoints)}this.hasMultipleParts=true}w.prototype.setPoints.call(this,hU)},setPathIn:function(e){this.setPoints(e)},_processSinglePointArray:function(e){var i=w.getGraphPoints(e).slice(0);innerPoints=i.slice(0);if(innerPoints.length>1&&!innerPoints[0].equals(innerPoints[innerPoints.length-1])){innerPoints.push(new hv(innerPoints[0].lng,innerPoints[0].lat))}return{userPoints:i,innerPoints:innerPoints}},setPointAt:function(i,e){if(!this._userPoints[i]){return}this._clearCache();this._userPoints[i]=new hv(e.lng,e.lat);this.points[i]=new hv(e.lng,e.lat);if(i===0&&!this.points[0].equals(this.points[this.points.length-1])){this.points[this.points.length-1]=new hv(e.lng,e.lat)}this._calcBounds()},setPositionAt:function(i,e){if(!this._userPoints[i]){return}var T=en.convertLL2MC(e);this.setPointAt(i,T)},getPoints:function(){var e=this._userPoints;if(e.length===0){e=this.points}return e},getPathIn:function(){return this.getPoints()}});function g7(hZ,hW){if(!hZ||hZ.length===0){return}var hY=[];if(typeof hZ==="string"||hZ[0] instanceof hv||hZ[0] instanceof c4){var e=this._processSinglePointArray(hZ);for(var hX=0;hX<e.innerPoints.length;hX++){hY[hX]=en.convertLL2MC(e.innerPoints[hX])}}else{for(var hX=0;hX<hZ.length;hX++){var T=this._processSinglePointArray(hZ[hX]);var hV=[];for(var hU=0;hU<T.innerPoints.length;hU++){hV[hU]=en.convertLL2MC(T.innerPoints[hU])}hY.push(hV)}}aQ.call(this,hY,hW)}g7.inherits(aQ,"PolygonOut");C.extend(g7.prototype,{toString:function(){return"Polygon"},setPath:function(hU){if(!hU||hU.length===0){return}hU=w.getGraphPoints(hU);var T=[];for(var e=0;e<hU.length;e++){T[e]=en.convertLL2MC(hU[e])}this.setPathIn(T)},getPath:function(){var e=this.getPathIn();if(!e||e.length===0){return[]}var hU=[];for(var T=0;T<e.length;T++){hU[T]=en.convertMC2LL(e[T])}return hU}});function gb(i,e,T){this.point=i;this.radius=Math.abs(e);aQ.call(this,[],T)}gb.parseTolerance={0:[0.01,0.0001,0.00001,0.000004],1:[1000,10,1,0.4]};gb.inherits(aQ,"Circle");C.extend(gb.prototype,{initialize:function(e){this.map=e;this.points=this._getPerimeterPoints(this.point,this.radius);this._calcBounds();return null},getPoint:function(){return this.point},setPoint:function(e){if(!e){return}this.point=e;this.latLng=en.convertMC2LL(e)},setCenterIn:function(e){var i=arguments[1];this.setPoint(e,i)},setRadius:function(e){this.radius=Math.abs(e)},getCenterIn:function(){return this.point},getRadius:function(){return this.radius},_getPerimeterPoints:function(e,h1){if(!e||!h1||!this.map){return[]}var T=this.map;var hY=e.lng;var hW=e.lat;var h7=en.convertMC2LL(e);hY=h7.lng;hW=h7.lat;var h8=[];var h3=h1/en.EARTHRADIUS;var h0=(Math.PI/180)*hW;var h6=(Math.PI/180)*hY;for(var hZ=0;hZ<360;hZ+=9){var hX=(Math.PI/180)*hZ;var h4=Math.asin(Math.sin(h0)*Math.cos(h3)+Math.cos(h0)*Math.sin(h3)*Math.cos(hX));var h2=Math.atan2(Math.sin(hX)*Math.sin(h3)*Math.cos(h0),Math.cos(h3)-Math.sin(h0)*Math.sin(h4));var h5=((h6-h2+Math.PI)%(2*Math.PI))-Math.PI;var hV=new c4(h4*(180/Math.PI),h5*(180/Math.PI));h8.push(en.convertLL2MC(hV))}var hU=h8[0];h8.push(new hv(hU.lng,hU.lat));if(hU){this._radiusMercator=Math.sqrt(Math.pow(hU.lng-this.point.lng,2)+Math.pow(hU.lat-this.point.lat,2))}else{this._radiusMercator=this.radius}return h8}});function dF(i,e,hU){this.latLng=new c4(i.lat,i.lng);var T=en.convertLL2MC(i);gb.call(this,T,e,hU)}dF.inherits(gb,"CircleOut");C.extend(dF.prototype,{toString:function(){return"Circle"},setCenter:function(e){this.latLng=new c4(e.lat,e.lng);var i=en.convertLL2MC(e);this.setCenterIn(i)},getCenter:function(){return this.latLng},getPath:function(){var e=this.getPathIn();if(!e||e.length===0){return[]}var hU=[];for(var T=0;T<e.length;T++){hU[T]=en.convertMC2LL(e[T])}return hU}});function bs(hU,e,i){w.call(this,i);i=i||{};if(typeof i.topFillOpacity==="number"){this._config.topFillOpacity=i.topFillOpacity}else{this._config.topFillOpacity=0.6}if(typeof i.sideFillOpacity==="number"){this._config.sideFillOpacity=i.sideFillOpacity}else{this._config.sideFillOpacity=0.8}fI(this._config.sideFillOpacity,0,1);if(i.topFillColor===""){this._config.topFillColor=""}else{this._config.topFillColor=i.topFillColor?i.topFillColor:"#fff"}if(i.sideFillColor===""){this._config.sideFillColor=""}else{this._config.sideFillColor=i.sideFillColor?i.sideFillColor:"#fff"}this._parseFillCacheWebGL=[];this.setPoints(hU,i);this._config.altitude=e||0;var T=this;ea.load("poly",function(){T._draw()})}bs.inherits(w,"Prism");C.extend(bs.prototype,{setPoints:function(hW){var hU=[];if(typeof hW==="string"||hW[0] instanceof hv||hW[0] instanceof c4||this instanceof gb||hW.length===0){var e=this._processSinglePointArray(hW);this._userPoints=e.userPoints;hU=e.innerPoints;this.hasMultipleParts=false}else{this._userPoints=[];for(var hV=0;hV<hW.length;hV++){var T=this._processSinglePointArray(hW[hV]);this._userPoints.push(T.userPoints);hU.push(T.innerPoints)}this.hasMultipleParts=true}w.prototype.setPoints.call(this,hU)},setPathIn:function(e){this.setPoints(e)},_processSinglePointArray:function(e){var i=w.getGraphPoints(e).slice(0);innerPoints=i.slice(0);if(innerPoints.length>1&&!innerPoints[0].equals(innerPoints[innerPoints.length-1])){innerPoints.push(new hv(innerPoints[0].lng,innerPoints[0].lat))}return{userPoints:i,innerPoints:innerPoints}},setPointAt:function(i,e){if(!this._userPoints[i]){return}this._clearCache();this._userPoints[i]=new hv(e.lng,e.lat);this.points[i]=new hv(e.lng,e.lat);if(i===0&&!this.points[0].equals(this.points[this.points.length-1])){this.points[this.points.length-1]=new hv(e.lng,e.lat)}this._calcBounds()},getPoints:function(){var e=this._userPoints;if(e.length===0){e=this.points}return e},getPathIn:function(){return this.getPoints()},setTopFillOpacity:function(e){if(e>1||e<0){return}this._config.topFillOpacity=e;this._setDomAttribute("topfillopacity",e)},getTopFillOpacity:function(){return this._config.topFillOpacity},setSideFillOpacity:function(e){if(e>1||e<0){return}this._config.sideFillOpacity=e;this._setDomAttribute("sidefillopacity",e)},getSideFillOpacity:function(){return this._config.sideFillOpacity},setTopFillColor:function(e){this._config.topFillColor=e||"";this._setDomAttribute("topfillcolor",e)},getTopFillColor:function(){return this._config.topFillColor},setSideFillColor:function(e){this._config.sideFillColor=e||"";this._setDomAttribute("sidefillcolor",e)},getSideFillColor:function(){return this._config.sideFillColor},setAltitude:function(e){this._config.altitude=Number(e);this.draw();var i=new bb("onlineupdate");i.overlay=this;this.dispatchEvent(i)},getAltitude:function(){return this._config.altitude}});function cg(hY,hW,hZ){if(!hY||hY.length===0){return}this.userPath=hY;var e=[];if(typeof hY==="string"||hY[0] instanceof hv||hY[0] instanceof c4){var h0=this._processSinglePointArray(hY);for(var hV=0;hV<h0.innerPoints.length;hV++){e[hV]=en.convertLL2MC(h0.innerPoints[hV])}}else{for(var hV=0;hV<hY.length;hV++){var hX=this._processSinglePointArray(hY[hV]);var T=[];for(var hU=0;hU<hX.innerPoints.length;hU++){T[hU]=en.convertLL2MC(hX.innerPoints[hU])}e.push(T)}}bs.call(this,e,hW,hZ)}cg.inherits(bs,"PrismOut");C.extend(cg.prototype,{toString:function(){return"Prism"},setPath:function(hU){if(!hU||hU.length===0){return}this.userPath=hU;var T=[];for(var e=0;e<hU.length;e++){T[e]=en.convertLL2MC(hU[e])}this.setPathIn(T)},getPath:function(){return this.userPath;var e=this.getPathIn();if(!e||e.length===0){return[]}var hU=[];for(var T=0;T<e.length;T++){hU[T]=en.convertMC2LL(e[T])}return hU}});function dW(T,e){w.call(this,e);e=e||{};this._config.type=e.type||"image";this._config.url=e.url||"";this._config.opacity=typeof e.opacity==="number"?e.opacity:1;fI(this._config.opacity,0,1);this._parseFillCacheWebGL=[];this.setPoints(T,e);var i=this;ea.load("poly",function(){i._draw()})}dW.inherits(w,"GroundOverlay");C.extend(dW.prototype,{setPoints:function(i){var e=w.getGraphPoints(i).slice(0);this.hasMultipleParts=false;w.prototype.setPoints.call(this,e)},setPathIn:function(e){this.setPoints(e)},getPoints:function(){return this.points},getPathIn:function(){return this.getPoints()}});function cp(hV,T){if(!hV){return}var hX=[new hv(hV.sw.lng,hV.ne.lat),new hv(hV.ne.lng,hV.ne.lat),new hv(hV.ne.lng,hV.sw.lat),new hv(hV.sw.lng,hV.sw.lat)];var e=w.getGraphPoints(hX).slice(0);var hW=[];for(var hU=0;hU<e.length;hU++){hW[hU]=en.convertLL2MC(e[hU])}dW.call(this,hW,T)}cp.inherits(dW,"GroundOverlayOut");C.extend(cp.prototype,{toString:function(){return"GroundOverlay"}});var bB={};function hK(T,i){C.BaseClass.call(this);this.content=T;this.map=null;this._config={width:0,height:0,maxWidth:600,offset:new d9(0,0),title:"",maxContent:"",enableMaximize:false,enableAutoPan:true,enableCloseOnClick:true,margin:[10,10,40,10],collisions:[[10,10],[10,10],[10,10],[10,10]],ifMaxScene:false,onClosing:function(){return true}};this.setConfig(i);if(this._config.width<50){this._config.width=50}if(this._config.width>730){this._config.width=730}if(this._config.height!=0){if(this._config.height<50){this._config.height=50}if(this._config.height>650){this._config.height=650}}if(this._config.maxWidth!==0){if(this._config.maxWidth<50){this._config.maxWidth=50}if(this._config.maxWidth>730){this._config.maxWidth=730}}this.isWinMax=false;this.IMG_PATH=e5.imgPath;this.overlay=null;var e=this;ea.load("simpleInfowindow",function(){e._draw()})}hK.inherits(C.BaseClass,"SimpleInfoWindow");C.extend(hK.prototype,{setWidth:function(e){e=e*1;if(!e&&e!=0||isNaN(e)||e<0){return}if(e!=0){if(e<50){e=50}if(e>730){e=730}}this._config.width=e},setHeight:function(e){e=e*1;e-=10;if(!e&&e!=0||isNaN(e)||e<0){return}if(e!=0){if(e<50){e=50}if(e>650){e=650}}this._config.height=e},setMaxWidth:function(e){e=e*1;if(!e&&e!=0||isNaN(e)||e<0){return}if(e!=0){if(e<50){e=50}if(e>730){e=730}}this._config.maxWidth=e},setTitle:function(e){this._config.title=e||""},setContent:function(e){this.content=e||""},setMaxContent:function(e){this._config.maxContent=e||""},redraw:function(){},enableAutoPan:function(){this._config.enableAutoPan=true},disableAutoPan:function(){this._config.enableAutoPan=false},enableCloseOnClick:function(){this._config.enableCloseOnClick=true},disableCloseOnClick:function(){this._config.enableCloseOnClick=false},enableMaximize:function(){this._config.enableMaximize=true},disableMaximize:function(){this._config.enableMaximize=false},show:function(){this._visible=true},hide:function(){this._visible=false},close:function(){this.hide()},dispose:function(){C.BaseClass.prototype.decontrol.call(this)},maximize:function(){this.isWinMax=true},restore:function(){this.isWinMax=false},setConfig:function(i){if(!i){return}for(var e in i){if(typeof(this._config[e])==typeof(i[e])){this._config[e]=i[e]}}},isVisible:function(){return this.isOpen()},isOpen:function(){return false},getPoint:function(){if(this.overlay&&this.overlay.getPoint){return this.overlay.getPoint()}},getOffset:function(){return this._config.offset},dispose:function(){C.BaseClass.prototype.decontrol.call(this)},toString:function(){return"SimpleInfoWindow"}});c8.prototype.openSimpleInfoWindow=function(hU,e){if(!hU||hU.toString()!="SimpleInfoWindow"||!e||e.toString()!="Point"){return}var i=this.temp;if(!i.marker){var T=new he(e5.imgPath+"blank.gif",{width:1,height:1});i.marker=new dr(e,{icon:T,width:1,height:1,offset:new d9(0,0),infoWindowOffset:new d9(0,0),clickable:false});i.marker._fromMap=1}else{i.marker.setPoint(e)}this.addOverlay(i.marker);i.marker.show();i.marker.openSimpleInfoWindow(hU)};c8.prototype.closeSimpleInfoWindow=function(){var e=this.temp.infoWin||this.temp._infoWin;if(e&&e.overlay){e.overlay.closeSimpleInfoWindow()}};cV.prototype.openSimpleInfoWindow=function(e){if(this.map){this.map.closeSimpleInfoWindow();e._visible=true;this.map.temp._infoWin=e;e.overlay=this;C.BaseClass.call(e,e.hashCode)}};cV.prototype.closeSimpleInfoWindow=function(){if(this.map&&this.map.temp._infoWin){this.map.temp._infoWin._visible=false;this.map.temp._infoWin.decontrol();this.map.temp._infoWin=null}};function ej(e,i){e=isNaN(e)?0:e;i=isNaN(i)?0:i;this.x=e;this.y=i}ej.prototype.equals=function(e){if(!e){return false}return e.x===this.x&&e.y===this.y};ej.prototype.clone=function(){return new ej(this.x,this.y)};ej.prototype.toString=function(){return"Pixel"};function d9(i,e){if(typeof i!=="number"){this.width=parseFloat(i)}else{this.width=i}if(typeof e!=="number"){this.height=parseFloat(e)}else{this.height=e}}d9.prototype.equals=function(e){return !!(e&&this.width===e.width&&this.height===e.height)};d9.prototype.toString=function(){return"Size"};var bH={B_NORMAL_MAP:{tileUrls:er(e5.tileDomain,e5.rasterTilePath),vectorTileUrls:er(e5.tileDomain,e5.vectorTilePath),tileSize:256,baseUnits:256,zoomLevelMin:3,zoomLevelMax:19,minDataZoom:3,maxDataZoom:19,minZoom:3,maxZoom:19,webgl:{minZoom:3,maxZoom:25},zoomLevelBase:18,errorUrl:e5.imgPath+"bg.png",bounds:new dS(new hv(-21364736,-11708041.66),new hv(23855104,12474104.17)),imgExtend:"png"},B_SATELLITE_MAP:{tileUrls:["//maponline0.bdimg.com/starpic/?qt=satepc&","//maponline1.bdimg.com/starpic/?qt=satepc&","//maponline2.bdimg.com/starpic/?qt=satepc&","//maponline3.bdimg.com/starpic/?qt=satepc&"],tileSize:256,baseUnits:256,zoomLevelMin:3,zoomLevelMax:19,minDataZoom:3,maxDataZoom:19,minZoom:3,maxZoom:19,zoomLevelBase:18,errorUrl:e5.imgPath+"bg.png",bounds:new dS(new hv(-21364736,-10616832),new hv(23855104,15859712)),imgExtend:"png"},B_STREET_MAP:{tileUrls:er(e5.tileDomain,e5.rasterTilePath),tileSize:256,baseUnits:256,zoomLevelMin:3,zoomLevelMax:19,minDataZoom:3,maxDataZoom:19,minZoom:3,maxZoom:19,zoomLevelBase:18,errorUrl:e5.imgPath+"bg.png",bounds:new dS(new hv(-21364736,-10616832),new hv(23855104,15859712)),imgExtend:"png"},BMAP_CUSTOM_LAYER:{tileUrls:[""],tileSize:256,baseUnits:256,zoomLevelMin:1,zoomLevelMax:19,minDataZoom:3,maxDataZoom:19,minZoom:3,maxZoom:19,zoomLevelBase:18,errorUrl:e5.imgPath+"blank.gif",bounds:new dS(new hv(-21364736,-10616832),new hv(23855104,15859712)),imgExtend:"png"},B_EARTH_MAP:{tileUrls:[""],tileSize:256,baseUnits:256,zoomLevelMin:3,zoomLevelMax:19,minDataZoom:3,maxDataZoom:19,minZoom:3,maxZoom:19,webgl:{minZoom:3,maxZoom:21},zoomLevelBase:18,errorUrl:e5.imgPath+"blank.gif",bounds:new dS(new hv(-21364736,-10616832),new hv(23855104,15859712)),imgExtend:"png"}};var b6=bH;function bT(hZ,i,hV,T,hU){this.mgr=hZ;this.position=hV;this._cbks=[];this.name=hZ.getTileName(T,hU,hZ.map.config.style);this.info=T;this._transparentPng=hU.isTransparentPng();var h0=S("img");dm(h0);h0.galleryImg=false;var hY=h0.style;hY.position="absolute";hY.width=hZ.tileSize+"px";hY.height=hZ.tileSize+"px";hY.left=hV[0]+"px";hY.top=hV[1]+"px";this.img=h0;this.src=i;if(ab&&hV._offsetX===0){hY.opacity=0;hY.willChange="opacity"}var hX=this;this.img.onload=function(h8){if(!hX.mgr){return}var h3=hX.mgr;var h1=h3.bufferTiles;if(h3.bufferNumber>0){h1[hX.name]=hX;h1.push(hX.name)}var h5=h1.length-h3.bufferNumber;for(var h6=0;h5>0&&h6<h1.length;h6++){var h7=h1[h6];if(!h3.mapTiles[h7]){if(h1[h7]){h1[h7].mgr=null;var h4=h1[h7].img;if(h4.parentNode){ft(h4);h4.parentNode.removeChild(h4)}h4=null;h1[h7].img=null;h1[h7]=null;delete h1[h7]}h1.splice(h6,1);h6--;h5--}}hX.loaded=true;h3.imgNumber++;if(!hg(hX.img)){if(hU.tilesDiv){hU.tilesDiv.appendChild(hX.img)}}var h8=new bb("onimagechange");h8.action="show";h8.tile=hX.name;h3.map.dispatchEvent(h8);if(ab&&hV._offsetX===0){var h2=new o({fps:10,duration:300,render:function(e){if(hX.img&&hX.img.style){hX.img.style.opacity=e*1}},finish:function(){if(hX.img&&hX.img.style){delete hX.img.style.opacity;hX.img.style.willChange="auto"}}})}hX._callCbks()};this.img.onerror=function(h3){hX.error=true;hX._callCbks();if(!hX.mgr){return}var h1=hX.mgr;var h2=b6[hU.mapType];if(h2.errorUrl){hX.img.src=h2.errorUrl}if(!hg(hX.img)){if(hU.tilesDiv){hU.tilesDiv.appendChild(hX.img)}}};h0=null;var hW=new bb("onimagebefore");hW.tile=hX.name;hZ.map.dispatchEvent(hW)}bT.prototype._addLoadCbk=function(e){this._cbks.push(e)};bT.prototype._load=function(){if(FeBrowser.ie<=6&&FeBrowser.ie>0&&this._transparentPng){this.img.src=e5.imgPath+"blank.gif"}else{this.img.src=this.src}};bT.prototype._callCbks=function(){var T=this;for(var e=0;e<T._cbks.length;e++){T._cbks[e]()}T._cbks.length=0};var ab=(!C.Browser.ie||C.Browser.ie>8);function fg(e){this.tileLayers=[];this.map=e;this.bufferNumber=300;this.mapTiles=[];this.bufferTiles=[];this.config=b6[this.map.mapType];this.errorUrl=this.config.errorUrl;this.tileSize=this.config.tileSize;this.baseUnits=this.config.baseUnits;this.baseZoomLevel=this.config.zoomLevelBase;this.tileURLs=this.config.tileUrls;this.imgNumber=0;this.numLoading=0;this.temp={}}bo.register(function(i){if(i._renderType==="webgl"){return}var e=i.tileMgr=new fg(i);i.addEventListener("mousewheel",function(T){e.mouseWheel(T)});i.addEventListener("dblclick",function(T){e.dblClick(T)});i.addEventListener("rightdblclick",function(T){e.dblClick(T)});i.addEventListener("minuspress",function(T){e.keypress(T)});i.addEventListener("pluspress",function(T){e.keypress(T)});i.addEventListener("load",function(T){if(this.mapType===BMAP_EARTH_MAP){return}e.loadTiles()});i.addEventListener("zoomstartcode",function(T){if(this.mapType===BMAP_EARTH_MAP){return}e._zoom(T)});i.addEventListener("moving",function(T){if(this.mapType===BMAP_EARTH_MAP){return}e.moveGridTiles()});i.addEventListener("resize",function(T){if(this.mapType===BMAP_EARTH_MAP){return}e.resizeMap(T)});i.addEventListener("addtilelayer",function(T){e.addTileLayer(T)});i.addEventListener("removetilelayer",function(T){e.removeTileLayer(T)})});C.extend(fg.prototype,{addTileLayer:function(hU){var T=this;var i=hU.target;T.tileLayers.push(i);if(T.map.loaded){T.moveGridTiles()}},removeTileLayer:function(h1){var h2=this;var hZ=h1.target;var hX=hZ.mapType;var hW=h2.mapTiles;var h4=h2.bufferTiles;for(var T in h4){var hU=T.split("-")[1];if(hU==hX){delete h4[T]}}for(var T in hW){var hU=T.split("-")[1];if(hU==hX){delete hW[T]}}if(h2.zoomsDiv&&h2.zoomsDiv.parentNode){h2.zoomsDiv.parentNode.removeChild(h2.zoomsDiv);h2.zoomsDiv.innerHTML=""}var hV=h2.map;if(hV.deepZoom){var h3=hV.deepZoom.preDeepZoomDiv;if(h3&&h3.parentNode){h3.parentNode.removeChild(h3)}}for(var h0=0,hY=h2.tileLayers.length;h0<hY;h0++){if(hZ==h2.tileLayers[h0]){h2.tileLayers.splice(h0,1)}}h2.moveGridTiles()},hideDeepZoomDiv:function(){var i=this,T=i.map;if(T.deepZoom){var e=T.deepZoom.preDeepZoomDiv;if(e&&e.style.display!="none"){e.style.display="none"}}},getTileLayer:function(hV){var hU=this;for(var T=0,e=hU.tileLayers.length;T<e;T++){tilelayer=hU.tileLayers[T];if(tilelayer.mapType==hV){return tilelayer}}return null},_zoom:function(T){var i=this;if(i.zoomsDiv&&i.zoomsDiv.style.display!="none"){i.zoomsDiv.style.display="none"}i.hideDeepZoomDiv();i.moveGridTiles()},resizeMap:function(i){this.loaded=false;this.moveGridTiles()},_checkTilesLoaded:function(){this.numLoading--;var e=this;if(this.numLoading==0){if(this._checkLoadedTimer){clearTimeout(this._checkLoadedTimer);this._checkLoadedTimer=null}this._checkLoadedTimer=setTimeout(function(){if(e.numLoading==0){e.map.dispatchEvent(new bb("ontilesloaded"))}e._checkLoadedTimer=null},80)}},getTileName:function(e,T,i){var hV=T.mapType;var hU="TILE-"+hV+"-"+i+"-"+e[0]+"-"+e[1]+"-"+e[2];return hU},hideTile:function(hU,T){var i=hU.img;if(hg(i)){if(hU.loaded){this.imgNumber--}if(i.parentNode){ft(i);i.parentNode.removeChild(i)}}var hV=new bb("onimagechange");hV.tile=this.getTileName(hU.info,T,this.map.config.style);hV.action="hide";delete this.mapTiles[hU.name];if(!hU.loaded){ft(i);hU._callCbks();i=null;hU.img=null;hU.mgr=null}this.map.dispatchEvent(hV)},loadTiles:function(){var i=this;if(C.Browser.ie){try{document.execCommand("BackgroundImageCache",false,true)}catch(T){}}if(this.zoomsDiv&&this.zoomsDiv.style.display!="none"){this.zoomsDiv.style.display="none"}i.hideDeepZoomDiv();i.moveGridTiles()},getCell:function(hV,hU){var e=this.baseUnits*Math.pow(2,(this.baseZoomLevel-hU));var T=parseInt(hV.lng/e);var i=parseInt(hV.lat/e);return[T,i,e*(T+0.5),e*(i+0.5)]},moveGridTiles:function(){var h8=this.map,ij=h8.getMapType(),ih=this.tileLayers.length;var ie=h8.centerPoint;if(ij!==BMAP_SATELLITE_MAP){ie=d4.calcLoopCenterPoint(ie)}var hZ=h8.width;var ix=h8.getZoomUnits();var ig=ix*hZ;var il=ie.lng-ig/2;var h4=ie.lng+ig/2;var h7=d4.isAddWidth(il,h4);for(var io=0;io<ih;io++){var hV=this.tileLayers[io];if(hV.baseLayer||ih==1){this.tilesDiv=hV.tilesDiv}var h9=b6[hV.mapType];var hU=h8.zoomLevel;var ir=h8.getZoomUnits(h8.zoomLevel);var h3=h9.baseUnits*Math.pow(2,(h9.zoomLevelBase-hU));var h1=Math.floor(ie.lng/h3);var im=Math.floor(ie.lat/h3);var h6=h9.tileSize;var ia=[h1,im,(ie.lng-h1*h3)/h3*h6,(ie.lat-im*h3)/h3*h6];var h2=h7?h8.width/2*1.5:h8.width/2;var h5=ia[0]-Math.ceil((h2-ia[2])/h6);var iw=ia[1]-Math.ceil((h8.height/2-ia[3])/h6);var ip=ia[0]+Math.ceil((h2+ia[2])/h6);var ib=ia[1]+Math.ceil((h8.height/2+ia[3])/h6);var h0=[];for(var iu=h5;iu<ip;iu++){for(var it=iw;it<ib;it++){h0.push([iu,it]);var ii="id_"+iu+"_"+it+"_"+hU;h0[ii]=true}}if(hV.mapType!==BMAP_SATELLITE_MAP){h0=d4.calcLoopTiles(h0,hU)}h0.sort((function(i){return function(id,iz){return((0.4*Math.abs(id[0]-i[0])+0.6*Math.abs(id[1]-i[1]))-(0.4*Math.abs(iz[0]-i[0])+0.6*Math.abs(iz[1]-i[1])))}})([ia[0],ia[1]]));var T=this.mapTiles;var e=-ie.lng/ir;var iy=ie.lat/ir;var ik=[e,iy];for(var ic in T){var hX=T[ic];var iv=hX.info;if(!iv){continue}var ii="id_"+iv[0]+"_"+iv[1]+"_"+iv[2];if(!h0[ii]){this.hideTile(hX,hV)}}var hW=-h8.offsetX+h8.width/2;var hY=-h8.offsetY+h8.height/2;hV.tilesDiv.style.left=Math.round(e+hW)-ik[0]+"px";hV.tilesDiv.style.top=Math.round(iy+hY)-ik[1]+"px";this.numLoading+=h0.length;for(var iu=0,iq=h0.length;iu<iq;iu++){this.showTile([h0[iu][0],h0[iu][1],h8.zoomLevel],ik,hV,iu,h8.config.style)}}},showTile:function(hX,hW,h0,h5){this.centerPos=hW;var hY=b6[h0.mapType];var h1=this.map.config.style;var hU=this.getTileName(hX,h0,h1);var hV=(hX[0]*hY.tileSize)+hW[0];var T=(-1-hX[1])*hY.tileSize+hW[1];var h4=[hV,T];var hZ=null;if(h0.mapType!==BMAP_SATELLITE_MAP){hZ=d4.calcLoopParam(hX[0],hX[2]);var h3=hZ.offsetX;h4[0]+=h3;h4._offsetX=h3}var h8=this;var h7=this.mapTiles[hU];if(h7){h7.img.style.left=h4[0]+"px";h7.img.style.top=h4[1]+"px";if(h7.loaded){this._checkTilesLoaded()}else{h7._addLoadCbk(function(){h8._checkTilesLoaded()})}return}h7=this.bufferTiles[hU];if(h7){this.imgNumber++;h0.tilesDiv.insertBefore(h7.img,h0.tilesDiv.lastChild);this.mapTiles[hU]=h7;h7.img.style.left=h4[0]+"px";h7.img.style.top=h4[1]+"px";if(h7.loaded){this._checkTilesLoaded()}else{h7._addLoadCbk(function(){h8._checkTilesLoaded()})}var h6=new bb("onimagechange");h6.action="cache";h6.tile=this.getTileName(hX,h0,h1);this.map.dispatchEvent(h6)}else{var h2=new ej(hX[0],hX[1]);if(hZ){h2.x=hZ.col}var i=h0.getTilesUrl(h2,hX[2]);h7=new bT(this,i,h4,hX,h0);h7._addLoadCbk(function(){h8._checkTilesLoaded()});h7._load();this.mapTiles[hU]=h7;by(this.map)}},mouseWheel:function(hY){var hX=this.map;if(!hX.config.enableWheelZoom){return}var hZ=hX.zoomLevel+(hY.trend===true?1:-1);var hV=hX._getProperZoom(hZ);if(hV.exceeded){var T=new bb("onzoomexceeded");T.targetZoom=hZ;hX.dispatchEvent(T);return}hX.dispatchEvent(new bb("onzoomstart"));hX.lastLevel=hX.zoomLevel;hX.zoomLevel=hV.zoom;var i=hY.pixel;var hU=hX.pixelToPointIn(i,{zoom:hX.lastLevel});var hW=hX.getZoomUnits(hX.zoomLevel);hX.centerPoint=new hv(hU.lng+hW*(hX.width/2-i.x),hU.lat-hW*(hX.height/2-i.y));this.zoom(i)},dblClick:function(T){var i=this.map;if(!i.config.enableDblclickZoom){return}if(i.mapType==="B_EARTH_MAP"){return}if(i.currentOperation===dU.dragging){return}if(T.type=="onrightdblclick"){i.zoomOut(T.point)}else{i.zoomIn(T.point)}},keypress:function(T){var i=this.map;if(i.getMapType()===BMAP_EARTH_MAP){return}T.type=="onpluspress"?i.zoomIn():i.zoomOut()}});function cR(hU){this.opts=hU||{};this.copyright=this.opts.copyright||{};this.transparentPng=this.opts.transparentPng||false;this.png8=this.opts.png8||false;this.baseLayer=this.opts.baseLayer||false;this.dataType=this.opts.dataType||1;this.isFlat=this.opts.isFlat===false?false:true;this.showLabel=this.opts.showLabel===false?false:true;var e=this.opts.tileTypeName||"web";this.tileType=cL.getInstance(e);this.clipTile=this.opts.clipTile||false;this._type="tilelayer";var i=f8()?128:256;this.cacheSize=this.opts.cacheSize||i;var T=this;this.tileCache=new e0(this.cacheSize,{clearCallback:function(hV){if(hV.label){if(hV.label.textImageBitmap){hV.label.textImageBitmap.close()}if(hV.label.indoorTextImageBitmap){hV.label.indoorTextImageBitmap.close()}}T._removeIndoorData(hV)}});this.scaler=a6()>=1.5?2:1;this.normalUdt=aD("ditu","normal").udt;this.numLoading=0;this.useThumbData=false;this.useThumbData=this.opts.useThumbData||false;if(this.baseLayer){this.useThumbData=true}if(typeof this.opts.customLayer==="boolean"){this.customLayer=this.opts.customLayer}else{this.customLayer=true}}cR.inherits(ed,"TileLayer");C.extend(cR.prototype,{isTransparentPng:function(){return this.transparentPng},getTilesUrl:function(h1,e){var T=b6[this.mapType];if(typeof T!=="object"){return null}var hU=h1.x;var h2=h1.y;if(this.mapType!==BMAP_SATELLITE_MAP){var h2=d4.calcLoopParam(h2,e).col}var i="";if(this.opts.tileUrlTemplate){i=this.opts.tileUrlTemplate;i=i.replace(/\{X\}/,h2);i=i.replace(/\{Y\}/,hU);i=i.replace(/\{Z\}/,e)}else{if(this.mapType===BMAPGL_NORMAL_MAP){var h0=this.isCanvasMap?0:1;var hW=T.tileUrls[Math.abs(h2+hU)%T.tileUrls.length];if(window.offLineIPAddress){hW=window.offLineIPAddress+"tile5/"}var hV=this.map.config.style;i=hW+"?qt=vtile&x="+hU+"&y="+h2+"&z="+e+(hV==="default"?"":("&styleId=1"))+"&styles=pl&udt="+this.normalUdt+"&scaler="+this.scaler+"&showtext="+h0;i=i.replace(/-(\d+)/gi,"M$1")}if(this.mapType===BMAP_SATELLITE_MAP){var hX=aD("ditu","satellite");var hZ=hX.ver;var hY=hX.udt;i=T.tileUrls[Math.abs(h2+hU)%T.tileUrls.length]+"u=x="+hU+";y="+h2+";z="+e+";v="+hZ+";type=sate&fm=46&udt="+hY;i=i.replace(/-(\d+)/gi,"M$1")}}return i},initialize:function(hV){this.map=hV;if(hV._renderType==="webgl"){var hU=null;if(this.customLayer!==false){hU=this.getTilesUrl}C.extend(this,fV);this.labelProcessor=new dj(this);this.callbackDataQueue=[];if(hU){this.getTilesUrl=hU}var e=this;hV.on("indoor_data_refresh",function(hW){if(!e.baseLayer){return}e._refreshIndoorData(hW.uid,hW.floor)});hV.on("custom_labels_ready",function(hW){if(!e.baseLayer){return}e._doWorkAfterLabelImageLoad(hW.virtualTile,hW.labelCanvas,null,hW.imgKey)});hV.on("glmoduleloaded",function(){if(!e.baseLayer){return}e.updateAllIconsTextureCoords()})}if(!hV.temp.layerZIndex){hV.temp.layerZIndex=0}this.zIndex=this.zIndex||0;if(this.baseLayer){this.zIndex=0}if(!hV.temp.layid){hV.temp.layid=0}if(!this.opts.mapType){this.mapType="BMAP_CUSTOM_LAYER_"+hV.temp.layid;hV.temp.layid++}else{this.mapType=this.opts.mapType}var i=b6[this.mapType];if(!i){b6[this.mapType]={tileUrls:[],tileSize:256,baseUnits:256,zoomLevelMin:1,zoomLevelMax:19,minZoom:3,maxZoom:19,minDataZoom:3,maxDataZoom:19,zoomLevelBase:18,errorUrl:e5.imgPath+"/blank.gif",bounds:new dS(new hv(-21364736,-10616832),new hv(23855104,15859712)),imgExtend:"png"}}if(hV._renderType!=="webgl"){var T=dI(hV.platform,'<div style="position:absolute;z-index:'+this.zIndex+'"></div>');T.style.display="";T.style.left=Math.ceil(-hV.offsetX+hV.width/2)+"px";T.style.top=Math.ceil(-hV.offsetY+hV.height/2)+"px";this.tilesDiv=T}this.isCanvasMap=hV.isCanvasMap();this.lastZoom=hV.getZoom()},remove:function(){if(this.tilesDiv&&this.tilesDiv.parentNode){this.tilesDiv.innerHTML="";this.tilesDiv.parentNode.removeChild(this.tilesDiv)}delete this.tilesDiv},getCopyright:function(){return this.copyright},getMapType:function(){return this.mapType},setZIndex:function(e){this.zIndex=e;if(this.tilesDiv){this.tilesDiv.style.zIndex=e}},calcLoopParam:function(e,i){return d4.calcLoopParam(e,i)}});function c5(i,e,T){this.bounds=i;this.content=e;this.mapType=T}c5.inherits(ed,"Copyright");var gr={get:function(e){if(!gr.singleton){gr.singleton=new ai(e)}return gr.singleton}};function ai(i){this._map=i;this._tileMgr=i.tileMgr;this._animationDiv=null;this._preAnimationDiv=null;this._animation=null;this._baseLayerDiv=null;this._transformStyleName=a8.ifSupportCSS3("transform",true);this._transformOriginStyleName=a8.ifSupportCSS3("transformOrigin",true);this._preZoomTimes=1;this._preRenderTick=1;this._enableCanvas2dMap=!!(i.getRenderType()==="canvas");this._isIE9=!!(C.Browser.ie===9);var e=this;i.addEventListener("maptypechange",function(){e.hide()});i.addEventListener("load",function(){e.hide()})}C.extend(ai.prototype,{prepareLayer:function(){var hU=this._map;var e=this._tileMgr;this._canvas2dMapMgr=hU.canvas2dMapMgr;var T=this._baseLayerDiv=e.tilesDiv;if(!this._animationDiv){var i=this._preAnimationDiv;if(i){i.parentNode&&i.parentNode.removeChild(i);this._preAnimationDiv=null}this._preAnimationDiv=this._animationDiv=T.cloneNode(true);hU.platform.insertBefore(this._animationDiv,hU.platform.firstChild)}this.show()},prepareAniParam:function(){var hU=this._animationDiv;if(!hU){return}var e=hU.children.length;var T;this._zoomAniInfo=[];for(var hV=e-1;hV>-1;hV--){var hW={};T=hU.children[hV].style;hW.top=parseInt(T.top,10);hW.left=parseInt(T.left,10);this._zoomAniInfo[hV]=hW}},prepareLabelLayer:function(){var hV=this._map;if(this._enableCanvas2dMap&&hV.canvas2dMapMgr){if(this.touchZoomLabelCanvas){this.touchZoomLabelCanvas.parentNode.removeChild(this.touchZoomLabelCanvas)}var i=hV.canvas2dMapMgr._labelCanvas;this.touchZoomLabelCanvas=i.cloneNode(false);var e=this.touchZoomLabelCanvas.getContext("2d");e.drawImage(i,0,0);hV.platform.insertBefore(this.touchZoomLabelCanvas,hV.platform.firstChild);var hU=parseInt(i.style.left,10);var T=parseInt(i.style.top,10);this.touchZoomLabelCanvas.style.zIndex=9;this.touchZoomLabelCanvas.style[this._transformOriginStyleName]=(this._fixPosition.x-(hV.offsetX+hU))+"px "+(this._fixPosition.y-(hV.offsetY+T))+"px";i.style.visibility="hidden"}},show:function(){if(this._animationDiv){this._animationDiv.style.visibility=""}},showLabel:function(){var i=this._map;if(this._enableCanvas2dMap&&i.canvas2dMapMgr){var e=i.canvas2dMapMgr._labelCanvas;if(e){e.style.visibility=""}if(this.touchZoomLabelCanvas){this.touchZoomLabelCanvas.style.zIndex=-2;this.touchZoomLabelCanvas.style.visibility="hidden"}}},hide:function(){if(this._animationDiv){this._animationDiv.style.visibility="hidden"}if(this._preAnimationDiv){this._preAnimationDiv.style.visibility="hidden"}},hideNonAnimationLayers:function(){var hU=this._map;if(hU.getRenderType()==="dom"){if(hU.overlayDiv){hU.overlayDiv.style.visibility="hidden"}if(hU.overlayDivEx){hU.overlayDivEx.style.visibility="hidden"}}var hW=hU.tileMgr.tileLayers;var hV;for(var T=0,e=hW.length;T<e;T++){hV=hW[T];hV.tilesDiv.style.visibility="hidden"}},showNonAnimationLayers:function(){var hU=this._map;if(hU.getRenderType()==="dom"){if(hU.overlayDiv){hU.overlayDiv.style.visibility=""}if(hU.overlayDivEx){hU.overlayDivEx.style.visibility=""}}var hW=hU.tileMgr.tileLayers;var hV;for(var T=0,e=hW.length;T<e;T++){hV=hW[T];hV.tilesDiv.style.visibility=""}},setFixPosition:function(e){this._fixPosition=e},setZoom:function(e,h0){var hX=this._fixPosition;var h6=this._map;var h7=this._baseLayerDiv;var hY={x:hX.x-parseInt(h7.style.left,10)-h6.offsetX,y:hX.y-parseInt(h7.style.top,10)-h6.offsetY};var hU=this._animationDiv;if(!hU){return}var h4=hU.children.length;var h2;var h5=this._transformStyleName;var hW=this._transformOriginStyleName;var h8=this;var ia;var hZ;for(var h3=h4-1;h3>-1;h3--){var h1=this._zoomAniInfo[h3];h2=hU.children[h3].style;var hV=h1.left-hY.x;var T=h1.top-hY.y;h1.dx=hV*e-hV;h1.dy=T*e-T;h1.preDx=hV-hV;h1.preDy=T-T;ia=h1.preDx+(h1.dx-h1.preDx);hZ=h1.preDy+(h1.dy-h1.preDy)+h0;h2.left=h1.left+ia+"px";h2.top=h1.top+hZ+"px";h2.width=h2.height=256*e+"px"}if(this._enableCanvas2dMap){var h9=!h8._isIE9?"translate3d(0px, "+h0+"px, 0) scale("+e+")":"translate(0px, "+h0+"px) scale("+e+")";this.touchZoomLabelCanvas.style[h5]=h9}},setZoomFinish:function(){this._animationDiv=null},startAnimation:function(hX){this.prepareLayer();this.hideNonAnimationLayers();var ih=this._map;if(this.touchZoomLabelCanvas){this.touchZoomLabelCanvas.style.display="none"}hX=hX||{};var ie=hX.zoomCount||0;var h2=hX.fixPosition;var ic=hX.fixMCPosition;var h0=hX.pixOffset;this._zoomCount=ie;var hU=ih.getZoom();var ig=hU+ie;var e=ih.config.enableContinuousZoom;var h6=0.5;var h1=5;var T=Math.pow(2,ie);var ij=this._baseLayerDiv;var h3={x:h2.x-parseInt(ij.style.left,10)-ih.offsetX,y:h2.y-parseInt(ij.style.top,10)-ih.offsetY};var hY=this._animationDiv;var ia=hY.children.length;var il=this._preZoomTimes;var id=[];var ib=this._transformStyleName;var hZ=this._transformOriginStyleName;for(var h9=ia-1;h9>-1;h9--){var h7={};var h8=hY.children[h9].style;h7.top=parseInt(h8.top,10);h7.left=parseInt(h8.left,10);var hW=h7.left-h3.x;var hV=h7.top-h3.y;h7.dx=hW*T-hW;h7.dy=hV*T-hV;h7.preDx=hW*il-hW;h7.preDy=hV*il-hV;id[h9]=h7}var ii=this;var h5;var ik;var h4;this._zoomAni=new o({fps:60,duration:e?500:1,transition:function(i){i=i*h1/(2*h6);return h1*i-h6*i*i},render:function(iw){iw=iw*(4*h6)/(h1*h1);h5=il+iw*(T-il);var io=hU+eD(h5);var iu=null;var it=0;var ix=0;if(hX.onAnimationBeforeLooping){var iy=hX.onAnimationBeforeLooping(iw,io);iu=iy.loopingCenter;it=iy.yDiff;ix=iy.totalYDiff}for(var ip=id.length-1;ip>-1;ip--){var iq=id[ip];if(hY.children[ip]){var iv=hY.children[ip].style;ik=iq.preDx+(iq.dx-iq.preDx)*iw-h0.width*iw;h4=iq.preDy+(iq.dy-iq.preDy)*iw-h0.height*iw+it;iv.left=iq.left+ik+"px";iv.top=iq.top+h4+"px";iv.height=iv.width=256*h5+"px"}}var im=h0.width*iw;var ir=h0.height*iw;if(ih.isRestrict){ii._enableCanvas2dMap&&ii._canvas2dMapMgr.clearLabel()}else{ii._enableCanvas2dMap&&ii._canvas2dMapMgr.drawLabel(h5,h2,hU,ig,ie,iw,im,ir,ix,it)}ii._preZoomTimes=h5;ii._preRenderTick=iw;hX.onAnimationLooping&&hX.onAnimationLooping(iw,io,iu)},finish:function(){ii._preZoomTimes=1;ii._zoomAni=null;ii._animationDiv=null;hX.onAnimationFinish&&hX.onAnimationFinish();ii.showNonAnimationLayers()}});return this._zoomAni},stopAnimation:function(){if(this._zoomAni){this._zoomAni.stop();this._zoomAni=null}}});function c(e){this._initVars(e);this._initColorCanvas();this._bindEvent(e)}C.extend(c.prototype,{_initVars:function(e){this._map=e._map;this._canvas2dMapMgr=e;this._labelCtx=e._labelCtx;this.ratio=this._map.config.ratio;this.sizeRatio=this.ratio>1?2:1;this.RANK1=1000000;this.RANK2=2000000;this.RANK3=3000000;this.RANK4=4000000;this.RANK5=5000000},_initColorCanvas:function(){var i=256,T=S("canvas"),e=T.style;e.width=i+"px";e.height=i+"px";T.width=i;T.height=i;this._colorCvsSize=i;this._colorCvs=T;this._colorCtx=T.getContext("2d")},getLabelImageData:function(h7){var h6=h7.textImg;var T=h7.textPos;var h4=this.ratio;var h2=this.sizeRatio/h4;var hV=this._colorCtx;var hZ=this._colorCvsSize;hV.clearRect(0,0,hZ,hZ);var h1=0;var e=0;var hY=0;for(var h0=0;h0<T.length;h0++){if(T[h0].width>h1){h1=T[h0].width;e=h0;hY=T[h0].drawX}}h1/=h2;var h3=0;for(var h0=0,hX=T.length;h0<hX;h0++){var h5=T[h0];var h8;if(h0===e){h8=0}else{h8=h5.drawX-hY}hV.drawImage(h6,h5.srcX,h5.srcY,h5.width,h5.height,h8,h3,h5.width/h2,h5.height/h2);if(h5.width/h2>h1){h1=h5.width/h2}h3+=h5.height/h2+2*h4}var hU=hV.getImageData(0,0,h1,h3);var hW=hV.getImageData(0,0,h1,h3);return[hU,hW]},_bindEvent:function(i){var e=this,T=i._map;T.addEventListener("onspotmouseover",function(hX){if(!this.isCanvasMap()||!this.temp.isPermitSpotOver){return}if(hX.spots.length>0){var hW=hX.spots[0].userdata.uid;var hV=hX.spots[0].userdata.name;var hU=e.findLabelByUid(hW,hV);hU&&e._toHighLightColor(hU)}});T.addEventListener("onspotmouseout",function(hX){if(!this.isCanvasMap()||!this.temp.isPermitSpotOver){return}if(hX.spots.length>0){var hW=hX.spots[0].userdata.uid;var hV=hX.spots[0].userdata.name;var hU=e.findLabelByUid(hW,hV);hU&&e._toDefaultColor(hU)}});T.addEventListener("onspotclick",function(hX){if(!this.isCanvasMap()||!this.temp.isPermitSpotOver){return}if(hX.spots&&hX.spots.length>0){var hW=hX.spots[0].userdata.uid;var hV=hX.spots[0].userdata.name;var hU=e.findLabelByUid(hW,hV);hU&&e._changeBaseMapState(hU)}else{e._recoverNormalState()}});T.on("spot_status_reset",function(){e._recoverNormalState()});T.on("spot_highlight",function(hV){var hU=e.findLabelByUid(hV.uid);hU&&e._changeBaseMapState(hU)})},_getTextBound:function(h5){if(!h5.textPos){return null}var h3=this.ratio;var h1=this.sizeRatio/h3;var T=h5.textPos;var h4=h5.baseDrawX;var h2=h5.baseDrawY;var hZ=h4*h3+(T[0].drawX-h4)/h1;var hX=h2*h3+(T[0].drawY-h2)/h1;var hV=hZ+T[0].width/h1;var e=hX+T[0].height/h1;for(var h0=0,hY=T.length;h0<hY;h0++){var h6=T[h0];var hW=h4*h3+(h6.drawX-h4)/h1;if(hW<hZ){hZ=hW}var hU=h2*h3+(h6.drawY-h2)/h1;if(hU<hX){hX=hU}if(hW+h6.width>hV){hV=hW+h6.width}if(hU+h6.height>e){e=hU+h6.height}}return[hZ,hX,hV,e]},_toHighLightColor:function(T){if(T._tempRank&&T._tempRank==this.RANK5){return}var hY=this._getTextBound(T);if(!hY){return}var hU=Math.round(hY[0]);var i=Math.round(hY[1]);var e=this.getLabelImageData(T);var hW=e[0];var hV=e[1];var hX=this._canvas2dMapMgr.getFilterImageData(hW,this.RANK5);T._oldImgData=hV;this._labelCtx.putImageData(hX,hU,i)},_toDefaultColor:function(e){if(e._tempRank&&e._tempRank==this.RANK5){return}if(e._oldImgData){var i=this.sizeRatio;var T=this._getTextBound(e);if(!T){return}this._labelCtx.putImageData(e._oldImgData,Math.round(T[0]),Math.round(T[1]));e._oldImgData=null}},_changeBaseMapState:function(hU){var T=this._canvas2dMapMgr;var i=hU.guid;var e=hU.guidExt;var hV={guid:i,name:hU.name,guidExt:e};T._labelStrategy.setStrategyInfo(hV);T._loadData()},_recoverNormalState:function(){var e=this._canvas2dMapMgr;e._labelStrategy.setStrategyInfo(null);e._loadData()},findLabelByUid:function(hW,hU){var hY=this._canvas2dMapMgr,e=hY._computedLabel;for(var hV=0,T=e.length;hV<T;hV++){var hX=e[hV];if(!hY.isClickableLabel(hX)){continue}if(hW&&hX.guid===hW){return hX}if(hU&&hX.name===hU){return hX}}return null}});function ec(e){this._initVars(e)}C.extend(ec.prototype,{_initVars:function(e){this._map=e._map;this._canvas2dMapMgr=e;this.ratio=this._map.config.ratio;this._strategyInfo=null;this.RANK1=1000000;this.RANK2=2000000;this.RANK3=3000000;this.RANK4=4000000;this.RANK5=5000000},setStrategyInfo:function(e){this._strategyInfo=e},preComputeLabel:function(h0,iU,iD,ic,iO,i8){var ix=[],h8=h0._centerX,h6=h0._centerY,i9=ic*iO;var iJ=this.ratio;var hZ=this._map.getZoom();var ir=0;if(hZ===5){ir=4}if(hZ===8){ir=-6}h0.sort(function(ja,i){if(ja.x*ja.y<i.x*i.y){return -1}else{return 1}});for(var iu=0,ip=h0.length;iu<ip;iu++){var iZ=h0[iu],ij=iZ.x,ig=iZ.y,id=iZ.z;var il=d4.calcLoopParam(ij,id).offsetX;var iH=ij*i9,iG=(ig+1)*i9,hU=(iH-h8)/ic+iU/2+il,T=(h6-iG)/ic+iD/2;for(var iq=0,i3=iZ.length;iq<i3;iq++){var h2=iZ[iq],h9=undefined,h7=undefined,i1=undefined,i0=undefined;var iQ=h2.baseDrawX=hU+h2.baseX;var iP=h2.baseDrawY=T+h2.baseY;if(h2.type=="fixed"){var iB=h2.iconPos,ib=h2.textPos,i5=h2.textImg;if(iB){iB.drawX=hU+iB.destX;iB.drawY=T+iB.destY;h9=iB.drawX;h7=iB.drawY;i1=iB.drawX+iB.width;i0=iB.drawY+iB.height}if(ib&&i5){for(var iR=0;iR<ib.length;iR++){var i4=ib[iR];i4.drawX=hU+i4.destX;i4.drawY=T+i4.destY;if(!h9){h9=i4.drawX;h7=i4.drawY;i1=i4.drawX+i4.width;i0=i4.drawY+i4.height}else{if(i4.drawX<h9){h9=i4.drawX}if(i4.drawY<h7){h7=i4.drawY}if(i4.drawX+i4.width>i1){i1=i4.drawX+i4.width}if(i4.drawY+i4.height>i0){i0=i4.drawY+i4.height}}}}}else{h2.tileX=hU;h2.tileY=T;h9=hU+h2.minXOriginal;h7=T+h2.minYOriginal;i1=hU+h2.maxXOriginal;i0=T+h2.maxYOriginal}if(h9!=undefined){var iT=iQ+(h9-iQ)/iJ;var iS=iP+(h7-iP)/iJ;var iv=iQ+(i1-iQ)/iJ;var it=iP+(i0-iP)/iJ;h2.minX=iT;h2.minY=iS;h2.maxX=iv;h2.maxY=it;var iX=(iT+iv)/2,iW=(iS+it)/2,iE=h8+(iX-iU/2)*ic,iC=h6+(iD/2-iW)*ic;h2.geoX=iE;h2.geoY=iC;ix.push(h2)}}}if(i8){for(var iu=0,ip=i8.length;iu<ip;iu++){var io=i8[iu];var iM=io[0];var h3=io[1];var iB=iM.iconPos;var hX=iB.geoX;var hV=iB.geoY;var iQ=(hX-h8)/ic+iU/2;var iP=(h6-hV)/ic+iD/2;var h9=iQ+iB.destX;var h7=iP+iB.destY;var i1=h9+iB.width;var i0=h7+iB.height;iM.textPos=iM.textPos||iM._textPos;var ib=iM.textPos;var iV=ib[0];var ii=iQ+iV.destX;var h5=iP+iV.destY;if(h5<h7){h7=h5}if(ii+iV.width>i1){i1=ii+iV.width}if(h5+iV.height>i0){i0=h5+iV.height}if(ib.length===2){var ih=ib[1];var ie=iQ+ih.destX;var h4=iP+ih.destY;if(h4<h7){h7=h4}if(ie+ih.width>i1){i1=ie+ih.width}if(h4+ih.height>i0){i0=h4+ih.height}}iM._tempBounds=[h9,h7,i1,i0];var iB=h3.iconPos;var hX=iB.geoX;var hV=iB.geoY;var iQ=(hX-h8)/ic+iU/2;var iP=(h6-hV)/ic+iD/2;var h9=iQ+iB.destX;var h7=iP+iB.destY;var i1=h9+iB.width;var i0=h7+iB.height;h3.textPos=h3.textPos||h3._textPos;var ib=h3.textPos;var iV=ib[0];var ii=iQ+iV.destX;var h5=iP+iV.destY;if(ii<h9){h9=ii}if(h5<h7){h7=h5}if(h5+iV.height>i0){i0=h5+iV.height}if(ib.length===2){var ih=ib[1];var ie=iQ+ih.destX;var h4=iP+ih.destY;if(ie<h9){h9=ie}if(h4<h7){h7=h4}if(h4+ih.height>i0){i0=h4+ih.height}}h3._tempBounds=[h9,h7,i1,i0]}for(var iu=0,ip=i8.length;iu<ip;iu++){var io=i8[iu];var iM=io[0];var h3=io[1];if(iu===0&&h3.textPos){h3._textPos=h3.textPos;delete h3.textPos}var iY=iM;if(!iM.textPos&&h3.textPos){iY=h3}var i2=iY._tempBounds;for(iq=iu+1;iq<ip;iq++){var im=i8[iq];var iy=im[0];var i7=im[1];var ia=0;var i6=iy._tempBounds;if(!(i2[2]<i6[0]||i2[0]>i6[2]||i2[3]<i6[1]||i2[1]>i6[3])){ia++;if(iy.textPos){iy._textPos=iy.textPos;delete iy.textPos}}var i6=i7._tempBounds;if(!(i2[2]<i6[0]||i2[0]>i6[2]||i2[3]<i6[1]||i2[1]>i6[3])){ia++;if(i7.textPos){i7._textPos=i7.textPos;delete i7.textPos}}if(ia>=2){if(iY.textPos){iY._textPos=iY.textPos;delete iY.textPos}}}}for(var iu=0,ip=i8.length;iu<ip;iu++){var io=i8[iu];var iM=io[0];var h3=io[1];var iz=iM;if(!iM.textPos&&h3.textPos){iz=h3}var iB=iz.iconPos;var hX=iB.geoX;var hV=iB.geoY;var iQ=iz.baseDrawX=(hX-h8)/ic+iU/2;var iP=iz.baseDrawY=(h6-hV)/ic+iD/2;iB.drawX=iQ+iB.destX;iB.drawY=iP+iB.destY;var h9=iB.drawX;var h7=iB.drawY;var i1=iB.drawX+iB.width;var i0=iB.drawY+iB.height;var ib=iz.textPos;if(ib){var iV=ib[0];iV.drawX=iQ+iV.destX;iV.drawY=iP+iV.destY;if(iV.drawX<h9){h9=iV.drawX}if(iV.drawY<h7){h7=iV.drawY}if(iV.drawX+iV.width>i1){i1=iV.drawX+iV.width}if(iV.drawY+iV.height>i0){i0=iV.drawY+iV.height}if(ib.length===2){var ih=ib[1];ih.drawX=iQ+ih.destX;ih.drawY=iP+ih.destY;if(ih.drawX<h9){h9=ih.drawX}if(ih.drawY<h7){h7=ih.drawY}if(ih.drawX+ih.width>i1){i1=ih.drawX+ih.width}if(ih.drawY+ih.height>i0){i0=ih.drawY+ih.height}}}var iT=iQ+(h9-iQ)/iJ;var iS=iP+(h7-iP)/iJ;var iv=iQ+(i1-iQ)/iJ;var it=iP+(i0-iP)/iJ;iz.minX=iT;iz.minY=iS;iz.maxX=iv;iz.maxY=it;var iL=(iT+iv)/2;var iK=(iS+it)/2;var hY=h8+(iL-iU/2)*ic;var hW=h6+(iD/2-iK)*ic;iz.geoX=hY;iz.geoY=hW;ix.push(iz)}}var iN=this._strategyInfo;if(iN){var iw=iN.guid;var iF=iN.name;var ik=iN.guidExt;for(var iu=0,ip=ix.length;iu<ip;iu++){var h1=ix[iu];delete h1._tempRank;if(!this._canvas2dMapMgr.isClickableLabel(h1)||(ik===1&&!h1.guidExt)){continue}if((iw&&iw===h1.guid)||(iF&&iF===h1.name)){h1._tempRank=this.RANK5}}}else{for(var iu=0,ip=ix.length;iu<ip;iu++){var h1=ix[iu];if(h1.type=="line"||!h1.iconPos){continue}delete h1._tempRank}}ix.sort(function(jb,ja){var jc=jb._tempRank?jb._tempRank:jb.rank,i=ja._tempRank?ja._tempRank:ja.rank;if(jc===i){return jb.baseX-ja.baseX}return i-jc});for(var iu=0,ip=ix.length;iu<ip;iu++){var iY=ix[iu];iY.isDel=false;iY.isFadeout=false;iY._schedule=0;iY._isIgnore=false;iY.arrIntersectIndex=[];for(iq=iu+1;iq<ip;iq++){var iA=ix[iq];if(!(iY.maxX-ir<iA.minX||iY.minX>iA.maxX-ir||iY.maxY-ir<iA.minY||iY.minY>iA.maxY-ir)){iY.arrIntersectIndex.push(iq)}}}for(var iu=0,ip=ix.length;iu<ip;iu++){var h1=ix[iu];if(h1.isDel==false){var e=h1.arrIntersectIndex;for(var iq=0,i3=e.length;iq<i3;iq++){var iI=ix[e[iq]];iI.isDel=true;if(iI.guidExt===1){iI.isDel=false}}}}return ix}});function ah(e){this._map=e;this._initCanvas();this._initVars();this._bindEvent();this._tileType=cL.getInstance("na")}bo.register(function(i){if(i.getRenderType()==="canvas"){var e=i.config.style;if(bo["FeatureStyle"+e]){i.canvas2dMapMgr=new ah(i)}else{i.loadMapStyleFiles(function(){i.canvas2dMapMgr=new ah(i);i.canvas2dMapMgr._loadData()})}}});C.extend(ah.prototype,{_initCanvas:function(){var hX=this._map,hV=hX.getSize(),hU=hV.width,i=hV.height,e=hX.platform,hY=S("canvas"),hW=hY.style;var T=this.ratio=hX.config.ratio;this._width=hU;this._height=i;hW.cssText="position: absolute;left:0;top:0;width:"+hU+"px;height:"+i+"px;z-index:100;";hY.width=hU*T;hY.height=i*T;this._labelCanvas=hY;this._labelCtx=hY.getContext("2d");e.appendChild(hY)},_initVars:function(){var e=aD("ditu","normal");this._udt=e.udt;this._version=e.ver;this._labelDataUrls=b6.B_NORMAL_MAP.vectorTileUrls;this._style=bo["FeatureStyle"+this._map.config.style];this._labelCount=0;this._vectorDrawLib=new a0(this);this._cache={maxNum:500,delNum:50,arrCache:[]};this._computedLabel=null;this._spotData=null;this._labelStrategy=new ec(this);this._labelClick=new c(this);this._biz=new gQ(this);this._map.temp.isPermitSpotOver=true;this.labelStyleParam="pl";if(this._map.getMapType()===BMAP_SATELLITE_MAP){this.labelStyleParam="sl"}this.statRequestCount=0;this.statResponseCount=0},_resizeHandler:function(hW){var hY=this,i=hY._map,hV=i.getSize(),T=hV.width,h0=hV.height;var hX=this.ratio;var h1=this._labelCanvas,hU=h1.style;hU.width=T+"px";hU.height=h0+"px";h1.width=T*hX;h1.height=h0*hX;hY._width=T;hY._height=h0;var hZ=true;hY._loadData(hZ)},_bindEvent:function(){var e=this,i=e._map;i.addEventListener("load",function(T){e.clearLabel();e._loadData()});i.addEventListener("zoomend",function(T){if(!T.notClearLabel){e.clearLabel()}e._loadData()});i.addEventListener("moveend",function(T){e._loadData()});i.addEventListener("resize",function(T){e._resizeHandler(T)});i.addEventListener("maptypechange",function(T){if(T.mapType===BMAP_EARTH_MAP){e.hideLabelCanvas()}else{e.showLabelCanvas();if(T.mapType===BMAPGL_NORMAL_MAP){e.labelStyleParam="pl"}else{if(T.mapType===BMAP_SATELLITE_MAP){e.labelStyleParam="sl"}}e._loadData()}});i.addEventListener("streetlayer_show",function(T){if(this.isCanvasMap()){e.showLabelCanvas()}});i.addEventListener("streetlayer_hide",function(T){if(this.isCanvasMap()){e.hideLabelCanvas()}});i.addEventListener("loadbizdata",function(hU){var T=hU.data;e._biz.proecessBizData(T,function(){e.updateLabel()})});i.addEventListener("unloadbizdata",function(T){e._biz.clearBizData();e.updateLabel()});e.isDrawText=false;setTimeout(function(){if(!e.isDrawText){i.dispatchEvent(new bb("onmapwhitescreen"))}},10000)},getStyle:function(){return this._style},_getZoomUnits:function(e){return Math.pow(2,18-e)},_createCacheForm:function(T,hY,hX,i){var hW=this;var e=hW._cache;var hU=e.arrCache;var hZ=this._getLabelId(T,hY,hX,i);var hV={id:hZ,updateLabelCounter:0};hU.push(hV);hU[hZ]=hV;return hV},_getLabelId:function(i,hU,T,e){return"_"+i+"_"+hU+"_"+T+"_"+e+"_"+this.labelStyleParam},_getCache:function(i,hU,T,e){return this._cache.arrCache[this._getLabelId(i,hU,T,e)]},_setCacheValue:function(hV,h8,h6,hU,h1){var h3=this;var e=h3._cache;var hX=e.arrCache;var hZ=e.maxNum;var hW=e.delNum;var h7=this._getLabelId(hV,h8,h6,hU);var h2=hX[h7];if(h1){h2.lb=h1}if(hX.length>hZ){var T=hX.splice(0,hW);for(var h0=0,hY=T.length;h0<hY;h0++){var h4=T[h0],h5=h4.id;if(hX[h5].lb){hX[h5].lb=null}hX[h5]=null;delete hX[h5]}T=null}},_loadData:function(h6){var it=this._map;if(!it.isCanvasMap()){return}var hZ=it.getCenterIn();var ir=d4.calcLoopCenterPoint(hZ);var hY=this._tileType;var h1=this._width/2;var ie=this._height;var ig=it.getZoom();var ia=hY.getDataZoom(ig);var h3=it.getZoomUnits(ig);var h9=h3*h1;var iq=ir.lng-h9;var ip=ir.lng+h9;var h7=d4.isAddWidth(iq,ip);h1=h7?h1*1.5:h1;var h8=hY.getTileSize(ig);var hV=hY.getMercatorSize(ig,ia);var h2=Math.floor(ir.lng/hV);var h4=Math.floor(ir.lat/hV);var hW=[h2,h4,(ir.lng-h2*hV)/hV*h8,(ir.lat-h4*hV)/hV*h8];var ii=hW[0]-Math.ceil((h1-hW[2])/h8);var im=hW[1]-Math.ceil((ie/2-hW[3])/h8);var ic=hW[0]+Math.ceil((h1+hW[2])/h8);var ij=hW[1]+Math.ceil((ie/2+hW[3])/h8);it.temp.isPermitSpotOver=false;var e=[];for(var il=ii;il<ic;il++){for(var ik=im;ik<ij;ik++){e.push([il,ik,ia]);var ib="id_"+il+"_"+ik+"_"+ig;e[ib]=true}}e._zoom=ia;e=d4.calcLoopTiles(e,ig);e.sort((function(i){return function(id,iv){return((0.4*Math.abs(id[0]-i[0])+0.6*Math.abs(id[1]-i[1]))-(0.4*Math.abs(iv[0]-i[0])+0.6*Math.abs(iv[1]-i[1])))}})([hW[0],hW[1]]));var h5=this._cache.arrCache;this._curViewLabels=[];var hU="viewKey_"+Math.floor(hZ.lng)+"_"+Math.floor(hZ.lat)+"_"+ig;this.statRequestCount=0;this.statResponseCount=0;this._labelCount+=e.length;var h0=ig;for(var il=0,ih=e.length;il<ih;il++){var h2=e[il][0];var h4=e[il][1];var T=e[il][2];var hX=this._getLabelId(h2,h4,T,h0);var io=h5[hX];if(!io){io=this._createCacheForm(h2,h4,T,h0)}if(typeof io.lb==="undefined"){io.lb=null;this._loadLabelData(h2,h4,T,h0,h8,hU);this.statRequestCount++}else{if(io.lb){this._curViewLabels.push(io.lb);this._labelCount--}else{if(h6){this._loadLabelData(h2,h4,T,h0,h8,hU)}io.updateLabelCounter++}}}if(this._labelCount===0){this.updateLabel()}var iu=this;if(iu.errorTimer){clearTimeout(iu.errorTimer)}iu.errorTimer=setTimeout(function(){if(iu._labelCount!==0){iu._labelCount=0;iu.updateLabel()}var iv=new bb("onloaddatatimeout");var iw=0;var id=0;var ix=0;var i=0;if(iu.statRequestCount===iu.statResponseCount){iw=1}else{id=1}if(id===1){i=iu.statRequestCount-iu.statResponseCount;ix=iu.statResponseCount}iv.noTimeoutCount=iw;iv.timeoutCount=id;iv.timeoutNoLoaded=i;iv.timeoutLoaded=ix;iu._map.dispatchEvent(iv)},500)},clearLabel:function(){var e=this._width;var T=this._height;var i=this.ratio;this._labelCtx.clearRect(0,0,e*i,T*i)},updateLabel:function(){var i=this._map;var e=i.getCenterIn();var hU=this._width;var hX=this._height;var h0=i.getZoom();var hZ=this._tileType.getTileSize(h0);var hY=this._getZoomUnits(h0);var T=this._labelCtx;this._labelCanvas.style.left=-i.offsetX+"px";this._labelCanvas.style.top=-i.offsetY+"px";var hW=this._curViewLabels;hW._centerX=e.lng;hW._centerY=e.lat;var hV=this._biz.bizLabels;this._computedLabel=this._labelStrategy.preComputeLabel(hW,hU,hX,hY,hZ,hV);this._computedLabel._zoom=h0;this.clearLabel();this._vectorDrawLib.drawIconAndText(T,this._computedLabel,h0);this._addSpotData();i.temp.isPermitSpotOver=true;if(hW.length>0){this.isDrawText=true}},_loadLabelData:function(h3,h2,h1,T,h4,e){var hW=h3.toString();var hU=h2.toString();var hY="cbk_"+hW.replace("-","_")+"_"+hU.replace("-","__")+"_"+Math.floor(h1);var h8=eB+"."+hY;var h7=this._labelDataUrls;var h0=Math.abs(h3+h2)%h7.length;var id=h7[h0];if(window.offLineIPAddress){id=window.offLineIPAddress+"pvd/"}var i=this.labelStyleParam;var h6="?qt=vtile";var h9="";if(this._map.config.style!=="default"){h9="&styleId=1"}var h5="x={x}&y={y}&z={z}&udt={udt}&v={v}&styles={styles}"+h9+"&textonly=1&textimg=1&scaler={scaler}&fn="+encodeURIComponent(h8);var ia=d4.calcLoopParam(h3,h1).col;var hZ=this.ratio>1?2:1;var hX=h5.replace(/{x}/,ia).replace(/{y}/,h2).replace(/{z}/,Math.floor(h1)).replace(/{styles}/,i).replace(/{udt}/,this._udt).replace(/{v}/,this._version).replace(/{scaler}/,hZ);var hV=id+h6+"&param="+window.encodeURIComponent(go(hX));var ic=this;var ib=ic._map;bo[hY]=function(ie){ic._vectorDrawLib.parseLabelData(ie,h3,h2,h1,T,h4,function(ik){var ih=ib.getCenterIn();var il=ib.getZoom();var io="viewKey_"+Math.floor(ih.lng)+"_"+Math.floor(ih.lat)+"_"+il;ic._labelCount--;var ip=ic._getCache(h3,h2,h1,T).updateLabelCounter;ic._labelCount-=ip;var ii=ic._curViewLabels;if(io===e||(ic._labelCount<0&&il===h1)){ii.push(ik)}if(io===e){ic.statResponseCount++}if(ic._labelCount<=0){var ig=(new Date()).getTime();ic.updateLabel();var ij=(new Date()).getTime();var im=new bb("oncanvasmaploaded");im.drawTime=ij-ig;if(ic.statResponseCount===ic.statRequestCount){im.isAllLoadedDrawing=true}ib.dispatchEvent(im)}ic._setCacheValue(h3,h2,h1,T,ik);delete bo[hY]})};hp.load(hV)},drawLabel:function(T,hU,h1,i,hZ,hV,e,hW,h0,hX){var hY=this;if(!hY._computedLabel){return}if(hY._computedLabel._zoom!==h1){hY.clearLabel();return}hY._map.temp.isPermitSpotOver=false;hY.clearLabel();hY._vectorDrawLib.zoomingIconAndText(this._labelCtx,hY._computedLabel,T,hU,i,hZ,hV,e,hW,h0,hX)},_addSpotData:function(){this._spotData=[];var h1=this._map.getZoom();for(var hW=0,hV=this._computedLabel.length;hW<hV;hW++){var hY=this._computedLabel[hW];if(!this.isClickableLabel(hY)||(hY.guidExt===1&&hY.startScale>h1)){continue}var hX=[];hX[0]=(hY.minX-hY.maxX)/2;hX[1]=(hY.minY-hY.maxY)/2;hX[2]=(hY.maxX-hY.minX)/2;hX[3]=(hY.maxY-hY.minY)/2;var hU=null;if(hY.iconPos){hU=new hv(hY.iconPos.geoX,hY.iconPos.geoY)}var T=hY.name?hY.name.replace("\\\\","<br>"):"";if(hY.iconPos&&hY.iconPos.iconType.indexOf("ditie")>-1&&this._map.getZoom()>14){T=""}var h0={n:T,pt:new hv(hY.geoX,hY.geoY),userdata:{iconPoint:hU,uid:hY.guid,name:T,type:hY.iconPos?hY.iconPos.iconType:"",iconImg:hY.iconImg,mapPoi:true,adver_log:hY.adver_log||""},bd:hX,tag:"MAP_SPOT_INFO"};this._spotData.push(h0)}var hZ=new bb("onspotsdataready");hZ.spots=this._spotData;this._map._spotDataOnCanvas=this._spotData;this._map.dispatchEvent(hZ)},isClickableLabel:function(e){if(e.isDel||(!e.guid&&!e.name)){return false}return true},getFilterImageData:function(T,hX){var hY=T.data,hW=this._labelStrategy,hX=parseInt(hX);for(var hZ=0,hV=hY.length;hZ<hV;hZ+=4){var e=hY[hZ],h0=hY[hZ+1],h1=hY[hZ+2],h2=hY[hZ+3];if(h2===0){continue}var hU=Math.round((e+h0+h1)/3);var h3=hU-90;h3=h3<0?0:h3;if(hX===hW.RANK5){hY[hZ]=51+h3*1.3;hY[hZ+1]=133+h3*0.8;hY[hZ+2]=255}}return T},showLabelCanvas:function(){this._labelCanvas.style.visibility=""},hideLabelCanvas:function(){this._labelCanvas.style.visibility="hidden"}});var b9=5;var dX=4;var ht=3;var fi=2;var hN=1;var d0=0;var hQ=3;var hj=5;var I={3:{start:3,base:3},4:{start:4,base:5},5:{start:4,base:5},6:{start:6,base:7},7:{start:6,base:7},8:{start:8,base:9},9:{start:8,base:9},10:{start:10,base:10},11:{start:11,base:12},12:{start:11,base:12},13:{start:11,base:12},14:{start:14,base:15},15:{start:14,base:15},16:{start:16,base:17},17:{start:16,base:17},18:{start:18,base:19},19:{start:18,base:19},20:{start:18,base:19},21:{start:18,base:19}};function a0(hU){this._canvas2dMapMgr=hU;var i=this.ratio=hU._map.config.ratio;this._featureStyle=null;this._map=hU._map;var T=fC();var e="udt="+T.udt+"&v="+T.ver;this.sizeRatio=this.ratio>1?2:1;this._binaryCache={};this._iconCache={};this._initColorCanvas()}C.extend(a0.prototype,{_initColorCanvas:function(){var i=256,T=S("canvas"),e=T.style;e.width=i+"px";e.height=i+"px";T.width=i;T.height=i;this._colorCvs=T;this._colorCtx=T.getContext("2d")},parseLabelData:function(i,hW,hV,hU,e,hZ,hY){if(!this._featureStyle){this._featureStyle=this._canvas2dMapMgr.getStyle()}if(!i||!i[0]){hY([]);return}var hX=this._map.getZoomUnits();var T=this;this.loadTextPng(i,hZ,hW,hV,hU,e,hX,hY)},loadTextPng:function(ib,h2,h0,hZ,hX,i,hV,hU){var ia=this;var e=ib[5];var h9=this._map;var h6=h9.getZoom();var T=h9.getSize();var h7=T.width;var h5=T.height;var h8=h9.getCenterIn();var hY=h8.lng;var hW=h8.lat;var h4=h0*h2*hV;var h3=(hZ+1)*h2*hV;if(e){var h1=new Image();h1.onload=function(){ia.calcIconAndTextInfo(ib,h1,h2,h0,hZ,hX,i,hV,h4,h3,hU);delete this.onload};h1.src=e}else{setTimeout(function(){ia.calcIconAndTextInfo(ib,null,h2,h0,hZ,hX,i,hV,h4,h3,hU)},1)}},calcIconAndTextInfo:function(id,h4,h5,h3,h0,hY,hU,hW,h7,h6,hV){var ic=this;var ib=ic._featureStyle;var h1=[];h1.x=h3;h1.y=h0;h1.z=hY;var h2=ic._canvas2dMapMgr,T=h3*hW*h5,ia=(h0+1)*hW*h5,hX={tileLeft:T,tileTop:ia,zoomUnits:hW};var e=[];if(id[0]){for(var h8=0;h8<id[0].length;h8++){if(id[0][h8][0]===hQ){e.push(id[0][h8])}}}var hZ=id[2]||[];for(var h8=0;h8<e.length;h8++){this._getFixedLabelInfo(e[h8],h4,hU,hW,h5,h7,h6,h1)}var h9=Math.pow(2,hU-hY);for(h8=0;h8<hZ.length;h8++){this._getLineLabelInfo(hZ[h8],h4,hY,hU,hW,h5,h7,h6,h9,h1)}hV(h1)},_getFixedLabelInfo:function(h4,h8,hV,hZ,h9,ic,ib,ie){var h3=h4[1];if(!h3){return}var ih=this._map.getZoom();var iq=this._map.config.style;var ir=this._featureStyle;var h0=hV;if(h0===9){h0=8}for(var im=0;im<h3.length;im++){var it=h3[im];var e=it[0];var hU=el.getStyleFromCache(iq,e,"point",h0,ir);var il=el.getStyleFromCache(iq,e,"pointText",h0,ir);if((!il||il.length===0)&&(!hU||hU.length===0)){if(h0===5){var hY=it[1];if(!hY){continue}for(var ii=0;ii<hY.length;ii++){var ig=hY[ii][4];if(ig&&ig[7]==="北京"){hU=el.getStyleFromCache(iq,e,"point",6,ir);il=el.getStyleFromCache(iq,e,"pointText",6,ir);break}else{continue}}}else{continue}}var hY=it[1];if(!hY){continue}var io=null;var h1=1;var T=0;var h7=0;if(hU&&hU[0]){hU=hU[0];io=hU.icon;h1=hU.zoom?hU.zoom/100:1}else{hU=null}for(var ii=0;ii<hY.length;ii++){var ig=hY[ii][4];if(!ig){continue}var ik=ig[2];if(!this._isVisible(ik,ih)){continue}var h2=ig[12];if(il&&il.length>0&&!h2){continue}var h6=Math.round(ig[0]/100);var h5=Math.round(ig[1]/100);var ij={lng:ic+h6,lat:ib-(h9*hZ-h5)};var hX=h6/hZ;var hW=h9-h5/hZ;var ia=ig[7]||"";var ip=ig[5];var id={type:"fixed",name:ia,textImg:h8,rank:ig[4],baseX:hX,baseY:hW,iconPos:null,textPos:null,guid:ig[3]||"",tracer:ik,direction:ip,startScale:3};if((ip!==dX&&h2||!h2)&&io!==null){id.iconPos=this._getIconPosition(io,h1,hX,hW,ij);if(id.iconPos){T=id.iconPos.width;h7=id.iconPos.height}}if(T===0){id.direction=dX}if(h2){id.textPos=this._getTextDrawData(ig,hX,hW,T,h7)}if(id.textPos||id.iconPos){ie.push(id)}}}},_isVisible:function(e,i){var hU;if(!this._binaryCache[e]){hU=e.toString(2);if(hU.length<8){hU=new Array(8-hU.length+1).join("0")+hU}this._binaryCache[e]=hU}hU=this._binaryCache[e];var T=I[i].start;return hU[i-T]==="1"},_getIconPosition:function(hY,hW,T,i,e){var hU=this._map.config.style;var hZ=bo["iconSetInfo"+hU][hY];if(!hZ){if(hY.charCodeAt(0)>=48&&hY.charCodeAt(0)<=57){hZ=bo["iconSetInfo"+hU]["_"+hY]}}if(!hZ){return null}var hV=hZ[0];var hX=hZ[1];hV=hV*hW;hX=hX*hW;return{srcX:0,srcY:0,destX:T-hV/2,destY:i-hX/2,width:hV,height:hX,geoX:e.lng,geoY:e.lat,mcPt:e,iconType:hY}},_getTextDrawData:function(h5,h4,h3,hU,h1){var ia=h5[5];if(typeof ia!=="number"){ia=0}var hZ=this.ratio;var hY=hZ/2;hU*=hY;h1*=hY;var h0=h5[12];var hV=h0.length;var id=0;var ic=0;var h9=[];var h8=0;var ib=0;for(var h7=0;h7<hV;h7++){ib+=Math.round(h0[h7][3])}for(var h7=0;h7<hV;h7++){var hX=h0[h7];var hW=hX[0];var i=hX[1];var T=hX[2];var e=hX[3];var ie=2*hZ;var h6=0;if(hU!==0){h6=2*hZ}if(hU===0){ia=dX}switch(ia){case ht:var h2=h3-ib/2-ie*(hV-1)/2;id=h4-T-hU/2-h6;ic=h2+h8+ie*h7;break;case hN:var h2=h3-ib/2-ie*(hV-1)/2;id=h4+hU/2+h6;ic=h2+h8+ie*h7;break;case fi:var h2=h3-h1/2-ib-ie*(hV-1)-ie;id=h4-T/2;ic=h2+h8+ie*h7;break;case d0:var h2=h3+h1/2+ie/2;id=h4-T/2;ic=h2+h8+ie*h7;break;case dX:var h2=h3-e/2-ie*(hV-1)/2;id=h4-T/2;ic=h2+h8+ie*h7;break}h8+=e;if(T>0&&e>0){h9.push({srcX:hW,srcY:i,destX:id,destY:ic,width:T,height:e})}}if(h9.length>0){return h9}return null},_getLineLabelInfo:function(h2,hU,hV,ii,ix,h9,ig,ie,ih,h8){if(h2.length!==10){return}var ik=this.ratio;var T=this.ratio;var it=h2[7].length;var ia=h2[1];var iv=h2[3];var iB=h2[8];var hY=h2[4];var e=2;var hW=hY.slice(0,e);for(var iy=e;iy<hY.length;iy+=e){hW[iy]=hW[iy-e]+hY[iy];hW[iy+1]=hW[iy-(e-1)]+hY[iy+1]}for(var iy=e;iy<hY.length;iy+=e){if(iy%(iv*e)===0||iy%(iv*e)===1){continue}hW[iy]=hW[iy-e]+hY[iy]/ih;hW[iy+1]=hW[iy-(e-1)]+hY[iy+1]/ih}for(var iA=0;iA<it;iA++){var iw=h2[7][iA];if(!this._isVisible(iw,ii)){continue}var im=h2[6][iA];var h7=iA*iv*e;hY=hW.slice(h7,h7+iv*e);var ib=[];var il=undefined;var ij=undefined;var h6=undefined;var h5=undefined;var iB=h2[9].slice(0);if(im){iB.reverse()}var iq;var io;for(var iz=0;iz<iv;iz++){var h4=h2[5][iv*iA+iz];var ir=hY[iz*e]/100;var ip=hY[iz*e+1]/100;var h3=iB[iz];var hZ=h3[0];var h1=h3[1];var hX=h3[2];var h0=h3[3];var id;var ic;var iD;var iC;if(iz===0){iq=iD=ir/ix;io=h9-ip/ix;iC=ip/ix}else{iD=ir/ix;iC=ip/ix}var iF=iq+(iD-iq)*T-hX/2;var iE=io+(h9-iC-io)*T-h0/2;if(il===undefined){il=iq-hX/2;ij=io-h0/2;h6=il+hX;h5=ij+h0}else{if(iF<il){il=iF}if(iE<ij){ij=iE}if(iF+hX>h6){h6=iF+hX}if(iE+h0>h5){h5=iE+h0}}ib.push({angle:h4,srcX:hZ,srcY:h1,destX:iF,destY:iE,width:hX,height:h0})}var iu={type:"line",textImg:hU,rank:ia,baseX:iq,baseY:io,arrWordPos:ib,minXOriginal:il,minYOriginal:ij,maxXOriginal:h6,maxYOriginal:h5,text:""};h8.push(iu)}},alterColor:function(hX,e,hW){var T=this._colorCtx,i=this._canvas2dMapMgr;T.clearRect(0,0,hX.width,hX.height);T.drawImage(e,hX.srcX,hX.srcY,hX.width,hX.height,0,0,hX.width,hX.height);var hV=T.getImageData(0,0,hX.width,hX.height),hU=i.getFilterImageData(hV,hW);T.putImageData(hU,0,0)},drawIconAndText:function(h9,h8,e){var h0=this.ratio;var hY=this.sizeRatio/h0;var h2=2/h0;var il=this;for(var ic=0,ia=h8.length;ic<ia;ic++){var h1=h8[ic];if(h1.isDel==false){var hV=h1.baseDrawX;var hU=h1.baseDrawY;if(h1.type=="fixed"){var hX=h1.iconPos,id=h1.textPos,h6=h1.textImg,ih=h1.startScale;if(hX&&ih<=e){var T=this._iconCache[hX.iconType];if(T){if(T.img){h9.drawImage(T.img,0,0,T.img.width,T.img.height,Math.round(hV*h0+(hX.drawX-hV)/h2),Math.round(hU*h0+(hX.drawY-hU)/h2),hX.width/h2,hX.height/h2)}else{T.drawLabels.push(h1)}}else{if(!T){this._iconCache[hX.iconType]={img:null,drawLabels:[h1]};var io=new Image();io._iconName=hX.iconType;io.onload=function(){var iv=il._iconCache[this._iconName];iv.img=this;this.onload=null;for(var iq=0;iq<iv.drawLabels.length;iq++){var it=iv.drawLabels[iq];var ir=it.baseDrawX;var ip=it.baseDrawY;var iu=it.iconPos;h9.drawImage(this,0,0,this.width,this.height,Math.round(ir*h0+(iu.drawX-ir)/h2),Math.round(ip*h0+(iu.drawY-ip)/h2),iu.width/h2,iu.height/h2)}iv.drawPos=[]};io.src=e5.getIconSetPath(il._map.config.style)+hX.iconType+".png"}}}if(id&&h6&&ih<=e){for(var hZ=0;hZ<id.length;hZ++){var h7=id[hZ];if(!h1._tempRank){h9.drawImage(h6,h7.srcX,h7.srcY,h7.width,h7.height,Math.round(hV*h0+(h7.drawX-hV)/hY),Math.round(hU*h0+(h7.drawY-hU)/hY),h7.width/hY,h7.height/hY)}else{this.alterColor(h7,h6,h1._tempRank);h9.drawImage(this._colorCvs,0,0,h7.width,h7.height,Math.round(hV*h0+(h7.drawX-hV)/hY),Math.round(hU*h0+(h7.drawY-hU)/hY),h7.width/hY,h7.height/hY)}}}}else{var hW=h1.arrWordPos,h6=h1.textImg,h5=h1.tileX,h3=h1.tileY;for(var ib=0,h4=hW.length;ib<h4;ib++){var ie=hW[ib];var im=Math.round(h5+ie.destX);var ik=Math.round(h3+ie.destY);var ig=ie.angle;im=hV*h0+im-hV;ik=hU*h0+ik-hU;if(ig>10&&ig<350){h9.save();var ij=Math.round(im+ie.width/2);var ii=Math.round(ik+ie.height/2);h9.translate(ij,ii);h9.rotate(-ig/180*Math.PI);h9.drawImage(h6,ie.srcX,ie.srcY,ie.width,ie.height,-Math.round(ie.width/2),-Math.round(ie.height/2),ie.width/hY,ie.height/hY);h9.restore()}else{h9.drawImage(h6,ie.srcX,ie.srcY,ie.width,ie.height,im,ik,ie.width/hY,ie.height/hY)}}}}}},isCollide:function(hW,h5,h4,e,hY,T,h0){for(var hV=0,hU=T.length;hV<hU;hV++){var hZ=T[hV],hX=1/Math.pow(2,h0+1),h3=hX*hZ[3]/2,h2=hX*hZ[4]/2,h1=hZ[0];if(h1!=hW){if(!(h5+e<hZ[1]-h3||h5>hZ[1]+hZ[3]+h3||h4+hY<hZ[2]-h2||h4>hZ[2]+hZ[4]+h2)){return true}}}return false},zoomingIconAndText:function(il,ie,hU,ij,ik,iO,iu,h2,iA,it,ib){var iP=this.ratio;var h3=this.sizeRatio/iP;var iQ=2/iP;var i0=iP/2;var iK=ij.x;var iJ=ij.y;var im=2*iP;if(ib!==0){iJ+=it}var h6=undefined,hZ=undefined,hW=undefined,h1=undefined,ia=undefined;var iz=iO>0?true:false;if(!iz){h6=[];var iD=1-iu}for(var iW=0,iU=ie.length;iW<iU;iW++){var iR=ie[iW];if(iR.isDel==false){var i1=iR.baseDrawX;var iY=iR.baseDrawY;il.save();il.translate(-h2*iP,-iA*iP);if(iR.isFadeout){if(!iz&&iR._schedule<=iu&&!iR._isIgnore){il.globalAlpha=iD;iR._schedule=iu}else{iR._isIgnore=true;continue}}if(iR.type=="fixed"){var io=iR.iconPos,iw=iR.textPos,hX=iR.textImg,ip=iR.startScale;var T;var iH=0;if(io){iH=im}if(io&&!iR.iconImg&&this._iconCache[io.iconType]){T=this._iconCache[io.iconType].img}if(io&&ip<=ik&&T){h1=io.width;ia=io.height;hZ=(iK+(i1-iK)*hU)*iP-h1/2/iQ;hW=(iJ+(iY-iJ)*hU)*iP-ia/2/iQ+ib;if(!iz&&this.isCollide(iW,hZ,hW,h1,ia,h6,iO)){iR.isFadeout=true}il.drawImage(T,io.srcX,io.srcY,T.width,T.height,Math.round(hZ),Math.round(hW),h1/iQ,ia/iQ);!iz&&h6.push([iW,hZ,hW,h1,ia])}if(iw&&hX&&ip<=ik){var iv;var ix;var id=0;var ir=0;if(io){id=io.width;ir=io.height}var iI=iw.length;var h5=0;var iy=0;for(var ig=0;ig<iI;ig++){var iT=iw[ig];iy+=iT.height;if(h5<iT.width){h5=iT.width}}iy+=(ig-1)*im;if(!iz&&this.isCollide(iW,hZ,hW,h5,iy,h6,iO)){iR.isFadeout=true}var iS=0;for(var ig=0;ig<iI;ig++){var iT=iw[ig];switch(iR.direction){case ht:iv=-(id/2/iQ+iT.width+iH);ix=-iy/2+iS+im*ig;break;case hN:iv=id/2/iQ+iH;ix=-iy/2+iS+im*ig;break;case fi:iv=-iT.width/2;ix=-ir/2/iQ-iy+iS-im*(ig+1);break;case d0:iv=-iT.width/2;ix=ir/2/iQ+iS+im*(ig+1);break;case dX:iv=-iT.width/2;ix=-iy/2+iS+im*ig;break}iS+=iT.height;hZ=(iK+(i1-iK)*hU)*iP+iv/h3;hW=(iJ+(iY-iJ)*hU)*iP+ix/h3;+ib;h1=iT.width;ia=iT.height;if(!iR._tempRank){il.drawImage(hX,iT.srcX,iT.srcY,h1,ia,Math.round(hZ),Math.round(hW),h1/h3,ia/h3)}else{this.alterColor(iT,hX,iR._tempRank);il.drawImage(this._colorCvs,0,0,h1,ia,Math.round(hZ),Math.round(hW),h1/h3,ia/h3)}!iz&&h6.push([iW,hZ,hW,h1,ia])}}}else{var ic=iR.arrWordPos,hX=iR.textImg,iZ=iR.tileX,iX=iR.tileY;var h4=ic[0];var h0=Math.round(iZ+h4.destX);var hY=Math.round(iX+h4.destY);for(var iV=0,iG=ic.length;iV<iG;iV++){var iN=ic[iV];var i3=Math.round(iZ+iN.destX);var i2=Math.round(iX+iN.destY);var ii=iN.angle;var iF=Math.round((iK+(i1-iK)*hU)*iP-h4.width/2+i3-h0);var iE=Math.round((iJ+(iY-iJ)*hU)*iP-h4.height/2+i2-hY);hZ=iF;hW=iE;h1=iN.width;ia=iN.height;if(!iz&&this.isCollide(iW,hZ,hW,h1,ia,h6,iO)){iR.isFadeout=true}if(ii>10&&ii<350){var iM=iF+iN.width/2;var iL=iE+iN.height/2;var hV=ii/180*Math.PI;var iq=Math.cos(hV);var h7=Math.sin(hV);var iC=iq;var h8=iq;var iB=h7;var h9=-h7;var ih=iM-iM*iq-iL*h7;var e=iL+iM*h7-iL*iq;il.save();il.transform(iC,h9,iB,h8,ih,e);il.drawImage(hX,iN.srcX,iN.srcY,h1,ia,hZ,hW,h1/h3,ia/h3);il.restore()}else{il.drawImage(hX,iN.srcX,iN.srcY,h1,ia,hZ,hW,h1/h3,ia/h3)}!iz&&h6.push([iW,hZ,hW,h1,ia])}}il.restore()}}}});function gQ(e){this.initVars(e)}C.extend(gQ.prototype,{initVars:function(e){this._map=e._map;this._canvas2dMapMgr=e;this.base64Prefix="data:image/png;base64,";this.bizData=null;this.objTextsPng=null;this.arrIconsPng=null;this.bizLabels=null},proecessBizData:function(hW,h0){var hY=this;this.bizData=hW;this.objTextsPng=null;this.arrIconsPng=null;var T=hW.textsPng;var h2=hW.iconsPng;if(!T||!h2){return}var hZ=new Image();hZ.onload=function(){hY.objTextsPng=this;hY.calcIconAndTextInfo(h0);this.onload=null};hZ.src=this.base64Prefix+T;var h1=h2.length;var e=[];for(var hV=0;hV<h1;hV++){var hX=h2[hV];var hU=new Image();(function(i){hU.onload=function(){h1--;e[i]=this;if(h1===0){hY.arrIconsPng=e;hY.calcIconAndTextInfo(h0)}this.onload=null}})(hV);hU.src=this.base64Prefix+hX}},calcIconAndTextInfo:function(h3){if(this.objTextsPng&&this.arrIconsPng){var hZ=this.bizData;var hX=hZ.pois;var e=[];for(var h0=0,hW=hX.length;h0<hW;h0++){var hU=hX[h0];var hY=this.arrIconsPng[hU.iconPng];var hV=hY.height/2;var h2={type:"fixed",name:"",textImg:this.objTextsPng,iconImg:hY,rank:hU.rank,iconPos:{srcX:0,srcY:0,destX:-hY.width/2,destY:-hV/2,width:hY.width,height:hV,geoX:hU.x,geoY:hU.y,iconType:"vectorCustom"},textPos:this.calcTextPos(hU.pos,hY),startScale:hU.from<12?12:hU.from,guid:hU.guid,guidExt:1,adver_log:hU.adver_log||""};var T={type:"fixed",textDirLeft:"left",name:"",textImg:this.objTextsPng,iconImg:hY,rank:hU.rank,iconPos:{srcX:0,srcY:0,destX:-hY.width/2,destY:-hV/2,width:hY.width,height:hV,geoX:hU.x,geoY:hU.y,iconType:"vectorCustom"},textPos:this.calcTextPosLeft(hU.pos,hY),startScale:hU.from<12?12:hU.from,guid:hU.guid,guidExt:1,adver_log:hU.adver_log||""};var h1=[h2,T];e.push(h1)}this.bizLabels=e;h3&&h3()}},calcTextPos:function(hX,T){var i=[];var hW=hX.length/4;var hV=T.width/2;if(hW===1){var hU={srcX:hX[0],srcY:hX[1],destX:hV,destY:-hX[3]/2,width:hX[2],height:hX[3]};i.push(hU)}else{var hU={srcX:hX[0],srcY:hX[1],destX:hV,destY:-hX[3],width:hX[2],height:hX[3]};var e={srcX:hX[4],srcY:hX[5],destX:hV,destY:0,width:hX[6],height:hX[7]};i.push(hU);i.push(e)}return i},calcTextPosLeft:function(hX,T){var i=[];var hW=hX.length/4;var hV=T.width/2;if(hW===1){var hU={srcX:hX[0],srcY:hX[1],destX:-hV-hX[2],destY:-hX[3]/2,width:hX[2],height:hX[3]};i.push(hU)}else{var hU={srcX:hX[0],srcY:hX[1],destX:-hV-hX[2],destY:-hX[3],width:hX[2],height:hX[3]};var e={srcX:hX[4],srcY:hX[5],destX:-hV-hX[2],destY:0,width:hX[6],height:hX[7]};i.push(hU);i.push(e)}return i},clearBizData:function(){this.bizData=null;this.bizLabels=null}});function c7(){}C.extend(c7.prototype,{centerAndZoomIn:function(T,h0,h1){h1=h1||{};if(!this.loaded){this.firstTileLoad=false}h0=this._getProperZoom(h0).zoom;if(h1.noAnimation!==true&&this.loaded){var hW=this._ifUseAnimation(T,h0);if(hW){this.flyToIn(T,h0,h1);return}}var hY=this;if(!T&&!h0){return}this._stopAllAnimations();if(T&&!T.equals(this.centerPoint)){this.fire(new bb("oncenter_changed"))}if(h0&&h0!==this.zoomLevel){this.fire(new bb("onzoom_changed"))}T=T||this.centerPoint;h0=h0||this.zoomLevel;h0=this._getProperZoom(h0).zoom;if(this.mapType===BMAP_EARTH_MAP){if(!this._earth){this.mapType=BMAPGL_NORMAL_MAP;this.temp.originMapType=BMAP_EARTH_MAP;function hZ(){hY._earth=new bo.Earth(hY,{showRealSunlight:hY.config.showRealSunlight,showMilkyway:hY.config.showMilkyway,earthBackground:hY.config.earthBackground});hY._proxyEarthEvents();hY._changeEarthMapType(BMAP_EARTH_MAP);C.extend(hY,bo.EarthView.prototype);delete hY.temp.originMapType}ea.load("earth",function(){if(bo["FeatureStyle"+hY.config.style]){hZ()}else{hY.loadMapStyleFiles(function(){hZ()})}})}}this.lastLevel=this.zoomLevel||h0;this.zoomLevel=h0;var hX=new bb("onload");hX.point=T;hX.zoom=h0;this.centerPoint=new hv(T.lng,T.lat);this.defaultZoomLevel=this.defaultZoomLevel||this.zoomLevel;this.defaultCenter=this.defaultCenter||this.centerPoint;if(this.mapType!==BMAP_EARTH_MAP){this.centerPoint=this.restrictCenter(this.centerPoint)}if(!this.loaded&&!(this.temp.originMapType===BMAP_EARTH_MAP)){var i=this.config.defaultMaxBounds;var hV=new c5(i,"baidu",this.mapType);var hU=new cR({mapType:this.mapType,copyright:hV,dataType:this.mapType===BMAP_SATELLITE_MAP?eI:gw,customLayer:this.mapType===BMAP_SATELLITE_MAP,baseLayer:true,transparentPng:true,tileTypeName:this.mapType===BMAP_SATELLITE_MAP?"web":"na"});hU._isInnerLayer=true;this.addTileLayer(hU);if(this.mapType===BMAP_SATELLITE_MAP&&this._isHybridShow===true){this._addHybirdMap()}this.baseLayerAdded=true;this.on("zoom_changed",function(){if(this._heading===0){return}if(this.getZoom()<7&&this.config.restrictCenter===true){hY.resetHeading()}})}this.loaded=true;this.dispatchEvent(hX);h1.callback&&h1.callback()},_ifUseAnimation:function(hU,hZ){var hY=this.getSize();var T={zoom:this.zoomLevel};var h1={zoom:hZ};var h0=this.pointToPixelIn(this.centerPoint);var hV=this.pointToPixelIn(hU,T);var hX=this.pointToPixelIn(this.centerPoint,h1);var h3=this.pointToPixelIn(hU,h1);var hW=Math.abs(h0.x-hV.x);var i=Math.abs(h0.y-hV.y);var e=Math.abs(hX.x-h3.x);var h2=Math.abs(hX.y-h3.y);if((hW>hY.width||i>hY.height)&&(e>hY.width||h2>hY.height)){return false}return true},_setPlatformPosition:function(h1,h0,h3){h3=h3||{};if(h1===0&&h0===0&&!h3.point){return}if(isNaN(h3.initMapOffsetX)){h3.initMapOffsetX=this.offsetX}if(isNaN(h3.initMapOffsetY)){h3.initMapOffsetY=this.offsetY}var hX=dK(this._heading);if(this._tilt>0){h0=h0/Math.cos(dK(this._tilt))}var h2=h1*Math.cos(hX)+h0*Math.sin(hX);var hZ=-h1*Math.sin(hX)+h0*Math.cos(hX);h2=h2+h3.initMapOffsetX;hZ=hZ+h3.initMapOffsetY;if(h3.point){var i=this.restrictCenter(h3.point);if(!i.equals(this.centerPoint)){this.centerPoint=i.clone();this.fire(new bb("oncenter_changed"))}}else{var hU=this.offsetX-h2;var e=this.offsetY-hZ;var hY=this.centerPoint.lng;var hW=this.centerPoint.lat;var hV=new hv(hY,hW);var T=this.getZoomUnits();this.centerPoint=this.restrictCenter(new hv(hV.lng+hU*T,hV.lat-e*T),T);this.fire(new bb("oncenter_changed"))}this.offsetX=h2;this.offsetY=hZ;this.dispatchEvent(new bb("onmoving"))},restrictCenter:function(hU,hV){if(this.config.restrictCenter===false){return hU}hV=hV||this.getZoomUnits();var T=this.pixelToPointIn(new ej(0,0),{center:hU});var i=this.pixelToPointIn(new ej(0,this.height),{center:hU});if(this.zoomLevel<5){if(T.lat>c8.MAX_LAT&&i.lat<c8.MIN_LAT){var hW=c8.MAX_LAT-hU.lat;var e=hU.lat-c8.MIN_LAT;var hY;if(hW<e){hY=hW/(this.height/2)}else{hY=e/(this.height/2)}var hX=18-eD(hY);this.zoomLevel=hX;return hU}}if(T.lat>c8.MAX_LAT){hU.lat=c8.MAX_LAT-this.height/2*hV}else{if(i.lat<c8.MIN_LAT){hU.lat=c8.MIN_LAT+this.height/2*hV}}return hU},zoomTo:function(e,h5,h6){var h1=b6[this.mapType];if(!h1){return}var h0=this._getProperZoom(e);e=h0.zoom;if(this.zoomLevel===e){h6&&h6.callback&&h6.callback();return}var hW=e;this.lastLevel=this.zoomLevel;h6=h6||{};if(this.zoomEventStatus==="idle"){this.fire(new bb("onzoomstart"));this.zoomEventStatus="zooming"}if(!h5&&(this.getInfoWindow()&&this.temp.infoWin&&this.temp.infoWin.isOpen())){h5=en.convertLL2MC(this.getInfoWindow().getPoint())}var T=null;if(h6.fixPixel){T=h6.fixPixel}else{if(h5){T=this.pointToPixelIn(h5,{useRound:false})}}var hX=this.pixelToPointIn(T);var hY=this.centerPoint.clone();this.fixPoint=h5;this.fixPixel=T;this.fixCenter=hY;this.mousePosMCPoint=hX;if(h6.noAnimation){e=h0.zoom;this.zoomLevel=e;this.fire(new bb("onzoom_changed"));var hV=this.getCurrentMaxTilt();if(this._tilt>hV){this._tilt=hV}if(h5){if(this._heading%360!==0||this._tilt>0){var i=this._webglMapCamera.fromScreenPixelToMC(T.x,T.y,{center:hY,zoom:this.zoomLevel});if(i){var h2=i.sub(hX);var hU=hY.sub(h2);this.centerPoint=this.restrictCenter(hU)}}else{var hZ=this.getZoomUnits();var hU=new hv(h5.lng-hZ*(T.x-this.width/2),h5.lat+hZ*(T.y-this.height/2));this.centerPoint=this.restrictCenter(hU,hZ)}this.fire(new bb("oncenter_changed"))}this._checkFireZoomend();h6.callback&&h6.callback();return}this._animationInfo.zoom={current:this.zoomLevel,diff:e-this.zoomLevel,target:e};var h3=this;h3._checkFireZoomend();var h4=this._tilt;if(this.fixPoint||h4>c8.MAX_DRAG_TILT_L2){h6.renderCallback=function(){var ia=h3.getCurrentMaxTilt();if(h3._tilt>ia){h3._tilt=ia}var ib=h3.fixPixel;if(!h3.fixPixel||!h3.fixPoint){return}var h7=h3.fixPixel;var ii=h3.fixPoint;var ie=h3.fixCenter;var ic=h3.mousePosMCPoint;if(h3._heading%360!==0||h3._tilt>0){var h8=h3._webglMapCamera.fromScreenPixelToMC(h7.x,h7.y,{center:ie,zoom:h3.zoomLevel,tilt:h3._tilt});if(h8){var ih=h8.sub(ic);var h9=ie.sub(ih);h3.centerPoint=h3.restrictCenter(h9)}}else{var id=h7;var ig=h3.getZoomUnits();var h9=new hv(ii.lng-ig*(id.x-h3.width/2),ii.lat+ig*(id.y-h3.height/2));h3.centerPoint=h3.restrictCenter(h9,ig)}h3.fire(new bb("oncenter_changed"))}}if(h6.fromMouseWheel===true){this._startInfiniteZoomAnimation(h6);h6.callback&&h6.callback();return}this._startAnimation(h6)},_checkFireZoomend:function(){var e=this;if(e.fireZoomendTimer){clearTimeout(e.fireZoomendTimer)}e.fireZoomendTimer=setTimeout(function(){if(e.zoomEventStatus==="zooming"){e.fire(new bb("onzoomend"));e.zoomEventStatus="idle"}e.fireZoomendTimer=null},150)},deepZoomMedia:function(e){var i=this;if(!i.temp.isStdCtrlBusy){i.temp.isStdCtrlBusy=true;i.deepZoomTo(i.zoomLevel+e);setTimeout(function(){i.temp.isStdCtrlBusy=false},400)}},deepZoomTo:function(e){this.zoomTo(e)},flyToIn:function(T,iq,h9){h9=h9||{};var hV=this._getProperZoom(iq);iq=hV.zoom;if(this.centerPoint.equals(T)&&this.zoomLevel===iq&&typeof h9.heading!=="number"&&typeof h9.tilt!=="number"){return}var e=this.getHeading()%360;var h1=this.getTilt();var h7=0;var ib=0;var h4=this.getBounds().containsPoint(T);if(typeof h9.heading==="number"){h7=h9.heading}else{if(h4){h7=e}}if(typeof h9.tilt==="number"){ib=h9.tilt}else{if(h4){ib=h1}}this._heading=e;var im=h7-e;var ii=ib-h1;var h5=this;var hX=this.zoomLevel;var hY=1.42;var id=this.zoomScale(iq-hX);var it=this.getZoomUnits();var h3=this.centerPoint.div(it);var iu=T.div(it);var il=this.worldSize();var ih=hY;var ig=Math.max(this.width,this.height);var ie=ig/id;var h2=iu.sub(h3).mag();var i=ih*ih;function ip(iw){var iv=(ie*ie-ig*ig+(iw?-1:1)*i*i*h2*h2)/(2*(iw?ie:ig)*i*h2);return Math.log(Math.sqrt(iv*iv+1)-iv)}function hU(iv){return(Math.exp(iv)-Math.exp(-iv))/2}function hZ(iv){return(Math.exp(iv)+Math.exp(-iv))/2}function h8(iv){return hU(iv)/hZ(iv)}var h0=ip(0);var ij=function(iv){return(hZ(h0)/hZ(h0+ih*iv))};var ik=function(iv){return ig*((hZ(h0)*h8(h0+ih*iv)-hU(h0))/i)/h2};var hW=(ip(1)-h0)/ih;if(Math.abs(h2)<0.000001||hW===Infinity||isNaN(hW)){if(Math.abs(ig-ie)<0.000001){this._animationInfo.zoom={current:this.zoomLevel,diff:iq-this.zoomLevel};this._animationInfo.center={current:this.centerPoint,diff:T.sub(this.centerPoint)};this._animationInfo.heading={current:e,diff:h7-e};this._animationInfo.tilt={current:h1,diff:ib-h1};this.setLock(true);this._startAnimation({callback:function(iv){h5.setLock(false);if(h9.callback){h9.callback(iv)}},duration:h9.duration});return}var ir=ie<ig?-1:1;hW=Math.abs(Math.log(ie/ig))/ih;ik=function(){return 0};ij=function(iv){return Math.exp(ir*ih*iv)}}var io=1.7;if(hW<0.3){io=0.8}else{if(hW>5){io=(hW-5)/2+io}}var ia=h9.duration||1000*hW/io;if(isNaN(ia)){var ic={};for(var h6 in h9){ic[h6]=h9[h6];ic.noAnimation=true}this.centerAndZoomIn(T,iq,ic);return}this.fire(new bb("onmovestart"));this.fire(new bb("onzoomstart"));this.setLock(true);this._startAnimation({duration:ia,renderCallback:function(iv,iw){var ix=iv*hW;var iA=ik(ix);var iz=hX+h5.scaleZoom(1/ij(ix));if(iz<h5.getMinZoom()){iz=h5.getMinZoom()}if(iz>h5.getMaxZoom()){iz=h5.getMaxZoom()}if(iz!==h5.zoomLevel){h5.zoomLevel=iz;h5.fire(new bb("onzoom_changed"))}h5.centerPoint=h3.add(iu.sub(h3).mult(iA)).mult(it);h5.fire(new bb("oncenter_changed"));if(typeof h7==="number"){var iy=iv/0.7;if(iy>1){iy=1}h5.setHeading(e+im*iv,{noAnimation:true})}if(typeof ib==="number"){h5.setTilt(h1+ii*iv,{noAnimation:true})}},callback:function(iv,iw){h5.setLock(false);if(iw&&iw.stop===true){h5.fire(new bb("onmoveend"));h5.fire(new bb("onzoomend"));h9.callback&&h9.callback(iv);return}if(iq!==h5.zoomLevel){h5.zoomLevel=iq;h5.fire(new bb("onzoom_changed"))}h5.fire(new bb("onmoveend"));h5.fire(new bb("onzoomend"));h9.callback&&h9.callback(iv)}})},zoomScale:function(e){return Math.pow(2,e)},scaleZoom:function(e){return Math.log(e)/Math.LN2},panToIn:function(i,T){T=T||{};if(!i||i.equals(this.centerPoint)){T.callback&&T.callback();return}var hU=this.pointToPixelIn(i);var e=Math.round(this.width/2);var hW=Math.round(this.height/2);var hV=this._ifUseAnimation(i,this.zoomLevel);if(T.noAnimation===true||hV===false){this._stopAllAnimations();this._panToIn(e-hU.x,hW-hU.y,i);T.callback&&T.callback();return}this.flyToIn(i,this.zoomLevel,T)},_panToIn:function(i,e,hU){var T=this.temp;if(T.operating===true){return}if(T.dragAni){T.dragAni.stop(false,{readyToMove:true});T.dragAni=null}this.dispatchEvent(new bb("onmovestart"));this._setPlatformPosition(i,e,{point:hU});this.dispatchEvent(new bb("onmoveend"))},_stopAllAnimations:function(e){e=e||{};if(this._ani){this._ani.stop(!!e.goToEnd,{stopCurrentAnimation:e.stopCurrentAnimation});this._ani=null}if(this._infiniteAni){this._infiniteAni.stop();this._infiniteAni=null}},panBy:function(i,e,T){i=Math.round(i)||0;e=Math.round(e)||0;T=T||{};if(Math.abs(i)<=this.width&&Math.abs(e)<=this.height&&T.noAnimation!==true){this._panBy(i,e,T)}else{this._panToIn(i,e,T.point);T.callback&&T.callback()}},_panBy:function(i,e,hV){if(this.temp.operating===true){return}hV=hV||{};this.dispatchEvent(new bb("onmovestart"));var hU=this;var T=hU.temp;T.pl=hU.offsetX;T.pt=hU.offsetY;if(T.tlPan){T.tlPan.cancel()}if(T.dragAni){T.dragAni.stop(false,{readyToMove:true});T.dragAni=null}T.tlPan=new o({fps:hV.fps||hU.config.fps,duration:hV.duration||hU.config.actionDuration,transition:hV.transition||cn.easeInOutQuad,render:function(hW){this.terminative=hU.temp.operating;if(hU.temp.operating){return}hU._setPlatformPosition(i*hW,e*hW,{initMapOffsetX:T.pl,initMapOffsetY:T.pt})},finish:function(hW){hU.dispatchEvent(new bb("onmoveend"));hU.temp.tlPan=false;if(hU.temp.stopArrow===true){hU.temp.stopArrow=false;if(hU.temp.arrow!==0){hU._arrow()}}}})},_startAnimation:function(i){var hV=this._animationInfo;var T=this;i=i||{};if(T._ani){T._ani.stop(!!i.goToEnd,{stopCurrentAnimation:i.stopCurrentAnimation})}if(T._infiniteAni){T._infiniteAni.stop();T._infiniteAni=null}var hW=i.duration||500;var hX=i.transition||cn.ease;var e=new bb("onanimation_start");this.fire(e);if(i.unstopable){hV=this._animationInfoUnstopable}var hU=new o({duration:hW,transition:hX,render:function(h0,hZ){for(var hY in hV){if(!hV.hasOwnProperty(hY)){continue}var h2=hV[hY].current;var h1=hV[hY].diff;T._setValueTick(hY,h2,h1,h0)}if(i.renderCallback){i.renderCallback(h0,hZ)}},finish:function(hY){T.fire(new bb("onanimation_end"));if(i.unstopable){T._animationInfoUnstopable={};T._unstopableAni=null}else{T._ani=null;T._animationInfo={}}if(i.mapNeedCbk){i.mapNeedCbk()}if(i.callback){i.callback(hY)}},onStop:function(hY){hY=hY||{};T.fire(new bb("onanimation_end"));if(hY.stopCurrentAnimation){T._animationInfo={}}T._ani=null;if(i.mapNeedCbk){i.mapNeedCbk()}if(i.callback){i.callback(null,{stop:true})}}});if(i.unstopable){T._unstopableAni=hU}else{T._ani=hU}},_startInfiniteZoomAnimation:function(e){var i=this;if(i._ani){i._ani.stop(!!e.goToEnd,{stopCurrentAnimation:e.stopCurrentAnimation})}if(i._infiniteAni){return}this.fire(new bb("onanimation_start"));i._infiniteAni=new o({duration:10000,transition:cn.linear,render:function(){var T=i._animationInfo.zoom;if(Math.abs(T.current-T.target)<0.001){i._setValue("zoom",T.target);i._infiniteAni.stop();return}T.current+=(T.target-T.current)*0.35;i._setValue("zoom",T.current);if(e.renderCallback){e.renderCallback()}},finish:function(){i._infiniteAni=null;i._animationInfo={};i.fire(new bb("onanimation_end"));if(e.callback){e.callback()}},onStop:function(){i._infiniteAni=null;i._animationInfo={};i.fire(new bb("onanimation_end"));if(e.callback){e.callback()}}})},_setValue:function(e,T){if(e==="zoom"){this._preZoomLevel=this.zoomLevel;var i=this._getProperZoom(T);T=i.zoom;if(T!==this.zoomLevel){this.zoomLevel=T;if(T<5){this.restrictCenter(this.centerPoint)}this.fire(new bb("on"+e+"_changed"))}return}else{if(e==="center"){this.centerPoint=T}}this["_"+e]=T;this.fire(new bb("on"+e+"_changed"))},_setValueTick:function(e,hV,hU,i){if(e==="center"){var T=new hv(hV.lng+hU.lng*i,hV.lat+hU.lat*i);this._setValue(e,T);return}if(e==="zoom"){this._setValue(e,Math.pow(hV,1-i)*Math.pow(hV+hU,i));return}this._setValue(e,hV+hU*i)},setHeading:function(hU,i){i=i||{};if(hU===this._heading){i.callback&&i.callback();return}var T=f2(this._heading,360);var e=f2(hU,360);if(e===T){this._heading=hU;i.callback&&i.callback();return}if(i.noAnimation){this._setValue("heading",hU);i.callback&&i.callback();return}if(i.unstopable){this._animationInfoUnstopable.heading={current:this._heading,diff:hU-this._heading}}else{this._animationInfo.heading={current:this._heading,diff:hU-this._heading}}this._startAnimation(i)},resetHeading:function(e){var i=this._heading;while(i<0){i+=360}i=i%360;if(i>180){i-=360}this._heading=i;e=e||{};e.unstopable=true;this.setHeading(0,e)},getHeading:function(){return this._heading},setTilt:function(e,i){i=i||{};if(e===this._tilt){i.callback&&i.callback();return}if(e>c8.MAX_TILT){e=c8.MAX_TILT}if(e<c8.MIN_TILT){e=c8.MIN_TILT}if(i&&i.noAnimation){this._setValue("tilt",e);i.callback&&i.callback();return}this._animationInfo.tilt={current:this._tilt,diff:e-this._tilt};this._startAnimation(i)},getTilt:function(){return this._tilt},getCenterIn:function(){return this.centerPoint},getZoom:function(){return this.zoomLevel},getCameraPosition:function(T){T=T||{};var e=T.center||this.centerPoint;var hU=T.zoom||this.zoomLevel;var hX=typeof T.heading==="number"?T.heading:this._heading;var i=typeof T.tilt==="number"?T.tilt:this._tilt;var hW=this._webglMapCamera.generateMVMatrix(e,hU,hX,i);var hV=mat4.create(Float32Array);mat4.invert(hV,hW);return this._webglMapCamera.getPosition(hV)}});function fR(i){this._jobQueue=[];this._idleOnlyJobQueue=[];var e=this;this.isIdle=true;i.on("updateframe",function(hU){var T=12-hU.frameTime;T=T<1?1:T;e.isIdle=false;if(e.idleWorkTimer){clearInterval(e.idleWorkTimer);e.idleWorkTimer=null}e.runJobs(T)});this._idleWorkerTicker=(function(T){return function(){if(T.isIdle){T.runJobs();T.runIdleOnlyJobs()}}})(this);i.on("mapglidle",function(){e.isIdle=true;e.runJobs();e.runIdleOnlyJobs();e.idleWorkTimer=setInterval(e._idleWorkerTicker,fR.MAX_IDLE_TIME)})}fR.MAX_IDLE_TIME=50;fR.MAX_FRAME_TIME=6;fR.prototype.runJobs=function(i){if(this._jobQueue.length===0){return}var hU=fE();var e=0;i=i||fR.MAX_FRAME_TIME;while(this._jobQueue.length&&e<i){var T=this._jobQueue.shift();if(T.state!=="invalid"){T.call()}e=fE()-hU}};fR.prototype.runIdleOnlyJobs=function(){if(this._idleOnlyJobQueue.length===0){return}var T=fE();var e=0;while(this._idleOnlyJobQueue.length&&e<fR.MAX_IDLE_TIME){var i=this._idleOnlyJobQueue.shift();if(i.state!=="invalid"){i.call()}e=fE()-T}};fR.prototype.checkIdleRunning=function(){if(this.isIdle&&!this.idleWorkTimer){this.runJobs();this.runIdleOnlyJobs();this.idleWorkTimer=setInterval(this._idleWorkerTicker,50)}};fR.prototype.addJob=function(e){this._jobQueue.push(e);this.checkIdleRunning()};fR.prototype.clearJobs=function(){this._jobQueue.length=0;this._idleOnlyJobQueue.length=0};fR.prototype.addIdleOnlyJob=function(e){this._idleOnlyJobQueue.push(e);this.checkIdleRunning()};var cb={};(function(hX){if(!h1){var h1=0.000001}if(!i){var i=(typeof Float32Array!=="undefined")?Float32Array:Array}if(!hV){var hV=Math.random}var T={};var hW=Math.PI/180;T.toRadian=function(h2){return h2*hW};var h0={};h0.create=function(h3){h3=h3||i;var h2=new h3(2);h2[0]=0;h2[1]=0;return h2};h0.clone=function(h2,h4){h4=h4||i;var h3=new h4(2);h3[0]=h2[0];h3[1]=h2[1];return h3};h0.fromValues=function(h2,h5,h4){h4=h4||i;var h3=new h4(2);h3[0]=h2;h3[1]=h5;return h3};h0.copy=function(h3,h2){h3[0]=h2[0];h3[1]=h2[1];return h3};h0.set=function(h3,h2,h4){h3[0]=h2;h3[1]=h4;return h3};h0.add=function(h4,h3,h2){h4[0]=h3[0]+h2[0];h4[1]=h3[1]+h2[1];return h4};h0.subtract=function(h4,h3,h2){h4[0]=h3[0]-h2[0];h4[1]=h3[1]-h2[1];return h4};h0.sub=h0.subtract;h0.multiply=function(h4,h3,h2){h4[0]=h3[0]*h2[0];h4[1]=h3[1]*h2[1];return h4};h0.mul=h0.multiply;h0.divide=function(h4,h3,h2){h4[0]=h3[0]/h2[0];h4[1]=h3[1]/h2[1];return h4};h0.div=h0.divide;h0.min=function(h4,h3,h2){h4[0]=Math.min(h3[0],h2[0]);h4[1]=Math.min(h3[1],h2[1]);return h4};h0.max=function(h4,h3,h2){h4[0]=Math.max(h3[0],h2[0]);h4[1]=Math.max(h3[1],h2[1]);return h4};h0.scale=function(h4,h3,h2){h4[0]=h3[0]*h2;h4[1]=h3[1]*h2;return h4};h0.scaleAndAdd=function(h4,h3,h2,h5){h4[0]=h3[0]+(h2[0]*h5);h4[1]=h3[1]+(h2[1]*h5);return h4};h0.distance=function(h4,h3){var h2=h3[0]-h4[0],h5=h3[1]-h4[1];return Math.sqrt(h2*h2+h5*h5)};h0.dist=h0.distance;h0.squaredDistance=function(h4,h3){var h2=h3[0]-h4[0],h5=h3[1]-h4[1];return h2*h2+h5*h5};h0.sqrDist=h0.squaredDistance;h0.length=function(h3){var h2=h3[0],h4=h3[1];return Math.sqrt(h2*h2+h4*h4)};h0.len=h0.length;h0.squaredLength=function(h3){var h2=h3[0],h4=h3[1];return h2*h2+h4*h4};h0.sqrLen=h0.squaredLength;h0.negate=function(h3,h2){h3[0]=-h2[0];h3[1]=-h2[1];return h3};h0.normalize=function(h5,h4){var h3=h4[0],h6=h4[1];var h2=h3*h3+h6*h6;if(h2>0){h2=1/Math.sqrt(h2);h5[0]=h4[0]*h2;h5[1]=h4[1]*h2}return h5};h0.dot=function(h3,h2){return h3[0]*h2[0]+h3[1]*h2[1]};h0.cross=function(h4,h3,h2){var h5=h3[0]*h2[1]-h3[1]*h2[0];h4[0]=h4[1]=0;h4[2]=h5;return h4};h0.lerp=function(h4,h3,h2,h5){var h7=h3[0],h6=h3[1];h4[0]=h7+h5*(h2[0]-h7);h4[1]=h6+h5*(h2[1]-h6);return h4};h0.random=function(h2,h4){h4=h4||1;var h3=hV()*2*Math.PI;h2[0]=Math.cos(h3)*h4;h2[1]=Math.sin(h3)*h4;return h2};h0.transformMat2=function(h5,h4,h3){var h2=h4[0],h6=h4[1];h5[0]=h3[0]*h2+h3[2]*h6;h5[1]=h3[1]*h2+h3[3]*h6;return h5};h0.transformMat2d=function(h5,h4,h3){var h2=h4[0],h6=h4[1];h5[0]=h3[0]*h2+h3[2]*h6+h3[4];h5[1]=h3[1]*h2+h3[3]*h6+h3[5];return h5};h0.transformMat3=function(h5,h4,h3){var h2=h4[0],h6=h4[1];h5[0]=h3[0]*h2+h3[3]*h6+h3[6];h5[1]=h3[1]*h2+h3[4]*h6+h3[7];return h5};h0.transformMat4=function(h5,h4,h3){var h2=h4[0],h6=h4[1];h5[0]=h3[0]*h2+h3[4]*h6+h3[12];h5[1]=h3[1]*h2+h3[5]*h6+h3[13];return h5};h0.rotate=function(h5,h3,h2,h9){var h8=h3[0]-h2[0];var h7=h3[1]-h2[1];var h4=Math.sin(h9);var h6=Math.cos(h9);h5[0]=h8*h6-h7*h4+h2[0];h5[1]=h8*h4+h7*h6+h2[1];return h5};h0.forEach=(function(){var h2=h0.create();return function(h5,h9,ia,h8,h7,h3){var h6,h4;if(!h9){h9=2}if(!ia){ia=0}if(h8){h4=Math.min((h8*h9)+ia,h5.length)}else{h4=h5.length}for(h6=ia;h6<h4;h6+=h9){h2[0]=h5[h6];h2[1]=h5[h6+1];h7(h2,h2,h3);h5[h6]=h2[0];h5[h6+1]=h2[1]}return h5}})();h0.str=function(h2){return"vec2("+h2[0]+", "+h2[1]+")"};hX.vec2=h0;var hZ={};hZ.create=function(h3){h3=h3||i;var h2=new h3(3);h2[0]=0;h2[1]=0;h2[2]=0;return h2};hZ.clone=function(h2,h4){h4=h4||i;var h3=new h4(3);h3[0]=h2[0];h3[1]=h2[1];h3[2]=h2[2];return h3};hZ.fromValues=function(h2,h6,h4,h5){h5=h5||i;var h3=new h5(3);h3[0]=h2;h3[1]=h6;h3[2]=h4;return h3};hZ.copy=function(h3,h2){h3[0]=h2[0];h3[1]=h2[1];h3[2]=h2[2];return h3};hZ.set=function(h3,h2,h5,h4){h3[0]=h2;h3[1]=h5;h3[2]=h4;return h3};hZ.add=function(h4,h3,h2){h4[0]=h3[0]+h2[0];h4[1]=h3[1]+h2[1];h4[2]=h3[2]+h2[2];return h4};hZ.subtract=function(h4,h3,h2){h4[0]=h3[0]-h2[0];h4[1]=h3[1]-h2[1];h4[2]=h3[2]-h2[2];return h4};hZ.sub=hZ.subtract;hZ.multiply=function(h4,h3,h2){h4[0]=h3[0]*h2[0];h4[1]=h3[1]*h2[1];h4[2]=h3[2]*h2[2];return h4};hZ.mul=hZ.multiply;hZ.divide=function(h4,h3,h2){h4[0]=h3[0]/h2[0];h4[1]=h3[1]/h2[1];h4[2]=h3[2]/h2[2];return h4};hZ.div=hZ.divide;hZ.min=function(h4,h3,h2){h4[0]=Math.min(h3[0],h2[0]);h4[1]=Math.min(h3[1],h2[1]);h4[2]=Math.min(h3[2],h2[2]);return h4};hZ.max=function(h4,h3,h2){h4[0]=Math.max(h3[0],h2[0]);h4[1]=Math.max(h3[1],h2[1]);h4[2]=Math.max(h3[2],h2[2]);return h4};hZ.scale=function(h4,h3,h2){h4[0]=h3[0]*h2;h4[1]=h3[1]*h2;h4[2]=h3[2]*h2;return h4};hZ.scaleAndAdd=function(h4,h3,h2,h5){h4[0]=h3[0]+(h2[0]*h5);h4[1]=h3[1]+(h2[1]*h5);h4[2]=h3[2]+(h2[2]*h5);return h4};hZ.distance=function(h4,h3){var h2=h3[0]-h4[0],h6=h3[1]-h4[1],h5=h3[2]-h4[2];return Math.sqrt(h2*h2+h6*h6+h5*h5)};hZ.dist=hZ.distance;hZ.squaredDistance=function(h4,h3){var h2=h3[0]-h4[0],h6=h3[1]-h4[1],h5=h3[2]-h4[2];return h2*h2+h6*h6+h5*h5};hZ.sqrDist=hZ.squaredDistance;hZ.length=function(h3){var h2=h3[0],h5=h3[1],h4=h3[2];return Math.sqrt(h2*h2+h5*h5+h4*h4)};hZ.len=hZ.length;hZ.squaredLength=function(h3){var h2=h3[0],h5=h3[1],h4=h3[2];return h2*h2+h5*h5+h4*h4};hZ.sqrLen=hZ.squaredLength;hZ.negate=function(h3,h2){h3[0]=-h2[0];h3[1]=-h2[1];h3[2]=-h2[2];return h3};hZ.normalize=function(h5,h4){var h3=h4[0],h7=h4[1],h6=h4[2];var h2=h3*h3+h7*h7+h6*h6;if(h2>0){h2=1/Math.sqrt(h2);h5[0]=h4[0]*h2;h5[1]=h4[1]*h2;h5[2]=h4[2]*h2}return h5};hZ.dot=function(h3,h2){return h3[0]*h2[0]+h3[1]*h2[1]+h3[2]*h2[2]};hZ.cross=function(h3,h8,h7){var h2=h8[0],ia=h8[1],h9=h8[2],h6=h7[0],h5=h7[1],h4=h7[2];h3[0]=ia*h4-h9*h5;h3[1]=h9*h6-h2*h4;h3[2]=h2*h5-ia*h6;return h3};hZ.lerp=function(h4,h3,h2,h5){var h8=h3[0],h7=h3[1],h6=h3[2];h4[0]=h8+h5*(h2[0]-h8);h4[1]=h7+h5*(h2[1]-h7);h4[2]=h6+h5*(h2[2]-h6);return h4};hZ.random=function(h2,h6){h6=h6||1;var h4=hV()*2*Math.PI;var h5=(hV()*2)-1;var h3=Math.sqrt(1-h5*h5)*h6;h2[0]=Math.cos(h4)*h3;h2[1]=Math.sin(h4)*h3;h2[2]=h5*h6;return h2};hZ.transformMat4=function(h5,h4,h3){var h2=h4[0],h7=h4[1],h6=h4[2];h5[0]=h3[0]*h2+h3[4]*h7+h3[8]*h6+h3[12];h5[1]=h3[1]*h2+h3[5]*h7+h3[9]*h6+h3[13];h5[2]=h3[2]*h2+h3[6]*h7+h3[10]*h6+h3[14];return h5};hZ.transformMat3=function(h5,h4,h3){var h2=h4[0],h7=h4[1],h6=h4[2];h5[0]=h2*h3[0]+h7*h3[3]+h6*h3[6];h5[1]=h2*h3[1]+h7*h3[4]+h6*h3[7];h5[2]=h2*h3[2]+h7*h3[5]+h6*h3[8];return h5};hZ.transformQuat=function(h8,ie,h2){var ig=ie[0],id=ie[1],ic=ie[2],ia=h2[0],h9=h2[1],h7=h2[2],ib=h2[3],h5=ib*ig+h9*ic-h7*id,h4=ib*id+h7*ig-ia*ic,h3=ib*ic+ia*id-h9*ig,h6=-ia*ig-h9*id-h7*ic;h8[0]=h5*ib+h6*-ia+h4*-h7-h3*-h9;h8[1]=h4*ib+h6*-h9+h3*-ia-h5*-h7;h8[2]=h3*ib+h6*-h7+h5*-h9-h4*-ia;return h8};hZ.rotateX=function(h4,h3,h2,h7){var h6=[],h5=[];h6[0]=h3[0]-h2[0];h6[1]=h3[1]-h2[1];h6[2]=h3[2]-h2[2];h5[0]=h6[0];h5[1]=h6[1]*Math.cos(h7)-h6[2]*Math.sin(h7);h5[2]=h6[1]*Math.sin(h7)+h6[2]*Math.cos(h7);h4[0]=h5[0]+h2[0];h4[1]=h5[1]+h2[1];h4[2]=h5[2]+h2[2];return h4};hZ.rotateY=function(h4,h3,h2,h7){var h6=[],h5=[];h6[0]=h3[0]-h2[0];h6[1]=h3[1]-h2[1];h6[2]=h3[2]-h2[2];h5[0]=h6[2]*Math.sin(h7)+h6[0]*Math.cos(h7);h5[1]=h6[1];h5[2]=h6[2]*Math.cos(h7)-h6[0]*Math.sin(h7);h4[0]=h5[0]+h2[0];h4[1]=h5[1]+h2[1];h4[2]=h5[2]+h2[2];return h4};hZ.rotateZ=function(h4,h3,h2,h7){var h6=[],h5=[];h6[0]=h3[0]-h2[0];h6[1]=h3[1]-h2[1];h6[2]=h3[2]-h2[2];h5[0]=h6[0]*Math.cos(h7)-h6[1]*Math.sin(h7);h5[1]=h6[0]*Math.sin(h7)+h6[1]*Math.cos(h7);h5[2]=h6[2];h4[0]=h5[0]+h2[0];h4[1]=h5[1]+h2[1];h4[2]=h5[2]+h2[2];return h4};hZ.forEach=(function(){var h2=hZ.create();return function(h5,h9,ia,h8,h7,h3){var h6,h4;if(!h9){h9=3}if(!ia){ia=0}if(h8){h4=Math.min((h8*h9)+ia,h5.length)}else{h4=h5.length}for(h6=ia;h6<h4;h6+=h9){h2[0]=h5[h6];h2[1]=h5[h6+1];h2[2]=h5[h6+2];h7(h2,h2,h3);h5[h6]=h2[0];h5[h6+1]=h2[1];h5[h6+2]=h2[2]}return h5}})();hZ.str=function(h2){return"vec3("+h2[0]+", "+h2[1]+", "+h2[2]+")"};hX.vec3=hZ;var hY={};hY.create=function(h3){h3=h3||i;var h2=new h3(4);h2[0]=0;h2[1]=0;h2[2]=0;h2[3]=0;return h2};hY.clone=function(h2,h4){h4=h4||i;var h3=new h4(4);h3[0]=h2[0];h3[1]=h2[1];h3[2]=h2[2];h3[3]=h2[3];return h3};hY.fromValues=function(h2,h7,h5,h3,h6){h6=h6||i;var h4=new h6(4);h4[0]=h2;h4[1]=h7;h4[2]=h5;h4[3]=h3;return h4};hY.copy=function(h3,h2){h3[0]=h2[0];h3[1]=h2[1];h3[2]=h2[2];h3[3]=h2[3];return h3};hY.set=function(h4,h2,h6,h5,h3){h4[0]=h2;h4[1]=h6;h4[2]=h5;h4[3]=h3;return h4};hY.add=function(h4,h3,h2){h4[0]=h3[0]+h2[0];h4[1]=h3[1]+h2[1];h4[2]=h3[2]+h2[2];h4[3]=h3[3]+h2[3];return h4};hY.subtract=function(h4,h3,h2){h4[0]=h3[0]-h2[0];h4[1]=h3[1]-h2[1];h4[2]=h3[2]-h2[2];h4[3]=h3[3]-h2[3];return h4};hY.sub=hY.subtract;hY.multiply=function(h4,h3,h2){h4[0]=h3[0]*h2[0];h4[1]=h3[1]*h2[1];h4[2]=h3[2]*h2[2];h4[3]=h3[3]*h2[3];return h4};hY.mul=hY.multiply;hY.divide=function(h4,h3,h2){h4[0]=h3[0]/h2[0];h4[1]=h3[1]/h2[1];h4[2]=h3[2]/h2[2];h4[3]=h3[3]/h2[3];return h4};hY.div=hY.divide;hY.min=function(h4,h3,h2){h4[0]=Math.min(h3[0],h2[0]);h4[1]=Math.min(h3[1],h2[1]);h4[2]=Math.min(h3[2],h2[2]);h4[3]=Math.min(h3[3],h2[3]);return h4};hY.max=function(h4,h3,h2){h4[0]=Math.max(h3[0],h2[0]);h4[1]=Math.max(h3[1],h2[1]);h4[2]=Math.max(h3[2],h2[2]);h4[3]=Math.max(h3[3],h2[3]);return h4};hY.scale=function(h4,h3,h2){h4[0]=h3[0]*h2;h4[1]=h3[1]*h2;h4[2]=h3[2]*h2;h4[3]=h3[3]*h2;return h4};hY.scaleAndAdd=function(h4,h3,h2,h5){h4[0]=h3[0]+(h2[0]*h5);h4[1]=h3[1]+(h2[1]*h5);h4[2]=h3[2]+(h2[2]*h5);h4[3]=h3[3]+(h2[3]*h5);return h4};hY.distance=function(h5,h3){var h2=h3[0]-h5[0],h7=h3[1]-h5[1],h6=h3[2]-h5[2],h4=h3[3]-h5[3];return Math.sqrt(h2*h2+h7*h7+h6*h6+h4*h4)};hY.dist=hY.distance;hY.squaredDistance=function(h5,h3){var h2=h3[0]-h5[0],h7=h3[1]-h5[1],h6=h3[2]-h5[2],h4=h3[3]-h5[3];return h2*h2+h7*h7+h6*h6+h4*h4};hY.sqrDist=hY.squaredDistance;hY.length=function(h4){var h2=h4[0],h6=h4[1],h5=h4[2],h3=h4[3];return Math.sqrt(h2*h2+h6*h6+h5*h5+h3*h3)};hY.len=hY.length;hY.squaredLength=function(h4){var h2=h4[0],h6=h4[1],h5=h4[2],h3=h4[3];return h2*h2+h6*h6+h5*h5+h3*h3};hY.sqrLen=hY.squaredLength;hY.negate=function(h3,h2){h3[0]=-h2[0];h3[1]=-h2[1];h3[2]=-h2[2];h3[3]=-h2[3];return h3};hY.normalize=function(h6,h5){var h3=h5[0],h8=h5[1],h7=h5[2],h4=h5[3];var h2=h3*h3+h8*h8+h7*h7+h4*h4;if(h2>0){h2=1/Math.sqrt(h2);h6[0]=h5[0]*h2;h6[1]=h5[1]*h2;h6[2]=h5[2]*h2;h6[3]=h5[3]*h2}return h6};hY.dot=function(h3,h2){return h3[0]*h2[0]+h3[1]*h2[1]+h3[2]*h2[2]+h3[3]*h2[3]};hY.lerp=function(h4,h3,h2,h5){var h8=h3[0],h7=h3[1],h6=h3[2],h9=h3[3];h4[0]=h8+h5*(h2[0]-h8);h4[1]=h7+h5*(h2[1]-h7);h4[2]=h6+h5*(h2[2]-h6);h4[3]=h9+h5*(h2[3]-h9);return h4};hY.random=function(h2,h3){h3=h3||1;h2[0]=hV();h2[1]=hV();h2[2]=hV();h2[3]=hV();hY.normalize(h2,h2);hY.scale(h2,h2,h3);return h2};hY.transformMat4=function(h6,h5,h3){var h2=h5[0],h8=h5[1],h7=h5[2],h4=h5[3];h6[0]=h3[0]*h2+h3[4]*h8+h3[8]*h7+h3[12]*h4;h6[1]=h3[1]*h2+h3[5]*h8+h3[9]*h7+h3[13]*h4;h6[2]=h3[2]*h2+h3[6]*h8+h3[10]*h7+h3[14]*h4;h6[3]=h3[3]*h2+h3[7]*h8+h3[11]*h7+h3[15]*h4;return h6};hY.transformQuat=function(h8,ie,h2){var ig=ie[0],id=ie[1],ic=ie[2],ia=h2[0],h9=h2[1],h7=h2[2],ib=h2[3],h5=ib*ig+h9*ic-h7*id,h4=ib*id+h7*ig-ia*ic,h3=ib*ic+ia*id-h9*ig,h6=-ia*ig-h9*id-h7*ic;h8[0]=h5*ib+h6*-ia+h4*-h7-h3*-h9;h8[1]=h4*ib+h6*-h9+h3*-ia-h5*-h7;h8[2]=h3*ib+h6*-h7+h5*-h9-h4*-ia;return h8};hY.forEach=(function(){var h2=hY.create();return function(h5,h9,ia,h8,h7,h3){var h6,h4;if(!h9){h9=4}if(!ia){ia=0}if(h8){h4=Math.min((h8*h9)+ia,h5.length)}else{h4=h5.length}for(h6=ia;h6<h4;h6+=h9){h2[0]=h5[h6];h2[1]=h5[h6+1];h2[2]=h5[h6+2];h2[3]=h5[h6+3];h7(h2,h2,h3);h5[h6]=h2[0];h5[h6+1]=h2[1];h5[h6+2]=h2[2];h5[h6+3]=h2[3]}return h5}})();hY.str=function(h2){return"vec4("+h2[0]+", "+h2[1]+", "+h2[2]+", "+h2[3]+")"};hX.vec4=hY;var hU={};hU.create=function(h3){h3=h3||i;var h2=new h3(4);h2[0]=1;h2[1]=0;h2[2]=0;h2[3]=1;return h2};hU.clone=function(h2,h4){h4=h4||i;var h3=new h4(4);h3[0]=h2[0];h3[1]=h2[1];h3[2]=h2[2];h3[3]=h2[3];return h3};hU.copy=function(h3,h2){h3[0]=h2[0];h3[1]=h2[1];h3[2]=h2[2];h3[3]=h2[3];return h3};hU.identity=function(h2){h2[0]=1;h2[1]=0;h2[2]=0;h2[3]=1;return h2};hU.transpose=function(h4,h3){if(h4===h3){var h2=h3[1];h4[1]=h3[2];h4[2]=h2}else{h4[0]=h3[0];h4[1]=h3[2];h4[2]=h3[1];h4[3]=h3[3]}return h4};hU.invert=function(h6,h4){var h5=h4[0],h3=h4[1],h2=h4[2],h8=h4[3],h7=h5*h8-h2*h3;if(!h7){return null}h7=1/h7;h6[0]=h8*h7;h6[1]=-h3*h7;h6[2]=-h2*h7;h6[3]=h5*h7;return h6};hU.adjoint=function(h4,h2){var h3=h2[0];h4[0]=h2[3];h4[1]=-h2[1];h4[2]=-h2[2];h4[3]=h3;return h4};hU.determinant=function(h2){return h2[0]*h2[3]-h2[2]*h2[1]};hU.multiply=function(h6,ib,h9){var h5=ib[0],h4=ib[1],h3=ib[2],h2=ib[3];var ic=h9[0],ia=h9[1],h8=h9[2],h7=h9[3];h6[0]=h5*ic+h3*ia;h6[1]=h4*ic+h2*ia;h6[2]=h5*h8+h3*h7;h6[3]=h4*h8+h2*h7;return h6};hU.mul=hU.multiply;hU.rotate=function(h6,h9,h8){var h5=h9[0],h4=h9[1],h3=h9[2],h2=h9[3],ia=Math.sin(h8),h7=Math.cos(h8);h6[0]=h5*h7+h3*ia;h6[1]=h4*h7+h2*ia;h6[2]=h5*-ia+h3*h7;h6[3]=h4*-ia+h2*h7;return h6};hU.scale=function(h6,h7,h9){var h5=h7[0],h4=h7[1],h3=h7[2],h2=h7[3],ia=h9[0],h8=h9[1];h6[0]=h5*ia;h6[1]=h4*ia;h6[2]=h3*h8;h6[3]=h2*h8;return h6};hU.str=function(h2){return"mat2("+h2[0]+", "+h2[1]+", "+h2[2]+", "+h2[3]+")"};hU.frob=function(h2){return(Math.sqrt(Math.pow(h2[0],2)+Math.pow(h2[1],2)+Math.pow(h2[2],2)+Math.pow(h2[3],2)))};hU.LDU=function(h2,h5,h4,h3){h2[2]=h3[2]/h3[0];h4[0]=h3[0];h4[1]=h3[1];h4[3]=h3[3]-h2[2]*h4[1];return[h2,h5,h4]};hX.mat2=hU;var e={};e.create=function(h3){h3=h3||i;var h2=new h3(16);h2[0]=1;h2[1]=0;h2[2]=0;h2[3]=0;h2[4]=0;h2[5]=1;h2[6]=0;h2[7]=0;h2[8]=0;h2[9]=0;h2[10]=1;h2[11]=0;h2[12]=0;h2[13]=0;h2[14]=0;h2[15]=1;return h2};e.clone=function(h2){var h3=new i(16);h3[0]=h2[0];h3[1]=h2[1];h3[2]=h2[2];h3[3]=h2[3];h3[4]=h2[4];h3[5]=h2[5];h3[6]=h2[6];h3[7]=h2[7];h3[8]=h2[8];h3[9]=h2[9];h3[10]=h2[10];h3[11]=h2[11];h3[12]=h2[12];h3[13]=h2[13];h3[14]=h2[14];h3[15]=h2[15];return h3};e.copy=function(h3,h2){h3[0]=h2[0];h3[1]=h2[1];h3[2]=h2[2];h3[3]=h2[3];h3[4]=h2[4];h3[5]=h2[5];h3[6]=h2[6];h3[7]=h2[7];h3[8]=h2[8];h3[9]=h2[9];h3[10]=h2[10];h3[11]=h2[11];h3[12]=h2[12];h3[13]=h2[13];h3[14]=h2[14];h3[15]=h2[15];return h3};e.identity=function(h2){h2[0]=1;h2[1]=0;h2[2]=0;h2[3]=0;h2[4]=0;h2[5]=1;h2[6]=0;h2[7]=0;h2[8]=0;h2[9]=0;h2[10]=1;h2[11]=0;h2[12]=0;h2[13]=0;h2[14]=0;h2[15]=1;return h2};e.transpose=function(h5,h4){if(h5===h4){var h9=h4[1],h7=h4[2],h6=h4[3],h2=h4[6],h8=h4[7],h3=h4[11];h5[1]=h4[4];h5[2]=h4[8];h5[3]=h4[12];h5[4]=h9;h5[6]=h4[9];h5[7]=h4[13];h5[8]=h7;h5[9]=h2;h5[11]=h4[14];h5[12]=h6;h5[13]=h8;h5[14]=h3}else{h5[0]=h4[0];h5[1]=h4[4];h5[2]=h4[8];h5[3]=h4[12];h5[4]=h4[1];h5[5]=h4[5];h5[6]=h4[9];h5[7]=h4[13];h5[8]=h4[2];h5[9]=h4[6];h5[10]=h4[10];h5[11]=h4[14];h5[12]=h4[3];h5[13]=h4[7];h5[14]=h4[11];h5[15]=h4[15]}return h5};e.invert=function(im,it){var ix=it[0],iv=it[1],iu=it[2],iq=it[3],h6=it[4],h5=it[5],h4=it[6],h3=it[7],il=it[8],ik=it[9],ij=it[10],ii=it[11],iz=it[12],iy=it[13],iw=it[14],ir=it[15],ih=ix*h5-iv*h6,ig=ix*h4-iu*h6,ie=ix*h3-iq*h6,id=iv*h4-iu*h5,ic=iv*h3-iq*h5,ib=iu*h3-iq*h4,ia=il*iy-ik*iz,h9=il*iw-ij*iz,h8=il*ir-ii*iz,h7=ik*iw-ij*iy,ip=ik*ir-ii*iy,io=ij*ir-ii*iw,h2=ih*io-ig*ip+ie*h7+id*h8-ic*h9+ib*ia;if(!h2){return null}h2=1/h2;im[0]=(h5*io-h4*ip+h3*h7)*h2;im[1]=(iu*ip-iv*io-iq*h7)*h2;im[2]=(iy*ib-iw*ic+ir*id)*h2;im[3]=(ij*ic-ik*ib-ii*id)*h2;im[4]=(h4*h8-h6*io-h3*h9)*h2;im[5]=(ix*io-iu*h8+iq*h9)*h2;im[6]=(iw*ie-iz*ib-ir*ig)*h2;im[7]=(il*ib-ij*ie+ii*ig)*h2;im[8]=(h6*ip-h5*h8+h3*ia)*h2;im[9]=(iv*h8-ix*ip-iq*ia)*h2;im[10]=(iz*ic-iy*ie+ir*ih)*h2;im[11]=(ik*ie-il*ic-ii*ih)*h2;im[12]=(h5*h9-h6*h7-h4*ia)*h2;im[13]=(ix*h7-iv*h9+iu*ia)*h2;im[14]=(iy*ig-iz*id-iw*ih)*h2;im[15]=(il*id-ik*ig+ij*ih)*h2;return im};e.adjoint=function(ia,id){var ii=id[0],ig=id[1],ie=id[2],ib=id[3],h5=id[4],h4=id[5],h3=id[6],h2=id[7],h9=id[8],h8=id[9],h7=id[10],h6=id[11],ik=id[12],ij=id[13],ih=id[14],ic=id[15];ia[0]=(h4*(h7*ic-h6*ih)-h8*(h3*ic-h2*ih)+ij*(h3*h6-h2*h7));ia[1]=-(ig*(h7*ic-h6*ih)-h8*(ie*ic-ib*ih)+ij*(ie*h6-ib*h7));ia[2]=(ig*(h3*ic-h2*ih)-h4*(ie*ic-ib*ih)+ij*(ie*h2-ib*h3));ia[3]=-(ig*(h3*h6-h2*h7)-h4*(ie*h6-ib*h7)+h8*(ie*h2-ib*h3));ia[4]=-(h5*(h7*ic-h6*ih)-h9*(h3*ic-h2*ih)+ik*(h3*h6-h2*h7));ia[5]=(ii*(h7*ic-h6*ih)-h9*(ie*ic-ib*ih)+ik*(ie*h6-ib*h7));ia[6]=-(ii*(h3*ic-h2*ih)-h5*(ie*ic-ib*ih)+ik*(ie*h2-ib*h3));ia[7]=(ii*(h3*h6-h2*h7)-h5*(ie*h6-ib*h7)+h9*(ie*h2-ib*h3));ia[8]=(h5*(h8*ic-h6*ij)-h9*(h4*ic-h2*ij)+ik*(h4*h6-h2*h8));ia[9]=-(ii*(h8*ic-h6*ij)-h9*(ig*ic-ib*ij)+ik*(ig*h6-ib*h8));ia[10]=(ii*(h4*ic-h2*ij)-h5*(ig*ic-ib*ij)+ik*(ig*h2-ib*h4));ia[11]=-(ii*(h4*h6-h2*h8)-h5*(ig*h6-ib*h8)+h9*(ig*h2-ib*h4));ia[12]=-(h5*(h8*ih-h7*ij)-h9*(h4*ih-h3*ij)+ik*(h4*h7-h3*h8));ia[13]=(ii*(h8*ih-h7*ij)-h9*(ig*ih-ie*ij)+ik*(ig*h7-ie*h8));ia[14]=-(ii*(h4*ih-h3*ij)-h5*(ig*ih-ie*ij)+ik*(ig*h3-ie*h4));ia[15]=(ii*(h4*h7-h3*h8)-h5*(ig*h7-ie*h8)+h9*(ig*h3-ie*h4));return ia};e.determinant=function(ip){var iv=ip[0],it=ip[1],iq=ip[2],io=ip[3],h5=ip[4],h4=ip[5],h3=ip[6],h2=ip[7],ik=ip[8],ij=ip[9],ii=ip[10],ih=ip[11],ix=ip[12],iw=ip[13],iu=ip[14],ir=ip[15],ig=iv*h4-it*h5,ie=iv*h3-iq*h5,id=iv*h2-io*h5,ic=it*h3-iq*h4,ib=it*h2-io*h4,ia=iq*h2-io*h3,h9=ik*iw-ij*ix,h8=ik*iu-ii*ix,h7=ik*ir-ih*ix,h6=ij*iu-ii*iw,im=ij*ir-ih*iw,il=ii*ir-ih*iu;return ig*il-ie*im+id*h6+ic*h7-ib*h8+ia*h9};e.multiply=function(ie,ij,ig){var io=ij[0],im=ij[1],ik=ij[2],ih=ij[3],h8=ij[4],h6=ij[5],h4=ij[6],h2=ij[7],id=ij[8],ic=ij[9],ib=ij[10],ia=ij[11],iq=ij[12],ip=ij[13],il=ij[14],ii=ij[15];var h9=ig[0],h7=ig[1],h5=ig[2],h3=ig[3];ie[0]=h9*io+h7*h8+h5*id+h3*iq;ie[1]=h9*im+h7*h6+h5*ic+h3*ip;ie[2]=h9*ik+h7*h4+h5*ib+h3*il;ie[3]=h9*ih+h7*h2+h5*ia+h3*ii;h9=ig[4];h7=ig[5];h5=ig[6];h3=ig[7];ie[4]=h9*io+h7*h8+h5*id+h3*iq;ie[5]=h9*im+h7*h6+h5*ic+h3*ip;ie[6]=h9*ik+h7*h4+h5*ib+h3*il;ie[7]=h9*ih+h7*h2+h5*ia+h3*ii;h9=ig[8];h7=ig[9];h5=ig[10];h3=ig[11];ie[8]=h9*io+h7*h8+h5*id+h3*iq;ie[9]=h9*im+h7*h6+h5*ic+h3*ip;ie[10]=h9*ik+h7*h4+h5*ib+h3*il;ie[11]=h9*ih+h7*h2+h5*ia+h3*ii;h9=ig[12];h7=ig[13];h5=ig[14];h3=ig[15];ie[12]=h9*io+h7*h8+h5*id+h3*iq;ie[13]=h9*im+h7*h6+h5*ic+h3*ip;ie[14]=h9*ik+h7*h4+h5*ib+h3*il;ie[15]=h9*ih+h7*h2+h5*ia+h3*ii;return ie};e.mul=e.multiply;e.translate=function(ie,ih,h9){var h8=h9[0],h7=h9[1],h6=h9[2],ik,ij,ii,ig,h5,h4,h3,h2,id,ic,ib,ia;if(ih===ie){ie[12]=ih[0]*h8+ih[4]*h7+ih[8]*h6+ih[12];ie[13]=ih[1]*h8+ih[5]*h7+ih[9]*h6+ih[13];ie[14]=ih[2]*h8+ih[6]*h7+ih[10]*h6+ih[14];ie[15]=ih[3]*h8+ih[7]*h7+ih[11]*h6+ih[15]}else{ik=ih[0];ij=ih[1];ii=ih[2];ig=ih[3];h5=ih[4];h4=ih[5];h3=ih[6];h2=ih[7];id=ih[8];ic=ih[9];ib=ih[10];ia=ih[11];ie[0]=ik;ie[1]=ij;ie[2]=ii;ie[3]=ig;ie[4]=h5;ie[5]=h4;ie[6]=h3;ie[7]=h2;ie[8]=id;ie[9]=ic;ie[10]=ib;ie[11]=ia;ie[12]=ik*h8+h5*h7+id*h6+ih[12];ie[13]=ij*h8+h4*h7+ic*h6+ih[13];ie[14]=ii*h8+h3*h7+ib*h6+ih[14];ie[15]=ig*h8+h2*h7+ia*h6+ih[15]}return ie};e.scale=function(h5,h3,h4){var h2=h4[0],h7=h4[1],h6=h4[2];h5[0]=h3[0]*h2;h5[1]=h3[1]*h2;h5[2]=h3[2]*h2;h5[3]=h3[3]*h2;h5[4]=h3[4]*h7;h5[5]=h3[5]*h7;h5[6]=h3[6]*h7;h5[7]=h3[7]*h7;h5[8]=h3[8]*h6;h5[9]=h3[9]*h6;h5[10]=h3[10]*h6;h5[11]=h3[11]*h6;h5[12]=h3[12];h5[13]=h3[13];h5[14]=h3[14];h5[15]=h3[15];return h5};e.rotate=function(io,iw,iy,h2){var ic=h2[0],ib=h2[1],ia=h2[2],ip=Math.sqrt(ic*ic+ib*ib+ia*ia),ii,iu,ih,iA,iz,ix,iv,h9,h8,h7,h6,im,il,ik,ij,ig,ie,id,it,ir,iq,h5,h4,h3;if(Math.abs(ip)<h1){return null}ip=1/ip;ic*=ip;ib*=ip;ia*=ip;ii=Math.sin(iy);iu=Math.cos(iy);ih=1-iu;iA=iw[0];iz=iw[1];ix=iw[2];iv=iw[3];h9=iw[4];h8=iw[5];h7=iw[6];h6=iw[7];im=iw[8];il=iw[9];ik=iw[10];ij=iw[11];ig=ic*ic*ih+iu;ie=ib*ic*ih+ia*ii;id=ia*ic*ih-ib*ii;it=ic*ib*ih-ia*ii;ir=ib*ib*ih+iu;iq=ia*ib*ih+ic*ii;h5=ic*ia*ih+ib*ii;h4=ib*ia*ih-ic*ii;h3=ia*ia*ih+iu;io[0]=iA*ig+h9*ie+im*id;io[1]=iz*ig+h8*ie+il*id;io[2]=ix*ig+h7*ie+ik*id;io[3]=iv*ig+h6*ie+ij*id;io[4]=iA*it+h9*ir+im*iq;io[5]=iz*it+h8*ir+il*iq;io[6]=ix*it+h7*ir+ik*iq;io[7]=iv*it+h6*ir+ij*iq;io[8]=iA*h5+h9*h4+im*h3;io[9]=iz*h5+h8*h4+il*h3;io[10]=ix*h5+h7*h4+ik*h3;io[11]=iv*h5+h6*h4+ij*h3;if(iw!==io){io[12]=iw[12];io[13]=iw[13];io[14]=iw[14];io[15]=iw[15]}return io};e.rotateX=function(h2,h9,h8){var ie=Math.sin(h8),h7=Math.cos(h8),id=h9[4],ic=h9[5],ib=h9[6],ia=h9[7],h6=h9[8],h5=h9[9],h4=h9[10],h3=h9[11];if(h9!==h2){h2[0]=h9[0];h2[1]=h9[1];h2[2]=h9[2];h2[3]=h9[3];h2[12]=h9[12];h2[13]=h9[13];h2[14]=h9[14];h2[15]=h9[15]}h2[4]=id*h7+h6*ie;h2[5]=ic*h7+h5*ie;h2[6]=ib*h7+h4*ie;h2[7]=ia*h7+h3*ie;h2[8]=h6*h7-id*ie;h2[9]=h5*h7-ic*ie;h2[10]=h4*h7-ib*ie;h2[11]=h3*h7-ia*ie;return h2};e.rotateY=function(h6,id,ic){var ie=Math.sin(ic),ib=Math.cos(ic),h5=id[0],h4=id[1],h3=id[2],h2=id[3],ia=id[8],h9=id[9],h8=id[10],h7=id[11];if(id!==h6){h6[4]=id[4];h6[5]=id[5];h6[6]=id[6];h6[7]=id[7];h6[12]=id[12];h6[13]=id[13];h6[14]=id[14];h6[15]=id[15]}h6[0]=h5*ib-ia*ie;h6[1]=h4*ib-h9*ie;h6[2]=h3*ib-h8*ie;h6[3]=h2*ib-h7*ie;h6[8]=h5*ie+ia*ib;h6[9]=h4*ie+h9*ib;h6[10]=h3*ie+h8*ib;h6[11]=h2*ie+h7*ib;return h6};e.rotateZ=function(h6,h9,h8){var ie=Math.sin(h8),h7=Math.cos(h8),h5=h9[0],h4=h9[1],h3=h9[2],h2=h9[3],id=h9[4],ic=h9[5],ib=h9[6],ia=h9[7];if(h9!==h6){h6[8]=h9[8];h6[9]=h9[9];h6[10]=h9[10];h6[11]=h9[11];h6[12]=h9[12];h6[13]=h9[13];h6[14]=h9[14];h6[15]=h9[15]}h6[0]=h5*h7+id*ie;h6[1]=h4*h7+ic*ie;h6[2]=h3*h7+ib*ie;h6[3]=h2*h7+ia*ie;h6[4]=id*h7-h5*ie;h6[5]=ic*h7-h4*ie;h6[6]=ib*h7-h3*ie;h6[7]=ia*h7-h2*ie;return h6};e.fromRotationTranslation=function(ig,id,ib){var h8=id[0],h7=id[1],h6=id[2],h9=id[3],ih=h8+h8,h2=h7+h7,ia=h6+h6,h5=h8*ih,h4=h8*h2,h3=h8*ia,ie=h7*h2,ic=h7*ia,ik=h6*ia,il=h9*ih,ij=h9*h2,ii=h9*ia;ig[0]=1-(ie+ik);ig[1]=h4+ii;ig[2]=h3-ij;ig[3]=0;ig[4]=h4-ii;ig[5]=1-(h5+ik);ig[6]=ic+il;ig[7]=0;ig[8]=h3+ij;ig[9]=ic-il;ig[10]=1-(h5+ie);ig[11]=0;ig[12]=ib[0];ig[13]=ib[1];ig[14]=ib[2];ig[15]=1;return ig};e.fromQuat=function(ic,h9){var h6=h9[0],h5=h9[1],h4=h9[2],h7=h9[3],id=h6+h6,h2=h5+h5,h8=h4+h4,h3=h6*id,ib=h5*id,ia=h5*h2,ik=h4*id,ij=h4*h2,ih=h4*h8,ii=h7*id,ig=h7*h2,ie=h7*h8;ic[0]=1-ia-ih;ic[1]=ib+ie;ic[2]=ik-ig;ic[3]=0;ic[4]=ib-ie;ic[5]=1-h3-ih;ic[6]=ij+ii;ic[7]=0;ic[8]=ik+ig;ic[9]=ij-ii;ic[10]=1-h3-ia;ic[11]=0;ic[12]=0;ic[13]=0;ic[14]=0;ic[15]=1;return ic};e.frustum=function(h6,h3,ib,h2,ia,h8,h7){var h9=1/(ib-h3),h5=1/(ia-h2),h4=1/(h8-h7);h6[0]=(h8*2)*h9;h6[1]=0;h6[2]=0;h6[3]=0;h6[4]=0;h6[5]=(h8*2)*h5;h6[6]=0;h6[7]=0;h6[8]=(ib+h3)*h9;h6[9]=(ia+h2)*h5;h6[10]=(h7+h8)*h4;h6[11]=-1;h6[12]=0;h6[13]=0;h6[14]=(h7*h8*2)*h4;h6[15]=0;return h6};e.perspective=function(h5,h4,h3,h6,h2){var h8=1/Math.tan(h4/2),h7=1/(h6-h2);h5[0]=h8/h3;h5[1]=0;h5[2]=0;h5[3]=0;h5[4]=0;h5[5]=h8;h5[6]=0;h5[7]=0;h5[8]=0;h5[9]=0;h5[10]=(h2+h6)*h7;h5[11]=-1;h5[12]=0;h5[13]=0;h5[14]=(2*h2*h6)*h7;h5[15]=0;return h5};e.ortho=function(h5,h3,ib,h2,h9,h8,h7){var h6=1/(h3-ib),ia=1/(h2-h9),h4=1/(h8-h7);h5[0]=-2*h6;h5[1]=0;h5[2]=0;h5[3]=0;h5[4]=0;h5[5]=-2*ia;h5[6]=0;h5[7]=0;h5[8]=0;h5[9]=0;h5[10]=2*h4;h5[11]=0;h5[12]=(h3+ib)*h6;h5[13]=(h9+h2)*ia;h5[14]=(h7+h8)*h4;h5[15]=1;return h5};e.lookAt=function(ih,ip,iq,h8){var io,im,ik,h4,h3,h2,ib,ia,h9,ii,il=ip[0],ij=ip[1],ig=ip[2],h7=h8[0],h6=h8[1],h5=h8[2],ie=iq[0],id=iq[1],ic=iq[2];if(Math.abs(il-ie)<h1&&Math.abs(ij-id)<h1&&Math.abs(ig-ic)<h1){return e.identity(ih)}ib=il-ie;ia=ij-id;h9=ig-ic;ii=1/Math.sqrt(ib*ib+ia*ia+h9*h9);ib*=ii;ia*=ii;h9*=ii;io=h6*h9-h5*ia;im=h5*ib-h7*h9;ik=h7*ia-h6*ib;ii=Math.sqrt(io*io+im*im+ik*ik);if(!ii){io=0;im=0;ik=0}else{ii=1/ii;io*=ii;im*=ii;ik*=ii}h4=ia*ik-h9*im;h3=h9*io-ib*ik;h2=ib*im-ia*io;ii=Math.sqrt(h4*h4+h3*h3+h2*h2);if(!ii){h4=0;h3=0;h2=0}else{ii=1/ii;h4*=ii;h3*=ii;h2*=ii}ih[0]=io;ih[1]=h4;ih[2]=ib;ih[3]=0;ih[4]=im;ih[5]=h3;ih[6]=ia;ih[7]=0;ih[8]=ik;ih[9]=h2;ih[10]=h9;ih[11]=0;ih[12]=-(io*il+im*ij+ik*ig);ih[13]=-(h4*il+h3*ij+h2*ig);ih[14]=-(ib*il+ia*ij+h9*ig);ih[15]=1;return ih};e.str=function(h2){return"mat4("+h2[0]+", "+h2[1]+", "+h2[2]+", "+h2[3]+", "+h2[4]+", "+h2[5]+", "+h2[6]+", "+h2[7]+", "+h2[8]+", "+h2[9]+", "+h2[10]+", "+h2[11]+", "+h2[12]+", "+h2[13]+", "+h2[14]+", "+h2[15]+")"};e.frob=function(h2){return(Math.sqrt(Math.pow(h2[0],2)+Math.pow(h2[1],2)+Math.pow(h2[2],2)+Math.pow(h2[3],2)+Math.pow(h2[4],2)+Math.pow(h2[5],2)+Math.pow(h2[6],2)+Math.pow(h2[6],2)+Math.pow(h2[7],2)+Math.pow(h2[8],2)+Math.pow(h2[9],2)+Math.pow(h2[10],2)+Math.pow(h2[11],2)+Math.pow(h2[12],2)+Math.pow(h2[13],2)+Math.pow(h2[14],2)+Math.pow(h2[15],2)))};hX.mat4=e})(window);function dc(){this.result={bkData:[],eleData:[[],[],[],[],[],[],[],[],[]],tileLabels:[]}}C.extend(dc.prototype,{createLayer:function(T,i){var e=this.result.bkData;i=i||{};if(!e[T]){e[T]=[[],[],[]]}e[T].tileTypeName=i.tileTypeName||"na";e[T].dataType=i.dataType||2;e[T].png8=i.png8||false;e[T].clipTile=i.clipTile||false},removeLayer:function(i){var e=this.result.bkData;e[i]=null},getResult:function(){return this.result},setData:function(hW,hV,hX){var e=this.result.bkData;var T=e[hV]?e[hV][hX]:null;if(!T){return}for(var hU=0;hU<T.length;hU++){if(T[hU].key&&T[hU].key===hW.key){T[hU]=hW;return}}T.push(hW)},setLabelData:function(e){this.result.tileLabels=e},getLabelData:function(){return this.result.tileLabels},setOverlayData:function(i,e){if(!this.result.eleData[e]){return}this.result.eleData[e]=i},clearLabelOverlayData:function(){this.result.eleData[2]=[];this.result.eleData[3]=[];this.result.eleData[4]=[]},clearData:function(hU){var e=this.result.bkData;if(typeof hU==="number"){if(e[hU]){e[hU][0]=[];e[hU][1]=[];e[hU][2]=[]}return}for(var T=0;T<e.length;T++){if(!e[T]){continue}e[T][0]=[];e[T][1]=[];e[T][2]=[]}},sortThumbData:function(i){var e=this.result.bkData;var T=e[i];if(!T){return}if(T[0]&&T[0].length>0){T[0].sort(function(hV,hU){return hV.tileInfo.useZoom-hU.tileInfo.useZoom})}}});var fk=(function(){var h4=new Int8Array(4);var T=new Int32Array(h4.buffer,0,1);var hZ=new Float32Array(h4.buffer,0,1);function h6(id){T[0]=id;return hZ[0]}function i(id){hZ[0]=id;return T[0]}function h0(id){var ig=(id[3]<<24|id[2]<<16|id[1]<<8|id[0]);var ie=h6(ig&4278190079);return ie}var hV=0;var hY=1;var h2=2;var ia=0;var h7=1;var h5=2;var hW=9;function h3(id,ie){var ig;if(ie%2===0){ig=[-id[1],id[0]]}else{ig=[id[1],-id[0]]}return ig}function e(id,ie,ig){var ih=h3(id,ie);var ii;if(ig===hY){return ih}else{if(ie===4||ie===5){ii=[ih[0]-id[0],ih[1]-id[1]]}else{ii=[ih[0]+id[0],ih[1]+id[1]]}if(ig===hV){vec2.normalize(ii,ii)}return ii}}function h9(ie,id){return Math.sqrt(Math.pow(ie[0]-id[0],2)+Math.pow(ie[1]-id[1],2))}function hU(ii,ih,ig,id){var ie=vec2.dot(ii,ih);if(ig===h5||ig===h7){if((id===0||id===1)&&ie>0){return true}else{if((id===2||id===3)&&ie<0){return true}}}if((id===0||id===1)&&ie<0){return true}else{if((id===2||id===3)&&ie>0){return true}}return false}function h1(ie,ik,im){var il=h3(ie,ik);var ih;var ij=ie;var ii=im;var ip=[];vec2.normalize(ip,[ij[0]+ii[0],ij[1]+ii[1]]);var io=vec2.dot(il,[-ip[1],ip[0]]);if(Math.abs(io)<0.1){io=1}var ig=1/io;ih=[-ip[1]*ig,ip[0]*ig];var id=vec2.dot(ie,ih);if(id<0){vec2.negate(ih,ih)}return{cos2:id,offset:ih}}function ic(ie,ik,im,id){var il=h3(ie,ik);var ij;var ii;var ih;if(ik===0||ik===1){ij=im;ii=ie}else{ij=ie;ii=im}if(!ij||!ii){return il}var ip=[ij[0]+ii[0],ij[1]+ii[1]];if(ip[0]===0&&ip[1]===0){vec2.normalize(ip,ii)}else{vec2.normalize(ip,ip)}var iq=hU(ip,il,id,ik);if(iq){return il}var io=vec2.dot(il,[-ip[1],ip[0]]);if(Math.abs(io)<0.1){io=1}var ig=1/io;ih=[-ip[1]*ig,ip[0]*ig];return ih}function ib(iq,ir,ij,ii,it,ip,ih,ik,ig,io){var im;var ie=0;var id=false;im=ip.length/hW-1;hX(ir[0],iq[0],ij[0],it,ii,4,ik,ig,undefined,ip,io);im++;ie++;hX(ir[0],iq[0],ij[0],it,ii,5,ik,ig,undefined,ip,io);im++;ie++;for(var il=0;il<iq.length;il++){hX(ir[il],iq[il],ij[il],it,ii,0,ik,ig,iq[il-1],ip,io);h8(ih,++im,++ie,id);hX(ir[il],iq[il],ij[il],it,ii,1,ik,ig,iq[il-1],ip,io);h8(ih,++im,++ie,id);hX(ir[il+1],iq[il],ij[il+1],it,ii,2,ik,ig,iq[il+1],ip,io);h8(ih,++im,++ie,id);hX(ir[il+1],iq[il],ij[il+1],it,ii,3,ik,ig,iq[il+1],ip,io);h8(ih,++im,++ie,id);if(ii===h7&&il!==iq.length-1){hX(ir[il+1],iq[il],ij[il+1],it,ii,8,ik,ig,iq[il+1],ip,io);h8(ih,++im,++ie,id);id=id?false:true}}hX(ir[ir.length-1],iq[iq.length-1],ij[ir.length-1],it,ii,6,ik,ig,undefined,ip,io);h8(ih,++im,++ie,id);hX(ir[ir.length-1],iq[iq.length-1],ij[ir.length-1],it,ii,7,ik,ig,undefined,ip,io);h8(ih,++im,++ie,id)}function hX(it,ih,il,iu,ig,im,ij,ie,iq,ip,io){var ir=im%2===0?1:-1;var ik;if(im===4||im===5||im===6||im===7){ik=e(ih,im,iu)}else{if(im===0||im===1||im===2||im===3){ik=ic(ih,im,iq,ig)}else{if(im===8){var ii=h1(ih,im,iq);ik=ii.offset;vec2.normalize(ik,ik);var id=ii.cos2;if(id<0){ir=-ir}}}}ip[ip.length]=it[0]*10;ip[ip.length]=it[1]*10;ip[ip.length]=ik[0]*ie*10;ip[ip.length]=ik[1]*ie*10;ip[ip.length]=ij;ip[ip.length]=ir;ip[ip.length]=0;ip[ip.length]=io||0;ip[ip.length]=il}function h8(ii,ig,id,ih){var ie;if(id%2===0){if(ih){ii[ii.length]=ig-2;ii[ii.length]=ig-1;ii[ii.length]=ig}else{ii[ii.length]=ig-1;ii[ii.length]=ig-2;ii[ii.length]=ig}}else{if(ih){ii[ii.length]=ig-1;ii[ii.length]=ig-2;ii[ii.length]=ig}else{ii[ii.length]=ig-2;ii[ii.length]=ig-1;ii[ii.length]=ig}}}return{getVertexCount:function(ie,id){if(id===h7){return ie*5-2}else{return ie*4}},buildData:function(iq,ig,ir,im,id,ij,ie,io){var ip=[];var il=0;var ii=[0];for(var ik=0;ik<iq.length;ik++){if(ik>0){il+=h9(iq[ik],iq[ik-1]);ii.push(il*10)}if(ik!==iq.length-1){var ih=[iq[ik+1][0]-iq[ik][0],iq[ik+1][1]-iq[ik][1]];var it=[];if(ih[0]===0&&ih[1]===0){it=[0,0]}else{vec2.normalize(it,ih)}ip[ip.length]=[it[0],it[1]]}}return ib(ip,iq,ii,ig,ir,im,id,h0(ij),ie,io)},toTileSolidLineVertices:function(ii,ie){var ig=new Float32Array(ii.length/hW*5);var id=new Int16Array(ig.buffer);var ik=0;var ih=0;for(var ij=0;ij<ii.length;ij+=hW){id[ik]=~~ii[ij];id[ik+1]=~~ii[ij+1];id[ik+2]=~~ii[ij+2];id[ik+3]=~~ii[ij+3];ig[ih+2]=ii[ij+4];id[ik+6]=ii[ij+5];id[ik+7]=ie?ie:0;id[ik+8]=ii[ij+7];id[ik+9]=0;ik+=10;ih+=5}return ig}}})();var eI=1;var gw=2;var fV={drawIndex:0,devicePixelRatio:a6(),zoomState:1,curViewTilesInfo:null,iconSetImg:null,LAST_CALC_ZOOM:-1,LAST_LOAD_VECTOR_ZOOM_CHANGE:false,lastCollisionTestTime:0,remove:function(){this.tileCache.clear()},initDrawData:function(){this.drawIndex=this.zIndex;this.map._featureMgr.createLayer(this.drawIndex,{tileTypeName:this.tileType.getName(),dataType:this.dataType,png8:this.png8,clipTile:this.clipTile})},destroyDrawData:function(){this.map._featureMgr.removeLayer(this.drawIndex)},setZIndex:function(e){this.zIndex=e},getTileKey:function(e,hU){hU=hU||{};var i=typeof hU.useZoom==="number"?hU.useZoom:e.useZoom;var T=e.style||this.mapStyleId||"default";return this.mapType+"_"+T+"_"+e.col+"_"+e.row+"_"+e.zoom+"_"+i},getTileRenderDataKey:function(i){var T=i.col;var hU=i.zoom;var e=i.baseTileSize;T=d4.calcLoopParam(T,hU,e).col;return this.mapType+"_"+T+"_"+i.row+"_"+hU+"_"+i.useZoom},getTileUnits:function(e){var hU=this.map;var T=b6[hU.getMapType()];var i=T.baseUnits*Math.pow(2,T.zoomLevelBase-e);return i},getTilesUrl:function(hV,h4,h5){var i=hV.x;var h6=hV.y;var h1=aD("ditu","normal");var hX=h1.ver;var hY=h1.udt;i=d4.calcLoopParam(i,h4,h5).col;var h3=b6.B_NORMAL_MAP.vectorTileUrls;var hW=Math.abs(i+h6)%h3.length;var h2=h3[hW];if(window.offLineIPAddress){h3=[window.offLineIPAddress+"pvd/"];h2=h3[0]}var T="x="+i+"&y="+h6+"&z="+Math.floor(h4);var h0=this.devicePixelRatio>1?"&scaler=2":"";var hZ="&textimg=1";if(this.map.config.textRenderType==="canvas"){hZ="&textimg=0"}var hU=this.map.config.style;if(typeof hU==="string"&&hU!=="default"){T+="&styleId="+e5.mapStyleNameIdPair[hU]}T+="&styles=pl"+hZ+h0+"&v="+hX+"&udt="+hY+"&json=0";var e=h2+"?qt=vtile&param="+window.encodeURIComponent(go(T));return e},getRasterTilesUrl:function(T,hW,hU){var hV=b6[this.map.mapType];var i=this.map.config.style;var e=hV.tileUrls[Math.abs(hW+T)%hV.tileUrls.length]+"?qt=tile&x="+T+"&y="+hW+"&z="+hU+((i==="default"||typeof i!=="string")?"":("&styleId="+e5.mapStyleNameIdPair[i]))+"&styles=pl&udt="+this.normalUdt+"&scaler="+this.scaler+"&p=1";e=e.replace(/-(\d+)/gi,"M$1");return e},getZoomState:function(){var T=this.map;var i=T.getZoom();var e=i-this.lastZoom;if(e>0){this.zoomState=1}else{if(e<0){this.zoomState=-1}}this.lastZoom=i;return this.zoomState},releaseOutViewTileData:function(e){var hV=this.map._workerMgr.releasePendingData(e);for(var hU=0,T=hV.length;hU<T;hU++){var hW=this.getTileKey(hV[hU]);this.tileCache.removeData(hW)}},loadLayerData:function(e,hU,i){this.hasZoomChange=i;this.curViewTilesInfo=e;this.mapStyleId=this.map.getMapStyleId();this.releaseOutViewTileData(e);var T=this.getZoomState();if(this.dataType===gw){if(hU){this.getVectorLayerDataFromCache(e,T)}else{this.loadVectorLayerData(e)}}else{this.loadRasterLayerData(e,hU)}},getVectorLayerDataFromCache:function(hZ,h9){this.map.temp.isPermitSpotOver=false;this.tileLabels=[];if(this.baseLayer===true){var h3=this.map._customLabelMgr.virtualTile;if(h3&&h3.label){this.tileLabels.push(h3.label)}}this.thumbCache={};var ia=-1;for(var h6=0,h4=hZ.length;h6<h4;h6++){var h7=hZ[h6];var hV=h7.col;var hW=h7.row;var T=h7.zoom;var h5=this._getTileTexImgKey(h7);var hU=h7.useZoom;ia=T;var hX=this.getTileKey(h7);var ic=this.tileCache.getData(hX);if(ic&&ic.status==="ready"){var id=ic;this.map._featureMgr.setData(ic,this.drawIndex,2);if(ic.label){if(ic.label.status==="ready"){ic.label.tileInfo=ic.tileInfo;this.tileLabels.push(ic.label);if(ic.label.textureSources&&ic.label.textureSources[hU]&&this.map._webglMapScene){var ib=this.map._webglMapScene._painter;if(!ib._labelTextureAtlasOffset[h5]){ib._addToAsyncJob(ic.label.textureSources[hU])}}}else{if(ic.label.status!=="processing"){this.processLabelData(ic)}}}}else{var h8={tileInfo:h7,dataType:gw,key:hX};this.map._featureMgr.setData(h8,this.drawIndex,2);if(this.useThumbData){this.setThumbData(hV,hW,T,hU,h9)}}}this.tileLabels.labelZoom=ia;this.updateLabels(h9);var h0=this.map.getZoom();var hY=Math.floor(h0);var h2=h0-hY;var h1=Math.floor(this.LAST_CALC_ZOOM);var e=this.LAST_CALC_ZOOM-h1;var ie=false;if(this.hasZoomChange){if(Math.abs(h0-this.LAST_CALC_ZOOM)>=0.5){ie=true}else{if(h2<0.5&&e>=0.5){ie=true}else{if(h2>=0.5&&e<0.5){ie=true}}}if(ie){this.cacheDataCollideLabels(0)}this.LAST_CALC_ZOOM=h0}else{if(this.tileLabels.length>0){this.cacheDataCollideLabels(C.Browser.ie?50:30)}}},loadVectorLayerData:function(h0){this.map.temp.isPermitSpotOver=false;var hZ=this;function hY(i,h1){var h3=hZ.tileCache.getData(h1);if(!h3){return}if(!i||i.error){var h2=new bb("ontileloaderror");i=i||{};h2.error=i.error||"";h2.message=i.message||"";hZ.map.fire(h2);h3.status="init";h3.reloadTimer=setTimeout(function(){if(h3.retry<3){h3.retry++;h3.status="loading";hZ.loadVectorTileData(i.tileInfo,hY)}else{hZ.tileCache.removeData(h1)}},4000);hZ.map._featureMgr.clearData(hZ.drawIndex);hZ._checkTilesLoaded();hZ.getVectorLayerDataFromCache(hZ.curViewTilesInfo,hZ.getZoomState());return}if(h3.reloadTimer){clearTimeout(h3.reloadTimer);h3.reloadTimer=null}hZ.callbackDataQueue.push([i,h1]);if(hZ.processDataTimer){return}hZ.processDataTimer=setTimeout(function(){while(hZ.callbackDataQueue.length>0){var h4=hZ.callbackDataQueue.shift();hZ.vectorTileDataCbk(h4[0],h4[1]);hZ._checkTilesLoaded()}hZ.map._featureMgr.clearData(hZ.drawIndex);hZ.getVectorLayerDataFromCache(hZ.curViewTilesInfo,hZ.getZoomState());hZ.processDataTimer=null},200)}for(var hX=0,hV=h0.length;hX<hV;hX++){var T=h0[hX];var hW=this.getTileKey(T);var e=this.tileCache.getData(hW);if(!e){e={status:"init",tileInfo:T,dataType:gw,key:hW,retry:0}}if(e.status!=="ready"&&e.status!=="loading"){this.numLoading++;e.status="loading";this.tileCache.setData(hW,e);var hU=this.getProcessedLabelZoom(T);if(hU){T.processedLabelZooms=hU}this.loadVectorTileData(T,hY)}}},setThumbData:function(i,hV,hU,e,T){if(T===1){if(this._findParentZoomTile(i,hV,hU,e,8)===false){this._findChildZoomTile(i,hV,hU,e,3)}}else{if(T===-1){if(this._findChildZoomTile(i,hV,hU,e,3)===false){this._findParentZoomTile(i,hV,hU,e,8)}}}this.map._featureMgr.sortThumbData(this.drawIndex)},_findParentZoomTile:function(hX,h6,h5,hV,h0){var hW=b6[this.getMapType()];var T=hW.minDataZoom;var e=hX;var h3=h6;var h1=h5;var h2=hV;for(var hZ=1;hZ<=h0;hZ++){var hU=this.tileType.getParentTile(e,h3,h1,h2,T);if(hU===null){continue}var h4=this.getTileKey(hU);var hY=this.tileCache.getData(h4);if(hY&&hY.status==="ready"){if(this.thumbCache[h4]){continue}this.map._featureMgr.setData(hY,this.drawIndex,0);this.thumbCache[h4]=true;return true}e=hU.col;h3=hU.row;h1=hU.zoom;h2=hU.useZoom}return false},_findChildZoomTile:function(hY,h0,e,hV,h9){var h7=b6[this.getMapType()];var h3=h7.maxDataZoom;var hX=hY;var hZ=h0;var h1=e;var hU=hV;var hW=true;for(var h6=1;h6<=h9;h6++){var h4=false;var T=this.tileType.getChildTiles(hX,hZ,h1,hU,h3,h6);if(!T){continue}for(var h5=0;h5<T.length;h5++){var h2=this.getTileKey(T[h5]);var h8=this.tileCache.getData(h2);if(h8&&h8.status==="ready"){if(!this.thumbCache[h2]){this.map._featureMgr.setData(h8,this.drawIndex,1);this.thumbCache[h2]=true}h4=true}else{hW=false}}if(h4){break}}return hW},loadVectorTileData:function(i,hV){var T=i.col;var hZ=i.row;var hX=i.zoom;var hY=i.baseTileSize;var e=this.getTilesUrl(new ej(T,hZ),hX,hY);if(!e){return}var hW=this.getTileKey(i);by(this.map);if(!this.processData){this.map._workerMgr.loadTileData(e,i,hW,hV);return}var hV="cbk"+hW.replace(/-/g,"_");var hU=this;bo[hV]=function(h0){var h1=(function(h2){return function(){h2.tileInfo=i;var h8=hU.processData(h2);if(!h8.road){return}var h5={tileInfo:i,renderData:{base:[]},status:"ready",key:hW,mapType:hU.mapType};var ib=[];var ie=[];for(var h7=0;h7<h8.road.length;h7++){var ia=h8.road[h7];var h9=-1;for(var h6=0;h6<ia.length;h6++){var ic=ia[h6];var id=[];if(ib.length/7+ic[0].length/2>65536){h5.renderData.base.push({type:"line",data:[fk.toTileSolidLineVertices(ib,4000),new Uint16Array(ie)]});ib=[];ie=[]}for(var h4=0;h4<ic[0].length;h4+=2){id[id.length]=[ic[0][h4],ic[0][h4+1]]}var h3=ic[3];fk.buildData(id,ic[1],ic[2],ib,ie,h3,ic[4],h7+20,false)}h5.renderData.base.push({type:"line",data:[fk.toTileSolidLineVertices(ib,4000),new Uint16Array(ie)]})}hU.tileCache.setData(hW,h5);hU.map._featureMgr.clearData(hU.drawIndex);hU.getVectorLayerDataFromCache(hU.curViewTilesInfo,hU.getZoomState());hU.map.dispatchEvent(new bb("onrefresh"))}})(h0);hU.map.jobScheduler.addJob(h1);delete bo[hV]};e+="&fn="+encodeURIComponent(eB+"."+hV);hp.load(e)},vectorTileDataCbk:function(hU,hV){var hZ=new bb("ontileloaded");hZ.perfStat=hU.perfStat||[];var e=this.map;e.fire(hZ);var i=hU.tileInfo;var T=i.col;var h4=i.row;var h3=i.zoom;var h2=i.baseTileSize;var hX=this.tileCache.getData(hV);if(!hX){return}if(!this.showLabel){hU.label=null}hX.renderData=hU;hX.tileInfo=i;var hW=d4.calcLoopParam(T,h3,h2);var h0=hW.geoOffsetX;hX.tileInfo.loopOffsetX=h0;hX.status="ready";hX.mapType=this.mapType;this.tileCache.setData(hV,hX);hX.label=hU.label;hU.label=null;if(hU.indoorData&&e._indoorMgr){e._indoorMgr.setData(hU.indoorData)}var hY="id_"+T+"_"+h4+"_"+h3;if(!this.curViewTilesInfo[hY]){e.fire(new bb("ontilenotinview"));return}this.processLabelData(hX);if(hU.indoorData&&e._indoorMgr&&e._indoorMgr.currentUid){this._refreshIndoorData(e._indoorMgr.currentUid,e._indoorMgr.currentFloor)}var h1=new bb("onrefresh");h1.source="webgllayer";this.map.dispatchEvent(h1)},_refreshIndoorData:function(h2,h1){var h4=this.map._indoorMgr.getIndoorData(h2);var h7=h4.tileKeys;var h5=Math.floor(this.map.getZoom());for(var hZ=0;hZ<h7.length;hZ++){var hW=h7[hZ];var hY=this.tileCache.getData(hW);if(!hY){continue}var h6=hY.renderData;h6.indoorBase=[];h6.indoorBaseContour=[];h6.indoorBorder3D=[];h6.indoorArea3D=[];hY.label.indoorLabel=[];this.labelProcessor.clearCollisionCache(hY.label);for(var h0 in h6.indoorData){if(h0==="tileInfo"){continue}var e=h6.indoorData[h0];var hV=e.defaultFloor;if(h0===h2){hV=h1;e.currentFloor=h1}if(e.floors[hV]){if(e.floors[hV].base){for(var hX=0;hX<e.floors[hV].base.length;hX++){h6.indoorBase.push(e.floors[hV].base[hX])}}if(e.floors[hV].contour){for(var hX=0;hX<e.floors[hV].contour.length;hX++){h6.indoorBaseContour.push(e.floors[hV].contour[hX])}}if(e.floors[hV].indoorBorder3D){h6.indoorBorder3D.push(e.floors[hV].indoorBorder3D)}if(e.floors[hV].area3D){h6.indoorArea3D.push(e.floors[hV].area3D)}if(e.floors[hV].pois){hY.label.indoorLabel=hY.label.indoorLabel.concat(e.floors[hV].pois)}}}this.updateAllIconsTextureCoords(hY);var h3=this;this.labelProcessor.loadIconImages(hY,function(i){h3.updateAllIconsTextureCoords(i)});var hU=hW.split("_");var T=parseInt(hU[hU.length-1],10);if(T!==h5){continue}h3.map._featureMgr.setData(hY,this.drawIndex,2)}this.dataBackCollideLabels();this.map.dispatchEvent(new bb("onrefresh"))},_removeIndoorData:function(i){if(!i.indoorData){return}for(var e in i.indoorData){if(e==="tileInfo"){continue}this.map._indoorMgr.removeData(e,i.key)}},getProcessedLabelZoom:function(hU){var hV=di.baseZoomInfo[hU.zoom];if(!hV){return false}var T=[];for(var hW=0;hW<hV.length;hW++){var hX=this.getTileKey(hU,{useZoom:hV[hW]});var e=this.tileCache.getData(hX);if(e&&e.status==="ready"&&e.label&&e.label.status==="ready"){T.push(hV[hW])}}if(T.length){return T}else{return false}},getSameZoomDataFromCache:function(T){var hU=di.baseZoomInfo[T.zoom];for(var hV=0;hV<hU.length;hV++){var hW=this.getTileKey(T,{useZoom:hU[hV]});if(T.useZoom===hU[hV]){continue}var e=this.tileCache.getData(hW);if(e&&e.status==="ready"&&e.label&&e.label.status==="ready"){return e}}return false},hasSameLabelData:function(hU,T){for(var e=0;e<T.length;e++){if(T[e].key===hU){return true}}return false},getDataByFloorName:function(T,hU){for(var e=0;e<T.length;e++){if(T[e].floorName===hU){return T[e]}}return null},mergeIndoorLabelData:function(hZ,e){for(var hX in hZ){if(hX==="tileInfo"){continue}if(e[hX]){var T=hZ[hX].floors;var h0=e[hX].floors;for(var hV=0;hV<T.length;hV++){var hU=T[hV];var hY=hU.floorName;var hW=this.getDataByFloorName(h0,hY);if(hW){if(hW.pois){hW.pois=hW.pois.concat(hU.pois);hU.pois=hW.pois}else{hW.pois=hU.pois}}}}}},mergeSameZoomLabelData:function(hX){var hV=hX.label;if(!hV){return}var e=hX.tileInfo;var hW=this.getSameZoomDataFromCache(e);if(!hW){return}var hU=hW.label;if(!hU){return}for(var T=0;T<hV.fixedLabel.length;T++){if(!this.hasSameLabelData(hV.fixedLabel[T].key,hU.fixedLabel)){hU.hasNewData=true;hU.fixedLabel.push(hV.fixedLabel[T])}}for(var T=0;T<hV.lineLabel.length;T++){if(!this.hasSameLabelData(hV.lineLabel[T].key,hU.lineLabel)){hU.hasNewData=true;hU.lineLabel.push(hV.lineLabel[T])}}for(var T=0;T<hV.indoorLabel.length;T++){if(!this.hasSameLabelData(hV.indoorLabel[T].key,hU.indoorLabel)){hU.hasNewData=true;hU.indoorLabel.push(hV.indoorLabel[T])}}hX.label=hU;if(hW.renderData.indoorData&&hX.renderData.indoorData){this.mergeIndoorLabelData(hX.renderData.indoorData,hW.renderData.indoorData)}},processLabelData:function(hW){if(!hW.label){return}if(hW.label.status==="processing"){return}hW.label.status="processing";var hU=this;hU.updateAllIconsTextureCoords(hW);this.labelProcessor.loadIconImages(hW,function(hX){hU.updateAllIconsTextureCoords(hX)});if(this.map.config.textRenderType==="canvas"){var e=this.labelProcessor.drawLabelsOnCanvas(hW,function(hZ,h0){var hY=hW.tileInfo;if(!bo.customStyleInfo){hU.mergeSameZoomLabelData(hW)}if(hZ){if(!hW.label.textureHeights){hW.label.textureHeights=[]}hW.label.textureHeights[hY.useZoom]=hZ.height}if(h0){if(!hW.label.indoorTextureHeights){hW.label.indoorTextureHeights=[]}hW.label.indoorTextureHeights[hY.useZoom]=h0.height}var hX=hU._getTileTexImgKey(hY);hU._doWorkAfterLabelImageLoad(hW,hZ,h0,hX)});return}var T=hW.label.textImageBitmap||hW.label.textImgStr;var hV=hW.label.indoorTextImageBitmap||hW.label.indoorTextImgStr;this.labelProcessor.loadImgByStr(T,hV,function i(h2,h0){var hZ=hW.label.textureHeight;var h3=hW.label.indoorTextureHeight;hW.label.textureHeight=undefined;hW.label.indoorTextureHeight=undefined;var hY=hW.tileInfo;hU.mergeSameZoomLabelData(hW);var h1=hW.label;h1.textImgStr="";h1.indoorTextImgStr&&(h1.indoorTextImgStr="");if(!h1.textureHeights){h1.textureHeights=[]}h1.textureHeights[hY.useZoom]=hZ;if(!h1.indoorTextureHeights){h1.indoorTextureHeights=[]}h1.indoorTextureHeights[hY.useZoom]=h3;var hX=hU._getTileTexImgKey(hY);hU._doWorkAfterLabelImageLoad(hW,h2,h0,hX)})},_getTileTexImgKey:function(i){var T=i.style||this.mapStyleId||"default";var e=T+"_"+i.col+"_"+i.row+"_"+i.zoom;if(this.map.config.textRenderType==="canvas"){e+="_"+i.useZoom}return e},_doWorkAfterLabelImageLoad:function(hY,hW,hU,i){var hX=this;var hV=hY.label;hV.tileInfo=hY.tileInfo;hV.status="ready";if(hW||hU){var e=hV.tileInfo;if(hW){hW.id=i;if(!hV.textureSources){hV.textureSources=[]}hV.textureSources[e.useZoom]=hW}if(hU){hU.id=i+"_indoor";if(!hV.indoorTextureSources){hV.indoorTextureSources=[]}hV.indoorTextureSources[e.useZoom]=hU}if(hX.map._webglMapScene){var T=hX.map._webglMapScene._painter;if(hW){T._addToAsyncJob(hV.textureSources[e.useZoom])}}}if(hY.custom!==true){hX.tileLabels.push(hV)}if(hX.collisionTimer){return}hX.collisionTimer=setTimeout(function(){hX.dataBackCollideLabels();hX.collisionTimer=null},300)},_updateIconTextureCoords:function(hY,T){if(!hY){return}var hX=this.map;for(var hU=0;hU<hY.length;hU++){var hW=hY[hU];if(!hW.iconPos){continue}if(hX._webglMapScene){var e=hX._webglMapScene._painter;var hV=T+"_"+hW.iconPos.iconType;hW.iconPos.texcoord=e._iconTextureAtlasCoords[hV]||null}}},updateAllIconsTextureCoords:function(hV){if(this.map.viewAnimationTime){return}if(hV){if(hV.label){var i=hV.tileInfo.style;this._updateIconTextureCoords(hV.label.fixedLabel,i);this._updateIconTextureCoords(hV.label.indoorLabel,i)}}else{var hU=this.tileCache.getAllData();for(var T in hU){var e=hU[T].data;if(e.status==="ready"&&e.label){var i=e.tileInfo.style;this._updateIconTextureCoords(e.label.fixedLabel,i);this._updateIconTextureCoords(e.label.indoorLabel,i)}}}this.updateLabels();this.map.dispatchEvent(new bb("onrefresh"))},cacheDataCollideLabels:function(T){var hV=this;var i=this.map._featureMgr;function hU(){hV.cacheLabelTimer=null;var hW;var hX=hV.map.getTilt();var hY=hV.map.getHeading()%360;if(hV.tileLabels.length===0||(hV.tileLabels.length===1&&hV.tileLabels[0].tileInfo.zoom===0)){hW=i.getLabelData();if(hW.length>0){hW=hV.labelProcessor.collisionTest(hW,-1)}}else{if(hX||hY){if(this._collisionTimer){if(!hX){clearTimeout(this._collisionTimer)}else{if(Date.now()-hV.lastCollisionTestTime>500){hV.lastCollisionTestTime=Date.now()}else{clearTimeout(this._collisionTimer)}}}this._collisionTimer=setTimeout(function(){hW=hV.labelProcessor.collisionTest(hV.tileLabels);if(hW){i.setLabelData(hW)}hV.updateLabels();hV.map.dispatchEvent(new bb("onrefresh"));hV._collisionTimer=null},60);return}else{hW=hV.labelProcessor.getCachedLabels(hV.tileLabels)}}if(hW){i.setLabelData(hW)}hV.updateLabels();hV.map.dispatchEvent(new bb("onrefresh"))}if(!T){clearTimeout(hV.cacheLabelTimer);hU()}else{if(hV.cacheLabelTimer){return}hV.cacheLabelTimer=setTimeout(function e(){hU()},T)}},dataBackCollideLabels:function(){var i=this;if((i.tileLabels&&i.tileLabels.length===0)){return}var e;i.labelProcessor.calcLabelsCollision(i.tileLabels);e=i.labelProcessor.getCachedLabels(i.tileLabels);if(e){i.map._featureMgr.setLabelData(e)}i.updateLabels();i.map.dispatchEvent(new bb("onrefresh"));if(f8()){this.labelProcessor._refreshSpotData()}},updateLabels:function(hV){var hW=this.map;var i=hW._featureMgr;var T=i.getLabelData();if(T.length>0){var hU=hW.getZoom();if(T.labelZoom-hU<3){this.labelProcessor.updateLabels(T);var e=this.labelProcessor.fixDataFormat(T);i.setOverlayData(e[0],2);i.setOverlayData(e[1],3);i.setOverlayData(e[2],4)}else{i.clearLabelOverlayData()}hW.temp.isPermitSpotOver=false;this.labelProcessor.curSpotAdded=false}},loadRasterLayerData:function(hZ,hU){this.thumbCache={};var h0=this.getZoomState();if(hU){for(var hX=0,hV=hZ.length;hX<hV;hX++){var T=hZ[hX];var hW=this.getTileKey(T);var e=this.tileCache.getData(hW);if(e&&e.status==="ready"){this.map._featureMgr.setData(e,this.drawIndex,2)}else{if(this.useThumbData){this.setThumbData(T.col,T.row,T.zoom,T.useZoom,h0)}}}return}for(var hX=0,hV=hZ.length;hX<hV;hX++){var T=hZ[hX];var hW=this.getTileKey(T);var e=this.tileCache.getData(hW);if(!e){this.tileCache.setData(hW,{});var hY=this;this.loadRasterTileData(T,function(i,h1){hY.rasterTileDataCbk(i,h1)})}}},loadRasterTileData:function(i,e){var T=new Image();var hV=i.col;var hY=i.row;var hW=i.zoom;var hU=this.getTilesUrl(new ej(hV,hY),hW,i);if(!hU){return}var hX=this.getTileKey(i);if(i.combine){T=hU;T.tileInfo=i;if(T){e&&e(T,hX)}else{e&&e(null,hX)}}else{T=this.loadTileImage(hU,hX,e)}T.tileInfo=i},loadTileImage:function(hU,T,e){var i=new Image();i.crossOrigin="anonymous";i.onload=function(){e&&e(this,T)};i.onerror=function(){e&&e(null,T)};i.src=hU;return i},rasterTileDataCbk:function(hW,hU){if(!hW||typeof hW==="string"){this.tileCache.removeData(hU);return}var i=hW.tileInfo;var T=i.col;var h2=i.row;var h1=i.zoom;var e=this.tileCache.getData(hU);if(!e){return}e.textureSource=hW;e.dataType=eI;e.tileInfo=i;if(i.tileTypeName==="xyz"){e.renderData={vertexAll:[0,0,0,0,0,i.tileSize[0],0,0,1,0,i.tileSize[0],i.tileSize[1],0,1,1,0,0,0,0,0,i.tileSize[0],i.tileSize[1],0,1,1,0,i.tileSize[1],0,0,1]}}else{var hV=d4.calcLoopParam(T,h1);var hZ=hV.geoOffsetX;hW.tileInfo.loopOffsetX=hZ;e.renderData={vertexAll:[0,0,0,0,0,256,0,0,1,0,256,256,0,1,1,0,0,0,0,0,256,256,0,1,1,0,256,0,0,1]}}e.status="ready";this.tileCache.setData(hU,e);var hX="id_"+T+"_"+h2+"_"+h1;var hY=false;if(this.curViewTilesInfo[hX]){e.dataType=eI;e.png8=this.png8||false;this.map._featureMgr.setData(e,this.drawIndex,2);hY=true}if(hY){var h0=new bb("onrefresh");h0.source="webgllayer";this.map.dispatchEvent(h0)}},_checkTilesLoaded:function(){this.numLoading--;if(this.map.firstTileLoad===false){this.map.dispatchEvent(new bb("onfirsttilesloaded"));this.map.firstTileLoad=true}var e=this;if(this.numLoading===0){if(this._checkLoadedTimer){clearTimeout(this._checkLoadedTimer);this._checkLoadedTimer=null}this._checkLoadedTimer=setTimeout(function(){if(e.numLoading===0){e.map.dispatchEvent(new bb("ontilesloaded"))}e._checkLoadedTimer=null},60)}},isClickableLabel:function(e){if(e.isDel){return false}if(e.zoom>9&&!e.guid){return false}if(e.zoom<=9&&!e.name&&!e.guid){return false}return true}};var b9=5;var dX=4;var ht=3;var fi=2;var hN=1;var d0=0;function v(e){this._ratio=a6();this._iconCache={};this._map=e;this._drawingCanvasPool=[];this._drawingCanvasHeight=4096}C.extend(v.prototype,{_loadIcons:function(i,hY){var hW=0;var hV=this;var T=this._map.config.style;for(var hX in i){hW++;var e=new Image();e.id=hX;e.crossOrigin="anonymous";e.onload=function(){hV._iconCache[this.id].loaded=true;hW--;if(hW===0){hY()}this.onload=null};e.onerror=function(){hV._iconCache[this.id]=null;hW--;if(hW===0){hY()}this.onerror=null};var hU=e5.getIconSetPath(T)+hX+".png";e.src=hU;this._iconCache[hX]={loaded:false,image:e}}},_getEmptyDrawingCanvas:function(){for(var T=0;T<this._drawingCanvasPool.length;T++){if(this._drawingCanvasPool[T]._free===true){this._drawingCanvasPool[T]._free=false;return this._drawingCanvasPool[T]}}var e=this._createNewDrawingCanvas();this._drawingCanvasPool.push(e);e._free=false;return e},_createNewDrawingCanvas:function(){var e=S("canvas");e.width=512;e.height=this._drawingCanvasHeight;e._free=true;e._id=bo.getGUID();var i=e.getContext("2d");i.textBaseline="bottom";i.lineJoin="round";return e},drawLabelsOnCanvas:function(ic,hU){var h2=ic.label.fixedLabel.slice(0);var h8=ic.label.lineLabel.slice(0);var T=ic.label.indoorLabel.slice(0);if(h2.length===0&&h8.length===0&&T.length===0){hU();return}var hX=function(ii,i){return ii.styleId-i.styleId};h2.sort(hX);h8.sort(hX);T.sort(hX);var ib={};var e=this._getEmptyDrawingCanvas();var h7=e.getContext("2d");h7.clearRect(0,0,e.width,e.height);var ig=0;var h3=null;var hW=0;if(h2.length>0){while(hW<h2.length&&!h2[hW].styleText[0]){hW++}if(h2[hW]&&h2[hW].styleText[0]){h3=h2[hW].styleText[0].fontSize+h2[hW].styleText[0].haloSize*2}}if(h3===null&&T.length>0){hW=0;while(hW<T.length&&!T[hW].styleText[0]){hW++}if(T[hW]&&T[hW].styleText[0]){h3=T[hW].styleText[0].fontSize+T[hW].styleText[0].haloSize*2}}if(h3===null&&h8.length>0){hW=0;while(hW<h8.length&&!h8[hW].styleText[0]){hW++}if(h8[hW]&&h8[hW].styleText[0]){h3=h8[hW].styleText[0].fontSize+h8[hW].styleText[0].haloSize*2}}if(h3===null||isNaN(h3)){hU();return}var hZ=0;var hY=h3;var h5={};var ih=0;var h6=[];for(var ia=0;ia<h2.length;ia++){var h1=h2[ia];var h4=h1.name;var h9=h1.styleText;if(!h4||h9.length===0){continue}var hV=h1.icon;if(h1.textOnIcon&&(!this._iconCache[hV]||this._iconCache[hV].loaded===false)){h6.push(h1);ih++;if(!h5[hV]){h5[hV]=true}continue}var id=this._drawEachText(h7,h1,ig,hZ,hY,h3,ib);if(!id){continue}hZ=id.curX;hY=id.curY;h3=id.curLineHeight;ig=id.styleId}var id=this._drawEachTypeOfLabels(h7,T,ig,hZ,hY,h3,ib);ig=id.curStyleId;hZ=id.curX;hY=id.curY;h3=id.curLineHeight;var id=this._drawEachTypeOfLabels(h7,h8,ig,hZ,hY,h3,ib);ig=id.curStyleId;hZ=id.curX;hY=id.curY;h3=id.curLineHeight;if(ih>0){var ie=this;this._loadIcons(h5,function(){id=ie._drawEachTypeOfLabels(h7,h6,ig,hZ,hY,h3,ib);ig=id.curStyleId;hZ=id.curX;hY=id.curY;h3=id.curLineHeight;var i=ie._generateEachLabelCanvas(e,hY,h2,h8,T,ic);hU(i[0],i[1])});return}var h0=this._generateEachLabelCanvas(e,hY,h2,h8,T,ic);hU(h0[0],h0[1])},drawCustomLabelsOnCanvas:function(hX,h3){if(hX.length===0){h3();return}var T=0;var e=(hX[0].style.fontSize+(hX[0].style.haloSize||0)*2)||0;var hU=e;var hZ=this._getEmptyDrawingCanvas();var h4=hZ.getContext("2d");h4.clearRect(0,0,hZ.width,hZ.height);var h0={};var h2=-1;for(var hV=0;hV<hX.length;hV++){if(!hX[hV].name){continue}var h1=this._drawEachText(h4,hX[hV],h2,T,e,hU,h0);if(!h1){continue}T=h1.curX;e=h1.curY;hU=h1.curLineHeight;h2=h1.styleId}var hW=e;var hY=this._copyToNewCanvas(hZ,hW);for(var hV=0;hV<hX.length;hV++){if(!hX[hV].name&&hX[hV].style.iconSize){this._addFixedLabelBounds(hX[hV]);continue}if(!hX[hV].textSize){continue}this._updateFixedLabelCoords(hX[hV],hW);this._addFixedLabelBounds(hX[hV])}h3(hY)},_drawEachTypeOfLabels:function(h3,hX,h1,hU,T,hV,hZ){for(var hW=0;hW<hX.length;hW++){var hY=hX[hW];var h2=hY.name;var e=hY.styleText;if(!h2||e.length===0){continue}var h0=this._drawEachText(h3,hY,h1,hU,T,hV,hZ);if(!h0){continue}hU=h0.curX;T=h0.curY;hV=h0.curLineHeight;h1=h0.styleId;if(h0.curY>this._drawingCanvasHeight){return{curX:hU,curY:T,curLineHeight:hV,curStyleId:h1}}}return{curX:hU,curY:T,curLineHeight:hV,curStyleId:h1}},_drawIndoorTextLabelOnCanvas:function(hV){var e=this._getEmptyDrawingCanvas();var h2=e.getContext("2d");h2.clearRect(0,0,e.width,e.height);var ia=0;var h1=null;var h0=0;var hY;var h7={};var h6=[];for(var hW in hV){if(hW==="tileInfo"){continue}var hU=hV[hW];var h5=hU.defaultFloor;var hZ=hU.floors;for(var h4=0;h4<hZ.length;h4++){if(h4===h5){continue}var h8=hZ[h4];if(!h8.pois){continue}var hX=h8.pois;for(var h3=0;h3<hX.length;h3++){if(h1===null&&hX[h3].styleText[0]){h1=hX[h3].styleText[0].fontSize+hX[h3].styleText[0].haloSize*2;hY=h1}h6.push(hX[h3])}}}if(h1===null){return null}h6.sort(function(ib,i){return i.rank-ib.rank||ib.styleId-i.styleId});var h9=this._drawEachTypeOfLabels(h2,h6,ia,h0,hY,h1,h7);ia=h9.curStyleId;h0=h9.curX;hY=h9.curY;h1=h9.curLineHeight;var T=this._copyToNewCanvas(e,hY);return T},_updateIndoorLabelsCoords:function(h1,h2){for(var h0 in h1){if(h0==="tileInfo"){continue}var e=h1[h0];var hW=e.defaultFloor;var hX=e.floors;for(var hY=0;hY<hX.length;hY++){if(hY===hW){continue}var T=hX[hY];if(!T.pois){continue}var hV=T.pois;for(var hU=0;hU<hV.length;hU++){var hZ=hV[hU];if(hZ.name&&(!hZ.textSize||hZ.textSize.length===0)){hV.splice(hU,1);hU--;continue}this._updateFixedLabelCoords(hZ,h2);this._addFixedLabelBounds(hZ)}}}},_generateEachLabelCanvas:function(hX,hW,hY,e,h0,T){hW=Math.min(hW,this._drawingCanvasHeight);var hZ=this._copyToNewCanvas(hX,hW);var hU=null;if(T.renderData.indoorData){hU=this._drawIndoorTextLabelOnCanvas(T.renderData.indoorData);if(hU){this._updateIndoorLabelsCoords(T.renderData.indoorData,hU.height)}}for(var hV=0;hV<hY.length;hV++){if(!hY[hV].textSize){continue}this._updateFixedLabelCoords(hY[hV],hW);this._addFixedLabelBounds(hY[hV])}for(var hV=0;hV<h0.length;hV++){if(!h0[hV].textSize){continue}this._updateFixedLabelCoords(h0[hV],hW);this._addFixedLabelBounds(h0[hV])}for(var hV=0;hV<e.length;hV++){this._updateLineLabelCoords(e[hV],hW)}return[hZ,hU]},_copyToNewCanvas:function(T,i){if(i===0){return null}var hU=S("canvas");hU.width=T.width;hU.height=i;var e=hU.getContext("2d");e.drawImage(T,0,0,512,i,0,0,512,i);hU._id=T._id;T._free=true;return hU},_drawEachText:function(ic,hY,T,ie,id,im,hV){var il=hY.name;var h3=hY.styleText?hY.styleText[0]:hY.style;if(!h3){return null}var h6=h3.fontSize;var ir=h3.fontWeight;var iF=h3.haloSize||0;if(!h7){}if(h3.fontRgba){var iL=h3.fontRgba[3]/255;var h2=[];h2[3]=iL;for(var iK=0;iK<3;iK++){h2[iK]=h3.fontRgba[iK]}}if(h3.haloRgba){var iL=h3.haloRgba[3]/255;var h9=[];h9[3]=iL;for(var iK=0;iK<3;iK++){h9[iK]=h3.haloRgba[iK]}}var iz=h2?"rgba("+h2.join(",")+")":h3.color;var hX=h9?"rgba("+h9.join(",")+")":h3.strokeColor;var iH=hY.styleId||0;if(iF>4){iF=4}var io=[];var ib=[];var ij=0;if(hV&&!hV[iH]){hV[iH]={}}var h5=h6+iF*2;var ip=h5;if(hY.containDescendings){ip+=4}if(iF===0){ip+=2}if(hY.textOnIcon){ip=Math.max(ip,hY.iconSize[1])}if(iH!==T||ip>im){T=iH;if(ir>=10&&ir%10===0){ic.font=ir*10+" "+h6+"px sans-serif"}else{ic.font=h6+"px sans-serif"}if(ip>im){var ik=ip-im;im+=ik;id+=ik}if(iF>0){ic.lineWidth=iF*2;ic.strokeStyle=hX}ic.fillStyle=iz}if(hY.type==="line"){var h0=il.split("");for(var iI=0;iI<h0.length;iI++){var iB=h0[iI];var ig;var it;if(hV[iH][iB]){var h7=hV[iH][iB];ig=h7.displaySize;it=h7.curWordPosition}else{var hU=Math.ceil(ic.measureText(iB).width);if(ie+hU>512){ie=0;id+=ip;im=ip}if(id>this._drawingCanvasHeight){return{curX:ie,curY:id,curLineHeight:im,styleId:iH}}var iC=ie;if(iF>0){hU+=iF;iC-=Math.round(iF/2);ic.strokeText(iB,ie,id)}ic.fillText(iB,ie,id);var iy=[hU,ip];ig=[Math.round(iy[0]/2),Math.round(iy[1]/2)];it=[iC,id-ip];hV[iH][iB]={displaySize:ig,curWordPosition:it,totalHeight:ij};ie+=hU+2}io.push(ig);ib.push(it)}ij=Math.round(io[0][1])}else{if(hV[iH][il]){var h7=hV[iH][il];io=h7.textSize;ib=h7.labelImagePosition;ij=h7.totalHeight}else{var h8=il.split("\\");if(h8.length>1&&hY.textOnIcon){var iJ=0;var iG=0;var iM=[];var ih=8;for(var iI=0;iI<h8.length;iI++){var il=h8[iI];var h4=Math.ceil(ic.measureText(il).width);if(h4>iJ){iJ=h4}iM.push(Math.round(h4/2));iG+=ip}var h1=iJ+2*ih;var iE=iG+2*ih;if(ie+h1>512){ie=0;id+=im}id+=iG-ip+2*ih;var ix=ie;var ii=id-iE;var e=Math.round(h1/2);var ia=this._iconCache[hY.icon].image;this.drawStretchedIcon(ic,ia,[ix,ii],ih,iJ,iG);for(var iI=0;iI<h8.length;iI++){var il=h8[iI];var iD=ix+(e-iM[iI]);var iA=ii+4+(iI+1)*ip;ic.fillText(il,iD,iA)}io.push([Math.round(h1/2),Math.round(iE/2)]);ib.push([ix,ii]);ie+=h1;im=iE;ij=Math.round(iE/2)}else{for(var iI=0;iI<h8.length;iI++){var il=h8[iI];var h4=Math.ceil(ic.measureText(il).width);var h1=h4;var hW=0;if(hY.textOnIcon){hW=10;h1+=hW*2;if(hY.styleId===519){h1=hY.iconSize[0];hW=Math.round((h1-h4)/2)}}if(ie+h1>512){ie=0;id+=ip;im=ip}if(id>this._drawingCanvasHeight){return{curX:ie,curY:id,curLineHeight:im,styleId:iH}}var ix=ie;var ii=id-ip;var iw=ie;var iv=id;if(hY.containDescendings){iv-=4}if(hY.textOnIcon){var iq=false;var ia=this._iconCache[hY.icon].image;var iu=hY.iconSize.concat([]);if(h5>iu[1]){iu[1]=h5;iq=true}if(h4>iu[0]){iu[0]=h4;iq=true}if(hY.styleId===519){ic.drawImage(ia,0,0,iu[0],iu[1],ix,ii,iu[0],iu[1])}else{if(iq){this.drawStretchedIcon(ic,ia,[ix,ii],hW,h4,iu[1])}else{this.draw3StretchedIcon(ic,ia,[ix,ii],hW,h4,iu[1])}}iw+=hW;if(hY.iconSize[1]>h5){iv-=(hY.iconSize[1]-h5)/2-1}h1+=1}if(iF>0){h1+=iF;ix-=Math.round(iF/2);ii+=Math.round(iF/2);if(iH===71028){ip-=2}if(iH===32){ip-=2}ic.strokeText(il,iw,iv)}ic.fillText(il,iw,iv);var hZ=[h1,ip];var ig=[Math.round(hZ[0]/2),Math.round(hZ[1]/2)];io.push(ig);ib.push([ix,ii]);ij+=Math.round(ig[1]);ie+=h1}}hV[iH][il]={textSize:io,labelImagePosition:ib,totalHeight:ij}}}hY.textSize=io;hY.labelImagePosition=ib;hY.totalHeight=ij;return{curX:ie,curY:id,curLineHeight:im,styleId:iH}},drawStretchedIcon:function(e,T,hU,hX,hY,i){var hW=hU[0];var hV=hU[1];e.drawImage(T,0,0,hX,hX,hW,hV,hX,hX);e.drawImage(T,hX,0,1,hX,hW+hX,hV,hY,hX);e.drawImage(T,T.width-hX,0,hX,hX,hW+hY+hX,hV,hX,hX);e.drawImage(T,0,hX,hX,1,hW,hV+hX,hX,i);e.drawImage(T,hX,hX,1,1,hW+hX,hV+hX,hY,i);e.drawImage(T,T.width-hX,hX,hX,1,hW+hY+hX,hV+hX,hX,i);e.drawImage(T,0,T.height-hX,hX,hX,hW,hV+i+hX,hX,hX);e.drawImage(T,hX,T.height-hX,1,hX,hW+hX,hV+i+hX,hY,hX);e.drawImage(T,T.width-hX,T.height-hX,hX,hX,hW+hY+hX,hV+i+hX,hX,hX)},draw3StretchedIcon:function(e,i,T,hW,hY,hX){var hV=T[0];var hU=T[1];e.drawImage(i,0,0,hW,i.height,hV,hU,hW,i.height);e.drawImage(i,hW,0,1,i.height,hV+hW,hU,hY,i.height);e.drawImage(i,i.width-hW,0,hW,i.height,hV+hW+hY,hU,hW,i.height)},_updateFixedLabelCoords:function(hV,ia){if(ia===0){return}var h5=[];var ii=[];var ij=0;var h8=hV.totalHeight;var it=hV.textSize.length;var hW=hV.direction;if(typeof hW!=="number"){hW=0}for(var ik=0;ik<it;ik++){var ib=hV.labelImagePosition[ik];var h9=hV.textSize[ik];var h7=ib[0];var hU=ib[1];var hX=h9[0];var h2=h9[1];var h4=0;var ih=0;if(typeof hV.textMargin==="number"){ih=hV.textMargin}var h3;var e;var hZ=0;var h6=0;if(!hV.iconPos){if(!hV.custom){hW=dX}}else{hZ=hV.iconPos.width;h6=hV.iconPos.height}switch(hW){case ht:var T=h8/2-h2+h4*(it-1)/2;h3=Math.round(-hZ/2-hX-ih);e=Math.round(T-ij-h4*ik);break;case hN:var T=h8/2-h2+h4*(it-1)/2;h3=Math.round(hZ/2+ih);e=Math.round(T-ij-h4*ik);break;case fi:var T=h6/2+h8-h2+h4*it;h3=Math.round(-hX/2);e=Math.round(T-ij-h4*ik);break;case d0:var T=-h6/2-h4-h2;h3=Math.round(-hX/2);e=Math.round(T-ij-h4*ik);break;case dX:var T=-h8/2-h4*(it-1)/2;h3=Math.round(-hX/2);e=Math.round(T-ij-h4*ik);break}ij+=h2;var h1=h3+hX;var iu=e;var h0=h1;var ir=iu+h2;var hY=h3;var iq=ir;h5.push(h3,e,h1,iu,h0,ir,h3,e,h0,ir,hY,iq);var ip=h7/512;var ig=(ia-hU-h2*2)/ia;var io=(h7+hX*2)/512;var ie=ig;var im=io;var id=(ia-hU)/ia;var il=ip;var ic=id;ii.push(ip,ig,io,ie,im,id,ip,ig,im,id,il,ic)}if(!hV.textPos){hV.textPos={}}hV.textPos.vertex=h5;hV.textPos.texcoord=ii},_addFixedLabelBounds:function(h0){var hW=1000;var hU=1000;var T=-1000;var e=-1000;if(h0.iconPos){var hY=h0.iconPos["vertex"];for(var hZ=0,hV=hY.length;hZ<hV;hZ+=2){var h4=hY[hZ];var h2=hY[hZ+1];if(h4<hW){hW=h4}if(h4>T){T=h4}if(h2<hU){hU=h2}if(h2>e){e=h2}}}if(h0.custom&&h0.style.iconSize&&!h0.name){var h1=h0.style.iconSize;var h3=h0.direction;switch(h3){case dX:hW=-Math.round(h1[0]/2);hU=-Math.round(h1[1]/2);T=Math.round(h1[0]/2);e=Math.round(h1[1]/2);break;case fi:hW=-Math.round(h1[0]/2);hU=0;T=Math.round(h1[0]/2);e=h1[1];break}}if(h0.textPos){var hX=h0.textPos["vertex"];for(var hZ=0,hV=hX.length;hZ<hV;hZ+=2){var h4=hX[hZ];var h2=hX[hZ+1];if(h4<hW){hW=h4}if(h4>T){T=h4}if(h2<hU){hU=h2}if(h2>e){e=h2}}}h0.bds=[hW,hU,T,e]},_updateLineLabelCoords:function(ib,h1){if(h1===0){return}var hU=ib.wordsInfo;var h8=ib.wordCount;if(!ib.labelImagePosition){return}var h3=ib.labelImagePosition.slice(0);if(ib.reverse){h3.reverse()}var il=1000;var ii=1000;var ij=-1000;var ih=-1000;for(var ic=0;ic<h8;ic++){var im=h3[ic];var ik=im[0];var h9=im[1];var h7=ib.textSize[ic];var h0=h7[0];var e=h7[1];var hZ=ik/512;var h6=(h1-h9-e*2)/h1;var hX=(ik+h0*2)/512;var h5=h6;var hV=hX;var h4=(h1-h9)/h1;var T=hZ;var h2=h4;hU[ic].size=[h0,e];hU[ic].texcoord=[hZ,h6,hX,h5,hV,h4,hZ,h6,hV,h4,T,h2];var ig=hU[ic].offset[0];var ie=hU[ic].offset[1];var id=ig-h0/2;var hY=ie+e/2;var hW=ie-e/2;var ia=ig+h0/2;if(id<il){il=id}if(ia>ij){ij=ia}if(hW<ii){ii=hW}if(hY>ih){ih=hY}}ib.bds=[il,ii,ij,ih]}});var cT={0:"00000000",16:"00010000",32:"00100000",48:"00110000",64:"01000000",96:"01100000"};function cq(T,hU,hV){var e=T.bds;if(!e){return false}var i=T.tracer;var hY;if(i){if(!cT[i]){hY=i.toString(2);if(hY.length<8){hY=new Array(8-hY.length+1).join("0")+hY}cT[i]=hY}hY=cT[i];var hX=di.mapZoomStartZoomMapping[hU];return hY[hU-hX]==="1"}var hW=T.displayRange;if(hV>=hW[0]&&hV<=hW[1]){return true}return false}function dj(i,e){this.map=i.map;this.layer=i;e=e||[];this.allLabels=[];this._spotData=[];this._strategyInfo=null;this.RANK1=1000000;this.RANK2=2000000;this.RANK3=3000000;this.RANK4=4000000;this.RANK5=5000000;this._ratio=a6();this._useRound=true;this._sharpenRender=false;if(this._ratio>c8.HIGH_RES_MIN_RATIO){this._useRound=false;this._sharpenRender=true}this._mapIsMoving=false;this._onMapIdleCallback=e.onMapIdleCallback;this.map.temp.isPermitSpotOver=true;this.currentSelectedLabel=null;this.map._labelProcessor=this;this.iconCache={};this.fixedLabelData=[];this.lineLabelData=[];this.highlightLabelData=[];this._iconLoadTimer=null;this._labelTextCanvas=null;if(this.map.config.textRenderType==="canvas"){this._labelTextCanvas=this.map.tileMgr.getLabelTextCanvas()}this.bind()}C.extend(dj.prototype,{bind:function(){var T=this.map;var i=this;T.addEventListener("mapstatusbusy_inner",function(hU){i._mapIsMoving=true;if(i._ratio>c8.HIGH_RES_MIN_RATIO){i._sharpenRender=false}else{i._useRound=false}});T.addEventListener("mapstatusidle_inner",function(hU){if(i._ratio>c8.HIGH_RES_MIN_RATIO){i._sharpenRender=true}else{i._useRound=true}i._mapIsMoving=false});T.addEventListener("onspotmouseover",function(hW){if(!this.temp.isPermitSpotOver){return}if(hW.spots.length>0){var hV=hW.spots[0].userdata.uid;var hX=hW.spots[0].userdata.tilePosStr;var hU=i.getLabelByUid(hV,hX);hU&&hU.formatedData&&i._toHighlightColor(hU.formatedData)}});T.addEventListener("onspotmouseout",function(hW){if(!this.temp.isPermitSpotOver){return}if(hW.spots.length>0){var hV=hW.spots[0].userdata.uid;var hX=hW.spots[0].userdata.tilePosStr;var hU=i.getLabelByUid(hV,hX);hU&&hU.formatedData&&i._toDefaultColor(hU.formatedData)}});T.addEventListener("spotclick",function(hW){if(hW.spots&&hW.spots.length>0){if(hW.spots[0].userdata.zoom<10){return}var hV=hW.spots[0].userdata.uid;var hX=hW.spots[0].userdata.tilePosStr;if(i.currentSelectedLabel&&(i.currentSelectedLabel.uid!==hV||i.currentSelectedLabel.tilePosStr!==hX)){i._recoverNormalState()}var hU=i.getLabelByUid(hV,hX);hU&&i._changeBaseMapState(hU)}else{i._recoverNormalState()}});T.on("spot_status_reset",function(){i._recoverNormalState()});T.on("spot_highlight",function(hV){var hU=i.getLabelByUid(hV.uid,hV.tilePosStr);hU&&hU.formatedData&&i._toHighlightColor(hU.formatedData)});T.addEventListener("mousemove",function(hU){if(i.curSpotAdded){return}if(this.currentOperation!==dU.idle||i._mapIsMoving===true){return}i._refreshSpotData();this.temp.isPermitSpotOver=true;i.curSpotAdded=true});if(f8()){function e(){i._refreshSpotData()}T.addEventListener("mapstatusidle_inner",e)}T.on("style_loaded",function(){if(i.map.config.textRenderType==="canvas"&&!i._labelTextCanvas){i._labelTextCanvas=i.map.tileMgr.getLabelTextCanvas()}})},getLabelByUid:function(hX,hY){var e=this.map._featureMgr.getResult().tileLabels;for(var hW=0;hW<e.length;hW++){var T=e[hW].fixedLabel;for(var hV=0;hV<T.length;hV++){if(e[hW].fixedLabel[hV].guid===hX&&e[hW].fixedLabel[hV].tilePosStr===hY){return e[hW].fixedLabel[hV]}}var hU=e[hW].indoorLabel;for(var hV=0;hV<hU.length;hV++){if(e[hW].indoorLabel[hV].guid===hX&&e[hW].indoorLabel[hV].tilePosStr===hY){return e[hW].indoorLabel[hV]}}}return null},getTileByLabelUid:function(hX){var e=this.map._featureMgr.getResult().tileLabels;for(var hW=0;hW<e.length;hW++){var T=e[hW].fixedLabel;for(var hV=0;hV<T.length;hV++){if(e[hW].fixedLabel[hV].guid===hX){return e[hW]}}var hU=e[hW].indoorLabel;for(var hV=0;hV<hU.length;hV++){if(e[hW].indoorLabel[hV].guid===hX){return e[hW]}}}return null},_toHighlightColor:function(T){if(T.tempRank&&T.tempRank===this.RANK5){return}var e=this.map._featureMgr.getResult().eleData[4]||[];var hV=false;for(var hU=0;hU<e.length;hU++){if(e[hU]===T||(e[hU].guid===T.guid&&e[hU].tilePosStr===T.tilePosStr&&e[hU].zoom===T.zoom)){hV=true;break}}if(hV){return}e.push(T);this.map._featureMgr.setOverlayData(e,4);this.map.dispatchEvent(new bb("onrefresh"))},_toDefaultColor:function(T){if(T.tempRank&&T.tempRank===this.RANK5){return}var e=this.map._featureMgr.getResult().eleData[4]||[];for(var hU=0;hU<e.length;hU++){if(T===e[hU]||(T.guid===e[hU].guid&&T.tilePosStr===e[hU].tilePosStr&&T.zoom===e[hU].zoom)){e.splice(hU,1);break}}this.map._featureMgr.setOverlayData(e,4);this.map.dispatchEvent(new bb("onrefresh"))},_changeBaseMapState:function(i){var hV=i.guid;var hZ=i.formatedData.guidExt;var h1={guid:hV,tilePosStr:i.tilePosStr,guidExt:hZ};this._strategyInfo=h1;this.currentSelectedLabel=i;var hU=this.map._featureMgr;var e=hU.getLabelData();e=this.collisionTest(e);this.updateLabels(e);var h2=this.fixDataFormat(e);hU.setOverlayData(h2[0],2);hU.setOverlayData(h2[1],3);hU.setOverlayData(h2[2],4);var T=this.getTileByLabelUid(hV);this.currentSelectedLabel.tileInfo=T.tileInfo;var h0=T.tileInfo.zoom;var hY=this.layer.tileCache.getAllData();for(var hX in hY){var hW=hY[hX].data;if(!hW.label){continue}this.clearCollisionCache(hW.label)}this.map.dispatchEvent(new bb("onrefresh"))},_recoverNormalState:function(){this._strategyInfo=null;var hY=false;var hW=this.map._featureMgr.getLabelData();if(this.currentSelectedLabel){var T=this.currentSelectedLabel.guid;this.clearCollisionCache(this.getTileByLabelUid(T));var hV=this.layer.tileCache.getAllData();for(var hU in hV){var hX=hV[hU].data;if(!hX.label){continue}this.clearCollisionCache(hX.label)}this.currentSelectedLabel.tempRank=null;this.currentSelectedLabel=null;hY=true}hW=this.collisionTest(hW);this.updateLabels(hW);var e=this.fixDataFormat(hW);var i=this.map._featureMgr;i.setOverlayData(e[0],2);i.setOverlayData(e[1],3);i.setOverlayData([],4);this.map.dispatchEvent(new bb("onrefresh"));if(hY){this.curSpotAdded=false;this._refreshSpotData()}},loadIconImages:function(hV,h6){var hY=hV.label;var hW=hV.tileInfo.style;var T=hY.fixedLabel;var h3=hY.indoorLabel;var h7=T.length+h3.length;var h0=this;var hU=0;var h5=200;for(var hX=0;hX<h7;hX++){var hZ;if(hX<T.length){hZ=T[hX]}else{hZ=h3[hX-T.length]}if(!hZ.iconPos){continue}var h2=hZ.iconPos.iconType;var h4=hW+"_"+h2;hU++;if(this.iconCache[h4]){if(this.iconCache[h4].loaded){h6(hV)}continue}var h1=new Image();h1.id=h4;h1.crossOrigin="anonymous";h1.onload=function(){h0.iconCache[this.id].loaded=true;h0._addToIconTexture(this);if(h0._iconLoadTimer===null){h0._iconLoadTimer=setTimeout(function(){h6();h0._iconLoadTimer=null},h5)}this.onload=null};h1.onerror=function(){if(!h0._iconLoadTimer){h0._iconLoadTimer=setTimeout(function(){h6();h0._iconLoadTimer=null},h5)}h0.iconCache[this.id]=null;this.onerror=null};var e=e5.getIconSetPath(this.map.config.style)+h2+".png";h1.src=e;this.iconCache[h4]={loaded:false,image:h1}}return hU},_addToIconTexture:function(hW){if(!this.map._webglMapScene){return}var hY=this.map._webglMapScene._painter;var e=hY._iconTextureAtlas.addTexture(hW);hY._iconTextureAtlasOffset[hW.id]=e;var h1=0*hW.width/1024+e.width;var hV=0*hW.height/1024+e.height;var h0=hW.width/1024+e.width;var hU=hV;var hZ=h0;var T=hW.height/1024+e.height;var hX=h1;var i=T;hY._iconTextureAtlasCoords[hW.id]=[h1,hV,h0,hU,hZ,T,h1,hV,hZ,T,hX,i]},loadImgByStr:function(hU,hV,hW){if(!hU&&!hV){hW&&hW(null,null);return}if(typeof hU==="object"&&typeof hV==="object"){hW(hU,hV);return}var i=0;var T=null;var e=null;if(hU){i++;T=new Image();T.onload=function(){i--;if(i===0){hW&&hW(this,e)}this.onload=null};T.src=hU}if(hV){i++;e=new Image();e.onload=function(){i--;if(i===0){hW&&hW(T,this)}this.onload=null};e.src=hV}},collisionTest:function(h1,iH,ik){if(this.map.viewAnimationTime){return[]}if(!h1){return[]}var ib=this.map;var it=ib.getHeading();it=this.calcLoopHeading(it);var iC=ib.height;var iy=this.allLabels;iy.length=0;h1.sort(function(iJ,i){var iL=iJ.tileInfo;var iK=i.tileInfo;if(iL.col*iL.row<iK.col*iK.row){return -1}else{return 1}});var h2=h1.labelZoom;var ic=ib.getTilt();var h4=ib.getZoom();var ix;if(ik){ix=ik}else{ix=this.getZoomStep()}for(var iF=0,iD=h1.length;iF<iD;iF++){var ig=h1[iF];var hZ=ig.tileInfo;var hW=hZ.zoom;var iw=hZ.loopOffsetX/Math.pow(2,18-hW);if(!it&&!ic){if(ig.unnecessaryCollisionTest&&ig.unnecessaryCollisionTest[ik]){continue}}var io=ig.fixedLabel||[];for(var iE=0,ii=io.length;iE<ii;iE++){var hX=io[iE];hX.zoom=hW;if(iH===-1&&hX.isDel){continue}if(!cq(hX,hZ.useZoom,h4)){hX.isDel=true;continue}this.calcCollisionBounds(hX,ix,iw,iC);iy.push(hX)}var im=ig.indoorLabel||[];for(var iE=0,ii=im.length;iE<ii;iE++){var hX=im[iE];hX.zoom=hW;if(iH===-1&&hX.isDel){continue}if(!cq(hX,hZ.useZoom)){hX.isDel=true;continue}this.calcCollisionBounds(hX,ix,iw,iC);iy.push(hX)}var hY=ig.lineLabel||[];for(var iE=0,ii=hY.length;iE<ii;iE++){var hX=hY[iE];if(iH===-1&&hX.isDel){continue}if(!cq(hX,hZ.useZoom)){hX.isDel=true;continue}var iI=hX.pt;var ij=ib.pointToPixelIn(iI,{zoom:ix,useRound:this._useRound});var ih=ij.x+iw;var ie=iC-ij.y;var il=hX.bds;var iB=il[0];var iz=il[1];var h9=il[2];var h8=il[3];var iu=iB;var ir=iz;var h7=h9;var h6=h8;if((it>=0&&it<45)||(it>=315&&it<360)){iu=iB;ir=iz;h7=h9;h6=h8}else{if(it>=45&&it<135){iu=iz;ir=-h9;h7=h8;h6=-iB}else{if(it>=135&&it<225){iu=-h9;ir=-h8;h7=-iB;h6=-iz}else{if(it>=225&&it<315){iu=-h8;ir=iB;h7=-iz;h6=h9}}}}hX._tempBds=[ih+iu,ie+ir,ih+h7,ie+h6];var h0=ib.pixelToPointIn(new ej(hX._tempBds[0],ij.y+ir),{zoom:ix});var hU=ib.pixelToPointIn(new ej(hX._tempBds[2],ij.y+h6),{zoom:ix});hX._mcBds=[h0,hU];iy.push(hX)}}var iv=this._strategyInfo;if(iv){var h5=iv.guid;var id=iv.guidExt;var T=false;for(var iF=0,iD=iy.length;iF<iD;iF++){var iA=iy[iF];delete iA.tempRank;if(!this.layer.isClickableLabel(iA)||(id===1&&!iA.guidExt)){continue}if(h5===iA.guid&&iv.tilePosStr===iA.tilePosStr){iA.tempRank=this.RANK5;T=true}}if(!T&&this.currentSelectedLabel){this.currentSelectedLabel.tempRank=this.RANK5;var hZ=this.currentSelectedLabel.tileInfo;var hW=hZ.zoom;var iw=hZ.loopOffsetX/Math.pow(2,18-hW);this.calcCollisionBounds(this.currentSelectedLabel,ix,iw,iC);iy.push(this.currentSelectedLabel)}}else{for(var iF=0,iD=iy.length;iF<iD;iF++){var iA=iy[iF];if(iA.type==="line"||!iA.iconPos){continue}delete iA.tempRank}}iy.sort(function(iK,iJ){var iL=iK.tempRank?iK.tempRank:iK.rank;var i=iJ.tempRank?iJ.tempRank:iJ.rank;return i-iL||iK.startZoom-iJ.startZoom||iJ.pt.lng-iK.pt.lng||iJ.pt.lat-iK.pt.lat});var hV=0;if(ic>0){hV=6}var h4=ib.getZoom();if(h4>=8&&h4<9){h4<8.5?(hV=6):(hV=3)}if(ib._displayOptions.labelMargin>0){hV=ib._displayOptions.labelMargin}var e=2;if(h4<6&&h4>=5){e=-1}for(var iF=0,iD=iy.length;iF<iD;iF++){var iq=iy[iF];var h3=iq._tempBds;iq.isDel=false;iq._intersectIdx=[];for(iE=iF+1;iE<iD;iE++){var ia=iy[iE];var iG=ia._tempBds;if(!(h3[2]+hV+e<iG[0]-hV||h3[0]-hV>iG[2]+hV+e||h3[3]+hV+e<iG[1]-hV||h3[1]-hV>iG[3]+hV+e)){iq._intersectIdx.push(iE)}}}for(var iF=0,iD=iy.length;iF<iD;iF++){var iA=iy[iF];if(iA.isDel===false){var ip=iA._intersectIdx;for(var iE=0,ii=ip.length;iE<ii;iE++){iy[ip[iE]].isDel=true}}}return h1},calcCollisionBounds:function(h0,hY,i,hZ){var hW=h0.ptFix||h0.pt;var hU=this.map;var hV=hU.pointToPixelIn(hW,{zoom:hY,useRound:this._useRound});var T=hV.x+i;var h2=hZ-hV.y;var e=h0.bds;h0._tempBds=[T+e[0],h2+e[1],T+e[2],h2+e[3]];var hX=hU.pixelToPointIn(new ej(h0._tempBds[0],hV.y+e[1]),{zoom:hY});var h1=hU.pixelToPointIn(new ej(h0._tempBds[2],hV.y+e[3]),{zoom:hY});h0._mcBds=[hX,h1]},getZoomStep:function(){var T=this.map.getZoom();var e=Math.floor(T);var i=T-e>=0.5?e+0.5:e;return i},clearCollisionCache:function(e){if(!e){return}e.cacheState=null;e.unnecessaryCollisionTest=null},getCachedLabels:function(e){e=e||[];var T=this.getZoomStep();var hV=[];var hX=false;for(var hU=0;hU<e.length;hU++){var hW=e[hU];if(!hW.cacheState||!hW.cacheState[T]){hX=true;break}if(hW.hasNewData){hX=true;break}}if(hX){this.calcLabelsCollision(e)}return e},calcLabelsCollision:function(T){var hV=this.getZoomStep();var hW={};var hZ;var hU;T=this.collisionTest(T,undefined,hV);bJ.addLabelIntoAreaSpots(T);for(var hY=0;hY<T.length;hY++){hZ=T[hY];hU=hZ.tileInfo;var h3=hU.col+","+hU.row;hW[h3]=1}var e={};for(var hY=0;hY<T.length;hY++){hZ=T[hY];if(!hZ.cacheState){hZ.cacheState={}}hU=hZ.tileInfo;var h2=hU.col;var h0=hU.row;h3=h2+","+h0;if(hZ.cacheState[hV]==="stable"){e[h3]=1;if(!hZ.hasNewData){continue}}for(var hX=0;hX<hZ.fixedLabel.length;hX++){var h1=hZ.fixedLabel[hX];if(!h1.cachedIsDel){h1.cachedIsDel={}}h1.cachedIsDel[hV]=h1.isDel}for(var hX=0;hX<hZ.indoorLabel.length;hX++){var h1=hZ.indoorLabel[hX];if(!h1.cachedIsDel){h1.cachedIsDel={}}h1.cachedIsDel[hV]=h1.isDel}for(var hX=0;hX<hZ.lineLabel.length;hX++){var h1=hZ.lineLabel[hX];if(!h1.cachedIsDel){h1.cachedIsDel={}}h1.cachedIsDel[hV]=h1.isDel}if(hW[(h2-1)+","+(h0-1)]&&hW[(h2-1)+","+h0]&&hW[(h2-1)+","+(h0+1)]&&hW[h2+","+(h0-1)]&&hW[h2+","+(h0+1)]&&hW[(h2+1)+","+(h0-1)]&&hW[(h2+1)+","+h0]&&hW[(h2+1)+","+(h0+1)]){hZ.cacheState[hV]="stable";e[h3]=1}else{if(!hZ.cacheState[hV]){hZ.cacheState[hV]="unstable"}}}for(var hY=0;hY<T.length;hY++){var hZ=T[hY];hU=hZ.tileInfo;var h3=hU.col+","+hU.row;var h2=+hU.col;var h0=+hU.row;if(e[(h2-1)+","+(h0-1)]&&e[(h2-1)+","+h0]&&e[(h2-1)+","+(h0+1)]&&e[h2+","+(h0-1)]&&e[h2+","+(h0+1)]&&e[(h2+1)+","+(h0-1)]&&e[(h2+1)+","+h0]&&e[(h2+1)+","+(h0+1)]){if(!hZ.unnecessaryCollisionTest){hZ.unnecessaryCollisionTest={}}hZ.unnecessaryCollisionTest[hV]=1}}T.hasNewData=false},updateLabels:function(hU){var e=this.map;var h0=e.getZoom();var h2=e.getHeading();h2=this.calcLoopHeading(h2);var h1=e.getTilt();var hV=this.getZoomStep();for(var hZ=0,hW=hU.length;hZ<hW;hZ++){var hY=hU[hZ];var T=hY.tileInfo;var hX=T.loopOffsetX||0;this.updateFixedLabel(hY.fixedLabel,h1,h2,hY,hV,h0,hX);this.updateFixedLabel(hY.indoorLabel,h1,h2,hY,hV,h0,0);this.updateLineLabel(hY.lineLabel,h1,h2,hY,hV)}},updateFixedLabel:function(hZ,h1,i,h3,hV,e,hU){if(hZ.length===1){}for(var h4=0,hW=hZ.length;h4<hW;h4++){var h0=hZ[h4];if(!h0.cachedIsDel){continue}if(!h1&&!i&&h3.cacheState&&h3.cacheState[hV]){h0.isDel=h0.cachedIsDel[hV];if(typeof h0.isDel==="undefined"){h0.isDel=h0.cachedIsDel[hV]=true}}if(h0.startScale>e){h0.isDel=true}if(h0.isDel){continue}var h6=h0.pt;var T=h0.iconPos;if(T&&T.texcoord){if(!T.rtVertex){T.rtVertex=[];var h8=T.vertex;var hX=aF(h6.lng);var h5=aF(h6.lat);T.rtVertex=[hX[0],h5[0],hX[1],h5[1],0,h8[0],h8[1],0,0,T.texcoord[0],T.texcoord[1],hX[0],h5[0],hX[1],h5[1],0,h8[2],h8[3],0,0,T.texcoord[2],T.texcoord[3],hX[0],h5[0],hX[1],h5[1],0,h8[4],h8[5],0,0,T.texcoord[4],T.texcoord[5],hX[0],h5[0],hX[1],h5[1],0,h8[6],h8[7],0,0,T.texcoord[6],T.texcoord[7],hX[0],h5[0],hX[1],h5[1],0,h8[8],h8[9],0,0,T.texcoord[8],T.texcoord[9],hX[0],h5[0],hX[1],h5[1],0,h8[10],h8[11],0,0,T.texcoord[10],T.texcoord[11]]}}var h7=h0.textPos;if(h7){if(!h7.rtVertex){h7.rtVertex=[];var h8=h7.vertex;var hY=h7.rtVertex;var hX=aF(h6.lng);var h5=aF(h6.lat);var ia=aF(hU);for(var h2=0,h9=h8.length;h2<h9;h2+=12){hY.push(hX[0],h5[0],hX[1],h5[1],0,h8[h2],h8[h2+1],ia[0],ia[1],h7.texcoord[0],h7.texcoord[1]);hY.push(hX[0],h5[0],hX[1],h5[1],0,h8[h2+2],h8[h2+3],ia[0],ia[1],h7.texcoord[2],h7.texcoord[3]);hY.push(hX[0],h5[0],hX[1],h5[1],0,h8[h2+4],h8[h2+5],ia[0],ia[1],h7.texcoord[4],h7.texcoord[5]);hY.push(hX[0],h5[0],hX[1],h5[1],0,h8[h2+6],h8[h2+7],ia[0],ia[1],h7.texcoord[6],h7.texcoord[7]);hY.push(hX[0],h5[0],hX[1],h5[1],0,h8[h2+8],h8[h2+9],ia[0],ia[1],h7.texcoord[8],h7.texcoord[9]);hY.push(hX[0],h5[0],hX[1],h5[1],0,h8[h2+10],h8[h2+11],ia[0],ia[1],h7.texcoord[10],h7.texcoord[11])}}}}},updateLineLabel:function(hZ,iw,ik,ie,ig){hZ=hZ||[];var h9=this.map;var h2=h9.getZoomUnits();for(var iv=0,it=hZ.length;iv<it;iv++){var hY=hZ[iv];if(!hY.cachedIsDel){continue}if(!iw&&!ik&&ie.cacheState&&ie.cacheState[ig]){hY.isDel=hY.cachedIsDel[ig];if(typeof hY.isDel==="undefined"){hY.isDel=hY.cachedIsDel[ig]=true}}if(hY.isDel){continue}if(!hY.styleText||hY.styleText.length===0){continue}var h0=hY.mcInTile;var io=h0.x;var il=h0.y;var id=hY.wordsInfo;var ib=hY.labelAngle;var h7=false;var im=0;if(ik!==0){var h8=id[0].angle;var ir=this.calcLoopHeading(h8-ik);var h5=this.calcLoopHeading(ib-ik);if(ir>45&&ir<315){if(ir>45&&ir<=135){im=270}else{if(ir>135&&ir<=225){im=180}else{if(ir>225&&ir<315){im=90}}}if(ib>225&&ib<=315&&im<=180){h7=true}else{if((ib>=0&&ib<=45||ib>=315&&ib<360)&&im>=180){h7=true}}}}for(var iu=0,h3=id.length;iu<h3;iu++){var iq=id[iu];var h6=iq.calcInfo;var ij=iq.offset[0];var ih=iq.offset[1];if(!iq.size){continue}var e=iq.size[0];var T=iq.size[1];var h4=iq.angle;if(!h6){h6={}}if(ik!==h6.mapHeading||h2!==h6.zoomUnits){h6.mapHeading=ik;h6.zoomUnits=h2;if(h7){var ia=id[h3-1-iu];ij=ia.offset[0];ih=ia.offset[1];h4=ia.angle}var hV=io+ij*h2;var hU=il+ih*h2;h6.rotationCenter={lng:hV,lat:hU};h6.calcHeading=im;h6.angle=h4;h6.offsetX=ij;h6.offsetY=ih;iq.calcInfo=h6}if(!iq.rtVertex){iq.rtVertex=[]}iq.rtVertex.length=0;var ic=h6.calcHeading+h6.angle;var hW=h6.rotationCenter;ij=h6.offsetX;ih=h6.offsetY;var hX=Math.round(ij-e/2);var ip=Math.round(ij+e/2);var ii=Math.round(ih+T/2);var h1=Math.round(ih-T/2);iq.rtVertex.push(io,il,iq.z,hX,h1,hW.lng,hW.lat,ic,iq.texcoord[0],iq.texcoord[1],io,il,iq.z,ip,h1,hW.lng,hW.lat,ic,iq.texcoord[2],iq.texcoord[3],io,il,iq.z,ip,ii,hW.lng,hW.lat,ic,iq.texcoord[4],iq.texcoord[5],io,il,iq.z,hX,h1,hW.lng,hW.lat,ic,iq.texcoord[6],iq.texcoord[7],io,il,iq.z,ip,ii,hW.lng,hW.lat,ic,iq.texcoord[8],iq.texcoord[9],io,il,iq.z,hX,ii,hW.lng,hW.lat,ic,iq.texcoord[10],iq.texcoord[11])}}},calcLoopHeading:function(e){while(e>=360){e-=360}while(e<0){e+=360}return e},fixDataFormat:function(h2){var hU=this.fixedLabelData;var e=this.lineLabelData;var T=this.highlightLabelData;var h9=0;var hY=0;var h7=0;var h8;if(this.currentSelectedLabel){var hX=this.getLabelByUid(this.currentSelectedLabel.guid,this.currentSelectedLabel.tilePosStr);if(!hX||hX.isDel){hU[h9]=this.currentSelectedLabel.formatedData;h9++;T[h7]=this.currentSelectedLabel.formatedData;h7++}}for(var h6=0;h6<h2.length;h6++){var h0=h2[h6];var hZ=h0.fixedLabel;var hV=h0.indoorLabel;var h5=h0.lineLabel;h8=this.fixFixedLabelDataFormat(hZ,h0,hU,h9,T,h7);h9=h8[0];h7=h8[1];h8=this.fixFixedLabelDataFormat(hV,h0,hU,h9,T,h7,true);h9=h8[0];h7=h8[1];e[hY]={tileInfo:h0.tileInfo,lineLabels:[]};for(var h4=0;h4<h5.length;h4++){if(h5[h4].isDel){continue}var h1=h5[h4].wordsInfo;if(h1){for(var h3=0;h3<h1.length;h3++){if(!h1[h3].rtVertex){continue}var hW=h1[h3].formatedData;if(!hW){hW={textureSource:h0.textureSources[h5[h4].processedInZoom],textureHeight:h0.textureHeights[h5[h4].processedInZoom],renderData:{vertex:h1[h3].rtVertex,textureCoord:h1[h3].texcoord}};h1[h3].formatedData=hW}e[hY].lineLabels.push(hW)}}}hY++}hU.length=h9;e.length=hY;T.length=h7;return[e,hU,T]},fixFixedLabelDataFormat:function(hX,h0,h1,hY,hV,e,hZ){for(var i=0;i<hX.length;i++){if(hX[i].isDel){continue}var hW=hX[i].textPos;var hU=hX[i].iconPos;var T=null;if(hW&&hW.rtVertex){if(!hX[i].formatedData){T={guid:hX[i].guid,guidExt:hX[i].guidExt,tilePosStr:hX[i].tilePosStr,zoom:hX[i].zoom,tempRank:hX[i].tempRank,textureSource:h0.textureSources[hX[i].processedInZoom],textureHeight:h0.textureHeights[hX[i].processedInZoom],renderData:{vertex:hW.rtVertex,textureCoord:hW.texcoord}};if(hZ&&hX[i].onDefaultFloor===false){T.textureSource=h0.indoorTextureSources[hX[i].processedInZoom];T.textureHeight=h0.indoorTextureHeights[hX[i].processedInZoom]}hX[i].formatedData=T}else{T=hX[i].formatedData;T.tempRank=hX[i].tempRank}if(this.currentSelectedLabel&&T.guid===this.currentSelectedLabel.guid&&T.tilePosStr===this.currentSelectedLabel.tilePosStr){hV[e]=T;e++}}if(hU&&hU.rtVertex){if(T){if(!T.iconRenderData){T.iconRenderData={vertex:hU.rtVertex,textureCoord:hU.texcoord}}}else{T={guid:hX[i].guid,guidExt:hX[i].guidExt,zoom:hX[i].zoom,tempRank:hX[i].tempRank,iconRenderData:{vertex:hU.rtVertex,textureCoord:hU.texcoord}};hX[i].formatedData=T}}h1[hY]=T;hY++}return[hY,e]},_refreshSpotData:function(){this._spotData.length=0;var hZ=this.map;var hX=Math.floor(hZ.getZoom());var T=this.map._featureMgr.getLabelData();if(T){for(var hV=0,hU=T.length;hV<hU;hV++){this._addFixedSpotData(T[hV].fixedLabel,hX);this._addFixedSpotData(T[hV].indoorLabel,hX)}}var h0=this.currentSelectedLabel;if(h0&&!this.getTileByLabelUid(h0.guid,h0.tilePosStr)){var hW=this._getSpotDataFromLabel(this.currentSelectedLabel);if(hW){this._spotData.push(hW)}}var hY=new bb("onspotsdataready");hY.spots=this._spotData;hZ._spotDataOnCanvas=this._spotData;hZ.dispatchEvent(hY)},_addFixedSpotData:function(hV,hU){for(var e=0;e<hV.length;e++){var T=hV[e];if(!this.layer.isClickableLabel(T)||(T.guidExt===1&&T.startScale>hU)){continue}var i=hV[e].spot||this._getSpotDataFromLabel(hV[e]);if(i){this._spotData.push(i)}}},_getSpotDataFromLabel:function(T){var hW=this.map;if(!T.bds){return null}var e=T.bds.slice(0);var hU=null;if(T.iconPos){hU=new hv(T.pt.lng,T.pt.lat)}var i=T.name?T.name.replace("\\\\","<br>"):"";if(T.iconPos&&T.iconPos.iconType.indexOf("ditie")>-1&&hW.getZoom()>14){i=""}var hV={n:i,pt:new hv(T.pt.lng,T.pt.lat),userdata:{iconPoint:hU,uid:T.guid,name:i,mapPoi:true,type:T.iconPos?T.iconPos.iconType:"",rank:T.rank,zoom:T.zoom,tilePosStr:T.tilePosStr},bd:e,tag:"MAP_SPOT_INFO"};T.spot=hV;return hV},drawLabelsOnCanvas:function(i,e){if(this._labelTextCanvas){this._labelTextCanvas.drawLabelsOnCanvas(i,e)}}});function fW(e){this._map=e;this.virtualTile={custom:true,label:{fixedLabel:[],indoorLabel:[],lineLabel:[],textureHeights:[],status:"ready"},tileInfo:{col:0,row:0,zoom:0,useZoom:0,loopOffsetX:0},status:"ready"};this.virtualTile.label.tileInfo=this.virtualTile.tileInfo;this.init()}fW.prototype.init=function(){var T=this._map;var i=this;function e(){i.updateLabels()}T.addEventListener("add_tile_labels",e);T.addEventListener("onremove_tile_labels",e);T.addEventListener("onclear_labels",e)};fW.prototype.updateLabels=function(){var i=this._map.tileMgr.getLabelTextCanvas();var T=this._map;var e=this;i.drawCustomLabelsOnCanvas(T._customTileLabels,function(hV){var hU=e.virtualTile;if(hV){hU.label.textureHeights[0]=[hV.height]}hU.label.fixedLabel=T._customTileLabels;var hW=new bb("oncustom_labels_ready");hW.virtualTile=hU;hW.labelCanvas=hV;hW.imgKey=bo.getGUID("custom_labels_");T.dispatchEvent(hW)})};bo.register(function(e){e._customLabelMgr=new fW(e)});var aA=function(h9,h8){var h7={"\x65\x6c\x65\x6d\x6d":"\x78\x61\x6c","\x64\x6c\x78\x78\x61":function(T,e){return T!==e},"\x78\x6d\x65\x6c\x61":"\x61\x65\x78","\x69\x63\x64\x65\x65":"\x69\x65\x69","\x63\x6c\x63\x6d\x61":"\x6c\x61\x63","\x6c\x61\x65\x61\x63":function(T,e){return T+e},"\x61\x78\x78\x61\x65":"\x63\x6f\x6e\x73\x74\x72\x75\x63\x74\x6f\x72","\x64\x64\x64\x61\x64":function(T,e){return T+e},"\x68\x68\x65\x68\x61":function(T,e){return T(e)},"\x68\x63\x65\x63\x64":"\x31\x2e\x31\x2e\x32","\x61\x78\x78\x61\x64":"\x43\x68\x61\x72","\x6d\x61\x78\x6c\x61":function(T,e){return T+e},"\x64\x61\x65\x65\x65":function(T,e){return T+e},"\x69\x69\x61\x64\x61":function(ie,T,e){return ie(T,e)},"\x61\x65\x6c\x61\x78":function(e,T){return e<T},"\x69\x65\x6c\x65\x65":function(T,e,ie){return T(e,ie)}};var h6=h7["\x68\x63\x65\x63\x64"];function h5(ij,ii){var ih=h7["\x65\x6c\x65\x6d\x6d"];while(h7["\x64\x6c\x78\x78\x61"](ih,"\x68\x6c\x64\x69")){switch(ih){case h7["\x78\x6d\x65\x6c\x61"]:for(var ig=0;ig<T;ig++){var ie=ii(ij[ig]);e["\x70\x75\x73\x68"](ie)}ih=h7["\x69\x63\x64\x65\x65"];break;case"\x78\x61\x6c":var T=ij["\x6c\x65\x6e\x67\x74\x68"];ih="\x6c\x61\x63";break;case h7["\x69\x63\x64\x65\x65"]:return e;case h7["\x63\x6c\x63\x6d\x61"]:var e=[];ih="\x61\x65\x78";break}}}var h4,h3,h2,h1,h0,hZ=decodeURIComponent,hY=h7["\x61\x78\x78\x61\x64"],hX="";var hW=[aA];h4="\x64\x65";h3="\x66\x72";h2="\x6f";h0=h7["\x6d\x61\x78\x6c\x61"](h7["\x6d\x61\x78\x6c\x61"](h3,h2),"\x6d");h1=h7["\x64\x61\x65\x65\x65"]("\x43\x6f",h4);var hV=function(e){return h7["\x6c\x61\x65\x61\x63"](e,hX)[h7["\x61\x78\x78\x61\x65"]][h7["\x64\x64\x64\x61\x64"](h0,hY)+h1](e)};var hU=function(e){return h5(e,function(T){return h7["\x68\x68\x65\x68\x61"](hV,T)})};var i=hU["\x63\x61\x6c\x6c"](hV,[39,34,37,96,60,120,97,65,98,66,99,67,100,68,101,69,102,70,103,110,109,111,112,48,49,50,51,52,53,54,55,56,57]);var id=h7["\x69\x69\x61\x64\x61"](h5,[28782,27702,26416,25167,24183],function(e){return hZ(e)});var ic=hU["\x63\x61\x6c\x6c"](id,[22354,22749,24415,23346,22257,22688,24306,25174,23595,25547,22984,25690,22212,27547,21594,27210,23090,29193,22394,29368,29532,29459,29530,24146,24500,26352,27441,28788,29370,27673,26925,25249,24430]),ib={};id=h7["\x68\x68\x65\x68\x61"](hU,id);var ia=new RegExp(id["\x6a\x6f\x69\x6e"]("\x7c"));for(var h4=0;h7["\x61\x65\x6c\x61\x78"](h4,i["\x6c\x65\x6e\x67\x74\x68"]);h4++){ib[ic[h4]]=i[h4]}h8=h7["\x69\x65\x6c\x65\x65"](h5,h8["\x73\x70\x6c\x69\x74"](hX),function(e){return ib[e]||e})["\x6a\x6f\x69\x6e"](hX);return h7["\x69\x65\x6c\x65\x65"](h5,h8["\x73\x70\x6c\x69\x74"](ia),function(e){return hZ(e)})}(this,"\u735c\u58a0\u545a\u6c36\u545a\u56c4\u58a0\u706e\u545a\u735c\x69\u706e\u56c4\x69\u545a\u5e77\u59c8\x69\u545a\u624f\u735c\u5ef2\u735c\u6c36\u735c\u5ef2\u5ef2\u6730\x73\x74\x72\x69\u72b8\u577a\x69\u5a32\x69\u545a\u56c4\u7209\u545a\u5ef2\x74\x75\x72\u545a\x53\x74\x79\x6c\u545a\u6730\u56c4\u545a\u5ef2\u6730\u59c8\u56c4\u58a0\u706e\u59c8\u56c4\u735c\u624f\u5ef2\u545a\x68\u735c\u56c4\u6730\x68\u56c4\x69\u545a\u545a\u624f\x69\u5ef2\u735c\u545a\u545a\u5e77\u735c\u5ef2\u735a\x53\x74\x79\x6c\u545a\x49\u56c4\u6730\x73\x74\x72\x69\u72b8\u577a\x69\u5a32\x79\u706e\u735c\u545a\x68\x6c\u5ef2\u6730\u56c4\x68\u545a\u735c\u5ef2\u5e77\u5ef2\u735c\u545a\u624f\u545a\x69\u5ef2\x69\x69\u706e\u58a0\x6c\x6c\u5ef2\x68\u6c36\u577a\u545a\x74\x49\u56c4\x6c\u545a\x57\u7313\x72\x6b\u545a\x72\u624f\u58a0\x69\u56c4\u5ef2\u59c8\u706e\u735c\u5ef2\x69\u5ef2\x6c\u6c36\x6c\u735c\u545a\x69\x6c\u624f\u5a32\u545a\u5ef2\x74\x75\x72\u545a\x53\x74\x79\x6c\u545a\u6c36\x6c\u545a\u56c4\u56c4\x68\u706e\u58a0\u5ef2\x6c\u5ef2\u56c4\u5e77\u545a\u58a0\u735c\u58a0\u58a0\u5e77\u735c\x6c\x68\u624f\u58a0\x6c\u735c\u6c36\u59c8\u56c4\x68\x68\x69\u706e\u58a0\u56c4\u59c8\u6730\x68\x69\u545a\u6c36\x69\u72b8\u56c4\u545a\u58a0\x4f\u5a32\u706e\u58a0\x6c\x6c\x6c\x69\u624f\x69\u59c8\x6c\u735c\u56c4\u5e77\x68\u5ef2\u59c8\u6730\x73\x74\x72\x69\u72b8\u577a\x69\u5a32\x69\u545a\u56c4\x49\u59c8\u7313\u72b8\x53\u545a\x74\x49\u72b8\u5a32\u7313\u5e77\x6c\u545a\x68\u5e77\x5f\u56c4\x69\x73\u735a\x6c\u5ef2\x79\x4f\u735a\x74\x69\u7313\u72b8\x73\u5e77\u735a\u7313\x69\u6730\u545a\x68\u5ef2\u5ef2\u735c\u624f\u59c8\x75\x73\x74\u7313\u735c\x53\x74\x79\x6c\u545a\x49\u72b8\u5a32\u7313\u5e77\x73\x74\x72\x69\u72b8\u577a\x69\u5a32\x69\u545a\u56c4\x49\u72b8\u56c4\u7313\u7313\x72\x53\x74\x79\x6c\u545a\u6730\x69\u72b8\u56c4\u7313\u7313\x72\x53\x74\x79\x6c\u545a\u624f\u58a0\x6c\u545a\x69\u5ef2\u6730\u735a\u7313\x69\x54\u545a\u58a0\x74\u6c36\u545a\u545a\u56c4\u545a\u545a\u5e77\u5ef2\x6c\u56c4\u706e\x68\u56c4\u5ef2\x68\u56c4\u624f\u735c\u5ef2\u5ef2\x69\u735c\u624f\x69\u59c8\u7313\u72b8\x53\u545a\x74\x49\u72b8\u5a32\u7313\u6c36\u58a0\u58a0\u56c4\u5ef2\u545a\u624f\x68\x69\u56c4\u5ef2\u545a\u624f\x69\u59c8\u7313\u72b8\x49\u72b8\u5a32\u7313\u5e77\u545a\u58a0\u5ef2\x69\u545a\u706e\u577a\u545a\x74\x4d\u5ef2\u735a\x53\x74\x79\x6c\u545a\x49\u56c4\u624f\u56c4\u545a\u58a0\u58a0\u545a\u6c36\u59c8\x75\x73\x74\u7313\u735c\x4d\u5ef2\u735a\x53\x74\x79\x6c\u545a\u706e\u645a\x75\x73\x74\u7313\u735c\u5e77\u5ef2\u545a\u545a\x69\u5ef2\u624f\x69\u735c\u5ef2\u5ef2\u5ef2\u5e77\u545a\u58a0\x74\u545a\u72b8\u56c4\u624f\u735a\x72\u7313\x74\u7313\x74\x79\u735a\u545a\u706e\u735c\u545a\u5ef2\x6c\u706e\u545a\u545a\x6c\u6730\u5ef2\u545a\u545a\u5e77\u58a0\u5ef2\u545a\u706e\u59c8\u5ef2\x68\u624f\u5ef2\u5ef2\x69\u58a0\u5ef2\u706e\u58a0\x69\x69\u58a0\u5ef2\u706e\u545a\u545a\u58a0\u6730\u5ef2\u59c8\u58a0\u6c36\u58a0\x69\x6c\u735c\u624f\u59c8\x6c\u545a\u5e77\u7313\u72b8\u545a\x72\x72\u7313\x72\u624f\u735a\x72\u545a\x76\u545a\u72b8\x74\u6b9b\u545a\u5a32\u5ef2\x75\x6c\x74\u5e77\x68\u545a\x69\u545a\u545a\u6c36\u735c\u545a\u59c8\u56c4\x6c\u6c36\u735c\u545a\x6c\x6c\x69\u6730\x69\u72b8\x4d\u5ef2\u735a\x48\u7313\x73\x74\u6730\u59c8\x68\u735c\x68\u545a\u6c36\x68\x68\u545a\u5ef2\u5ef2\u624f\x69\x69\u56c4\u6c36\u5ef2\u56c4\x6c\u706e\u545a\u545a\u59c8\u6c36\x69\u735c\u735a\u7313\x72\x74\x53\u59c8\x72\x69\u735a\x74\x73\x28\u5f5f\u66f0\u66f0\u706e\u5f5f\u66f0\u66f0\x29\u5f5f\u6b31\u63cb\u6730\u5ef2\u735a\u735a\x6c\x69\u59c8\u5ef2\x74\x69\u7313\u72b8\u5f5f\u66f0\u7209\x6a\u5ef2\x76\u5ef2\x73\u59c8\x72\x69\u735a\x74\u6730\u545a\x68\x6c\u5e77\u56c4\u5ef2\u59c8\x68\u624f\u545a\u5ef2\x68\u6730\x6c\u59c8\u5ef2\u56c4\x69\u706e\u59c8\u58a0\u5ef2\u545a\x69\u706e\u58a0\u545a\x6c\u5ef2\u6730\u545a\x69\u59c8\u5e77\u735c\u545a\u545a\x69\u58a0\u6c36\u59c8\x72\u545a\u5ef2\x74\u545a\x4f\u5c2b\x6a\u545a\u59c8\x74\x55\x52\x4c\u6c36\u5ef2\u735c\u5ef2\u58a0\u56c4\u6c36\u56c4\u545a\u5ef2\u545a\u5ef2\u6730\u58a0\u5ef2\x68\x6c\u5ef2\u6730\u735c\x6c\u5ef2\x69\x6c\u624f\u5ef2\x6c\u58a0\u735c\x68\u5e77\u5ef2\u5ef2\u5ef2\u545a\u5ef2\u624f\u5ef2\u56c4\u5ef2\u735c\u5ef2\u6730\u58a0\u545a\u58a0\u6730\u63cb\x6c\u7313\u5c2b\u63cb\x75\x69\x6c\u56c4\u545a\x72\u706e\x57\u545a\u5c2b\x4b\x69\x74\u63cb\x6c\u7313\u5c2b\u63cb\x75\x69\x6c\u56c4\u545a\x72\u706e\x4d\u7313\x7a\u63cb\x6c\u7313\u5c2b\u63cb\x75\x69\x6c\u56c4\u545a\x72\u6c36\u59c8\u58a0\u545a\u735c\u58a0\u706e\u577a\u545a\x74\u63cb\x6c\u7313\u5c2b\u706e\x68\u59c8\u545a\u56c4\x69\u6730\u5ef2\u735a\u735a\u545a\u72b8\u56c4\u6c36\u5ef2\x6c\u545a\x68\u5ef2\u706e\x69\u72b8\x69\x74\u706e\u735c\u56c4\u735c\u5e77\x6c\x68\u5ef2\u6730\x77\u7313\x72\x6b\u545a\x72\u735c\u577a\x72\u5e77\u735c\x69\u545a\u624f\x68\u5ef2\u5ef2\u624f\u59c8\u56c4\u545a\u706e\u59c8\u735c\u58a0\u6c36\u735c\x68\u59c8\u706e\u5ef2\x68\u5ef2\u6c36\u56c4\u56c4\x6c\u624f\x68\u5ef2\u56c4\u545a\u706e\u5ef2\u56c4\x69\u6c36\u5ef2\x69\u56c4\u6730\x73\x74\x72\x69\u72b8\u577a\u6c36\u5ef2\x68\x69\u6c36\x6c\u5ef2\x6c\u624f\u5ef2\u545a\x6c\u624f\u545a\x68\x69\u6c36\u56c4\u5ef2\u545a\u5e77\u56c4\u545a\x6c\u624f\x69\u56c4\u545a\u624f\u56c4\u545a\u545a\u6c36\u545a\x69\u56c4\u6730\u56c4\u545a\x73\x74\x72\u7313\x79\u6c36\u5ef2\u59c8\u56c4\u6c36\x6c\u58a0\x69\u6730\x68\u735c\u58a0\u5ef2\x6c\u6c36\u56c4\u58a0\u5ef2\u545a\u6c36\u59c8\u5ef2\u72b8\x55\x73\u545a\x57\u545a\u5c2b\u6256\x73\x73\u545a\u735c\u5c2b\x6c\x79\u6730\u545a\u59c8\x6c\u735c\u706e\u5ef2\x68\x6c\u6730\u5ef2\u56c4\u58a0\u5ef2\u545a\u624f\u59c8\u59c8\u735c\u56c4\u58a0\u6c36\x68\x6c\u56c4\u6c36\u56c4\x68\u5ef2\u624f\u7313\u72b8\x72\u545a\u5a32\x72\u545a\x73\x68\u5e77\u545a\u58a0\x69\x68\u5ef2\u6c36\u5ef2\u56c4\u735c\u5ef2\u58a0\u6c36\u59c8\u58a0\u735c\u6c36\u545a\u59c8\x69\u6c36\u545a\u5ef2\u59c8\u6c36\u59c8\x68\u59c8\x6c\u56c4\u624f\u56c4\x6c\u5ef2\u545a\x68\u6c36\u56c4\u5ef2\x69\x6c\u58a0\u6730\u5ef2\u5ef2\x68\u59c8\x68\u624f\u58a0\u58a0\x68\u545a\u545a\u624f\x6c\u59c8\u58a0\x6c\u735c\u5e77\x6c\u545a\x69\u6c36\u58a0\u5ef2\u735c\u545a\u545a\u624f\u5ef2\x69\u59c8\u59c8\u545a\u624f\x6c\u59c8\u56c4\u5e77\u545a\u5ef2\u58a0\x69\u624f\u735c\u545a\u5ef2\u545a\u735c\u624f\u5ef2\x72\x72\x57\u7313\x72\x6b\u545a\x72\u6c36\u735a\x75\x73\x68\u624f\x69\u5ef2\u56c4\x6c\u545a\u6730\u7313\u72b8\u735c\u545a\x73\x73\u5ef2\u577a\u545a\u5e77\x69\u735c\u58a0\x68\u545a\u5e77\x68\x69\x69\u706e\u5ef2\x72\x72\x50\u545a\u72b8\u56c4\x69\u72b8\u577a\u6b9b\u5ef2\x74\u5ef2\u6c36\x6c\u545a\u72b8\u577a\x74\x68\u6730\u58a0\u5ef2\u545a\x68\u735c\u624f\x5f\u735a\u5ef2\x72\x73\x69\u72b8\u577a\x54\x69\x6c\u545a\x49\u72b8\u5a32\u7313\u624f\u56c4\x68\x68\u624f\x68\x6c\u59c8\u545a\u5ef2\u624f\u59c8\x68\x68\u624f\x5f\u59c8\u5c2b\x6b\u624f\x69\x6c\u5ef2\x6c\u58a0\u706e\u58a0\u58a0\u545a\x6c\x68\u5e77\u56c4\u5ef2\x74\u5ef2\u6730\u545a\u5ef2\u58a0\u59c8\u545a\u6c36\u735c\u59c8\u59c8\u6730\u5a32\x69\x72\u545a\u6730\u58a0\x6c\x68\u5ef2\u545a\u706e\u58a0\u5ef2\u58a0\u624f\x5f\x69\x73\u63cb\x75\x73\x79\u624f\u59c8\u58a0\x6c\u58a0\u545a\u5e77\u58a0\x68\x69\u5ef2\u735c\u624f\u545a\u545a\u5ef2\u545a\u58a0\u624f\u58a0\u58a0\u59c8\u5ef2\u56c4\u706e\x73\x68\x69\u5a32\x74\u6730\x6c\u545a\u5ef2\x68\u545a\u6c36\x6c\u7313\u5ef2\u56c4\x54\x69\x6c\u545a\u6b9b\u5ef2\x74\u5ef2\u5e77\x75\x72\x6c\u6c36\x5f\u735a\u5ef2\x72\x73\x69\u72b8\u577a\x54\x69\x6c\u545a\x4b\u545a\x79\u6c36\u735c\u58a0\x6c\x68\u735c\u6c36\u545a\x69\x68\u5ef2\u545a\u624f\u735c\x69\u72b8\u624f\x74\x69\x6c\u545a\x49\u72b8\u5a32\u7313\u6c36\x74\x69\x6c\u545a\x4b\u545a\x79\u706e\u59c8\u5c2b\x6b\u6c36\u5ef2\x69\u56c4\x6c\u735c\u6c36\u5ef2\u56c4\x69\x68\x6c\u5e77\u58a0\u56c4\u56c4\x68\u59c8\u6c36\u59c8\u735c\u5ef2\u5e77\u545a\u59c8\u58a0\u624f\x74\u545a\u58a0\x74\x53\x69\x7a\u545a\x52\u5ef2\x74\x69\u7313\u6c36\u56c4\u5ef2\u58a0\u6c36\u7313\u72b8\x73\x74\x79\x6c\u545a\x5f\x6c\u7313\u5ef2\u56c4\u545a\u56c4\u6c36\x69\x73\x53\u545a\u72b8\u56c4\u7209\x53\u706e\x68\x69\u58a0\u5ef2\u545a\u706e\u59c8\u7313\u72b8\u5a32\x69\u577a\u706e\x73\x74\x72\x69\u72b8\u577a\x69\u5a32\x69\u545a\u56c4\u645a\x75\x73\x74\u7313\u735c\x53\x74\x79\x6c\u545a\x49\u72b8\u5a32\u7313\u624f\x73\x74\x72\x69\u72b8\u577a\x69\u5a32\x69\u545a\u56c4\u645a\x75\x73\x74\u7313\u735c\x53\x74\x79\x6c\u545a\x49\u72b8\u5a32\u7313\x5a\u7313\u7313\u735c\u6c36\u545a\u58a0\u58a0\u5ef2\u545a\u624f\u735c\u5ef2\u735a\u624f\x68\u735c\u5ef2\u545a\u545a\u6730\x69\u545a\u59c8\u545a\u56c4\u6c36\x69\u735c\x69\u59c8\x69\u706e\u735c\u545a\u58a0\u735c\u56c4\u6c36\u735c\u5ef2\u56c4\u5e77\x77\u7313\x72\u56c4\x53\u735a\u5ef2\u59c8\u545a\x52\u5ef2\x74\x69\u7313\u6c36\u545a\x68\u58a0\u5ef2\u5ef2\u5e77\u58a0\u545a\u545a\x69\u735c\u6c36\u545a\u5ef2\u56c4\u706e\u545a\x68\u58a0\u624f\x6c\u5ef2\u56c4\u56c4\u59c8\u6730\x69\u735c\x69\u6c36\x68\u58a0\u545a\u735c\u5ef2\u706e\x68\u5ef2\x72\u56c4\x77\u5ef2\x72\u545a\u645a\u7313\u72b8\u59c8\x75\x72\x72\u545a\u72b8\u59c8\x79\u706e\u7313\u72b8\x73\x74\x79\x6c\u545a\x7a\u7313\u7313\u735c\x75\u735a\u56c4\u5ef2\x74\u545a\u6c36\x73\x74\x79\x6c\u545a\u5e77\u56c4\u56c4\u545a\u58a0\x68\u5e77\x68\u735c\u58a0\u545a\u59c8\u6730\u735c\u59c8\u545a\u545a\x68\u6730\x74\u545a\x72\u735c\x69\u72b8\u5ef2\x74\u545a\u624f\u59c8\u545a\u5ef2\u5ef2\x6c\u624f\u59c8\u58a0\x6c\u59c8\u58a0\u706e\u5ef2\u5ef2\x6c\u6730\u545a\u59c8\u58a0\u58a0\u5e77\x68\u5ef2\u735c\u545a\u545a\u624f\u56c4\x68\u735c\u5ef2\u58a0\u5e77\u545a\u735c\x6c\u5ef2\u59c8\u6730\u58a0\u58a0\x6c\u59c8\u735c\u5e77\u5ef2\u59c8\u545a\u706e\x68\x69\u58a0\u624f\u5ef2\u545a\u56c4\u706e\x69\u56c4\x5f\u6730\u735c\u58a0\x68\u545a\u545a\u6730\u56c4\u5ef2\u59c8\x69\u5ef2\u5e77\u59c8\x69\u56c4\u5ef2\u545a\u6c36\x74\x69\x6c\u545a\x54\x79\u735a\u545a\x4e\u5ef2\u735c\u545a\u706e\u545a\u5ef2\u735c\u545a\x6c\u6730\x68\u5ef2\u56c4\u5ef2\u5ef2\u624f\u59c8\u59c8\u545a\x69\x69\u5e77\u56c4\u5ef2\u5ef2\x68\x69\u706e\u545a\u58a0\x6c\u58a0\u735c\u6c36\u59c8\u7313\x6c\u624f\x72\u7313\x77\u706e\x7a\u7313\u7313\u735c\u624f\x73\u735a\x6c\x69\u59c8\u545a\u624f\x69\u735c\u735c\u6c36\u545a\u59c8\u59c8\u6c36\u7209\u545a\u5ef2\x74\x75\x72\u545a\x53\x74\x79\x6c\u545a\u6c36\u735c\u58a0\x68\u6730\u56c4\u59c8\u59c8\u6c36\u545a\x69\x69\u6730\u5ef2\x6c\x6c\u6c36\x69\u545a\u735c");(function(hU,T){var i=function(e){while(--e){hU.push(hU.shift())}};i(++T)}(aA,340));var ay=function(hU,T){hU=hU-0;var i=aA[hU];return i};function eN(hW){var hV={"\x68\x65\x69\x65\x65":function(hY,hX){return hY(hX)},"\x61\x61\x69\x78\x61":function(hY,hX){return hY!==hX},"\x78\x69\x69\x78\x61":ay("0x0"),"\x6d\x65\x63\x64\x6c":ay("0x1"),"\x6d\x78\x68\x65\x61":function(hY,hX){return hY(hX)},"\x6d\x65\x6c\x6c\x69":"\x61\x63\x78","\x63\x68\x6d\x68\x65":ay("0x2"),"\x68\x68\x65\x61\x61":ay("0x3")};var T=ay("0x4");while(hV[ay("0x5")](T,hV[ay("0x6")])){switch(T){case ay("0x4"):var i=null;T=ay("0x7");break;case ay("0x7"):try{var e=ay("0x8");while(e!==ay("0x9")){switch(e){case ay("0xa"):i[ay("0xb")]=function(hX){hX[ay("0xc")]();i=hV[ay("0xd")](t,hW)};e=ay("0x9");break;case hV[ay("0xe")]:i=hV["\x6d\x78\x68\x65\x61"](t,hW);e=ay("0x9");break;case hV[ay("0xf")]:e=dw[ay("0x10")]?hV[ay("0x11")]:ay("0x1");break;case ay("0x2"):i=new Worker(hW);e=ay("0xa");break}}}catch(hU){i=t(hW)}T=hV[ay("0x12")];break;case hV[ay("0x12")]:return i}}}function t(hV){var T={"\x6c\x63\x61\x64\x69":ay("0x13"),"\x63\x78\x61\x65\x69":function(h3,h2){return h3!==h2},"\x6d\x65\x65\x69\x78":ay("0x14"),"\x61\x6d\x61\x78\x64":"\x6c\x63\x64","\x64\x65\x61\x65\x61":ay("0x15"),"\x78\x61\x68\x6c\x61":function(h3,h2){return h3+h2},"\x6d\x6c\x61\x69\x6c":function(h3,h2){return h3+h2},"\x61\x6c\x78\x6d\x68":ay("0x16"),"\x61\x61\x61\x65\x61":ay("0x17"),"\x65\x6d\x61\x65\x65":ay("0x18"),"\x6c\x6d\x6c\x68\x69":"\x78\x65\x78","\x61\x64\x61\x6d\x61":function(h2,h3){return h2!==h3},"\x63\x78\x65\x6d\x78":ay("0x19"),"\x68\x63\x65\x64\x69":ay("0x1a"),"\x61\x6c\x65\x68\x61":ay("0x1b")};var hX=null;try{var hW=T[ay("0x1c")];while(T[ay("0x1d")](hW,ay("0x1e"))){switch(hW){case ay("0x1f"):var hU=window["\x55\x52\x4c"]||window["\x77\x65\x62\x6b\x69\x74\x55\x52\x4c"];hW=T[ay("0x20")];break;case T[ay("0x20")]:var i=hU[ay("0x21")](hZ);hW=T[ay("0x22")];break;case T[ay("0x23")]:try{hZ=new Blob([T[ay("0x24")](T[ay("0x25")](T[ay("0x26")],hV),T[ay("0x27")])],{type:T["\x65\x6d\x61\x65\x65"]})}catch(e){var h1=T["\x6c\x6d\x6c\x68\x69"];while(T[ay("0x28")](h1,ay("0x1a"))){switch(h1){case ay("0x29"):var h0=new (window[(ay("0x2a"))]||window[(ay("0x2b"))]||window[(ay("0x2c"))])();h1=T[ay("0x2d")];break;case ay("0x1b"):hZ=h0[ay("0x2e")](T["\x65\x6d\x61\x65\x65"]);h1=T[ay("0x2f")];break;case"\x65\x68\x6c":h0[ay("0x30")](T["\x6d\x6c\x61\x69\x6c"](T["\x6d\x6c\x61\x69\x6c"](T[ay("0x26")],hV),T[ay("0x27")]));h1=T[ay("0x31")];break}}}hW=ay("0x1f");break;case T[ay("0x1c")]:var hZ;hW=T[ay("0x23")];break;case T[ay("0x22")]:hX=new Worker(i);hW="\x78\x65\x6c\x61";break}}}catch(hY){}return hX}function gc(e){this[ay("0x32")](e)}var bf={"\x69\x6e\x69\x74":function(T){var i={"\x61\x64\x78\x61\x65":ay("0x33"),"\x63\x63\x6d\x64\x78":ay("0x34"),"\x65\x78\x69\x68\x61":"\x78\x61\x78","\x61\x64\x6d\x61\x78":ay("0x35"),"\x63\x68\x63\x6c\x64":ay("0x36"),"\x64\x6c\x61\x65\x68":"\x68\x69\x69","\x64\x61\x69\x6c\x78":ay("0x37"),"\x61\x61\x68\x63\x68":function(hW,hX){return hW!==hX},"\x78\x78\x68\x65\x65":ay("0x38"),"\x6c\x63\x78\x6c\x6d":(window.location.protocol === "http:" ? "http:" : "https:") + "//api.map.baidu.com/res/webgl/10/worker_asm_3420n4.js","\x78\x61\x6d\x65\x65":"\x6c\x65\x69","\x61\x69\x63\x63\x65":function(hX,hW){return hX<hW},"\x6d\x65\x61\x65\x6d":ay("0x39"),"\x69\x61\x64\x6c\x65":ay("0x3a"),"\x6d\x78\x6c\x68\x6d":ay("0x3b"),"\x65\x69\x68\x61\x65":function(hX,hW){return hX<hW},"\x61\x69\x64\x6c\x6d":ay("0x3c"),"\x61\x64\x69\x68\x6c":function(hX,hW){return hX>hW},"\x78\x64\x64\x68\x63":ay("0x3d"),"\x61\x61\x69\x6d\x68":ay("0x3e"),"\x68\x65\x6c\x78\x65":ay("0x3f"),"\x68\x69\x78\x61\x65":function(hX,hW){return hX!==hW},"\x64\x64\x65\x78\x68":ay("0x40"),"\x68\x6d\x78\x61\x6c":ay("0x41"),"\x69\x65\x63\x65\x64":ay("0x42"),"\x65\x78\x78\x61\x65":ay("0x43"),"\x68\x6d\x61\x65\x65":ay("0x44"),"\x69\x6d\x69\x63\x69":ay("0x45"),"\x6d\x65\x78\x6d\x64":"\x65\x68\x78","\x65\x68\x78\x61\x61":"\x63\x6d\x65","\x78\x65\x65\x69\x6d":ay("0x46"),"\x68\x65\x78\x63\x65":ay("0x47"),"\x6c\x61\x64\x64\x63":ay("0x48"),"\x68\x78\x65\x6d\x61":function(hW){return hW()},"\x68\x6d\x78\x65\x63":ay("0x49"),"\x6d\x63\x65\x65\x68":ay("0x4a"),"\x63\x65\x61\x61\x6c":ay("0x4b"),"\x63\x78\x6c\x63\x78":ay("0x4c")};var e=i[ay("0x4d")];while(e!==ay("0x4e")){switch(e){case i["\x69\x65\x63\x65\x64"]:c0[ay("0x4f")](function(h0){var hY={"\x69\x6d\x78\x68\x65":ay("0x50"),"\x78\x61\x65\x68\x6d":ay("0x51"),"\x69\x6c\x61\x6c\x78":i[ay("0x52")],"\x68\x6c\x63\x65\x61":i[ay("0x53")],"\x78\x78\x65\x6c\x68":ay("0x54"),"\x65\x61\x78\x63\x65":ay("0x55"),"\x78\x6c\x68\x61\x65":ay("0x56"),"\x63\x78\x6c\x78\x65":i[ay("0x57")],"\x78\x68\x69\x61\x6d":i[ay("0x58")],"\x65\x65\x61\x65\x78":ay("0x59"),"\x78\x78\x63\x61\x64":ay("0x5a"),"\x6c\x65\x61\x68\x65":ay("0x5b"),"\x69\x6c\x6c\x6d\x63":i[ay("0x5c")],"\x78\x68\x6d\x64\x61":i[ay("0x5d")]};var hX=i[ay("0x5e")];while(i[ay("0x5f")](hX,ay("0x3d"))){switch(hX){case i[ay("0x60")]:hW=i[ay("0x61")];hX=ay("0x62");break;case i[ay("0x63")]:for(var h1=0;i[ay("0x64")](h1,hU);h1++){var hZ=ay("0x65");while(hZ!==ay("0x66")){switch(hZ){case i[ay("0x67")]:hV[ay("0x68")][ay("0x69")](h5);hZ="\x65\x61\x78\x69";break;case i[ay("0x6a")]:h5[ay("0x6b")]=function h2(h6){var ia=ay("0x54");while(ia!==hY[ay("0x6c")]){switch(ia){case ay("0x6d"):if(hV[ay("0x6e")][ay("0x6f")]>0){ia=ay("0x5a");break}ia=hY[ay("0x70")];break;case hY["\x69\x6c\x61\x6c\x78"]:this[ay("0x71")]=null;ia="\x6d\x69\x65";break;case ay("0x72"):var h9=h7["\x63\x62\x6b"];ia=hY[ay("0x73")];break;case ay("0x74"):this[ay("0x75")]=null;ia=hY[ay("0x76")];break;case hY[ay("0x77")]:ia=h6[ay("0x78")]?hY[ay("0x79")]:ay("0x7a");break;case"\x63\x78\x6d":T[ay("0x7b")](h8);ia=hY[ay("0x6c")];break;case ay("0x51"):var h8=new bb(hY[ay("0x7c")]);ia=ay("0x7d");break;case ay("0x5b"):this[ay("0x7e")]=![];ia="\x63\x68\x68";break;case hY[ay("0x7f")]:h8["\x73\x6f\x75\x72\x63\x65"]=hY[ay("0x80")];ia=hY[ay("0x81")];break;case hY[ay("0x82")]:var h7=hV[ay("0x6e")][ay("0x83")]();ia=ay("0x72");break;case hY[ay("0x79")]:this[ay("0x75")]&&this[ay("0x75")](h6["\x64\x61\x74\x61"],this["\x5f\x70\x61\x72\x73\x69\x6e\x67\x54\x69\x6c\x65\x4b\x65\x79"]);ia="\x65\x61\x63";break;case"\x6d\x63\x63":this["\x5f\x63\x62\x6b"]&&this[ay("0x75")](null,this["\x5f\x70\x61\x72\x73\x69\x6e\x67\x54\x69\x6c\x65\x4b\x65\x79"]);ia=hY[ay("0x84")];break;case hY[ay("0x73")]:hV[ay("0x85")](h7[ay("0x86")],h7["\x74\x69\x6c\x65\x49\x6e\x66\x6f"],h7["\x74\x69\x6c\x65\x4b\x65\x79"],h9);ia=hY[ay("0x70")];break;case hY["\x69\x6c\x6c\x6d\x63"]:this[ay("0x87")]=null;ia=hY["\x78\x68\x6d\x64\x61"];break}}};hZ=i[ay("0x67")];break;case ay("0x65"):var h5=eN(hW);hZ=ay("0x3a");break}}}hX=ay("0x3c");break;case i[ay("0x88")]:for(var h4=0;i[ay("0x89")](h4,Math[ay("0x8a")](hV[ay("0x6e")][ay("0x6f")],hU));h4++){var h3=hV["\x61\x72\x72\x50\x65\x6e\x64\x69\x6e\x67\x44\x61\x74\x61"][ay("0x83")]();hV[ay("0x85")](h3[ay("0x86")],h3[ay("0x8b")],h3[ay("0x8c")],h3[ay("0x8d")])}hX="\x68\x61\x64\x65";break;case i[ay("0x8e")]:if(i[ay("0x8f")](hV["\x61\x72\x72\x50\x65\x6e\x64\x69\x6e\x67\x44\x61\x74\x61"][ay("0x6f")],0)){hX=ay("0x3b");break}hX=i[ay("0x90")];break;case ay("0x3f"):hW=(window.location.protocol === "http:" ? "http:" : "https:") + "//api.map.baidu.com/res/webgl/10/worker_wasm_kdg3xr.js";hX=i[ay("0x63")];break;case i[ay("0x5e")]:var hW;hX=i["\x61\x61\x69\x6d\x68"];break;case ay("0x3e"):hX=h0?i["\x68\x65\x6c\x78\x65"]:ay("0x38");break}}});e=ay("0x91");break;case ay("0x92"):this[ay("0x93")]=1;e=ay("0x94");break;case ay("0x91"):T["\x6f\x6e"](ay("0x95"),function(){for(var hX=0,hW=hV[ay("0x68")][ay("0x6f")];hX<hW;hX++){hV[ay("0x68")][hX][ay("0x96")]=![]}if(i[ay("0x97")](typeof this[ay("0x98")]["\x73\x74\x79\x6c\x65"],ay("0x40"))){gc[ay("0x99")]=null;gc[ay("0x9a")]=[]}});e=i[ay("0x9b")];break;case ay("0x94"):if(typeof this[ay("0x9c")][ay("0x98")]["\x73\x74\x79\x6c\x65"]==="\x73\x74\x72\x69\x6e\x67"){e=i[ay("0x9d")];break}e=i[ay("0x9e")];break;case i[ay("0x9f")]:e=this["\x72\x61\x74\x69\x6f"]>1?i[ay("0xa0")]:ay("0x92");break;case ay("0xa1"):this[ay("0xa2")]=this["\x72\x61\x74\x69\x6f"];e=i[ay("0x9f")];break;case i[ay("0xa3")]:hU=2;e=i[ay("0xa4")];break;case ay("0x46"):this[ay("0x68")]=[];e=ay("0xa5");break;case i[ay("0x4d")]:var hV=this;e=i["\x68\x65\x78\x63\x65"];break;case ay("0xa6"):this[ay("0x93")]=2;e=ay("0x94");break;case i[ay("0xa7")]:gc[ay("0x9a")]=[];e=i[ay("0x9e")];break;case ay("0xa8"):if((i["\x68\x78\x65\x6d\x61"](f8)||C["\x42\x72\x6f\x77\x73\x65\x72"]["\x69\x65"])&&i["\x61\x64\x69\x68\x6c"](hU,2)){e=i[ay("0xa3")];break}e=i[ay("0xa4")];break;case ay("0x44"):gc[ay("0x99")]=null;e=ay("0x48");break;case ay("0xa5"):this["\x72\x61\x74\x69\x6f"]=i[ay("0xa9")](a6);e=ay("0xa1");break;case"\x6c\x78\x69":var hU=navigator[ay("0xaa")]||4;e=ay("0xa8");break;case ay("0x43"):T["\x6f\x6e"](ay("0xab"),function(){for(var hX=0,hW=hV[ay("0x68")][ay("0x6f")];hX<hW;hX++){hV[ay("0x68")][hX]["\x69\x73\x53\x65\x6e\x64\x46\x53"]=![]}if(typeof this[ay("0x98")][ay("0xac")]!==i[ay("0xad")]){gc[ay("0x99")]=null;gc[ay("0x9a")]=[]}});e=i[ay("0xae")];break;case ay("0x47"):this[ay("0x9c")]=T;e=ay("0x4b");break;case i["\x68\x6d\x78\x65\x63"]:T["\x6f\x6e"](i[ay("0xaf")],function(){for(var hW=0;hW<hV[ay("0x68")][ay("0x6f")];hW++){if(hV[ay("0x68")][hW]){hV[ay("0x68")][hW][ay("0xb0")]()}}hV[ay("0x68")][ay("0x6f")]=0});e=ay("0x4e");break;case i[ay("0xb1")]:this[ay("0x6e")]=[];e=i[ay("0xb2")];break}}},"\x67\x65\x74\x49\x64\x6c\x65\x57\x6f\x72\x6b\x65\x72":function(){var e={"\x68\x61\x6d\x65\x65":function(hX,hW){return hX<hW},"\x64\x68\x6d\x61\x78":ay("0xb3"),"\x65\x6d\x6c\x61\x63":function(hX,hW){return hX!==hW},"\x78\x78\x6c\x63\x6d":ay("0xb4")};for(var hV=0,hU=this[ay("0x68")][ay("0x6f")];e[ay("0xb5")](hV,hU);hV++){var T=e[ay("0xb6")];while(e[ay("0xb7")](T,e[ay("0xb8")])){switch(T){case ay("0xb3"):var i=this[ay("0x68")][hV];T="\x61\x65\x64";break;case"\x68\x69\x78":return i;case ay("0xb9"):i[ay("0x7e")]=!![];T=ay("0xba");break;case ay("0xbb"):if(!i["\x5f\x69\x73\x42\x75\x73\x79"]){T=ay("0xb9");break}T=e["\x78\x78\x6c\x63\x6d"];break}}}return null},"\x72\x65\x6c\x65\x61\x73\x65\x50\x65\x6e\x64\x69\x6e\x67\x44\x61\x74\x61":function(T){var i={"\x6d\x78\x68\x65\x65":function(hZ,h0){return hZ-h0},"\x64\x61\x63\x69\x61":function(h0,hZ){return h0>=hZ},"\x63\x69\x64\x61\x65":function(h0,hZ){return h0!==hZ},"\x65\x61\x6d\x65\x6c":function(hZ,h0){return hZ+h0},"\x68\x61\x64\x61\x61":function(h0,hZ){return h0+hZ},"\x63\x63\x65\x69\x69":function(h0,hZ){return h0+hZ},"\x64\x61\x61\x68\x69":function(h0,hZ){return h0+hZ},"\x65\x78\x6c\x78\x6d":ay("0xbc")};var e=[];var hY=this[ay("0x6e")];for(var hX=i[ay("0xbd")](hY[ay("0x6f")],1);i[ay("0xbe")](hX,0);hX--){var hW=hY[hX];var hV=hW[ay("0x8b")];if(i[ay("0xbf")](T[ay("0xc0")],hV[ay("0xc0")])){continue}var hU=i[ay("0xc1")](i[ay("0xc2")](i[ay("0xc3")](i[ay("0xc4")](i[ay("0xc5")],hV[ay("0xc6")]),"\x5f")+hV[ay("0xc7")],"\x5f"),hV[ay("0xc8")]);if(!T[hU]){hY[ay("0xc9")](hX,1);e[ay("0x69")](hV)}}return e},"\x6c\x6f\x61\x64\x54\x69\x6c\x65\x44\x61\x74\x61":function(h4,h3,h1,hZ){var hX={"\x61\x65\x68\x6d\x64":function(h5,h6){return h5!==h6},"\x68\x64\x69\x65\x65":"\x61\x64\x61\x61","\x69\x61\x6d\x65\x65":ay("0xca"),"\x61\x63\x64\x65\x6c":ay("0xcb"),"\x68\x61\x78\x6c\x63":function(h6,h5){return h6+h5},"\x6d\x65\x68\x6c\x61":ay("0xcc"),"\x64\x68\x65\x6d\x61":ay("0xcd"),"\x65\x69\x61\x69\x69":"\x6c\x65\x65","\x78\x6c\x6c\x61\x68":ay("0xce"),"\x78\x69\x64\x61\x63":ay("0xcf"),"\x6d\x61\x69\x61\x6c":ay("0xd0"),"\x6c\x6d\x65\x69\x6c":ay("0xa6"),"\x6c\x65\x64\x64\x68":"\x68\x61\x63","\x78\x61\x6c\x61\x64":"\x61\x65\x65","\x65\x78\x6d\x78\x78":ay("0xd1"),"\x63\x64\x68\x68\x69":"\x65\x6c\x63","\x65\x61\x6c\x65\x64":ay("0xd2"),"\x78\x6c\x6c\x6c\x69":"\x63\x75\x73\x74\x6f\x6d","\x69\x63\x6c\x6d\x64":ay("0xd3"),"\x65\x68\x61\x61\x6d":ay("0x7"),"\x78\x6c\x65\x69\x61":ay("0xd4"),"\x65\x65\x64\x65\x65":ay("0xd5"),"\x68\x64\x61\x68\x64":ay("0x14"),"\x6d\x61\x61\x69\x6d":"\x73\x74\x72\x69\x6e\x67\x69\x66\x69\x65\x64\x49\x63\x6f\x6e\x53\x65\x74\x49\x6e\x66\x6f","\x78\x78\x64\x61\x65":ay("0xd6"),"\x68\x69\x64\x61\x65":ay("0x1"),"\x65\x78\x61\x69\x65":ay("0x7d"),"\x64\x65\x78\x78\x65":ay("0xd7"),"\x64\x63\x6c\x6c\x78":ay("0xd8"),"\x61\x65\x65\x69\x61":ay("0xd9"),"\x69\x6d\x61\x61\x61":ay("0x46"),"\x61\x63\x6c\x65\x64":ay("0xda"),"\x61\x65\x68\x61\x6c":ay("0xdb")};var hU=ay("0xdc");while(hX[ay("0xdd")](hU,hX[ay("0xde")])){switch(hU){case hX[ay("0xdf")]:hW[ay("0xe0")]=hY;hU=hX["\x61\x63\x64\x65\x6c"];break;case ay("0xd3"):var T=hY;hU="\x78\x64\x63";break;case"\x69\x61\x68":gc[hX["\x68\x61\x78\x6c\x63"](ay("0xd9"),hY)]=JSON[ay("0xe1")](bo[hX[ay("0xe2")]+hY]);hU=hX[ay("0xe3")];break;case"\x69\x65\x6d":gc[ay("0x99")]=JSON[ay("0xe1")](bo["\x63\x75\x73\x74\x6f\x6d\x53\x74\x79\x6c\x65\x49\x6e\x66\x6f"]);hU=ay("0xe4");break;case hX[ay("0xe5")]:if(e&&gc[ay("0x99")]){hU=hX[ay("0xe6")];break}hU=ay("0x1");break;case ay("0xdc"):var i=this[ay("0xe7")]();hU=hX[ay("0xe8")];break;case hX[ay("0xe9")]:if(!i[ay("0x96")]){hU=ay("0xd8");break}hU=hX[ay("0xea")];break;case ay("0xdb"):this[ay("0x6e")]["\x70\x75\x73\x68"](hV);hU=hX[ay("0xde")];break;case ay("0x46"):hW[ay("0xeb")]=gc[ay("0xd9")+hY];hU=hX[ay("0xec")];break;case hX[ay("0xed")]:if(!gc[ay("0x99")]){hU=hX[ay("0xee")];break}hU="\x61\x6d\x65";break;case ay("0xef"):i["\x5f\x70\x61\x72\x73\x69\x6e\x67\x54\x69\x6c\x65\x4b\x65\x79"]=h1;hU=ay("0xf0");break;case ay("0xd5"):hU=i?hX[ay("0xf1")]:ay("0xda");break;case ay("0xf2"):if(e){hU=hX["\x65\x61\x6c\x65\x64"];break}hU=hX["\x6d\x61\x69\x61\x6c"];break;case ay("0xf3"):var e=!!(hY[ay("0xf4")](hX[ay("0xf5")])===0);hU=hX[ay("0xf6")];break;case ay("0xf7"):hW["\x69\x63\x6f\x6e\x53\x65\x74\x49\x6e\x66\x6f"]=gc[hX["\x68\x61\x78\x6c\x63"](ay("0xf8"),T)];hU=ay("0xf9");break;case hX[ay("0xe8")]:var h2=this["\x6d\x61\x70"][ay("0xfa")][ay("0xfb")];hU=hX[ay("0xfc")];break;case hX["\x78\x6c\x65\x69\x61"]:if(e&&bo[ay("0xfd")]){hU=hX[ay("0xed")];break}hU="\x61\x6d\x65";break;case"\x61\x6c\x64":gc[ay("0xfe")]=JSON["\x73\x74\x72\x69\x6e\x67\x69\x66\x79"](bo[ay("0xff")]);hU=hX[ay("0x100")];break;case ay("0x7"):var h0=h2?this["\x6d\x61\x70"][ay("0xfa")][ay("0x101")]:![];hU=hX[ay("0x102")];break;case ay("0xd7"):i[ay("0x71")]=h3;hU=ay("0xef");break;case ay("0xd6"):if(!gc["\x73\x74\x72\x69\x6e\x67\x69\x66\x69\x65\x64\x49\x6e\x64\x6f\x6f\x72\x53\x74\x79\x6c\x65"]){hU=ay("0x103");break}hU=ay("0xd4");break;case hX[ay("0x104")]:gc[hX[ay("0x105")]+T]=JSON[ay("0xe1")](bo[ay("0x106")+T]);hU=hX[ay("0x107")];break;case hX[ay("0x108")]:hW[ay("0x109")]={"\x77\x6f\x72\x64\x53\x70\x61\x63\x65\x52\x61\x74\x69\x6f":this[ay("0xa2")],"\x74\x65\x78\x74\x53\x69\x7a\x65\x52\x61\x74\x69\x6f":this["\x74\x65\x78\x74\x53\x69\x7a\x65\x52\x61\x74\x69\x6f"]};hU=ay("0xca");break;case ay("0xcd"):if(!gc[ay("0xf8")+T]){hU=hX["\x68\x64\x61\x68\x64"];break}hU=hX[ay("0x107")];break;case ay("0xcb"):i["\x69\x73\x53\x65\x6e\x64\x46\x53"]=!![];hU=hX[ay("0xea")];break;case"\x6c\x65\x68":hW[ay("0xff")]=gc[ay("0xfe")];hU=hX["\x65\x69\x61\x69\x69"];break;case hX[ay("0x10a")]:var hY=this[ay("0x9c")][ay("0x10b")]();hU=ay("0xf3");break;case ay("0xf0"):var hW={"\x61\x63\x74\x69\x6f\x6e":ay("0x85"),"\x75\x72\x6c":h4,"\x74\x69\x6c\x65\x49\x6e\x66\x6f":h3,"\x74\x69\x6c\x65\x4b\x65\x79":h1,"\x69\x73\x54\x65\x78\x74":h0,"\x69\x73\x50\x6f\x69":h2};hU=ay("0x7d");break;case hX[ay("0xf1")]:i[ay("0x75")]=hZ;hU=hX[ay("0x10c")];break;case hX[ay("0xe6")]:hW[ay("0x10d")]=gc[ay("0x99")];hU="\x65\x65\x6c";break;case ay("0xd2"):T=ay("0x10e");hU=hX[ay("0xe9")];break;case hX["\x64\x63\x6c\x6c\x78"]:if(!gc[hX[ay("0x10f")]+hY]&&bo["\x46\x65\x61\x74\x75\x72\x65\x53\x74\x79\x6c\x65"+hY]){hU="\x69\x61\x68";break}hU=hX[ay("0xe3")];break;case ay("0xa6"):i["\x70\x6f\x73\x74\x4d\x65\x73\x73\x61\x67\x65"](hW);hU=hX["\x68\x64\x69\x65\x65"];break;case ay("0xe4"):if(gc[ay("0xd9")+hY]){hU=hX[ay("0x110")];break}hU=ay("0xf7");break;case hX["\x61\x63\x6c\x65\x64"]:var hV={"\x75\x72\x6c":h4,"\x74\x69\x6c\x65\x49\x6e\x66\x6f":h3,"\x74\x69\x6c\x65\x4b\x65\x79":h1,"\x63\x62\x6b":hZ};hU=hX["\x61\x65\x68\x61\x6c"];break}}}};C[ay("0x111")](gc[ay("0x112")],bf);function dT(i){this.tileLayers=[];this.map=i;var e=this.config=b6[this.map.mapType];this.errorUrl=e.errorUrl;this.tileSize=e.tileSize;this.baseUnits=e.baseUnits;this.baseZoomLevel=e.zoomLevelBase;this.tileURLs=e.tileUrls;this.tilesInfoCache={};this.loadDelay=10;this._labelTextCanvas=null}bo.register(function(i){if(i._renderType!=="webgl"){return}var e=i.tileMgr=new dT(i);i.addEventListener("addtilelayer",function(hU){e.addWebGLLayer(hU.target)});i.addEventListener("removetilelayer",function(hU){e.removeWebGLLayer(hU.target)});i.on("update",function T(hU){if(!bo["FeatureStyle"+this.config.style]&&!bo.customStyleLoaded){return}e.loadLayersData({zoomChanged:hU.changedStatus.onzoom_changed?true:false})});i.on("style_changed",function(){e.loadLayersData()})});C.extend(dT.prototype,{addWebGLLayer:function(hU){this.tileLayers.push(hU);hU.initDrawData();if(this.tileLayers.length>1){for(var T=1;T<this.tileLayers.length;T++){if(this.tileLayers[T].isFlat){this.map.setDisplayOptions({isFlat:true});break}}}var e=this.map.config.style;if(bo["FeatureStyle"+e]){this.loadLayersData()}else{var hV=this;this.map.loadMapStyleFiles(function(){hV.loadLayersData()})}},removeWebGLLayer:function(hW){var hX=false;for(var hV=0,hU=this.tileLayers.length;hV<hU;hV++){if(hW===this.tileLayers[hV]){hX=true;this.tileLayers.splice(hV,1);break}}if(hX===false){return}hW.destroyDrawData();if(bo["FeatureStyle"+this.map.config.style]){this.loadLayersData()}if(this.tileLayers.length===1){this.map.setDisplayOptions({isFlat:false})}else{var e=false;for(var hV=1;hV<this.tileLayers.length;hV++){if(this.tileLayers[hV].isFlat){e=true;break}}this.map.setDisplayOptions({isFlat:e})}var T=new bb("onrefresh");T.source="removewebgllayer";this.map.fire(T)},getLabelTextCanvas:function(){if(!this._labelTextCanvas){this._labelTextCanvas=new v(this.map)}return this._labelTextCanvas},loadLayersData:function(i){if(this.map.suspendLoad){return}var hU=this;i=i||{};var T=!!i.zoomChanged;var e=(T===true||this.map.getTilt()>50);if(!e){if(!this.syncLoadTimer){this.syncLoadTimer=setTimeout(function(){hU._loadLayersFromCache(T);hU.syncLoadTimer=null},40)}}else{this._loadLayersFromCache(T)}if(!hU.map.viewAnimationTime){this.timer&&window.clearTimeout(this.timer)}this.timer=window.setTimeout(function(){if(hU.map.viewAnimationTime){if(new Date().getTime()-hU.map.viewAnimationTime<1000){return}hU.map.viewAnimationTime=new Date().getTime()}var hW=hU.tileLayers.length;hU.tilesInfoCache={};for(var hX=0;hX<hW;hX++){var hZ=hU.tileLayers[hX];var hY=hZ.tileType;var hV=null;if(hU.tilesInfoCache[hY.getName()]){hV=hU.tilesInfoCache[hY.getName()]}else{hV=hU.calcTilesInfo(hY);hU.tilesInfoCache[hY.getName()]=hV}hZ.loadLayerData(hV,false,T)}hU.timer=null},this.loadDelay);if((f8()||C.Browser.ie)&&T){this.loadDelay=200}else{this.loadDelay=80}},_loadLayersFromCache:function(hV){this.map._featureMgr.clearData();var hY=this.tileLayers;hY.sort(function(hZ,i){return hZ.zIndex-i.zIndex>0});var T=hY.length;this.tilesInfoCache={};for(var hU=0;hU<T;hU++){var hX=hY[hU];var hW=hX.tileType;var e=null;if(this.tilesInfoCache[hW.getName()]){e=this.tilesInfoCache[hW.getName()]}else{e=this.calcTilesInfo(hW);this.tilesInfoCache[hW.getName()]=e}hX.loadLayerData(e,true,hV)}},calcTilesInfo:function(h7){var im=this.map;var iu=im.getMapType();var io=b6[iu];var ig=im.getZoom();var e=Math.floor(ig);var hX=h7.getDataZoom(ig);var iG=h7.getName();hX=fI(hX,io.minDataZoom,io.maxDataZoom);var ix=e;if(h7._name==="web"||h7._name==="xyz"){ix=hX}else{if(ix<3){ix=3}}var ik=h7.getTileSize(ig);var hW=h7.getBaseTileSize(ig);var ii=im.getBoundsIn();var ib=h7.getMercatorSize(ig,hX);var ia;var iv;var ij;var iz;var ip=im.getCenterIn();if(iu!==BMAP_SATELLITE_MAP){ip=d4.calcLoopCenterPoint(ip)}if(iG==="xyz"){return this.calcXYZTilesInfo(ip,ii,hX,iG)}var ih=Math.floor(ip.lng/ib);var hZ=Math.floor(ip.lat/ib);var ir=0;var hU=0;if(iG!=="web"&&iG==="xyz"){ii=d4.calcLoopMapBounds(ii,im.getCenter())}if(ii.ne.lng>d4._mc180X){var h5=d4.getSpaceDistanceInPixel(hX);ir=Math.ceil(h5/hW)}if(ii.sw.lng<d4._mcM180X){var h5=d4.getSpaceDistanceInPixel(hX);hU=Math.ceil(h5/hW)}if(ii.ne.lat>19505879.362428114||ii.sw.lat<-15949096.637571886){ii.ne.lat=19505879.362428114;ii.sw.lat=-15949096.637571886}var h1=[Math.floor(ii.sw.lng/ib)-hU,Math.floor(ii.sw.lat/ib)];var iE=[Math.floor(ii.ne.lng/ib)+ir,Math.floor(ii.ne.lat/ib)];ia=h1[0];iv=iE[0]+1;ij=h1[1];iz=iE[1]+1;var h6=[];for(var h3=ia;h3<iv;h3++){if(d4.isTileBlank(h3,hX,hW)===true){continue}for(var h8=ij;h8<iz;h8++){var iB=false;var h2=256;if(iG==="web"){var iw=d4.calcLoopParam(h3,hX);var iD={col:iw.col,row:h8,baseTileSize:256,zoom:hX};var il=en.prototype.tileToBound(iD,im.getCenter());if(il.LL.sw.lng*il.LL.ne.lng<0&&Math.floor(il.LL.ne.lng)<0){iB=true;h2=d4.pixelWidth(il.MC.sw.lng,im.getZoom())}}var h4={col:h3,row:h8,zoom:hX,useZoom:ix,tileTypeName:iG,loopOffsetX:0,tileSize:ik,baseTileSize:hW,mercatorSize:ib,combine:iB,dataIndex:h2};h6.push(h4);var it="id_"+h3+"_"+h8+"_"+hX;h6[it]=true}}if(iu!==BMAP_SATELLITE_MAP){h6=d4.calcLoopTiles(h6,hX,hW,ib)}if(hX===3){for(var iC=0,iA=h6.length;iC<iA;iC++){var h3=h6[iC].col;var h8=h6[iC].row;var iw=d4.calcLoopParam(h3,hX);var hY=iw.T;var ic=h3>=0?h3-hY:h3+hY;var ie="id_"+ic+"_"+h8+"_"+hX;if(!h6[ie]){var h4={col:ic,row:h8,zoom:hX,useZoom:ix,loopOffsetX:0,tileSize:ik,baseTileSize:hW,mercatorSize:ib,combine:false};h6.push(h4);h6[ie]=true}}}if(this.map._tilt>0){for(var iC=0;iC<h6.length;iC++){var h0=h6[iC];var iy=h0.col;var iF=h0.row;var iq=[];iq.minX=iy*ib;iq.maxX=(iy+1)*ib;iq.minY=iF*ib;iq.maxY=(iF+1)*ib;var hV=new hv(0,0);hV.lng=(iq.minX+iq.maxX)/2;hV.lat=(iq.minY+iq.maxY)/2;var h9=im.pointToPixelIn(hV);if(h9.x>0&&h9.x<this.map.width&&h9.y>0&&h9.y<this.map.height){continue}if(iq.minX<ip.lng&&iq.maxX>ip.lng&&iq.minY<ip.lat&&iq.maxY>ip.lat){continue}if(!this.ifTileInMapBounds(iq,ii,iy,iF)){h6.splice(iC,1);iC--}}}h6.sort((function(i){return function(T,id){return((0.4*Math.abs(T.col-i[0])+0.6*Math.abs(T.row-i[1]))-(0.4*Math.abs(id.col-i[0])+0.6*Math.abs(id.row-i[1])))}})([ih,hZ]));h6.zoom=hX;h6.tileTypeName=iG;return h6},calcXYZTilesInfo:function(ih,h3,ie,im){var hV=gcoord.transform([ih.lng,ih.lat],gcoord.BD09MC,gcoord.EPSG3857);var ip=gcoord.transform([h3.sw.lng,h3.sw.lat],gcoord.BD09MC,gcoord.EPSG3857);var h7=gcoord.transform([h3.ne.lng,h3.ne.lat],gcoord.BD09MC,gcoord.EPSG3857);var h4=Math.floor(ie);var T=[ip[0],ip[1],h7[0],h7[1]];var hU=eu.getTileRangeForExtentAndZ(T,h4);var e=[];var h5=[];var io=[];var it;var ig;var ic;var hX;var hY;var iq;var hZ;var h2;var h0=Math.pow(2,(18-h4));for(var ik=hU.minX;ik<=hU.maxX;ik++){for(var ii=hU.minY;ii<=hU.maxY;ii++){var hW=eu.getTileRangeExtent([h4,ik,ii]);var ia=gcoord.transform([hW.minX,hW.minY],gcoord.EPSG3857,gcoord.BD09MC);var h1=gcoord.transform([hW.maxX,hW.maxY],gcoord.EPSG3857,gcoord.BD09MC);var ib=Math.ceil((h1[0]-ia[0])/h0);var h8=Math.ceil((h1[1]-ia[1])/h0);if(h5.length===0){it=ia;ig=h1}h5.push(ib);io.push(h8)}}ic=h5.sort()[h5.length-1];hX=io.sort()[io.length-1];hZ=ic*h0;h2=hX*h0;for(var ik=hU.minX;ik<=hU.maxX;ik++){for(var ii=hU.minY;ii<=hU.maxY;ii++){var h6=hZ*(ik-hU.minX);var il=h2*(ii-hU.minY);hY=[it[0]+h6,it[1]-il];iq=[ig[0]+h6,ig[1]-il];var ij={col:ik,row:ii,zoom:h4,useZoom:h4,tileTypeName:im,loopOffsetX:0,tileSize:[ic,hX],sw:hY,ne:iq,combine:false,dataIndex:0};e.push(ij);var h9="id_"+ik+"_"+ii+"_"+h4;e[h9]=true}}var ir=eu.getTileCoordForCoordAndZ(hV,h4);e.sort((function(i){return function(id,iu){return((0.4*Math.abs(id.col-i[0])+0.6*Math.abs(id.row-i[1]))-(0.4*Math.abs(iu.col-i[0])+0.6*Math.abs(iu.row-i[1])))}})([ir[1],ir[2]]));e.zoom=h4;e.tileTypeName=im;return e},getCurrentViewTilesInfo:function(i){var e=this.tilesInfoCache[i.getName()];if(!e){return this.calcTilesInfo(i)}return e},ifTileInMapBounds:function(e,hW,T,hV){var i=hW.normalizedBottomLeft;var h7=hW.normalizedTopRight;var hZ=hW.normalizedTopLeft;var hX=hW.normalizedBottomRight;var hU=false;var h6=new hv(e.minX,e.minY);var h3=new hv(e.maxX,e.maxY);var hY=new hv(h3.lng,h6.lat);var h4=new hv(h6.lng,h3.lat);var h1=[h4,h3,hY,h6];for(var h5=0,h0=h1.length;h5<h0;h5++){var h2=h5+1;if(h2===h0){h2=0}var h8=h5;var h9=gA(h1[h2],h1[h8],hZ,i);if(h9){hU=true;break}h9=gA(h1[h2],h1[h8],hX,h7);if(h9){hU=true;break}h9=gA(h1[h2],h1[h8],h7,hZ);if(h9){hU=true;break}h9=gA(h1[h2],h1[h8],i,hX);if(h9){hU=true;break}}return hU},getTileLayer:function(hV){for(var hU=0,e=this.tileLayers.length;hU<e;hU++){var T=this.tileLayers[hU];if(T.mapType===hV){return T}}return null}});function aR(e){this._map=e;this._spotsId=null;this._init()}aR.prototype._init=function(){var e=this._map;e.addEventListener("onspotsdataready",function(T){var i=T.spots;if(this._spotsId){e.removeSpots(this._spotsId)}this._spotsId=e.addSpots(i)})};bo.register(function(e){if(!e.config.enableIconClick){return}e._mapIcon=new aR(e)});function aU(e){this._indoorData={};this._map=e;this.currentUid=null;this.currentFloor=null;this._indoorControl=null;this.enterMethod=null;this.showMask=false;this._isMobile=f8();this._autoEnterZoom=19;if(this._isMobile){this._autoEnterZoom=17}this._init(e);window._indoorMgr=this}aU.prototype._init=function(i){var e=this;i.on("indoor_status_changed",function(hX){var T=hX.uid;var hV=hX.floor;if(T===null){T=e.currentUid;if(e._indoorData[T]){hV=e._indoorData[T].defaultFloor}if(e._indoorControl){e._indoorControl.hide()}e.currentUid=null;e.currentFloor=null;e.enterMethod=null}else{if(e._indoorData[T]){var hW=e._indoorData[T];hV=(typeof hV==="number")?hV:hW.defaultFloor;if(!e._indoorControl){if(i.config.showControls&&i._displayOptions.indoor){e._indoorControl=new gE(i,hW)}}else{e._indoorControl.setInfo(hW);e._indoorControl.show()}e.currentUid=T;e.currentFloor=hV}}if(!e._indoorData||!e._indoorData[T]||e._indoorData[T].currentFloor===hV){this.fire(new bb("onrefresh"));return}var hU=new bb("onindoor_data_refresh");hU.uid=T;hU.floor=hV;hU.tileKey=e._indoorData[T].tileKey;e._indoorData[T].currentFloor=hV;e.currentFloor=hV;this.fire(hU)});i.on("spotclick",function(hU){var T=null;if(hU.curAreaSpot&&this.areaSpots[hU.curAreaSpot]){T=this.areaSpots[hU.curAreaSpot].userData.uid}if(T===e.currentUid){if(hU.curAreaSpot){e.enterMethod="byClick"}return}if(T===null){if(e.currentUid&&e.enterMethod==="byClick"){i.showIndoor(null);e.enterMethod=null}}else{e.enterMethod="byClick";if(e.currentUid){i.showIndoor(e.currentUid,e._indoorData[e.currentUid].defaultFloor)}i.showIndoor(T,e._indoorData[T].defaultFloor)}});i.on("moveend",function(){if(this.getZoom()>=e._autoEnterZoom){e._checkIndoorByMove()}});i.on("zoomend",function(){if(this.getZoom()>=e._autoEnterZoom){e._checkIndoorByMove()}else{if(e.enterMethod!=="byClick"&&e.currentUid!==null){this.showIndoor(null)}}})};aU.prototype._checkIndoorByMove=function(){var T=this._map;var h0=T.getSize();var h5={x:h0.width/2,y:h0.height/2};var h4=Math.max(h0.width,h0.height);var h6=[];for(var h1 in this._indoorData){var e=this._indoorData[h1].center;var hU=T.pointToPixelIn(new bo.Point(e[0],e[1]));var hX=gZ(h5,hU);h6.push({uid:h1,distance:hX})}if(h6.length===0){return}h6.sort(function(h7,i){return h7.distance-i.distance});var hW=h6[0];var h2=T.getCenterIn();var hV=false;for(var hZ=0;hZ<this._indoorData[hW.uid].contour.length;hZ++){if(dg([h2.lng,h2.lat],this._indoorData[hW.uid].contour[hZ])){hV=true;break}}if(hV===false&&hW.uid==="e96b44200baa3b4082288acc"){var hY=this._indoorData[hW.uid].boundsMin;var h3=this._indoorData[hW.uid].boundsMax;if(h2.lng>hY[0]&&h2.lat>hY[1]&&h2.lng<h3[0]&&h2.lat<h3[1]){hV=true}}if(hV){if(this.enterMethod!=="byClick"){if(this.currentUid!==null&&this.currentUid!==hW.uid){this._map.showIndoor(this.currentUid,this._indoorData[this.currentUid].defaultFloor)}if(this.currentUid!==hW.uid){this._map.showIndoor(hW.uid,this._indoorData[hW.uid].defaultFloor)}this.enterMethod="byMove"}}else{if(this.enterMethod!=="byClick"){this._map.showIndoor(null)}}};aU.prototype.setData=function(hU){if(hU===null){return}for(var T in hU){if(T==="tileInfo"){continue}var hV=hU[T].tileKey;if(this._indoorData[T]){if(!this._indoorData[T][hV]){this._indoorData[T].tileKeys.push(hV);this._indoorData[T][hV]=true}}else{this._indoorData[T]=hU[T];this._indoorData[T].tileKeys=[hU[T].tileKey];this._indoorData[T][hV]=true;for(var e=0;e<this._indoorData[T].contour.length;e++){this._map.addAreaSpot(this._indoorData[T].contour[e],{id:T+e,userData:{uid:T}})}}}if(this._map.getZoom()>=this._autoEnterZoom){this._checkIndoorByMove()}};aU.prototype.removeData=function(T,hV){if(!this._indoorData[T]){return}var hU=this._indoorData[T];for(var e=0;e<hU.tileKeys.length;e++){if(hU.tileKeys[e]===hV){hU.tileKeys.splice(e,1);break}}delete hU[hV];if(hU.tileKeys.length===0){delete this._indoorData[T]}};aU.prototype.getIndoorData=function(e){return this._indoorData[e]||null};aU.prototype.getData=function(){return this._indoorData};bo.register(function(e){e._indoorMgr=new aU(e)});var el=(function(){var hU={};var h3={};var hZ={};function h1(h5){if(Object.prototype.toString.call(h5)==="[object Object]"){for(var h4 in h5){return false}return true}else{return false}}function h0(ib,ic,ig,h8,ie){var h4=h4||null;h8=h8||h4;var h6;if(h8){h6=h2(ib,ic,ig,h8)}else{h6=T(ib,ic,ig,ie)}var ia=h6.drawId;var h5=h6.style;var id=h6.styleUpdate;var ih=[];if(!ia){return ih}for(var h7=0;h7<ia.length;h7++){var h9=id[ia[h7]]||h5[ia[h7]];if(h9){switch(ic){case"polygon":h9=hV(h9,ib);break;case"line":h9=hY(h9,ib);break;case"pointText":h9=hW(h9,ib);break;case"point":h9=e(h9,ib);break;case"polygon3d":h9=hX(h9,ib);break}if(h9){h9.did=ia[h7];ih[ih.length]=h9}}}return ih}function h2(h5,h7,h8,h4){var h6=h4[2];switch(h7){case"point":h6=h6[0];break;case"pointText":h6=h6[1];break;case"line":h6=h6[3];break;case"polygon":h6=h6[4];break;case"polygon3d":h6=h6[5];break}var ia=h8-1;if(h7==="line"&&h8===12){ia=h8}var ib=h4[1][ia][0];var h9=ib[h5];if(!h9){if(h7==="point"||h7==="pointText"){ib=h4[1][h8][0];h9=ib[h5]}}return{drawId:h9,style:h6,styleUpdate:[]}}function T(h8,h9,ic,ib){if(!ib){return{drawId:null,style:[],styleUpdate:[]}}var ia;var h6=ib.baseFs;if(h1(ib.zoomRegion)){ia=ib.StyleBody||[]}else{ia=ib.zoomStyleBody[ic]||[]}var h5=h6[2];switch(h9){case"point":h5=h5[0];ia=ia[0]||{};break;case"pointText":h5=h5[1];ia=ia[1]||{};break;case"line":h5=h5[3];ia=ia[3]||{};break;case"polygon":h5=h5[4];ia=ia[4]||{};break;case"polygon3d":h5=h5[5];ia=ia[5]||{};break}var h4=h6[1][ic-1][0];var h7=h4[h8];return{drawId:h7,style:h5,styleUpdate:ia}}function hW(h5,h4){if(!h5||h5.length===0){return null}return{sid:h4,fontRgba:i(h5[0]),haloRgba:i(h5[1]),backRgba:i(h5[2]),fontSize:h5[3],haloSize:h5[4],fontWeight:h5[5],fontStyle:h5[6],density:h5[7]}}function e(h5,h4){return{sid:h4,rank:h5[0],ucflag:h5[1],icon:h5[2],iconType:h5[3],nineGG:h5[4],density:h5[5],zoom:h5[6]}}function hY(h5,h4){return{sid:h4,borderRgba:i(h5[0]),fillRgba:i(h5[1]),borderWidth:h5[2],fillWidth:h5[3],borderCap:h5[4],fillCap:h5[5],haveBorderLine:h5[6],haveBorderTexture:h5[7],haveFillTexture:h5[8],isUseBorderRgba:h5[9],isUseFillRgba:h5[10],borderTexture:h5[11],fillTexture:h5[12],borderTextureType:h5[13],fillTextureType:h5[14],isRealWidth:h5[15],haveArrow:h5[16],needRound:h5[17],realBorderWidth:h5[18]}}function hV(h5,h4){return{sid:h4,fillRgba:i(h5[0]),borderRgba:i(h5[1]),borderWidth:h5[2],borderTexture:h5[3],borderTextureType:h5[4],waterStyle:h5[5],haloStyle:h5[6],textureStyle:h5[7],thickRgba:i(h5[8])}}function hX(h5,h4){return{sid:h4,filter:h5[0],ratio:h5[1],haveBorder:h5[2],borderWidth:h5[3],borderRgba:i(h5[4]),fillTop:i(h5[5]),fillSide:i(h5[6]),polyTexture:h5[7]}}function i(h9){var h8=h9;if(hZ[h8]){return hZ[h8]}h9=h9>>>0;var h7=(h9)&255;var h6=(h9>>8)&255;var h4=(h9>>16)&255;var h5=(h9>>24)&255;hZ[h8]=[h7,h6,h4,h5];return hZ[h8]}return{getStyleFromCache:function(ib,h6,h9,ia,h5,h8,h4){ib=ib||"default";var h7=ib+"-"+h6+"-"+h9+"-"+ia;if(h8){h7+="-indoor"}if(h5){if(!h3[h7]){h3[h7]=h0(h6,h9,ia,h5)}return h3[h7]}if(!hU[h7]){hU[h7]=h0(h6,h9,ia,h5,h4)}return hU[h7]}}})();bo.register(function(i){var e=new dG(i)});function dG(e){e.container.appendChild(this.render());this.bind(e)}dG.prototype.render=function(){var i=document.createElement("div");i.className="click-ripple-container";var e=document.createElement("div");e.className="click-ripple";i.appendChild(e);this._div=i;this._ripple=e;return i};dG.prototype.bind=function(i){var e=this;i.addEventListener("spotclick",function(T){if(!T.spots||T.spots.length===0){return}e._div.style.left=T.pixel.x+"px";e._div.style.top=T.pixel.y+"px";C.ac(e._ripple,"ripple-playing")});C.on(e._ripple,"transitionend",function(){C.rc(e._ripple,"ripple-playing")})};function f4(e){ed.call(this);if(!e){return}this._opts={};this._map=e;this._maxLat=84.6;this._minLat=-80.6;this._maxLatMC=en.convertLL2MC(new c4(this._maxLat,0)).lat;this._minLatMC=en.convertLL2MC(new c4(this._minLat,0)).lat}f4.inherits(ed,"ToolbarItem");C.extend(f4.prototype,{open:function(){if(this._isOpen==true){return true}if(this._map._toolInUse){return false}this._map._toolInUse=true;this._isOpen=true;return true},close:function(){if(!this._isOpen){return}this._map._toolInUse=false;this._isOpen=false},_checkStr:function(e){if(!e){return""}return e.replace(/</g,"&lt;").replace(/>/g,"&gt;")}});function gO(T,i){f4.call(this,T);i=i||{};this._opts=C.extend(C.extend(this._opts||{},{autoClear:false,tips:"测距",followText:"单击确定起点，双击结束绘制",unit:"metric",showResult:true,lineColor:"blue",lineStroke:2,opacity:1,lineStyle:"solid",cursor:e5.distCursor,styleCodes:{lnCode:0,spCode:0,slCode:0,tlCode:0},enableMassClear:true}),i);if(this._opts.showResult===false){if(typeof i.tips==="undefined"){this._opts.tips="绘制折线"}if(!i.cursor){this._opts.cursor="crosshair"}}if(this._opts.lineStroke<=0){this._opts.lineStroke=2}if(this._opts.opacity>1){this._opts.opacity=1}else{if(this._opts.opacity<0){this._opts.opacity=0}}if(this._opts.lineStyle!=="solid"&&this._opts.lineStyle!=="dashed"){this._opts.lineStyle="solid"}this._checked=false;this._drawing=null;this.followTitle=null;this._totalDis={};this._points=[];this._paths=[];this._dots=[];this._segDistance=[];this._overlays=[];this._units={metric:{name:"metric",conv:1,incon:1000,u1:"米",u2:"公里"},us:{name:"us",conv:3.2808,incon:5279.856,u1:"英尺",u2:"英里"}};if(!this._units[this._opts.unit]){this._opts.unit="metric"}this._dLineColor="#ff6319";this._dLineStroke=3;this._dOpacity=0.8;this._dLineStyle="solid";this._dCursor=e5.distCursor;if(this._opts.showResult){this._opts.followText="单击确定起点"}this._followTextM="单击确定地点，双击结束";this._sectionMarkerTip="单击可删除此点，拖拽可调整位置";this._movingTimerId=null;if(this._opts.showResult){this.text="测距"}else{this.text="绘线"}this._isOpen=false;var e=this;ea.load("tools",function(){e._draw()})}gO.inherits(f4,"PolylineTItem");C.extend(gO.prototype,{setLineColor:function(e){this._opts.lineColor=e},setLineStroke:function(e){if(Math.round(e)>0){this._opts.lineStroke=Math.round(e)}},setOpacity:function(e){if(e>=0&&e<=1){this._opts.opacity=e}},setLineStyle:function(e){if(e==="solid"||e==="dashed"){this._opts.lineStyle=e}},clear:function(){for(var T=0,e=this._overlays.length;T<e;T++){if(this._overlays[T]){this._map.removeOverlay(this._overlays[T])}}this._overlays.length=0;for(var T=0,e=this._dots.length;T<e;T++){if(this._dots[T]&&this._dots[T].parentNode){this._dots[T].parentNode.removeChild(this._dots[T])}}this._dots.length=0},setCursor:function(e){if(this._opts.showResult===true){return}this._opts.cursor=e},getCursor:function(){if(this._opts.showResult===true){return this._dCursor}var e=this._opts.cursor.match(/^url\((.+)\)(,.*)?/);if(e!==null){return e[1]}else{return this._opts.cursor}},showResult:function(e){this._opts.showResult=!!e}});function cu(){var hV=3;var h2=256;var hU=Math.pow(2,18-hV)*h2;var h3=2;var h1=(h3+1)*hU;var T=en.convertLL2MC(new hv(180,0));var hZ=T.lng;var hX=h1-hZ;var h0=-3;var e=h0*hU;var hW=en.convertLL2MC(new hv(-180,0));var hY=hW.lng;var i=hY-e;this._validPixels=hZ/Math.pow(2,18-hV);this._mc180X=hZ;this._mcM180X=hY;this._loopOffset=hX+i;this._mcTSpan=hZ-hY;this._spaceDistance=hX;this._mSpaceDistance=i}cu.prototype={calcLoopParam:function(hU,i,h1){h1=h1||256;var hY=0;var hV=3;var hX=6;var hW=hX*Math.pow(2,(i-hV))*256/h1;var h0=hW/2-1;var hZ=-hW/2;while(hU>h0){hU-=hW;hY-=this._loopOffset}while(hU<hZ){hU+=hW;hY+=this._loopOffset}var e=hY;hY=Math.round(hY/Math.pow(2,18-i));return{offsetX:hY,geoOffsetX:e,col:hU,T:hW,maxCol:h0,minCol:hZ}},calcLoopCenterPoint:function(i){var e=i.lng;while(e>this._mc180X){e-=this._mcTSpan}while(e<this._mcM180X){e+=this._mcTSpan}i.lng=e;return i},calcLoopMapBounds:function(T,hU){var i=hU||T.getCenter();var e=T.sw.lng;var hV=T.ne.lng;while(i.lng>this._mc180X){i.lng-=this._mcTSpan;e-=this._mcTSpan;hV-=this._mcTSpan}while(i.lng<this._mcM180X){i.lng+=this._mcTSpan;e+=this._mcTSpan;hV+=this._mcTSpan}T.sw.lng=e;T.ne.lng=hV;if(T.pointBottomLeft){T.pointBottomLeft=this.calcLoopCenterPoint(T.pointBottomLeft);T.pointTopLeft=this.calcLoopCenterPoint(T.pointTopLeft);T.pointTopRight=this.calcLoopCenterPoint(T.pointTopRight);T.pointBottomRight=this.calcLoopCenterPoint(T.pointBottomRight)}return T},calcLoopTiles:function(h2,e,h6,hZ){h6=h6||256;var hV=hZ||Math.pow(2,18-e)*h6;var h1=Math.floor(this._mc180X/hV);var hX=Math.floor(this._mcM180X/hV);var h3=Math.floor(this._loopOffset/hV);var h4=[];for(var hY=0;hY<h2.length;hY++){var h5=h2[hY];var hU=h5[0];var h7=h5[1];if(hU>=h1){var h0=hU+h3;if(this.isTileBlank(h0,e,h6)===true){continue}var T="id_"+h0+"_"+h7+"_"+e;if(!h2[T]){h2[T]=true;h4.push([h0,h7,e,0])}}else{if(hU<=hX){var h0=hU-h3;if(this.isTileBlank(h0,e,h6)===true){continue}var T="id_"+h0+"_"+h7+"_"+e;if(!h2[T]){h2[T]=true;h4.push([h0,h7,e,0])}}}}for(var hY=0,hW=h4.length;hY<hW;hY++){h2.push(h4[hY])}for(var hY=h2.length-1;hY>=0;hY--){var hU=h2[hY][0];if(this.isTileBlank(hU,e,h6)){h2.splice(hY,1)}}return h2},isTileBlank:function(T,hV,e){var hW=Math.pow(2,hV-3);var i=Math.round(this._validPixels*hW);var hU=6*hW*256/e;while(T>hU/2-1){T-=hU}while(T<-(hU/2)){T+=hU}if(T>0&&T*e>i){return true}if(T<0&&Math.abs((T+1)*e)>i){return true}return false},isAddWidth:function(e,i){return e<this._mcM180X||i>this._mc180X},pixelWidth:function(e,i){if(e<0){e=-e}return Math.abs(e-this._mc180X)/(Math.pow(2,18-i))},getSpaceDistanceInPixel:function(i){var e=Math.round((this._spaceDistance+this._mSpaceDistance)/Math.pow(2,18-i));return e}};var d4=new cu();var ce=(function(){var i=true;var hV=256;var e=true;var hX=aD("ditu","normalTraffic");var hU=hX.udt;var hY="//its.map.baidu.com/traffic/";var hW=[[2,"79,210,125,1",3,2,0,[],0,0],[2,"79,210,125,1",3,2,0,[],0,0],[2,"79,210,125,1",4,2,0,[],0,0],[2,"79,210,125,1",5,2,0,[],0,0],[2,"79,210,125,1",6,2,0,[],0,0],[2,"255,208,69,1",3,2,0,[],0,0],[2,"255,208,69,1",3,2,0,[],0,0],[2,"255,208,69,1",4,2,0,[],0,0],[2,"255,208,69,1",5,2,0,[],0,0],[2,"255,208,69,1",6,2,0,[],0,0],[2,"232,14,14,1",3,2,0,[],0,0],[2,"232,14,14,1",3,2,0,[],0,0],[2,"232,14,14,1",4,2,0,[],0,0],[2,"232,14,14,1",5,2,0,[],0,0],[2,"232,14,14,1",6,2,0,[],0,0],[2,"181,0,0,1",3,2,0,[],0,0],[2,"181,0,0,1",3,2,0,[],0,0],[2,"181,0,0,1",4,2,0,[],0,0],[2,"181,0,0,1",5,2,0,[],0,0],[2,"181,0,0,1",6,2,0,[],0,0],[2,"255,255,255,1",4,0,0,[],0,0],[2,"255,255,255,1",5.5,0,0,[],0,0],[2,"255,255,255,1",7,0,0,[],0,0],[2,"255,255,255,1",8.5,0,0,[],0,0],[2,"255,255,255,1",10,0,0,[],0,0]];var T=new cR({transparentPng:true,dataType:2,cacheSize:256,clipTile:true});T.zIndex=2;T.getTilesUrl=function(h1,h2){if(!h1||h2<7){return null}var h0=h1.x;var h3=h1.y;var hZ=hY+"TrafficTileService?level="+h2+"&x="+h0+"&y="+h3+"&time="+(+new Date());if(this.map.getRenderType()==="webgl"){hZ=hY+"?qt=vtraffic&z="+h2+"&x="+h0+"&y="+h3+"&udt="+hU}return hZ};T.setColors=function(hZ){for(var h2=0;h2<hW.length;h2++){var h1=Math.floor(h2/5);var h0=hZ[h1];if(h0){if(Object.prototype.toString.call(h0)==="[object String]"){h0=g3.parseCSSColor(h0)}hW[h2][1]=[h0[0],h0[1],h0[2],h0[3]/255].join(",")}}};T.setEdge=function(hZ){e=!!hZ};T.processData=function(h2){var h6=h2.content;var h4=10;if(typeof h2.precision==="number"){h4=h2.precision*10}var id={road:[[],[]]};if(!h6){return id}var ib=h6.tf;if(!ib){return id}for(var h3=0;h3<ib.length;h3++){var ic=ib[h3][1];var ia=[];var h8=0;var h7=0;var h9=hW[ib[h3][3]];for(var h1=0,hZ=ic.length;h1<hZ/2;h1++){h8+=ic[h1*2]/h4;h7+=ic[h1*2+1]/h4;ia.push(h8,256-h7)}var h0=h9[1].split(",");h0[3]=h0[3]*255;var h5=h9[2]/2;if(e){id.road[0].push([ia,1,2,[255,255,255,255],h5+2])}id.road[1].push([ia,1,2,h0,h5])}return id};return T})();var e3=function(hY){var hY=hY||{};var h3=hY.url||"";var h4=hY.layerName||"";var h7=hY.urlTemplate||"";var hW=hY.extent||[];var e=hY.extentWGS84||false;var h2=true;var hX=256;var h8=512;var hV=hY.minZoom||0;var h1=hY.maxZoom||23;var T=h3+"?SERVICE=WMS&REQUEST=GetMap&FORMAT=image/png&TRANSPARENT=true&LAYERS="+h4+"&TILED=&WIDTH="+h8+"&HEIGHT="+h8+"&CRS=EPSG:3857&STYLES=&FORMAT_OPTIONS=dpi:180&VERSION=1.3.0";var hZ=new cR({transparentPng:h2,dataType:1,tileTypeName:"web",cacheSize:hX,customLayer:true,clipTile:false,useThumbData:hY.useThumbData||false});hZ.zIndex=4;(hW.length===4)&&e&&(hW=eu.fromEPSG4326(hW));hZ.getTilesUrl=function(ih,h9,ie){if(!ih||h9<0||h9<hV||h9>h1){return null}var ib=ih.x;ib=hZ.calcLoopParam(ib,h9).col;var ia={col:ib,row:ih.y,baseTileSize:hX,zoom:h9};var ic=en.prototype.tileToBound(ia,en.convertLL2MC(this.map.getCenter())).LL;if(ie.combine){return i(ic,ie,T)}else{var ij=hU(ic);if(!h0(ij)){return null}var ii=ij.gc1;var ig=ij.gc2;var id=h6(ii,ig);return id}};function h0(h9){if(hW&&hW instanceof Array&&hW.length===4){if((hW[0]<=h9.gc2[0]&&hW[1]<=h9.gc2[1])&&(hW[2]>=h9.gc1[0]&&hW[3]>=h9.gc1[1])){return true}else{return false}}return true}function i(ib,ig,h9){var ia=ig.dataIndex;var ik=document.createElement("canvas").getContext("2d");var ic=new Image();ik.canvas.width=256;ik.canvas.height=256;ik.canvas.toBlob(function(il){ic.src=URL.createObjectURL(il)});var ie=0;var ij=hU(ib);if(!h0(ij)){return null}var ii=ij.gc1;var ih=ij.gc2;ih[0]=20026376.39;var id=h6(ii,ih);h5(id,function(il){ie++;il&&ik.drawImage(il,0,0,h8,h8,0,0,ia,hX);if(ie===2){ik.canvas.toBlob(function(im){ic.src=URL.createObjectURL(im)});return ic}});ij=hU(ib);ii=ij.gc1;ih=ij.gc2;ii[0]=-20026376.39;id=h6(ii,ih);h5(id,function(il){ie++;il&&ik.drawImage(il,0,0,h8,h8,ia,0,hX-ia,hX);if(ie===2){ik.canvas.toBlob(function(im){ic.src=URL.createObjectURL(im)});return ic}});return ic}function h6(h9,ib){var ia;if(h7){ia=h7([h9[0],h9[1],ib[0],ib[1]])}else{ia=T+"&BBOX="+h9.join(",")+","+ib.join(",")}return ia}function hU(ia){var h9=gcoord.transform([ia.sw.lng,ia.sw.lat],gcoord.BD09LL,gcoord.EPSG3857);var ib=gcoord.transform([ia.ne.lng,ia.ne.lat],gcoord.BD09LL,gcoord.EPSG3857);return{gc1:h9,gc2:ib}}function h5(ib,h9){var ia=new Image();ia.crossOrigin="anonymous";ia.onload=function(){h9&&h9(this)};ia.onerror=function(){h9&&h9(null)};ia.src=ib;return ia}return hZ};var fc=function(i){var i=i||{};var hU=i.tileUrlTemplate||"";var hX=i.xTemplate||function(h3,h5,h4){return h3};var h0=i.yTemplate||function(h3,h5,h4){return h5};var hV=i.zTemplate||function(h3,h5,h4){return h4};var h1=i.extent||[];var hW=i.extentWGS84||false;var T=i.minZoom||0;var hZ=i.maxZoom||23;var hY=true;var h2=new cR({transparentPng:hY,dataType:1,tileTypeName:"xyz",cacheSize:256,customLayer:true,clipTile:false,useThumbData:i.useThumbData||false});h2.zIndex=5;(h1.length===4)&&hW&&(h1=eu.fromEPSG4326(h1));h2.getTilesUrl=function(h4,ia,h8){if(!h4||ia<0||ia<T||ia>hZ){return null}var h9=eu.getTileRangeExtent([ia,h4.x,h4.y]);var h7=e([h9.minX,h9.minY,h9.maxX,h9.maxY]);if(!h7){return null}var h5="";if(hU){h5=hU;var h6=/[^\{}]*\{(.*)\}[^\}]*/;h5.match(h6);var h3=[];if(RegExp.$1){h3=RegExp.$1.split(",")}h5=h5.replace(/\{(.*)\}/,h3[(h4.x+h4.y)%h3.length]);h5=h5.replace(/\[x\]/gi,hX(h4.x,h4.y,ia));h5=h5.replace(/\[y\]/gi,h0(h4.x,h4.y,ia));h5=h5.replace(/\[z\]/gi,hV(h4.x,h4.y,ia))}else{return null}return h5};function e(h3){if(h1&&h1 instanceof Array&&h1.length===4){if((h1[0]<=h3[2]&&h1[1]<=h3[3])&&(h1[2]>=h3[0]&&h1[3]>=h3[1])){return true}else{return false}}return true}return h2};var aV=function(e){var e=e||{};this.extentWGS84=e.extentWGS84||false;this.minZoom=e.minZoom||3;this.maxZoom=e.maxZoom||19;this.useThumbData=e.useThumbData||true;this.lastZoom=3;this.cacheSize=e.cacheSize||128;this.tileType=cL.getInstance("web");this._mapCenter={};this._featureMgr=[[],[],[]];this.tileCache=new e0(this.cacheSize,{clearCallback:function(i){}})};aV.inherits(ed,"BaiduLayer");C.extend(aV.prototype,{fetch:function(e,T,hU){var T=Math.ceil(T)||3;var e=e||[];if(e.length!==4){hU(null);return}var i=this.calCoord(e,T);this.curViewTilesInfo=this.calTilesOrders(i.sw,i.ne,T);this.clearData();this.loadLayerData(this.curViewTilesInfo,T,true,hU)},calCoord:function(i,T){(i.length===4)&&this.extentWGS84&&(i=eu.fromEPSG4326(i));var e=gcoord.transform([i[0],i[1]],gcoord.EPSG3857,gcoord.BD09MC);var hU=gcoord.transform([i[2],i[3]],gcoord.EPSG3857,gcoord.BD09MC);if(hU[1]>19505879.362428114||e[1]<-15949096.637571886){hU[1]=19505879.362428114;e[1]=-15949096.637571886}this._mapCenter[T]=new hv((e[0]+hU[0])/2,(e[1]+hU[1])/2);return{sw:e,ne:hU}},calTilesOrders:function(hZ,h5,h1){var h2=this.tileType.getMercatorSize(h1,h1);var hX=[Math.floor(hZ[0]/h2),Math.floor(hZ[1]/h2)];var i=[Math.floor(h5[0]/h2),Math.floor(h5[1]/h2)];var hY=hX[0]-1;var hW=i[0]+2;var hV=hX[1]-1;var h4=i[1]+2;var h0=[];for(var hU=hY;hU<hW;hU++){for(var h3=hV;h3<h4;h3++){var T={col:hU,row:h3,zoom:h1,useZoom:h1,tileTypeName:"web",loopOffsetX:0,tileSize:256,baseTileSize:256,mercatorSize:h2,combine:false,dataIndex:256};h0.push(T);var e="id_"+hU+"_"+h3+"_"+h1;h0[e]=true}}h0.sort((function(h6){return function(h7,h8){return((0.4*Math.abs(h7.col-h6[0])+0.6*Math.abs(h7.row-h6[1]))-(0.4*Math.abs(h8.col-h6[0])+0.6*Math.abs(h8.row-h6[1])))}})([(hY+hW)/2,(hV+h4)/2]));h0.zoom=h1;h0.tileTypeName="web";return h0},getZoomState:function(i){var e=i-this.lastZoom;if(e>0){this.zoomState=1}else{if(e<0){this.zoomState=-1}}this.lastZoom=i;return this.zoomState},loadLayerData:function(h0,h1,hU,hZ){this.thumbCache={};var h2=this.getZoomState(h1);if(hU){for(var hX=0,hV=h0.length;hX<hV;hX++){var T=h0[hX];var hW=this.getTileKey(T);var e=this.tileCache.getData(hW);if(e&&e.status==="ready"){this.setData(e,2)}else{if(this.useThumbData){h2===1&&this.setThumbData(T.col,T.row,T.zoom,T.useZoom,h2)}}}this.calOutData(hZ)}for(var hX=0,hV=h0.length;hX<hV;hX++){var T=h0[hX];var hW=this.getTileKey(T);var e=this.tileCache.getData(hW);if(!e){this.tileCache.setData(hW,{});var hY=this;this.loadRasterTileData(T,function(i,h3){hY.rasterTileDataCbk(i,h3,hZ)})}}},loadRasterTileData:function(i,e){var T=new Image();var hV=i.col;var hY=i.row;var hW=i.zoom;var hU=this.getTilesUrl(new ej(hV,hY),hW);if(!hU){return}var hX=this.getTileKey(i);T=this.loadTileImage(hU,hX,e);T.tileInfo=i},loadTileImage:function(hU,T,e){var i=new Image();i.crossOrigin="anonymous";i.onload=function(){e&&e(this,T)};i.onerror=function(){e&&e(null,T)};i.src=hU;return i},rasterTileDataCbk:function(hV,hU,hY){if(!hV||typeof hV==="string"){this.tileCache.removeData(hU);return}var i=hV.tileInfo;var T=i.col;var h0=i.row;var hZ=i.zoom;var e=this.tileCache.getData(hU);if(!e){return}e.textureSource=hV;e.dataType=eI;e.tileInfo=i;e.status="ready";this.tileCache.setData(hU,e);var hW="id_"+T+"_"+h0+"_"+hZ;var hX=false;if(this.curViewTilesInfo[hW]){e.png8=this.png8||false;this.setData(e,2);hX=true}if(hX){this.calOutData(hY,e)}},getTilesUrl:function(hU,h0){var i=hU.x;var h1=hU.y;var hX=aD("ditu","normal");var hW=hX.udt;var hZ=b6.B_NORMAL_MAP.tileUrls;var hV=Math.abs(i+h1)%hZ.length;var hY=hZ[hV];var T="x="+i+"&y="+h1+"&z="+Math.floor(h0);T+="&styles=pl&scaler=2&udt="+hW+"&from=jsapi3_0";var e=hY+"?qt=vtile&"+T;return e},calOutData:function(h2,hU){if(!hU){var hW;var h3;var h0;for(var hY=0;hY<this._featureMgr.length;hY++){var T=this._featureMgr[hY];for(var hX=0;hX<T.length;hX++){var hV=T[hX].tileInfo;if(hY===2){if(hX===0){var hZ=this.calBoxCoord(hV);T[0].extent=hZ;hW=T[0];h3=hZ[2]-hZ[0];h0=hZ[3]-hZ[1]}else{if(hW&&h3&&h0){var e=(hV.row-hW.tileInfo.row)*h0;var h1=(hV.col-hW.tileInfo.col)*h3;var hZ=hW.extent;T[hX].extent=[hZ[0]+h1,hZ[1]+e,hZ[2]+h1,hZ[3]+e]}}}else{var hZ=this.calBoxCoord(hV);T[hX].extent=hZ}}}h2({zoom:this.lastZoom,data:this._featureMgr})}else{if(this._featureMgr[2].length===1){var hZ=this.calBoxCoord(hU.tileInfo);hU.extent=hZ;this.featureCell=hU;this.cellW=hZ[2]-hZ[0];this.cellH=hZ[3]-hZ[1]}else{var e=(hU.tileInfo.row-this.featureCell.tileInfo.row)*this.cellH;var h1=(hU.tileInfo.col-this.featureCell.tileInfo.col)*this.cellW;var hZ=this.featureCell.extent;hU.extent=[hZ[0]+h1,hZ[1]+e,hZ[2]+h1,hZ[3]+e]}h2({zoom:this.lastZoom,data:[[],[],[hU]]})}},calBoxCoord:function(e){var i=en.prototype.tileToBound(e,this._mapCenter[e.zoom]).MC;var T=gcoord.transform([i.sw.lng,i.sw.lat],gcoord.BD09MC,gcoord.EPSG3857);var hU=gcoord.transform([i.ne.lng,i.ne.lat],gcoord.BD09MC,gcoord.EPSG3857);return[T[0],T[1],hU[0],hU[1]]},clearData:function(){this._featureMgr=[[],[],[]]},destroy:function(){this.tileCache.clear();this.clearData();this._mapCenter={}},setData:function(hV,T){var e=this._featureMgr[T];for(var hU=0;hU<e.length;hU++){if(e[hU].key&&e[hU].key===hV.key){e[hU]=hV;return}}e.push(hV)},getTileKey:function(e,hU){hU=hU||{};var i=typeof hU.useZoom==="number"?hU.useZoom:e.useZoom;var T="default";return"web_"+T+"_"+e.col+"_"+e.row+"_"+e.zoom+"_"+i},setThumbData:function(i,hV,hU,e,T){if(T===1){if(this._findParentZoomTile(i,hV,hU,e,8)===false){this._findChildZoomTile(i,hV,hU,e,3)}}else{if(T===-1){if(this._findChildZoomTile(i,hV,hU,e,3)===false){this._findParentZoomTile(i,hV,hU,e,8)}}}this.sortThumbData()},_findParentZoomTile:function(hX,h6,h5,hV,h0){var hW="web";var T=3;var e=hX;var h3=h6;var h1=h5;var h2=hV;for(var hZ=1;hZ<=h0;hZ++){var hU=this.tileType.getParentTile(e,h3,h1,h2,T);if(hU===null){continue}var h4=this.getTileKey(hU);var hY=this.tileCache.getData(h4);if(hY&&hY.status==="ready"){if(this.thumbCache[h4]){continue}this.setData(hY,0);this.thumbCache[h4]=true;return true}e=hU.col;h3=hU.row;h1=hU.zoom;h2=hU.useZoom}return false},_findChildZoomTile:function(hY,h0,e,hV,h9){var h7="web";var h3=21;var hX=hY;var hZ=h0;var h1=e;var hU=hV;var hW=true;for(var h6=1;h6<=h9;h6++){var h4=false;var T=this.tileType.getChildTiles(hX,hZ,h1,hU,h3,h6);if(!T){continue}for(var h5=0;h5<T.length;h5++){var h2=this.getTileKey(T[h5]);var h8=this.tileCache.getData(h2);if(h8&&h8.status==="ready"){if(!this.thumbCache[h2]){this.setData(h8,1);this.thumbCache[h2]=true}h4=true}else{hW=false}}if(h4){break}}return hW},sortThumbData:function(){var e=this._featureMgr;if(!e){return}if(e[0]&&e[0].length>0){e[0].sort(function(T,i){return T.tileInfo.useZoom-i.tileInfo.useZoom})}}});bo.register(function(i){if(i.config&&i.config.isOverviewMap){return}if(i.isLoaded()){fF(i)}else{i.addEventListener("load",function(){fF(this)})}i.cityName="中国";i.cCode="1";var e={};e.enableRequest=true;e.request=function(){if(e.enableRequest){e.enableRequest=false;setTimeout(function(){e._request()},500)}};e._request=function(){var hU=i.getBoundsIn();var hW=i.getZoom();var T=hU.getSouthWest();var hV=hU.getNorthEast();cB.request(function(h0){if(h0.current_city["code"]>=9000&&h0.current_city["code"]<=9378){h0.current_city["name"]="台湾省"}if(h0.current_city["code"]>=20000&&h0.current_city["code"]<=20499){h0.current_city["name"]="新加坡"}if(h0.current_city["code"]>=20500&&h0.current_city["code"]<=25999){h0.current_city["name"]="泰国"}if(h0.current_city["code"]>=26000&&h0.current_city["code"]<=29999){h0.current_city["name"]="日本"}if(h0.current_city["code"]>=30000&&h0.current_city["code"]<=30999){h0.current_city["name"]="韩国"}if(h0.current_city["code"]>=31000&&h0.current_city["code"]<=37000){h0.current_city["name"]="亚太"}if(h0.current_city["code"]>=46609&&h0.current_city["code"]<=52505){h0.current_city["name"]="欧洲"}if(h0.current_city["code"]>=39509&&h0.current_city["code"]<=53500){h0.current_city["name"]="南美洲"}if(h0.current_city["code"]>=54000&&h0.current_city["code"]<=70000){h0.current_city["name"]="北美洲"}if(h0.current_city["code"]===54003&&h0.current_city["code"]>=60731&&h0.current_city["code"]<=61123){h0.current_city["name"]="美国"}if(h0.current_city["code"]===54015||h0.current_city["code"]>=57970&&h0.current_city["code"]<=60223){h0.current_city["name"]="加拿大"}if(h0.current_city["code"]===54025||h0.current_city["code"]>=54338&&h0.current_city["code"]<=57374){h0.current_city["name"]="墨西哥"}e.enableRequest=true;if(h0&&h0.current_city){var hZ=h0.current_city["name"];var hY=h0.current_city["code"];if(hY!==i.cCode){var hX=new bb("oncitychange");hX.name=hZ;hX.code=hY;i.dispatchEvent(hX)}i.cityName=hZ;i.cCode=hY;if(!f8()){ew(i)}}},{qt:"cen",b:T.lng+","+T.lat+";"+hV.lng+","+hV.lat,l:hW},"","",true)};i.addEventListener("load",function(T){e.request()});i.addEventListener("moveend",function(T){e.request()});i.addEventListener("zoomend",function(T){e.request()});e.request()});function fF(i){if(i.temp.copyadded){return}i.temp.copyadded=true;if(!i.cpyCtrl){var hU=new d9(2,2);i.config.cpyCtrlOffset=hU;if(f8()){hU.width=72;hU.height=0}var T=new dH({offset:hU,printable:true});i.cpyCtrl=T}if(!f8()){ew(i);i.addEventListener("maptypechange",function(){ew(i)})}i.addControl(T);var e=new af();e._opts={printable:true};i.logoCtrl=e;i.addControl(e);i.addEventListener("resize",function(){if(this.getSize().width>=300&&i.getSize().height>=100){e.show();T.setOffset(i.config.cpyCtrlOffset)}else{e.hide();T.setOffset(new d9(4,2))}});if(i.getSize().width>=300&&i.getSize().height>=100){e.show()}else{e.hide();T.setOffset(new d9(4,2))}i.addEventListener("oncopyrightoffsetchange",function(hV){i.logoCtrl.setOffset(hV.target.logo);i.cpyCtrl.setOffset(hV.target.cpy)});i.dispatchEvent(new bb("oncopyrightaddend"))}function ew(h9){if(!h9.cpyCtrl){var ii=new d9(2,2);if(f8()){ii.width=72;ii.height=0}var ic=new dH({offset:ii,printable:true});h9.cpyCtrl=ic}var it=h9.cityName||"中国";var ia=h9.getMapType();var ib=["常州市","南昌市","乌鲁木齐市","无锡市","福州市","泉州市","珠海市","贵阳市"];var h3=["北京市","上海市","广州市","深圳市","宁波市","石家庄市","沈阳市","长春市","青岛市","温州市","台州市","金华市","佛山市","中山市","昆明市","南宁市","苏州市","西安市","济南市","郑州市","合肥市","呼和浩特市","杭州市","成都市","武汉市","长沙市","天津市","南京市","重庆市","大连市","东莞市","厦门市"];var h5=["香港特别行政区"];var hZ=["台湾省"];var ij=["日本"];var iq=["韩国"];var id=["泰国"];var ih=["亚太"];var h0=["新加坡"];var ir=["欧洲"];var hU=["南美洲"];var im=["北美洲"];var T=["美国"];var ig=["墨西哥"];var hX=["加拿大"];for(var io in ib){if(ib[io]===it){var h6=true;break}}for(var io in h3){if(h3[io]===it){var hV=true;break}}for(var io in h5){if(h5[io]===it){var iv=true;break}}if(hZ[0]===it){var il=true}if(h0[0]===it){var i=true}if(ij[0]===it){var h2=true}if(iq[0]===it){var h8=true}if(id[0]===it){var h7=true}if(ih[0]===it){var hY=true}if(ir[0]===it){var h4=true}if(hU[0]===it){var h1=true}if(im[0]===it){var e=true}if(T[0]===it){var ip=true}if(hX[0]===it){var ik=true}if(ig[0]===it){var hW=true}var iu=["&copy;&nbsp;2021 Baidu - GS(2019)5218号 - 甲测资字1100930 - 京ICP证030173号 - Data &copy; "];var ie="rgba(255, 255, 255, 0.701961)";if(h9.getZoom()<=9){iu=["&copy;&nbsp;2021 Baidu - GS(2019)5218号 - 甲测资字1100930 - 京ICP证030173号 - Data &copy; "]}else{if(il){iu=["&copy;&nbsp;2021 Baidu - GS(2019)5218号 - 甲测资字1100930 - 京ICP证030173号 - Data &copy; "]}else{if(h2||h8){iu=["&copy;&nbsp;2021 Baidu - GS(2019)5218号 - 甲测资字1100930 - 京ICP证030173号 - Data &copy; "]}else{if(i||h7){iu=["&copy;&nbsp;2021 Baidu - GS(2019)5218号 - 甲测资字1100930 - 京ICP证030173号 - Data &copy; "]}else{if(hY){iu=["&copy;&nbsp;2021 Baidu - GS(2019)5218号 - 甲测资字1100930 - 京ICP证030173号 - Data &copy; "]}else{if(h4){iu=["&copy;&nbsp;2021 Baidu - GS(2019)5218号 - 甲测资字1100930 - 京ICP证030173号 - Data &copy; "]}else{if(h1){iu=["&copy;&nbsp;2021 Baidu - GS(2019)5218号 - 甲测资字1100930 - 京ICP证030173号 - Data &copy; "]}else{if(e){iu=["&copy;&nbsp;2021 Baidu - GS(2019)5218号 - 甲测资字1100930 - 京ICP证030173号 - Data &copy; "]}}}}}}}}if(h9.getZoom()<=9){iu.push("长地万方");iu.push(' &amp; <a target="_blank" href="http://www.openstreetmap.org/">OpenStreetMap</a>');iu.push(' &amp; <a target="_blank" href="http://corporate.navteq.com/supplier_terms.html">HERE</a>');if(ia===BMAP_SATELLITE_MAP||ia===BMAP_HYBRID_MAP){iu.push(' &amp; <a target="_blank" href="http://www.eso.org/public/">ESO</a>');ie="rgba(0,0,0,.7)"}}else{if(h2||h8){iu.push('<a target="_blank" href="http://www.openstreetmap.org/">OpenStreetMap</a>')}else{if(i||h7){iu.push('<a target="_blank" href="http://corporate.navteq.com/supplier_terms.html">HERE</a>')}else{if(hY){iu.push('<a target="_blank" href="http://corporate.navteq.com/supplier_terms.html">HERE</a>');iu.push(' &amp; <a target="_blank" href="https://www.mapbox.com/">Mapbox</a>')}else{if(h4){iu.push('<a target="_blank" href="http://www.openstreetmap.org/">OpenStreetMap</a>');iu.push(' &amp; <a target="_blank" href="https://www.mapbox.com/">Mapbox</a>')}else{if(h1){iu.push('<a target="_blank" href="http://www.openstreetmap.org/">OpenStreetMap</a>');iu.push(' &amp; <a target="_blank" href="https://www.mapbox.com/">Mapbox</a>')}else{if(ip||hW||ik){iu.push('<a target="_blank" href="http://corporate.navteq.com/supplier_terms.html">HERE</a>');iu.push(' &amp; <a target="_blank" href="https://www.mapbox.com/">Mapbox</a>')}else{if(e){iu.push('<a target="_blank" href="http://www.openstreetmap.org/">OpenStreetMap</a>');iu.push(' &amp; <a target="_blank" href="https://www.mapbox.com/">Mapbox</a>')}else{iu.push("长地万方");if(h6){iu.push(' &amp; <a target="_blank" href="http://www.palmcity.cn/palmcity/">PalmCity</a>')}if(iv){iu.push(' &amp; <a target="_blank" href="http://www.mapking.com/HongKong/eng/home/MapKing_Webmap.html">MapKing</a>')}if(il){iu.push(' &amp; <a target="_blank" href="http://corporate.navteq.com/supplier_terms.html">HERE</a>');iu.push(' &amp; <a target="_blank" href="http://www.localking.com.tw/about/localking.aspx">樂客LocalKing</a>')}if(ia===BMAP_SATELLITE_MAP||ia===BMAP_HYBRID_MAP){ie="rgba(0,0,0,.7)"}}}}}}}}}iu.unshift('<span style="background: '+ie+';padding: 0px 1px;line-height: 16px;display: inline;height: 16px;">');iu.push("</span>");iu=iu.join("");h9.cpyCtrl.addCopyright({id:1,content:iu})}window.BMAP_STATUS_SUCCESS=0;window.BMAP_STATUS_CITY_LIST=1;window.BMAP_STATUS_UNKNOWN_LOCATION=2;window.BMAP_STATUS_UNKNOWN_ROUTE=3;window.BMAP_STATUS_INVALID_KEY=4;window.BMAP_STATUS_INVALID_REQUEST=5;window.BMAP_STATUS_PERMISSION_DENIED=6;window.BMAP_STATUS_SERVICE_UNAVAILABLE=7;window.BMAP_STATUS_TIMEOUT=8;window.BMAP_ROUTE_TYPE_WALKING=2;window.BMAP_ROUTE_TYPE_DRIVING=3;window.BMAP_ROUTE_TYPE_RIDING=6;window.BMAP_ROUTE_STATUS_NORMAL=0;window.BMAP_ROUTE_STATUS_EMPTY=1;window.BMAP_ROUTE_STATUS_ADDRESS=2;var eG="cur";var b2="cen";var em="s";var P="con";var dM="bd";var gg="nb";var hL="bt";var cP="nav";var ek="walk";var hH="gc";var fO="rgc";var ey="dec";var fe="bse";var fp="nse";var g="bl";var bc="bsl";var bp="bda";var X="sa";var az="nba";var bZ="drag";var H="ext";var aO="hip";var R="ride";var fT="drct";var gs=2;var fQ=4;var ha=7;var g8=11;var fA=12;var hF=14;var bQ=15;var dJ=18;var fh=20;var cI=21;var co=19;var fa=23;var ci=26;var ao=28;var ei=31;var cF=35;var gk=44;var hS=45;var eJ=46;var cD=47;var gB=-1;var g0=0;var hf=1;var cm=2;var b8=3;window.BMAP_POI_TYPE_NORMAL=0;var Q=1;var cc=2;BMapGL.I=C.I;var O={};O.removeHtml=function(e){e=e.replace(/<\/?[^>]*>/g,"");e=e.replace(/[ | ]* /g," ");return e};O.parseGeoExtReg1=function(e){return e.replace(/([1-9]\d*\.\d*|0\.\d*[1-9]\d*|0?\.0+|0|[1-9]\d*),([1-9]\d*\.\d*|0\.\d*[1-9]\d*|0?\.0+|0|[1-9]\d*)(,)/g,"$1,$2;")};O.parseGeoExtReg2=function(i,e){var T=new RegExp("(((-?\\d+)(\\.\\d+)?),((-?\\d+)(\\.\\d+)?);)(((-?\\d+)(\\.\\d+)?),((-?\\d+)(\\.\\d+)?);){"+e+"}","ig");return i.replace(T,"$1")};var fy=0;var cH=1;var hb=2;O.unique=function(T){var hW=false;var hV=[];var hX={};for(var hU=0,e=T.length;hU<e;hU++){if(!hX[T[hU]]){hX[T[hU]]=true;hV.push(T[hU])}}return hV};O.getBestLevel=function(T,i){if(i){var e=Math.min(i.width/1100,i.height/660);T=Math.round(T+(Math.log(e)/Math.log(2)))}if(T<1){T=1}if(T>21){T=21}return T};O.parseGeo=function(hX,h0){if(typeof hX!="string"||!hX){return}var h2=hX.split("|");var e;var hV;var T;if(h2.length==1){e=gd(hX)}else{e=gd(h2[2]);hV=gd(h2[0]);T=gd(h2[1]);if(!h0){return e}}var hY={type:e.geoType};if(h0){switch(hY.type){case hb:var hZ=new hv(e.geo[0][0],e.geo[0][1]);var h1=en.convertMC2LL(hZ);hY.point=h1;hY.points=[h1];break;case cH:hY.points=[];var h3=e.geo[0];for(var hW=0,hU=h3.length-1;hW<hU;hW+=2){var h4=new hv(h3[hW],h3[hW+1]);h4=en.convertMC2LL(h4);hY.points.push(h4)}hV=new hv(hV.geo[0][0],hV.geo[0][1]);T=new hv(T.geo[0][0],T.geo[0][1]);hV=en.convertMC2LL(hV);T=en.convertMC2LL(T);hY.bounds=new dS(hV,T);break;default:break}}return hY};O.parseGeoExt=function(id,h4){if(!h4){h4=0}else{if(h4<0.25){h4=0}else{if(h4>0.25&&h4<1){h4=1}else{if(h4>32){h4=32}}}}var hZ=id.split("|");if(hZ.length==1){var hU=gd(hZ[0]);return{type:hU.type,bound:"",points:hU.geo.join(",")}}else{if(hZ.length>1){var h5=id.split(";.=");var h1=[];var hV=[];var h6=0;var ia=h5.length;for(var h7=0;h7<ia;h7++){var ic=h5[h7];if(ia>1){if(h7==0){ic=ic+";"}if(h7>0&&h7<ia-1){ic=".="+ic+";"}if(h7==ia-1){ic=".="+ic}}var hW=ic.split("|");var h9=gd(hW[0]);var h8=gd(hW[1]);h1.push(h9.geo.join(","));h1.push(h8.geo.join(","));var hU=gd(hW[2]);h6=hU.type;var ib=hU.geo.join(",");ib=O.parseGeoExtReg1(ib);if(h4>0){ib=O.parseGeoExtReg2(ib,h4)}hV.push(ib)}if(ia<=1){hV=hV.join(";")}if(ia==2){var T=hV[0]+";"+hV[1];var hX=T.split(";");var e=[];for(var h7=0;h7<hX.length;h7++){var h0=hX[h7].split(",")[0];var hY=hX[h7].split(",")[1];var h2=new hv(h0,hY);var h3=en.convertMC2LL(h2);e.push(h3)}hV=e}return{type:h6,bound:h1.join(";"),points:hV}}}};O.getPoiPoint=function(e){var T=[];var i=null;if(e.toString()=="Point"){i=e}else{if(typeof e=="string"){T=C.trim(e).split(",");if(T.length<2){return}T[0]=parseFloat(C.trim(T[0]));T[1]=parseFloat(C.trim(T[1]))}else{T=e.slice(0);if(T.length<2){return}}i=new BMap.Point(T[0],T[1])}return i};O.parseGeoStr=function(T){var i=T.split(",");var e=new hv(i[0],i[1]);return en.convertMC2LL(e)};O.level={country:4,province:11,city:12,area:13};var hM=["=",".","-","*"];var f7=1<<23;function gd(h0){var hZ=a9(h0.charAt(0));var T=h0.substr(1);var h2=0;var e=T.length;var h3=[];var hX=[];var hY=[];while(h2<e){if(T.charAt(h2)==hM[0]){if((e-h2)<13){return 0}hY=aL(T.substr(h2,13),h3);if(hY<0){return 0}h2+=13}else{if(T.charAt(h2)==";"){hX.push(h3.slice(0));h3.length=0;++h2}else{if((e-h2)<8){return 0}hY=c6(T.substr(h2,8),h3);if(hY<0){return 0}h2+=8}}}for(var hW=0,hU=hX.length;hW<hU;hW++){for(var hV=0,h1=hX[hW].length;hV<h1;hV++){hX[hW][hV]/=100}}return{geoType:hZ,geo:hX}}function a9(i){var e=-1;if(i==hM[1]){e=hb}else{if(i==hM[2]){e=cH}else{if(i==hM[3]){e=fy}}}return e}function aL(hV,T){var e=0;var hX=0;var hW=0;for(var hU=0;hU<6;hU++){hW=cO(hV.substr(1+hU,1));if(hW<0){return -1-hU}e+=hW<<(6*hU);hW=cO(hV.substr(7+hU,1));if(hW<0){return -7-hU}hX+=hW<<(6*hU)}T.push(e);T.push(hX);return 0}function c6(hW,hU){var T=hU.length;if(T<2){return -1}var e=0;var hY=0;var hX=0;for(var hV=0;hV<4;hV++){hX=cO(hW.substr(hV,1));if(hX<0){return -1-hV}e+=hX<<(6*hV);hX=cO(hW.substr(4+hV,1));if(hX<0){return -5-hV}hY+=hX<<(6*hV)}if(e>f7){e=f7-e}if(hY>f7){hY=f7-hY}hU.push(hU[T-2]+e);hU.push(hU[T-1]+hY);return 0}function cO(i){var e=i.charCodeAt(0);if(i>="A"&&i<="Z"){return e-"A".charCodeAt(0)}else{if(i>="a"&&i<="z"){return(26+e-"a".charCodeAt(0))}else{if(i>="0"&&i<="9"){return(52+e-"0".charCodeAt(0))}else{if(i=="+"){return 62}else{if(i=="/"){return 63}}}}}return -1}O.pathToPoints=function(hW){var hU=[];if(typeof hW!=="string"){return hU}else{var hV=hW.split(";");for(var T=0;T<hV.length;T++){var e=hV[T].split(",");hU.push(new hv(e[0],e[1]))}}return hU};window.BMAP_POI_TYPE_NORMAL=0;window.BMAP_POI_TYPE_BUSSTOP=1;window.BMAP_POI_TYPE_BUSLINE=2;window.BMAP_POI_TYPE_SUBSTOP=3;window.BMAP_POI_TYPE_SUBLINE=4;var hy=0;var fZ=1;var c3={};window.APIPack=c3;function fD(i,e){ed.call(this);this._loc={};this.setLocation(i);e=e||{};e.renderOptions=e.renderOptions||{};this._opts={renderOptions:{panel:e.renderOptions.panel||null,map:e.renderOptions.map||null,autoViewport:e.renderOptions.autoViewport||true,selectFirstResult:e.renderOptions.selectFirstResult,highlightMode:e.renderOptions.highlightMode,enableDragging:e.renderOptions.enableDragging||false},onSearchComplete:e.onSearchComplete||function(){},onMarkersSet:e.onMarkersSet||function(){},onInfoHtmlSet:e.onInfoHtmlSet||function(){},onResultsHtmlSet:e.onResultsHtmlSet||function(){},onGetBusListComplete:e.onGetBusListComplete||function(){},onGetBusLineComplete:e.onGetBusLineComplete||function(){},onBusListHtmlSet:e.onBusListHtmlSet||function(){},onBusLineHtmlSet:e.onBusLineHtmlSet||function(){},onPolylinesSet:e.onPolylinesSet||function(){},reqFrom:e.reqFrom||""};if(typeof e!="undefined"&&typeof e.renderOptions!="undefined"&&typeof e.renderOptions["autoViewport"]!="undefined"){this._opts.renderOptions.autoViewport=e.renderOptions["autoViewport"]}else{this._opts.renderOptions.autoViewport=true}this._opts.renderOptions.panel=C.G(this._opts.renderOptions.panel)}fD.inherits(ed,"BaseSearch");C.extend(fD.prototype,{getResults:function(){if(!this._isMultiKey){return this._results}else{return this._arrResults}},enableAutoViewport:function(){this._opts.renderOptions.autoViewport=true},disableAutoViewport:function(){this._opts.renderOptions.autoViewport=false},setLocation:function(e){if(!e){return}this._loc.src=e},setSearchCompleteCallback:function(e){this._opts.onSearchComplete=e||function(){}},setMarkersSetCallback:function(e){this._opts.onMarkersSet=e||function(){}},setPolylinesSetCallback:function(e){this._opts.onPolylinesSet=e||function(){}},setInfoHtmlSetCallback:function(e){this._opts.onInfoHtmlSet=e||function(){}},setResultsHtmlSetCallback:function(e){this._opts.onResultsHtmlSet=e||function(){}},getStatus:function(){return this._status}});var dN=function(T,i){fD.call(this,T,i);i=i||{};i.renderOptions=i.renderOptions||{};this.setPageCapacity(i.pageCapacity);if(typeof i.renderOptions["selectFirstResult"]!="undefined"&&!i.renderOptions["selectFirstResult"]){this.disableFirstResultSelection()}else{this.enableFirstResultSelection()}this._overlays=[];this._arrPois=[];this._curIndex=-1;this._queryList=[];var e=this;ea.load("localSearch",function(){e._check()},true)};dN.inherits(fD,"LocalSearch");dN.DEFAULT_PAGE_CAPACITY=10;dN.MIN_PAGE_CAPACITY=1;dN.MAX_PAGE_CAPACITY=100;dN.DEFAULT_RADIUS=2000;dN.MAX_RADIUS=100000;C.extend(dN.prototype,{search:function(e,i){this._queryList.push({method:"search",arguments:[e,i]})},searchInBounds:function(e,T,i){this._queryList.push({method:"searchInBounds",arguments:[e,T,i]})},searchNearby:function(T,i,e,hU){this._queryList.push({method:"searchNearby",arguments:[T,i,e,hU]})},clearResults:function(){delete this._json;delete this._status;delete this._results;delete this._ud;this._curIndex=-1;this._setStatus();if(this._opts.renderOptions.panel){this._opts.renderOptions.panel.innerHTML=""}},gotoPage:function(){},enableFirstResultSelection:function(){this._opts.renderOptions.selectFirstResult=true},disableFirstResultSelection:function(){this._opts.renderOptions.selectFirstResult=false},setPageCapacity:function(e){if(typeof e=="number"&&!isNaN(e)){this._opts.pageCapacity=e<1?dN.DEFAULT_PAGE_CAPACITY:(e>dN.MAX_PAGE_CAPACITY?dN.DEFAULT_PAGE_CAPACITY:e)}else{this._opts.pageCapacity=dN.DEFAULT_PAGE_CAPACITY}},getPageCapacity:function(){return this._opts.pageCapacity},toString:function(){return"LocalSearch"}});function V(i){this._opts={};C.extend(this._opts,i);this._queryList=[];var e=this;ea.load("otherSearch",function(){e._asyncSearch()})}V.inherits(ed,"Geocoder");C.extend(V.prototype,{getPoint:function(e,T,i){this._queryList.push({method:"getPoint",arguments:[e,T,i]})},getLocation:function(e,T,i){this._queryList.push({method:"getLocation",arguments:[e,T,i]})},toString:function(){return"Geocoder"}});function cS(e){e=e||{};this.config={timeout:e.timeout||1000*10,maximumAge:e.maximumAge||0,enableHighAccuracy:e.enableHighAccuracy||false,SDKLocation:e.SDKLocation||false};this._pendingCalls=[];var i=this;ea.load("otherSearch",function(){var T=i._pendingCalls.length;for(var hU=0;hU<T;hU++){var hV=i._pendingCalls[hU];i[hV.method].apply(i,hV.arguments)}})}C.extend(cS.prototype,{getCurrentPosition:function(e,i){this._pendingCalls.push({method:"getCurrentPosition",arguments:arguments})},getStatus:function(){return BMAP_STATUS_UNKNOWN_LOCATION},enableSDKLocation:function(){if(f8()){this.config.SDKLocation=true}},disableSDKLocation:function(){this.config.SDKLocation=false}});function gC(){this._queryList=[];var e=this;ea.load("otherSearch",function(){e._asyncSearch()})}gC.inherits(ed,"Boundary");C.extend(gC.prototype,{get:function(i,e){this._queryList.push({method:"get",arguments:[i,e]})},toString:function(){return"Boundary"}});function W(i){i=i||{};i.renderOptions=i.renderOptions||{};this._opts={renderOptions:{map:i.renderOptions.map||null}};this._queryList=[];var e=this;ea.load("otherSearch",function(){e._asyncSearch()})}W.inherits(ed,"LocalCity");C.extend(W.prototype,{get:function(e){this._queryList.push({method:"get",arguments:[e]})},toString:function(){return"LocalCity"}});function cN(e,T){ed.call(this);this.markersList=[];this.destList=[];this.pointsList=[];this._opts=T;this.json=e;this.map=this._opts.renderOptions.map||null;this.sType=this._opts.sType;this.infoWindow=null;this.curPointIndex=0;this.startName="";this.endIndex=1;this.endName="";this.resCity=[0,0,0,0,0,0,0];this.locPois=[];this.curPageIndex=[1,1,1,1,1,1,1];this.totalPage=[1,1,1,1,1,1,1];this.resCount=[0,0,0,0,0,0,0];this.resType=[0,0,0,0,0,0,0];this.qInfo=[{n:"",c:0,u:0,x:0,y:0,t:-1},{n:"",c:0,u:0,x:0,y:0,t:-1},{n:"",c:0,u:0,x:0,y:0,t:-1},{n:"",c:0,u:0,x:0,y:0,t:-1},{n:"",c:0,u:0,x:0,y:0,t:-1},{n:"",c:0,u:0,x:0,y:0,t:-1},{n:"",c:0,u:0,x:0,y:0,t:-1}];this.curSelectedIndex=-1;this.tpList=[];this.tpListInMap=[];var i=this;ea.load("route",function(){})}cN.inherits(ed,"RouteAddr");function d2(T,i){fD.call(this,T,i);this.QUERY_TYPE_BUSLIST=g;this.RETURN_TYPE_BUSLIST=bQ;this.QUERY_TYPE_BUSLINE=bc;this.RETURN_TYPE_BUSLINE=dJ;this._queryList=[];var e=this;ea.load("buslineSearch",function(){e._asyncSearch()})}var bn=e5.staticHost+"/wolfman/static/common/images/";d2._iconOpen=e5.apiIMG+"/iw_plus.gif";d2._iconClose=e5.apiIMG+"/iw_minus.gif";d2._stopUrl=bn+"new/bus-stop-1x_ddd4723.png";d2.inherits(fD,"BusLineSearch");C.extend(d2.prototype,{getBusList:function(e){this._queryList.push({method:"getBusList",arguments:[e]})},getBusLine:function(e){this._queryList.push({method:"getBusLine",arguments:[e]})},setGetBusListCompleteCallback:function(e){this._opts.onGetBusListComplete=e||function(){}},setGetBusLineCompleteCallback:function(e){this._opts.onGetBusLineComplete=e||function(){}},setBusListHtmlSetCallback:function(e){this._opts.onBusListHtmlSet=e||function(){}},setBusLineHtmlSetCallback:function(e){this._opts.onBusLineHtmlSet=e||function(){}},setPolylinesSetCallback:function(e){this._opts.onPolylinesSet=e||function(){}}});function g5(i){fD.call(this,i);i=i||{};this._options={input:i.input||null,baseDom:i.baseDom||null,types:i.types||[],onSearchComplete:i.onSearchComplete||function(){}};this._loc.src=i.location||"全国";this._word="";this._show=false;this._suggestion=null;this._inputValue="";this._initialize();var e=this;ea.load("autocomplete",function(){e._asyncSearch()},true)}g5.inherits(fD,"Autocomplete");C.extend(g5.prototype,{_initialize:function(){},show:function(){this._show=true},hide:function(){this._show=false},setTypes:function(e){this._options.types=e},setLocation:function(e){this._loc.src=e},search:function(e){this._word=e},setInputValue:function(e){this._inputValue=e},setSearchCompleteCallback:function(e){this._options.onSearchComplete=e}});var hi=function(i,e){fD.call(this,i,e)};C.inherit(hi,fD,"BaseRoute");C.extend(hi.prototype,{clearResults:function(){}});window.BMAP_TRANSIT_POLICY_RECOMMEND=0;window.BMAP_TRANSIT_POLICY_LEAST_TIME=4;window.BMAP_TRANSIT_POLICY_LEAST_TRANSFER=1;window.BMAP_TRANSIT_POLICY_LEAST_WALKING=2;window.BMAP_TRANSIT_POLICY_AVOID_SUBWAYS=3;window.BMAP_TRANSIT_POLICY_FIRST_SUBWAYS=5;window.BMAP_LINE_TYPE_BUS=0;window.BMAP_LINE_TYPE_SUBWAY=1;window.BMAP_LINE_TYPE_FERRY=2;window.BMAP_LINE_TYPE_TRAIN=3;window.BMAP_LINE_TYPE_AIRPLANE=4;window.BMAP_LINE_TYPE_COACH=5;var dk=3;var fm=4;var hB=1;var dZ=2;var gS=5;var g9=6;window.BMAP_TRANSIT_TYPE_IN_CITY=0;window.BMAP_TRANSIT_TYPE_CROSS_CITY=1;window.BMAP_TRANSIT_PLAN_TYPE_ROUTE=0;window.BMAP_TRANSIT_PLAN_TYPE_LINE=1;window.BMAP_TRANSIT_TYPE_POLICY_TRAIN=0;window.BMAP_TRANSIT_TYPE_POLICY_AIRPLANE=1;window.BMAP_TRANSIT_TYPE_POLICY_COACH=2;window.BMAP_INTERCITY_POLICY_LEAST_TIME=0;window.BMAP_INTERCITY_POLICY_EARLY_START=1;window.BMAP_INTERCITY_POLICY_CHEAP_PRICE=2;function bI(T,i){hi.call(this,T,i);i=i||{};this.setPolicy(i.policy);this.setIntercityPolicy(i.intercityPolicy);this.setTransitTypePolicy(i.transitTypePolicy);this.setPageCapacity(i.pageCapacity);this.QUERY_TYPE=hL;this.RETURN_TYPE=hF;this.ROUTE_TYPE=fZ;this._overlays=[];this._curIndex=-1;this._opts._enableTraffic=i.enableTraffic||false;this._queryList=[];var e=this;ea.load("route",function(){e._asyncSearch()},true)}bI.MAX_PAGE_CAPACITY=100;bI.LINE_TYPE_MAPPING=[0,1,0,0,0,0,0,0,2,0,0,0,1,1,1];bI.LINE_TYPE_MAPPING_CROSS_CITY=[0,3,4,0,0,0,5];C.inherit(bI,hi,"TransitRoute");C.extend(bI.prototype,{setPolicy:function(e){if(e>=BMAP_TRANSIT_POLICY_RECOMMEND&&e<=BMAP_TRANSIT_POLICY_FIRST_SUBWAYS){this._opts.policy=e}else{this._opts.policy=BMAP_TRANSIT_POLICY_RECOMMEND}},setIntercityPolicy:function(e){if(e>=BMAP_INTERCITY_POLICY_LEAST_TIME&&e<=BMAP_INTERCITY_POLICY_CHEAP_PRICE){this._opts.intercityPolicy=e}else{this._opts.intercityPolicy=BMAP_INTERCITY_POLICY_LEAST_TIME}},setTransitTypePolicy:function(e){if(e>=BMAP_TRANSIT_TYPE_POLICY_TRAIN&&e<=BMAP_TRANSIT_TYPE_POLICY_COACH){this._opts.transitTypePolicy=e}else{this._opts.transitTypePolicy=BMAP_TRANSIT_TYPE_POLICY_TRAIN}},_internalSearch:function(i,e){this._queryList.push({method:"_internalSearch",arguments:[i,e]})},search:function(i,e){this._queryList.push({method:"search",arguments:[i,e]})},setPageCapacity:function(e){if(typeof e==="string"){e=parseInt(e,10);if(isNaN(e)){this._opts.pageCapacity=bI.MAX_PAGE_CAPACITY;return}}if(typeof e!=="number"){this._opts.pageCapacity=bI.MAX_PAGE_CAPACITY;return}if(e>=1&&e<=bI.MAX_PAGE_CAPACITY){this._opts.pageCapacity=Math.round(e)}else{this._opts.pageCapacity=bI.MAX_PAGE_CAPACITY}},toString:function(){return"TransitRoute"},_shortTitle:function(e){return e.replace(/\(.*\)/,"")}});window.BMAP_HIGHLIGHT_STEP=1;window.BMAP_HIGHLIGHT_ROUTE=2;var cK=function(e,hU){hi.call(this,e,hU);this._overlays=[];this._curIndex=-1;this._queryList=[];var T=this;var i=this._opts.renderOptions;if(i.highlightMode!==BMAP_HIGHLIGHT_STEP&&i.highlightMode!==BMAP_HIGHLIGHT_ROUTE){i.highlightMode=BMAP_HIGHLIGHT_STEP}this._enableDragging=this._opts.renderOptions.enableDragging?true:false;ea.load("route",function(){T._asyncSearch()},true);if(this.init_d){this.init_d()}};cK.ROAD_TYPE=["","环岛","无属性道路","主路","高速连接路","交叉点内路段","连接道路","停车场内部道路","服务区内部道路","桥","步行街","辅路","匝道","全封闭道路","未定义交通区域","POI连接路","隧道","步行道","公交专用道","提前右转道"];C.inherit(cK,hi,"DWRoute");C.extend(cK.prototype,{search:function(T,e,i){this._queryList.push({method:"search",arguments:[T,e,i]})}});window.BMAP_DRIVING_POLICY_DEFAULT=0;window.BMAP_DRIVING_POLICY_AVOID_HIGHWAYS=3;window.BMAP_DRIVING_POLICY_FIRST_HIGHWAYS=4;window.BMAP_DRIVING_POLICY_AVOID_CONGESTION=5;window.BMAP_TRAFFICE_STATUS_NONE=0;window.BMAP_TRAFFICE_STATUS_NORMAL=1;window.BMAP_TRAFFICE_STATUS_SLOW=2;window.BMAP_TRAFFICE_STATUS_JAM=3;function fH(e,i){cK.call(this,e,i);i=i||{};this._opts._enableTraffic=i.enableTraffic||false;this.setPolicy(i.policy);this.QUERY_TYPE=cP;this.RETURN_TYPE=fh;this.ROUTE_TYPE=BMAP_ROUTE_TYPE_DRIVING}C.inherit(fH,cK,"DrivingRoute");fH.prototype.setPolicy=function(e){if(e>=BMAP_DRIVING_POLICY_DEFAULT&&e<=BMAP_DRIVING_POLICY_AVOID_CONGESTION){this._opts.policy=e}else{this._opts.policy=BMAP_DRIVING_POLICY_DEFAULT}};function ba(e,i){cK.call(this,e,i);this.QUERY_TYPE=ek;this.RETURN_TYPE=ei;this.ROUTE_TYPE=BMAP_ROUTE_TYPE_WALKING;this._enableDragging=false}C.inherit(ba,cK,"WalkingRoute");function bm(e,i){cK.call(this,e,i);this.QUERY_TYPE=R;this.ROUTE_TYPE=BMAP_ROUTE_TYPE_RIDING;this._enableDragging=false}C.inherit(bm,cK,"RidingRoute");window.BMAP_MODE_DRIVING="driving";window.BMAP_MODE_TRANSIT="transit";window.BMAP_MODE_WALKING="walking";window.BMAP_MODE_NAVIGATION="navigation";var be={web:"//api.map.baidu.com/direction?",android:"bdapp://map/direction?",ios:"baidumap://map/direction?"};function hw(e){this.opts=e||{}}C.extend(hw.prototype,{routeCall:function(hU,e,T){var i=this;ea.load("route",function(){i._asyncSearch(hU,e,T)})}});bo.Map=c8;bo.MapType=b6;bo.Point=hv;bo.Pixel=ej;bo.Size=d9;bo.Bounds=dS;bo.TileLayer=cR;bo.Copyright=c5;bo.Projection=bo.Project=en;bo.XYZProjection=bo.XYZProject=eu;bo.Convertor=ax;bo.RenderTypeUtils=a8;bo.Overlay=bl;bo.Label=fS;bo.Marker=aC;bo.Icon=he;bo.Polyline=ak;bo.BezierCurve=fq;bo.PolylineMultipart=fo;bo.Polygon=g7;bo.Prism=cg;bo.Marker3D=cv;bo.GroundOverlay=cp;bo.InfoWindow=an;bo.SimpleInfoWindow=hK;bo.Circle=dF;bo.Control=a7;bo.NavigationControl=dt;bo.NavigationControl3D=eV;bo.CopyrightControl=dH;bo.ScaleControl=hk;bo.CityListControl=eb;bo.MapTypeControl=bC;bo.ZoomControl=cy;bo.LocationControl=bA;bo.LogoControl=af;bo.DistanceTool=gO;bo.ContextMenu=cf;bo.MenuItem=fB;bo.OperationMask=eh;bo.Animation=o;bo.ViewAnimation=cM;bo.Transitions=cn;bo.Event=bb;bo.trafficLayer=ce;bo.WMSLayer=e3;bo.XYZLayer=fc;bo.BaiduLayer=aV;bo.Geolocation=cS;bo.Geocoder=V;bo.Boundary=gC;bo.LocalCity=W;bo.LocalSearch=dN;bo.Autocomplete=g5;bo.BusLineSearch=d2;bo.WalkingRoute=ba;bo.RidingRoute=bm;bo.DrivingRoute=fH;bo.TransitRoute=bI;bo.RouteSearch=hw;function d1(e,i){for(var T in i){e[T]=i[T]}}bo.verify();bo.apiLoad();bo.frequency();bo.getSeckey();})(BMapGL,"BMapGL");